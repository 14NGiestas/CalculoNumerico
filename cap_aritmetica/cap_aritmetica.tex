%Este trabalho está licenciado sob a Licença Creative Commons Atribuição-CompartilhaIgual 3.0 Não Adaptada. Para ver uma cópia desta licença, visite http://creativecommons.org/licenses/by-sa/3.0/ ou envie uma carta para Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.

\documentclass[main.tex]{subfiles}

\begin{document}

\chapter{Aritmética de Máquina}\index{aritmética!de máquina}

\section{Sistema de Numeração e Mudança de Base}\index{mundança de base}\index{sistema de numeração}
Usualmente, utilizamos o sistema de numeração decimal para representar números. Esse é um sistema de numeração posicional onde a posição do dígito indica a potência de $10$ que o dígito está representando.

\begin{ex}
  O número 293 decomposto em centenas, dezenas e unidades:
  \begin{eqnarray*}
    293&=&2\ \hbox{centenas}+9\ \hbox{dezenas}+3\ \hbox{unidades}\\
    &=&2\cdot 10^2+9\cdot 10^1+3\cdot 10^0.
  \end{eqnarray*}
\end{ex}

O sistema de numeração posicional também pode ser usado com outras bases. Vejamos a seguinte definição.

\begin{defn}[Sistema de numeração de base $b$]\label{def:sistema_de_numeração}
Dado um número natural $b>1$ e a coleção de símbolos $\{\pmb{+}, \pmb{-}, \pmb{,} ,\pmb{0}, \pmb{1}, \pmb{2},\dotsc, \pmb{b-1}\}$\footnote{Para sistemas de numeração com base $b>10$, veja a Observação \ref{obs:sistema_de_numeracao}}, a seguinte notação:
\begin{equation*}
\pm \left(d_nd_{n-1} \ldots d_1d_0,d_{-1}d_{-2} \ldots \right)_b  
\end{equation*}
representa o número:
\begin{equation*}
\pm d_n\cdot b^n + d_{n-1}\cdot b^{n-1} + \cdots + d_0\cdot b^0 + d_{-1}\cdot b^{-1}+d_{-2}\cdot b^{-2} + \cdots
\end{equation*}
\end{defn}

\begin{obs}[$b\geq 10$]\label{obs:sistema_de_numeracao}
Para sistemas de numeração com base $b \geq 10$ é usual utilizar as seguintes notações:
\begin{itemize}
\item No sistema de numeração decimal, i.e. $b=10$, representamos o número:
\begin{equation*}
  \pm d_nd_{n-1}\ldots d_1d_0,d_{-1}d_{-2}\ldots := \pm (d_nd_{n-1}\ldots d_1d_0,d_{-1}d_{-2}\ldots)_{10}  
\end{equation*}
Ou seja, não usamos parênteses nem o subíndice indicando a base.
\item Em sistemas de numeração com base $b>10$, usamos as letras $A$, $B$, $C$, etc., para denotar os algarismos: $A=10$, $B=11$, $C=12$, etc..
\end{itemize}
\end{obs}

\begin{ex}[Sistema binário] O sistema de numeração em base dois é chamado de binário e os algarismos binários são conhecidos como \textit{bits}, do inglês \textit{\bf{b}inary dig\bf{its}}. Um \textit{bit} pode assumir apenas dois valores distintos: $0$ ou $1$. Por exemplo:
\begin{eqnarray*}
(1001,101)_{2}&=&1\cdot 2^3 +0\cdot 2^2 +0\cdot 2^1 +1\cdot 2^0  +1\cdot 2^{-1} +0\cdot 2^{-2} +1\cdot 2^{-3} \\ &=&8+0+0+1+ 0,5+0+0,125 = 9,625
\end{eqnarray*}
Ou seja, $(1001,101)_{2}$ é igual a $9,625$ no sistema decimal.
\end{ex}

\begin{ex}[Sistema quaternário]
No sistema quaternário a base $b$ é igual a $4$. Por exemplo:
  \begin{equation*}
    (301,2)_{4}=3\cdot 4^2+0\cdot 4^1+1\cdot 4^0+2\cdot 4^{-1}=49,5    
  \end{equation*}
\end{ex}

\begin{ex}[Sistema octal]
No sistema quaternário a base é $b=8$. Por exemplo:
\begin{eqnarray*}
(1357,24)_{8}&=&1\cdot 8^3+3\cdot 8^2+5\cdot 8^1+7\cdot 8^{0}+2\cdot 8^{-1}+4\cdot 8^{-2}\\&=&512+192+40+7+0,25+0,0625=751,3125
\end{eqnarray*}
\end{ex}

\begin{ex}[Sistema hexadecimal] O sistema de numeração cuja a base é $b=16$ é chamado de sistema hexadecimal. O conjunto de símbolos necessários é  $S=\{``,", -, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, A, B, C, D, E, F\}$. O número $(E2AC)_{16}$ no sistema decimal é igual a:
\begin{align*}
  (E2AC)_{16} &= 14\cdot 16^3+2\cdot 16^2+10\cdot 16^1+12\cdot 16^{0}\\
  &=57344+512+160+12=58028
\end{align*}
\end{ex}

\ifisscilab
\begin{ex}[Scilab]
  O Scilab oferece algumas funções para a conversão de números inteiros em dada base para a base decimal. Por exemplo, temos:
\begin{verbatim}
-->bin2dec('1001')
 ans  =
    9.  
-->hex2dec('451')
 ans  =
    1105.  
-->oct2dec('157')
 ans  =
    111.
-->base2dec('BEBA',16)
 ans  =
    48826.  
\end{verbatim}
\end{ex}
\fi

A partir da Definição \ref{def:sistema_de_numeração} acabamos de mostrar vários exemplos de conversão de números de uma sistema de numeração de base $b$ para o sistema decimal. Agora, vamos estudar como fazer o processo inverso. Isto é, dado um número decimal $(X)_{10}$ queremos escrevê-lo em uma outra base $b$, i.e., queremos obter a seguinte representação:
\begin{align*}
  (X)_{10} &= (d_nd_{n-1}\cdots d_0,d_{-1}\cdots)_{b} \\
  &= d_n\cdot b^{n}+d_{n-1}\cdot b^{n-1}+\cdots + d_0\cdot b^0+d_{-1}\cdot b^{-1}+d_{-2}\cdot b^{-2}+\cdots        
\end{align*}

Separando as partes inteira e fracionária de $X$, i.e. $X = X^{\mbox{i}} + X^{\mbox{f}}$, temos:
\begin{equation*}
X^{\mbox{i}} = d_n\cdot b^{n}+ \cdots+d_{n-1}b^{n-1} \cdot  +d_1\cdot b^1 +d_0\cdot b^0 \qquad \hbox{e}\qquad X^{f}
= \frac{d_{-1}}{b^1} + \frac{d_{-2}}{b^{2}} + \cdots  
\end{equation*}
Nosso objetivo é determinar os algarismos $\{d_n, d_{n-1}, ...\}$. 

Primeiramente, vejamos como tratar a parte inteira $X^{\mbox{i}}$. Calculando sua divisão por $b$, temos:
\begin{equation*}
\frac{X^{\mbox{i}}}{b}=   \frac{d_0}{b}+d_1+d_2 b^1\cdots+d_{n-1}\cdot b^{n-2} +d_n\cdot b^{n-1}.  
\end{equation*}
Observe que $d_0$ é o resto da divisão de $X^{\mbox{i}}$ por $b$, pois $d_1+d_2 b^1\cdots+d_{n-1}\cdot b^{n-2} +d_n\cdot b^{n-1}$ é inteiro e $\frac{d_0}{b}$ é uma fração (lembramos que $d_0<b$). Da mesma forma, o resto da divisão de $d_1+d_2 b^1\cdots+d_{n-1}\cdot b^{n-2} +d_n\cdot b^{n-1}$ por $b$ é $d_1$. Repetimos o processo até encontrar os símbolos $d_0, d_1, d_2, \ldots$.

\begin{ex}[Conversão da parte inteira] Vamos escrever o número $125$ na base $6$. Para encontrar $d_0$, dividimos $125$ por $6$:
  \begin{equation*}
    \begin{array}{l}
      125 \ \ \ |\! \underline{\ 6\ \ } \\
      \underline{12 }\ \ \ \ \ \ 20\\
      \ 05\\
      \ \underline{00}\\
      \ \ 5
    \end{array}
  \end{equation*}
e encontramos $d_0=5$. Dividindo o quociente por $6$ para encontrar $d_1$:
\begin{equation*}
  \begin{array}{l}
    20 \ \ \ |\! \underline{\ 6\ \ } \\
    \underline{18 }\ \ \ \ 3\\
    \ 2
  \end{array}    
\end{equation*}
e obtemos $d_1=2$. Observe que o quociente agora é menor que $6$, ou seja, uma sucessiva divisão por $6$ teria resto igual ao próprio quociente. Assim, concluímos que:
\begin{equation*}
  125=(325)_6.
\end{equation*}

\ifisscilab
Estes cálculos podem ser feitos no \verb+Scilab+ com o auxílio das funções \verb'modulo' e \verb'int'. A primeira calcula o resto da divisão entre dois números, enquanto que a segunda retorna a parte inteira de um número dado. No nosso exemplo, temos:
\begin{verbatim}
-->q = 125, d0 = modulo(q,6)
-->q = int(q/6), d1 = modulo(q,6)
-->q = int(q/6), d2 = modulo(q,6)
\end{verbatim}
Verifique!
\fi
\end{ex}

\ifisscilab
\begin{ex}[Scilab]
  O Scilab oferece algumas funções para a conversão de números inteiros em dada base para a base decimal. Por exemplo, temos:
\begin{verbatim}
-->bin2dec('1001')
 ans  =
    9.  
-->hex2dec('451')
 ans  =
    1105.  
-->oct2dec('157')
 ans  =
    111.
-->base2dec('BEBA',16)
 ans  =
    48826.  
\end{verbatim}
\end{ex}
\fi

Agora, veremos como converter a parte fracionária de um número decimal em uma dada base $b$. Usando a notação $X = X^{\mbox{i}} + X^{\mbox{f}}$ para as partes inteira e fracionária, respectivamente, temos:
\begin{equation*}
  bX^{\mbox{f}}=d_{-1}+\frac{d_{-2}}{b}+\frac{d_{-3}}{b^2}+\cdots  
\end{equation*}
Observe que a parte inteira desse produto é $d_{-1}$ e $\frac{d_{-2}}{b}+\frac{d_{-3}}{b^2}+\cdots$ é a parte fracionária. Quando multiplicamos $\frac{d_{-2}}{b}+\frac{d_{-3}}{b^2}+\cdots$ por $b$ novamente, encontramos $d_{-2}$. Repetimos o processo até encontrar todos os símbolos.

\begin{ex}[Conversão da parte fracionária] Escrever o número $125,58\overline{3}$ na base $6$. Do exemplo anterior temos que $125=(325)_6$. Assim, nos resta converter a parte fracionária, Multiplicando-a por $6$:
$$
\begin{array}{l}
0,58\overline{3}\\
\underline{\times\ 6}\\
3,49 \overline{9}
\end{array}
$$
e obtemos $d_{-1}=3$. Agora, multiplicamos $0,49\overline{9}=0,5$ por $6$:
$$
\begin{array}{l}
0,5\\
\underline{\times\ 6}\\
3,0
\end{array}
$$
e obtemos $d_{-2}=3$. Portanto:
$$
125,58\overline{3}=(325,33)_6
$$
\ifisscilab
As contas feitas aqui, também podem ser feitas no \verb+Scilab+. Você sabe como?
\fi
\end{ex}

Uma maneira de converter um número dado numa base $g$ para uma base $b$ é fazer em duas partes: primeiro converter o número dado na base $g$ para base decimal e depois converter para a base $b$.

\section*{Exercícios}

\begin{Exercise} Converta para base decimal cada um dos seguintes números:
  \begin{multicols}{4}
    \begin{itemize}
    \item[a)]  $(100)_2$
    \item[b)]  $(100)_3$
    \item[c)]  $(100)_b$
    \item[d)]  $(12)_5$
    \item[e)]  $(AA)_{16}$
    \item[f)]  $(7,1)_8$
    \item[g)]  $(3,12)_5$
    \end{itemize}    
  \end{multicols}
\end{Exercise}
\begin{Answer}
  a)~$4$; b)~$9$; c)~$b^2$; d)~$7$; e)~$170$; f)~$7,125$; g)~$3,28$
\end{Answer}

\begin{Exercise}Escreva os números abaixo na base decimal.
  \begin{itemize}
  \item[a)] $(25,13)_8$
  \item[b)] $(101,1)_2$
  \item[c)] $(12F,4)_{16}$
  \item[d)] $(11,2)_{3}$
  \end{itemize}
\end{Exercise}

\begin{Exercise} Escreva cada número decimal na base $b$.
  \begin{itemize}
  \item[a)] $7,\overline{6}$ na base $b=5$
  \item[b)] $29,1\overline{6}$ na base $b=6$
  \end{itemize}
\end{Exercise}

\begin{Exercise} Escreva cada número dado para a base $b$.
  \begin{itemize}
  \item[a)] $(45,1)_8$ para a base $b=2$
  \item[b)] $(21,2)_8$ para a base $b=16$
  \item[c)] $(1001,101)_2$ para a base $b=8$
  \item[d)] $(1001,101)_2$ para a base $b=16$
  \end{itemize}
\end{Exercise}

\begin{Exercise} Escreva o número $x=5,5$ em base binária.
\end{Exercise}
\begin{Answer}
  \begin{tiny}
    $(101,1)_2$
  \end{tiny}
\end{Answer}


\begin{Exercise} Escreva o número $x=17,109375$ em base hexadecimal (16).
\end{Exercise}
\begin{Answer}
  \begin{tiny}
    $(11,1C)_{16}$    
  \end{tiny}
\end{Answer}

\begin{Exercise} Quantos algarismos são necessários para representar o número $937163832173947$ em base binária? E em base 7? Dica: Qual é o menor e o maior inteiro que pode ser escrito em dada base com $N$ algarismos?
\end{Exercise}
\begin{Answer}
  \begin{tiny}
    $50$; $18$    
  \end{tiny}
\end{Answer}


\begin{Exercise} Escreva $x=(12.4)_8$ em base decimal e binária.
\end{Exercise}
\begin{Answer}
  \begin{tiny}
    $10,5$; $(1010,1)_2$
  \end{tiny}
\end{Answer}


\section{Aritmética de Máquina}\index{aritmética!de máquina}

Os computadores, em geral, usam uma base binária para representar os números, onde as posições, chamadas de bits, assume as condições ``verdadeiro'' ou ``falso'', ou seja, $0$ ou $1$. Cada computador tem um número de bits fixo e, portanto, representa uma quantidade finita de números. Os demais números são tomados por proximidade àqueles conhecidos, gerando erros de arredondamento. Por exemplo, em aritmética de computador, o número $2$ tem representação exata, logo $2^2=4$, mas $\sqrt{3}$ não tem representação finita, logo $(\sqrt{3})^2\neq 3$. 

\ifisscilab
Veja isso no \verb+Scilab+:
\begin{verbatim}
-->2^2 == 4
 ans  =
  T  
-->sqrt(3)^2 == 3
 ans  =
  F  
\end{verbatim}
\fi

\subsection{Representação de números inteiros}\index{representação!números inteiros}

Tipicamente um número inteiro é armazenado num computador como uma sequência de dígitos binários de comprimento fixo denominado registro.

\subsubsection{Representação sem sinal}
Um registro com $n$ bits da forma
\begin{equation*}
\begin{array}{|c|c|c|c|c|} \hline
d_{n-1}&d_{n-2}&\cdots&d_1&d_0\\\hline
\end{array}  
\end{equation*}
representa o número $(d_{n-1}d_{n-2}...d_1d_0)_2$. Assim é possível representar números inteiros entre
\begin{equation*}
\begin{array}{cl}
  (111...111)_2 & = 2^{n-1}+2^{n-2}+\cdots+2^1+2^0=2^n-1.\\
    \vdots      & = \\
  (000...000)_2 & = 0 \\
\end{array}  
\end{equation*}

\ifisscilab
\begin{obs}
  No \verb+Scilab+, consulte sobre os comandos: \verb+uint8+, \verb+uint16+ e \verb+uint32+.
\end{obs}
\fi

\subsubsection{Representação com bit de sinal}
O bit mais significativo (o primeiro à esquerda) representa o sinal: $0$ positivo e $1$ negativo. Um registro com $n$ bits da forma
\begin{equation*}
  \begin{array}{|c|c|c|c|c|} \hline
    s & d_{n-2} & \cdots & d_1 & d_0 \\\hline
  \end{array}  
\end{equation*}
representa o número $(-1)^s(d_{n-2}...d_1d_0)_2$. Assim é possível representar números inteiros entre $-2^{n-1}$ e $2^{n-1}$, com duas representações para o zero: $(1000...000)_2$ e $(00000...000)_2$.
\begin{ex}
Em um registro com $8$ bits, teremos os números
\begin{equation*}
\begin{array}{cl}
 (11111111)_2 &= -(2^{6}+\cdots+2+1)=-127\\
     &\vdots    \\
 (10000001)_2 &= -1 \\
 (10000000)_2 &= -0 \\
 (01111111)_2 &= 2^6+\cdots+2+1=127 \\
     &\vdots    \\
 (00000010)_2 &= 2 \\
 (00000001)_2 &= 1 \\
 (00000000)_2 &= 0 \\
\end{array}  
\end{equation*}
\end{ex}

\ifisscilab
\begin{obs}
  No \verb+Scilab+, consulte sobre os comandos: \verb+uint8+, \verb+uint16+ e \verb+uint32+.
\end{obs}
\fi

\subsubsection{Representação complemento de dois}
O bit mais significativo (o primeiro à esquerda) representa o coeficiente de $-2^{n-1}$.  Um registro com $n$ bits da forma
\begin{equation*}
  \begin{array}{|c|c|c|c|c|} \hline
    d_{n-1}&d_{n-2}&\cdots&d_1&d_0\\\hline
  \end{array}  
\end{equation*}
representa o número $-d_{n-1}2^{n-1}+(d_{n-2}...d_1d_0)_2$. 

Note que todo registro começando com $1$ será um número negativo.

\begin{ex}
 O registro com $8$ bits $[01000011]$ representa o número
 $-0(2^7)+(1000011)_2=64+2+1=67$.

 O registro com $8$ bits $[10111101]$ representa o número
 $-1(2^7)+(0111101)_2=-128+ 32+16+8+4+1=-67$.

 Note que podemos obter a representação de $-67$ invertendo os dígitos de $67$ em binário e somando 1.
\end{ex}

\begin{ex}
Em um registro com $8$ bits, teremos os números
\begin{align*}
 (11111111)_2 &= -2^7+2^{6}+\cdots+2+1=-1\\
     &\vdots   \\
 (10000001)_2 &= -2^7+1 = -127 \\
 (10000000)_2 &= -2^7   = -128 \\
 (01111111)_2 &= 2^6+\cdots+2+1=127 \\
     &\vdots   \\
 (00000010)_2 &= 2 \\
 (00000001)_2 &= 1 \\
 (00000000)_2 &= 0 \\
\end{align*}
\end{ex}

\ifisscilab
\begin{obs}
  No \verb+Scilab+, consulte sobre os comandos: \verb'int8', \verb'int16' e \verb'int32'.
\end{obs}
\fi


\subsection{Sistema de ponto fixo}\index{sistema numéricop!de ponto fixo}

O sistema de ponto fixo representa as partes inteira e fracionária do número com uma quantidade fixas de dígitos. Por exemplo, em um computador de 32 bits que usa o sistema de ponto fixo, o registro
$$
\begin{array}{|c|c|c|c|c|c|} \hline
d_{31}&d_{30}&d_{29}&\cdots&d_1&d_0\\\hline
\end{array}
$$
pode representar o número
\begin{itemize}
\item $(-1)^{d_{31}}(d_{30}d_{29}\cdots d_{17}d_{16}, d_{15}d_{14}\cdots d_1d_0)_2$
se o sinal for representado por um dígito. Observe que nesse caso o zero possui duas representações possíveis: 
\begin{equation*}
  10000000000000000000000000000000  
\end{equation*}
e
\begin{equation*}
  00000000000000000000000000000000
\end{equation*}
\item $(d_{30}d_{29}\cdots d_{17}d_{16})_2-d_{31}(2^{15}-2^{-16})+(0,d_{15}d_{14}\cdots d_1d_0)_2$
se o sinal do número estiver representado por uma implementação em complemento de um. Observe que o zero também possui duas representações possíveis: 
\begin{equation*}
  11111111111111111111111111111111  
\end{equation*}
e
\begin{equation*}
  00000000000000000000000000000000
\end{equation*}
\item $(d_{30}d_{29}\cdots d_{17}d_{16})_2-d_{31}2^{15}+(0,d_{15}d_{14}\cdots d_1d_0)_2$
se o sinal do número estiver representado por uma implementação em complemento de dois. Nesse caso o zero é unicamente representado por
\begin{equation*}
  00000000000000000000000000000000  
\end{equation*}
\end{itemize}

Observe que, nestes casos, 16 dígitos são foram usados para representar a parte fracionária e 15 para representar a parte inteira e um dígito, o $d_{31}$, está relacionado ao sinal do número.

\subsection{Sistema de ponto flutuante}\index{sistema numérico!de ponto flutuante}
O sistema de ponto flutuante não possui quantidade fixa de dígitos para as partes inteira e fracionária do número. 

\begin{ex} Um computador de 64 bits que usa o sistema de ponto flutuante com um dígito para o sinal, o registro:
\begin{equation*}
  \begin{array}{|c|c|c|c|c|c|c|c|c|c|}
    \hline
    s&c_{10}&c_{9}&\cdots&c_{0}&m_{-1}&m_{-2}&\cdots &m_{-50}&m_{-51}\\
    \hline
  \end{array}
\end{equation*}
representa o número
\begin{equation*}
  (-1)^{s}2^{c-1023}(1+m),  
\end{equation*}
onde:
\begin{equation*}
  c=c_{10}2^{10}+c_92^9+\cdots+c_12^1+c_02^0  
\end{equation*}
e
\begin{equation*}
  m=m_{-1}2^{-1}+m_{-2}2^{-2}+\cdots+m_{-50}2^{-50}+m_{-51}2^{-51}.
\end{equation*}
Os dígitos $c_{10}, c_9\, \cdots, c_0\ $ compõem a característica e $m_{-1}, m_{-2}\, \cdots, m_{-51}\ $ compõem a mantissa. Por exemplo, o número:
\begin{equation*}
0\ 1 0 0 0 0 0 0 0 0 0 0 \ 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  
\end{equation*}
representa o número:
\begin{equation*}
  (-1)^0 2^{1024-1023}(1+2^{-1})=3  
\end{equation*}
O menor número positivo nesse sistema acontece quando $s=0$, $c=1$ e $m=0$, ou seja:
\begin{equation*}
  2^{-1022}(1+0)\approx 0,2225\times 10^{-307}.  
\end{equation*}
O maior número acontece quando $s=0$, $c=2046$ e $m=1-2^{-52}$, ou seja:
\begin{equation*}
  2^{1023}(2-2^{-52})\approx 0,17977\times 10^{309}.  
\end{equation*}
\end{ex}

\ifisscilab
\begin{obs}
  O menor número positivo e o maior número positivo representados no \verb+Scilab+ são, respectivamente:
\begin{verbatim}
-->number_properties('tiny')
-->number_properties('huge')
\end{verbatim}
Outras informações sobre a representação em ponto flutuante podem ser obtidas. Veja \verb+help number_properties+.
\end{obs}
\fi

Em um computador, Um número muito pequeno (\emph{underflow}) geralmente é aproximado por zero e um número muito grande (\emph{overflow}) geralmente faz o cálculo parar. Os demais números são aproximados pelo mais próximo, gerando os erros de arredondamento. O comportamento do computador nestes casos é governado pelo chamado \emph{modo de exceção de ponto flutuante}.

\ifisscilab
\begin{obs}
  O chamado modo de exceção de ponto flutuante é controlado pela função \verb+ieee+. O padrão do \verb+Scilab+ é \verb+ieee(0)+. Estude os seguintes resultados das seguintes operações usando os diferentes modos de exceção:
\begin{verbatim}
-->2*number_properties('huge'), 1/2^999, 1/0, 1/-0
\end{verbatim}
\end{obs}
\fi

\begin{defn}[Forma normalizada de ponto flutuante]
  Seja $x$ um número real não nulo.\footnote{Se $x = 0$, então $fl(x) = 0,000\ldots 0\times b^0$ será considerada sua representação em ponto flutuante.} A representação de $x$ na forma normalizada em ponto flutuante na base $b\in\mathbb{N}$, $b>1$, e com $n$ {\bf dígitos significativos}\footnote{Na literatura, também encontra-se outros significados para o termo dígitos (algarismos) significativos. Veja, por exemplo, \cite{Burden2013}} é dada por:
  \begin{equation*}
    fl(x) = 0,d_1d_2d_3\ldots d_n \times b^{E}
  \end{equation*}
onde, $d_i\in\{0,1,\dotsc,b-1\}$, $d_1\neq 0$ e $E\in\mathbb{Z}$. Os dígitos $d_i$, $i=1,2,\dotsc,n$, formam o significando e $E$ o expoente da representação de $x$.
\end{defn}

\begin{ex}
  O número $0,05$ é representado na forma normalizada de ponto flutuante na base $2$ e com um dígito significativo  por $0,1\times 2^{-1}$.
\end{ex}

\begin{obs}
  Salvo especificado ao contrário, quando nos referirmos à representação em ponto flutuante de um número dado, estaremos nos referindo à representação deste número na forma normalizada de ponto flutuante na base dez.
\end{obs}

\begin{ex}Represente os números $0,00\overline{51}$ e $1205,41\overline{54}$ em um sistema de ponto fixo de 4 dígitos para a parte inteira e 4 dígitos para a parte fracionária. Depois represente os mesmos números num sistema de ponto flutuante com 7 dígitos significativos.
\end{ex}
\begin{sol} As representações dos números $0,00\overline{51}$ e $1205,41\overline{54}$ no sistema de ponto fixo são $0,0051$ e $1205,4154$, respectivamente. No sistema de ponto flutuante, as representações são $0,5151515\cdot 10^{-2}$ e $0,1205415 \cdot 10^{4}$, respectivamente.
\end{sol}

\ifisscilab
\begin{obs}
  Consulte sobre o comando \verb'format' no \verb+Scilab+.
\end{obs}
\fi

\section*{Exercícios}

\begin{Exercise} Explique a diferença entre o sistema de ponto fixo e ponto flutuante.
\end{Exercise}

\section{Origem e Definição de Erros}\index{errors}
Quando fazemos aproximações numéricas, os erros são gerados de várias formas, sendo as principais delas as seguintes:
\begin{enumerate}
 \item Dados de entrada: equipamentos de medição possuem precisão finita, acarretando erros nas medidas físicas.
 \item Erros de Truncamento: ocorrem quando aproximamos um procedimento formado por uma sequência infinita de passos através de um outro procedimento finito. Por exemplo, a definição de integral é dada por uma soma infinita e, como veremos na terceira área, aproximarmo-la por um soma finita. Esse é um assunto que discutiremos várias vezes no curso, pois o tratamento do erro de truncamento é feito para cada método numérico.
 \item Erros de Arredondamento: são aqueles relacionados com as limitações que existem na forma representar números de máquina. Sobre esse tópico dedicamos a subseção (\ref{arredondamento_sec}).
\end{enumerate}

\begin{defn} Seja $x$ um número real e $\overline{x}$ sua aproximação. O \emph{erro absoluto} da aproximação $\overline{x}$ é definido como sendo o número:
  \begin{equation*}
    |x-\overline{x}|.
  \end{equation*}
O \emph{erro relativo} da aproximação $\overline{x}$ é definido como sendo o número:
\begin{equation*}
\frac{|x-\overline{x}|}{|x|} .
\end{equation*}
\end{defn}

\begin{obs}
  Observe que o erro relativo é adimensional e, muitas vezes, é dado em porcentagem. Ou seja, o erro relativo, em porcentagem, da aproximação $\overline{x}$ é definido por:
  \begin{equation*}
    \frac{|x-\overline{x}|}{|x|}\times 100 \%.
  \end{equation*}
\end{obs}

\begin{ex}
Se $x=\frac{1}{3}$ e $\overline{x}=0,333$, então o erro absoluto é
$$
|x-\overline{x}|=|0,\overline{3}-0,333|=0,000\overline{3}=0,\overline{3}\cdot 10^{-3}
$$
e o erro relativo é
$$
\frac{|x-\overline{x}|}{|x|}=\frac{0,\overline{3}\cdot 10^{-3}}{0,\overline{3}}=10^{-3}=0,1\%
$$
\end{ex}

\begin{ex}
Observe os erros absolutos e relativos em cada caso
$$
\begin{array}{|c|c|c|}
\hline
&\hbox{erro absoluto}&\hbox{erro relativo}\\
\hline
x=0,\overline{3}\cdot 10^{-2}\ \hbox{e}\ \overline{x}=0,3\cdot 10^{-2}&0,\overline{3}\cdot 10^{-3}&\frac{0,\overline{3}\cdot 10^{-3}}{0,\overline{3}\cdot 10^{-2}}=10^{-1}=10\%\\
\hline
x=0,\overline{3}\ \hbox{e}\ \overline{x}=0,3&0,\overline{3}\cdot 10^{-1}&\frac{0,\overline{3}\cdot 10^{-1}}{0,\overline{3}}=10^{-1}=10\%\\
\hline
x=0,\overline{3}\cdot 10^{2}\ \hbox{e}\ \overline{x}=0,3\cdot 10^{2}&0,\overline{3}\cdot 10^{1}&\frac{0,\overline{3}\cdot 10^{1}}{0,\overline{3}\cdot 10^{2}}=10^{-1}=10\%\\
\hline
\end{array}
$$
\end{ex}

%\begin{defn}
%A aproximação $\overline{x}$ de um número $x$ da forma $\overline{x}=\pm 0,d_{-1}d_{-2}\cdots d_{s}\c%dots d_n\times 10^m$ possui $s$ {\bf dígitos significativos corretos} se o erro absoluto $|x-\overlin%e{x}|$ satisfazer\footnote{Observação: Não existe uma definição única na literatura para o conceito d%e dígitos significativos corretos, embora não precisamente equivalentes, transmitem a mesmo conceito.%}
%$$
%|x-\overline{x}|\leq 0,5\times 10^{m-s}
%$$
%\end{defn}


\begin{defn}
A aproximação $\overline{x}$ de um número $x = \pm 0,d_{-1}d_{-2}d_{-3}\cdots \times 10^m$ possui $s$ {\bf dígitos significativos corretos} se o erro absoluto $|x-\overline{x}|$ satisfazer\footnote{Observação: Não existe uma definição única na literatura para o conceito de dígitos significativos corretos, embora não precisamente equivalentes, transmitem a mesmo conceito.}
$$
|x-\overline{x}|\leq 0,5\times 10^{m-s}
$$
\end{defn}

\begin{ex} Veja os seguintes casos:
\begin{itemize}
\item[a)] Considere $x=0,\overline{3}$, $\overline{x}=0,333$ e o erro absoluto $\delta=|x-\overline{x}|=0,\overline{3}\times 10^{-3}=0,\overline{3}\times 10^{0-3}$. Essa aproximação tem 3 dígitos significativos corretos.
\item[b)] Agora, considere $x=10,00\overline{1}=0,1000\overline{1}\times 10^{2}$, $\overline{x}=9,99933=0,999933\times 10^1$ e o erro absoluto $\delta=|x-\overline{x}|=0,178\overline{1}\times 10^{-2}=0,178\overline{1}\times 10^{2-4}$. Essa aproximação possui todos os dígitos diferentes se comparamos um a um, mas tem 4 dígitos significativos corretos.
\end{itemize}
\end{ex}

\subsection{Erros de Arredondamento}{\label{arredondamento_sec}}\index{erros!de arredondamento}
Os erros de arredondamento são aqueles gerados quando aproximamos um número real por um número com representação finita.

\begin{ex}
O número $\frac{1}{3}=0,\overline{3}$ possui um representação infinita tanto na base decimal quanto na base binária. Logo, quando representamos ele no computador geramos um erro de arredondamento que denotaremos por $\epsilon$. Agora considere a seguinte sequência:
$$
\left\{\begin{array}{l}
x_0=\frac{1}{3}\\
x_{n+1}=4x_n-1,\qquad n\in\mathbb{N}
\end{array}\right..
$$
Observe que $x_0=\frac{1}{3}$, $x_1=4\cdot \frac{1}{3}-1=\frac{1}{3}$, $x_2=\frac{1}{3}$, ou seja, temos uma sequência constante igual a $\frac{1}{3}$. Se calcularmos no computador essa sequência, temos que incluir os erros de arredondamento, ou seja,
\begin{eqnarray*}
\tilde{x}_0&=&\frac{1}{3}+\epsilon\\
\tilde{x}_1&=&4x_0-1=4\left(\frac{1}{3}+\epsilon\right)-1=\frac{1}{3}+4\epsilon\\
\tilde{x}_2&=&4x_1-1=4\left(\frac{1}{3}+4\epsilon\right)-1=\frac{1}{3}+4^2\epsilon\\
&\vdots&\\
\tilde{x}_n&=&\frac{1}{3}+4^n\epsilon
\end{eqnarray*}
Portanto o limite da sequência diverge,
\begin{equation*}
\lim_{x\to\infty}|\tilde{x}_n|=\infty  
\end{equation*}

\ifisscilab
Faça o teste no \verb+Scilab+, colocando:
\begin{verbatim}
-->x = 1/3
\end{verbatim}
e itere algumas vezes a linha de comando:
\begin{verbatim}
-->x = 4*x-1
\end{verbatim}
\fi
\end{ex}

Existem várias formas de aproximar um número em ponto flutuante da forma:
\begin{equation*}
  \pm 0,d_{1}d_{2}d_{3}\ldots d_{k-1}d_kd_{k+1}\ldots d_n 10^e
\end{equation*}
usando $k$ dígitos significativos. As duas principais são as seguintes:
\begin{enumerate}
\item Por truncamento: aproximamos o número dado por:
$$
\pm 0,d_{1}d_{2}d_{3}\ldots d_{k}\times 10^e
$$
simplesmente descartando os dígitos $d_{j}$ com $j > k$.
\item Por arredondamento: aproximamos o número dado por:
$$
\pm 0,\tilde{d}_{1}\tilde{d}_{2}\tilde{d}_{3}\ldots \tilde{d}_{k}\times 10^{\tilde{e}}
$$
que é a aproximação por truncamento do número:
$$
\pm 0,d_{1}d_{2}d_{3}\ldots d_{k}d_{k+1} \times 10^e \pm 0,5 \times 10^{e-k}
$$
\end{enumerate}

\begin{ex} Represente os números:
  \begin{equation*}
    0,567;\quad 0,233;\quad -0,6785 \quad\mbox{e}\quad \pi = 0,314159265 \ldots \times 10^1
  \end{equation*}
com dois dígitos significativos por truncamento e arredondamento.
\end{ex}
\begin{sol}
Truncamento: $0,56$; $0,23$; $-0,67$ e $\pi =0,31\times 10^1 =3,1$

Arredondamento: $0,57$; $0,23$; $-0,68$ e $\pi = 0,31\times 10^1 = 3,1$  
\end{sol}

\begin{obs}
  Observe que o arredondamento pode mudar todos os dígitos e o expoente da representação em ponto flutuante de um número dado.
\end{obs}

\begin{ex}
  O arredondamento de $0,9999\times 10^{-1}$ com $3$ dígitos significativos é $0,1\times 10^{0}$.
\end{ex}

\section*{Exercícios}

\begin{Exercise} Calcule os erros absoluto e relativo das aproximações $\overline{x}$ para $x$.
  \begin{itemize}
  \item[a)] $x=\pi=3,14159265358979\cdots$ e $\overline{x}=3,141$
  \item[b)] $x=1,00001$ e $\overline{x}=1$
  \item[c)] $x=100001$ e $\overline{x}=100000$
  \end{itemize}
\end{Exercise}


\begin{Exercise} Arredonde os seguintes números para cinco algarismos significativos corretos:
  \begin{multicols}{3}
    \begin{itemize}
    \item [a)] $1,7888544$
    \item [b)] $1788,8544$
    \item [c)] $0,0017888544$
    \item [d)] $0,004596632$
    \item [e)] $ 2,1754999\times 10^{-10}$
    \item [f)] $ 2,1754999\times 10^{10}$
    \end{itemize}
  \end{multicols}
\end{Exercise}
\begin{Answer}
  \begin{tiny}
a)~$1,7889$; b)~$1788,9$; c)~$0,0017889$; d)~$0,0045966$; e)~$2,1755\times 10^{-10}$; f)~$2,1755\times 10^{10}$    
  \end{tiny}
\end{Answer}

\begin{Exercise}
Verifique quantos são os dígitos significativos corretos em cada aproximação $\overline{x}$ para $x$.
\begin{itemize}
\item[a)] $x=2,5834$ e $\overline{x}=2,6$
\item[b)] $x=100$ e $\overline{x}=99$
\end{itemize}
\end{Exercise}

\begin{Exercise}  Represente os números $3276$; $42,55$ e $0,00003331$ com três dígitos significativos por truncamento e arredondamento.
\end{Exercise}

\begin{Exercise} Resolva a equação $0,1x-0,01=12$ usando arredondamento com três dígitos significativos em cada passo e compare com o resultado analítico
\end{Exercise}


\begin{Exercise} Calcule o erro relativo e absoluto envolvido nas seguintes aproximações e expresse as respostas com três algarismos significativos corretos.
    \begin{itemize}
    \item [a)] $x=3,1415926535898$ e $\tilde{x}=3,141593$
    \item [b)] $x=\frac{1}{7}$ e $\tilde{x}=1,43\times 10^{-1}$
    \end{itemize}
\end{Exercise}
\begin{Answer}
  \begin{tiny}
    a)~$\delta_{\mbox{abs}}=3,46\times 10^{-7}$, $\delta_{\mbox{rel}}=1,10\times 10^{-7}$; b)~$\delta_{\mbox{abs}}=1,43\times 10^{-4}$, $\delta_{\mbox{rel}} = 1,00 \times 10^{-3}$
  \end{tiny}
\end{Answer}


\section{Propagação de Erros}\index{erros!propagação}

Dado uma função diferenciável $f$, considere $\overline{x}$ uma aproximação para $x$ e $f(\overline{x})$ uma aproximação para $f(x)$. Sabendo o erro $\delta_x=|x-\overline{x}|$, queremos estimar o erro $\delta_f=|f(x)-f(\overline{x})|$. Pelo teorema do valor médio, existe $\epsilon$ contido no intervalo aberto formado por $x$ e $\overline{x}$ tal que
$$
f(x)-f(\overline{x})=f'(\epsilon)(x-\overline{x}).
$$
Como não conhecemos o valor de $\epsilon$, supomos que a derivada $f'(\epsilon)$ é limitada por $M$ ($|f'(\epsilon)|\leq M$) no intervalo fechado formado por $x$ e $\overline{x}$ e obtemos
$$
|f(x)-f(\overline{x})|\leq M|x-\overline{x}|.
$$
Se $f'(x)$ não varia muito rápido nesse intervalo e supondo $\delta_x$ pequeno, aproximamos $M\approx |f'(x)|$ e temos:
$$
|f(x)-f(\overline{x})|\approx |f'(x)||x-\overline{x}|,
$$
ou
$$
\delta_f\approx |f'(x)|\delta_x.
$$
De modo geral, quando $f$ depende de várias variáveis, a seguinte estimativa vale:
$$
\delta_f=|f(x_1,x_2,...,x_n)-f(\overline{x}_1, \overline{x}_2,...,\overline{x}_n)|\approx \sum_{i=1}^n\left|\frac{\partial f}{\partial x_i}(x_1, x_2,...,x_n)\right|\delta_{x_i}
$$

\begin{ex}
  Seja $f(x) = x\exp(x)$. Calcule o erro absoluto em se calcular $f(x)$ sabendo que $x = 2 \pm 0,05$.
\end{ex}
\begin{sol}
  Temos que $x\approx 2$ com erro absoluto de $\delta_x = 0,05$. Neste caso, calculamos $\delta_f$, i.e. o erro absoluto em se calcular $f(x)$, por:
  \begin{equation*}
    \delta_f = |f'(x)|\delta_x.
  \end{equation*}
Como $f'(x) = (1 + x)e^{x}$, temos:
\begin{align*}
  \delta_f &= |(1 + x)e^{x}|\cdot\delta_x\\
  &= |3e^2|\cdot 0,05 = 1,084.
\end{align*}
Portanto, o erro absoluto em se calcular $f(x)$ quando $x=2\pm 0,05$ é de $1,084$.
\end{sol}

\begin{ex} Calcule o erro relativo ao medir $f(x,y)=\frac{x^2+1}{x^2}e^{2y}$ sabendo que $x\approx 3$ é conhecido com $10\%$ de erro e $y\approx 2$ é conhecido com $3\%$ de erro.
\end{ex}
\begin{sol}
Calculamos as derivadas parciais de $f$:
$$
\frac{\partial f}{\partial x}=\frac{2x^3-(2x^3+2x)}{x^4}e^{2y}=-\frac{2e^{2y}}{x^3}
$$
e
$$
\frac{\partial f}{\partial y}=2\frac{x^2+1}{x^2}e^{2y}
$$
Calculamos o erro absoluto em termos do erro relativo:
$$
\frac{\delta_x}{|x|}=0,1\Rightarrow \delta_x= 3\cdot 0,1=0,3
$$
$$
\frac{\delta_y}{|y|}=0,03\Rightarrow \delta_y= 2\cdot 0,03=0,06
$$
Aplicando a expressão para estimar o erro em $f$ temos
\begin{align*}
\delta_f &= \left|\frac{\partial f}{\partial x}\right|\delta_x+\left|\frac{\partial f}{\partial y}\right|\delta_y\\
&= \frac{2e^{4}}{27}\cdot 0,3+2\frac{9+1}{9}e^{4}\cdot 0,06=8,493045557
\end{align*}
Portanto, o erro relativo ao calcular $f$ é estimado por
$$
\frac{\delta f}{|f|}=\frac{8,493045557}{\frac{9+1}{9}e^{4}}=14\%
$$
\end{sol}

\begin{ex} No exemplo anterior, reduza o erro relativo em $x$ pela metade e calcule o erro relativo em $f$. Depois, repita o processo reduzindo o erro relativo em $y$ pela metade.
\end{ex}
\begin{sol}
Na primeira situação temos $x=3$ com erro relativo de $5\%$ e $\delta_x=0,05\cdot 3=0,15$. Calculamos $\delta_f=7,886399450$ e o erro relativo em $f$ de $13\%$. Na segunda situação, temos $y=2$ com erro de $1,5\%$ e $\delta_y=2\cdot 0,015=0,03$. Calculamos $\delta_f=4,853168892$ e o erro relativo em $f$ de $8\%$. Observe que mesma o erro relativo em $x$ sendo maior, o erro em $y$ é mais significante na função.
\end{sol}


\begin{ex}
Considere um triângulo retângulo onde a hipotenusa e um dos catetos são conhecidos a menos de um erro: hipotenusa $a=3\pm 0,01$ metros e cateto $b=2\pm 0,01$ metros. Calcule o erro absoluto ao calcular a área dessa triângulo.
\end{ex}
\begin{sol}
Primeiro vamos encontrar a expressão para a área em função da hipotenusa $a$ e um cateto $b$. A tamanho de segundo cateto $c$ é dado pelo teorema de Pitágoras, $a^2=b^2+c^2$, ou seja, $c=\sqrt{a^2-b^2}$. Portanto a área é $$
A=\frac{bc}{2}=\frac{b\sqrt{a^2-b^2}}{2}.
$$
Agora calculamos as derivadas
$$
\frac{\partial A}{\partial a}=\frac{ab}{2\sqrt{a^2-b^2}},
$$
$$
\frac{\partial A}{\partial b}=\frac{\sqrt{a^2-b^2}}{2}-\frac{b^2}{2\sqrt{a^2-b^2}},
$$
e substituindo na estimativa para o erro $\delta_A$ em termos de $\delta_a=0,01$ e $\delta_b=0,01$:
\begin{eqnarray*}
\delta_A&\approx & \left|\frac{\partial A}{\partial a}\right|\delta_a+\left|\frac{\partial A}{\partial b}\right|\delta_b\\
&\approx &\frac{3\sqrt{5}}{5}\cdot 0,01+\frac{\sqrt{5}}{10}\cdot 0,01=0,01565247584
\end{eqnarray*}
Em termos do erro relativo temos erro na hipotenusa de $\frac{0,01}{3}\approx 0,333\%$, erro no cateto de $\frac{0,01}{2}= 0,5\%$ e erro na área de
$$
\frac{0,01565247584}{\frac{2\sqrt{3^2-2^2}}{2}}=0,7\%
$$
\end{sol}

\section*{Exercícios}

\begin{Exercise}Considere que a variável $x\approx 2$ é conhecida com um erro relativo de $1\%$ e a variável $y\approx 10$ com um erro relativo de $10\%$. Calcule o erro relativo associado a $z$ quando:
  \begin{equation*}
    z=\frac{y^4}{1+y^4}e^x.  
  \end{equation*}
Suponha que você precise conhecer o valor de $z$ com um erro de $0,5\%$. Como engenheiro, você propõe uma melhoria na medição da variável $x$ ou $y$? Explique.
\end{Exercise}
\begin{Answer}
  \begin{tiny}
    $2\%$    
  \end{tiny}
\end{Answer}

\begin{Exercise} A corrente $I$ em ampères e a tensão $V$ em volts em uma lâmpada se relacionam conforme a seguinte expressão:
  \begin{equation*}
    I=\left(\frac{V}{V_0}\right)^\alpha,
  \end{equation*}
onde $\alpha$ é um número entre $0$ e $1$ e $V_0$ é tensão nominal em volts. Sabendo que $V_0=220\pm 3\%$ e $\alpha=-,8\pm 4\%$, calcule a corrente e o erro relativo associado quando a tensão vale $220\pm 1\%$.\\
{\bf Obs:} Este problema pode ser resolvido de duas formas distintas: usando a expressão aproximada para a propagação de erro e inspecionando os valores máximos e mínimos que a expressão pode assumir. Pratique os dois métodos.
\end{Exercise}
\begin{Answer}
  \begin{tiny}
    $3,2\%$ pela aproximação ou $3,4\%$ pela segundo método  $\left(0,96758 \leq I\leq 1,0342\right)$.
  \end{tiny} 
\end{Answer}

\begin{Exercise} A corrente $I$ em ampères e a tensão $V$ em volts em uma lâmpada se relacionam conforme a seguinte expressão:
$$I=\left(\frac{V}{V_0}\right)^\alpha$$
Onde $\alpha$ é um número entre 0 e 1 e $V_0$ é a tensão nominal em volts. Sabendo que $V_0=220\pm 3\%$ e $\alpha=0,8\pm 4\%$
Calcule a corrente e o erro relativo associado quando a tensão vale $220\pm 1\%$.
{\bf Dica:} lembre que $x^\alpha=e^{\alpha \ln(x)}$
\end{Exercise}

\begin{Exercise}[title= Propagação de erros] Obtenha os valores de $I_d$ no problema \ref{prob_diodo}. Lembre que existem duas expressões disponíveis:
  \begin{equation*}
    I_d=I_R\left(\exp\left(\frac{v_d}{v_t}\right)-1\right)  
  \end{equation*}
e
\begin{equation*}
  I_d=\frac{v-v_d}{R}
\end{equation*}
Faça o estudo da propagação do erro e decida qual a melhor expressão em cada caso.
\end{Exercise}
\begin{Answer}
  \begin{tiny}
  a) $0,0294$; b) $2.44e-3$; c) $2.50e-4$; d) $1.09\cdot 10^{-7}$; e) $- 10^{-12}$; f) $-10^{-12}$; g) $- 10^{-12}$  
  \end{tiny}
\end{Answer}



\section{Cancelamento Catastrófico}\section{cancelamento catastrófico}
Operações aritméticas entre números com representação finita pode fazer com que o resultado seja dominado pelos erros de arredondamento. Em geral, esse efeito, denominado cancelamento catastrófico, acontece quando fazemos a diferença de números muito próximos entre si.

\begin{ex}Efetue a operação
  \begin{equation*}
    0,987624687925-0,987624=0,687925\times 10^{-6}    
  \end{equation*}
usando arredondamento com seis dígitos significativos e observe a diferença se comparado com resultado sem arredondamento.
\end{ex}
\begin{sol}
Os números arredondados com seis dígitos para a mantissa resultam na seguinte diferença
$$
0,987625-0,987624=0,100000\times 10^{-5}
$$
Observe que os erros relativos entre os números exatos e aproximados no lado esquerdo são bem pequenos,
\begin{equation*}
  \frac{|0,987624687925-0,987625|}{|0,987624687925|}=0,00003159  
\end{equation*}
e
\begin{equation*}
  \frac{|0,987624-0,987624|}{|0,987624|}=0\%,
\end{equation*}
enquanto no lado direito o erro relativo é enorme:
\begin{equation*}
\frac{|0,100000\times 10^{-5}-0,687925\times 10^{-6}|}{0,687925\times 10^{-6}}=45,36\%.  
\end{equation*}
\end{sol}

\begin{ex} Considere o problema de encontrar as raízes da equação de segundo grau:
  \begin{equation*}
    x^2+300x-0,014=0,
  \end{equation*}
usando seis dígitos significativos.

Aplicando a fórmula de Bhaskara com $a=0,100000\times 10^1$, $b=0,300000\times 10^3$ e $c=0,140000\times 10^{-1}$, temos o discriminante:
\begin{align*}
  \Delta &= b^2 - 4\cdot a\cdot c\\
  &=0,300000\times 10^3\times 0,300000\times 10^3 \\
  &+ 0,400000\times 10^1\times 0,100000\times 10^1\times 0,140000\times 10^{-1}\\
  &=0,900000\times 10^5 +0,560000\times  10^{-1}\\
  &=0,900001\times 10^5
\end{align*}
e as raízes:
\begin{align*}
x_1,x_2 &=\frac{-0,300000\times 10^3\pm \sqrt{\Delta}}{0,200000\times 10^1} \\
&=\frac{-0,300000\times 10^3\pm \sqrt{0,900001\times 10^5}}{0,200000\times 10^1} \\
&=\frac{-0,300000\times 10^3\pm 0,300000\times 10^3}{0,200000\times 10^1}\\
\end{align*}
Então, as duas raízes são:
\begin{align*}
  \tilde{x}_1 &= \frac{-0,300000\times 10^3- 0,300000\times 10^3}{0,200000\times 10^1}\\
  &=-\frac{0,600000\times 10^3}{0,200000\times 10^1}=-0,300000\times 10^3
\end{align*}
e
\begin{equation*}
\tilde{x}_2=\frac{-0,300000\times 10^3+ 0,300000\times 10^3}{0,200000\times 10^1}=0,000000\times 10^{0} 
\end{equation*}
Agora, os valores das raízes com seis dígitos significativos deveriam ser
\begin{equation*}
  x_1=-0,300000\times 10^{3}\quad\hbox{e}\quad x_2=0,466667\times 10^{-4}.  
\end{equation*}
Observe que um raiz saiu com seis dígitos significativos corretos, mas a outra não possui nenhum dígito significativo correto.
\end{ex}

\begin{obs}
No exemplo anterior $b^2$ é muito maior que $4ac$, ou seja, $b\approx \sqrt{b^2-4ac}$, logo a diferença
\begin{equation*}
  -b+\sqrt{b^2-4ac}
\end{equation*}
estará próxima de zero. Uma maneira padrão de evitar o cancelamento catastrófico é usar procedimentos analíticos para eliminar essa diferença. Abaixo veremos alguns exemplos.  
\end{obs}

\begin{ex}Para eliminar o cancelamento catastrófico do exemplo anterior, usamos a seguinte expansão em série de Taylor em torno da origem
$$
\sqrt{1-x}=1-{\frac {1}{2}}x+O(x^2) .
$$
Substituindo na fórmula de Bhaskara, temos:
\begin{eqnarray*}
x&=&\frac{-b\pm \sqrt{b^2-4ac}}{2a}\\
&=&\frac{-b\pm b\sqrt{1-\frac{4ac}{b^2}}}{2a}\\
&\approx&\frac{-b\pm b\left(1-\frac{4ac}{2b^2}\right)}{2a}\\
\end{eqnarray*}
Observe que $\frac{4ac}{b^2}$ é um número pequeno e por isso a expansão faz sentido. Voltamos no exemplo anterior e calculamos as duas raízes com o nova expressão
\begin{eqnarray*}
\tilde{x}_1&=& \frac{-b- b+\frac{4ac}{2b}}{2a}\\
&=& -\frac{b}{a}+\frac{c}{b}\\
&=& -\frac{0,300000\times 10^{3}}{0,100000\times 10^{1}}-\frac{0,140000\times 10^{-1}}{0,300000\times 10^3}\\
&=& -0,300000\times 10^{3}-0,466667\times 10^{-4}\\
&=& -0,300000\times 10^{3}
\end{eqnarray*}
\begin{eqnarray*}
\tilde{x}_2&=& \frac{-b+ b-\frac{4ac}{2b}}{2a}\\
&=&-\frac{4ac}{4ab}\\
&=&-\frac{c}{b}=-\frac{-0,140000\times 10^{-1}}{0,300000\times 10^3}=0,466667\times 10^{-4}\\
\end{eqnarray*}
Observe que o efeito catastrófico foi eliminado.
\end{ex}
\begin{ex}Observe a seguinte identidade
$$
f(x)=\frac{(1+x)-1}{x}=1
$$
Calcule o valor da expressão à esquerda para $x=10^{-12}$, $x=10^{-13}$, $x=10^{-14}$, $x=10^{-15}$, $x=10^{-16}$ e $x=10^{-17}$. Observe que quando $x$ se aproxima do $\epsilon$ de máquina a expressão perde o significado. Veja abaixo o gráfico de $f(x)$ em escala logarítmica.

\includegraphics[width=0.8\textwidth]{./cap_aritmetica/pics/cancelamento_0}
\end{ex}

\begin{ex} Neste exemplo, estamos interessados em compreender mais detalhadamente o comportamento da expressão
\begin{equation}\label{def_lim}\left(1+\frac{1}{n}\right)^n\end{equation}
quando $n$ é um número grande ao computá-la em sistemas de numeral de ponto flutuante com acurácia finita.
Um resultado bem conhecido do cálculo nos diz que o limite de (\ref{def_lim}) quando $n$ tende a infinito é o número de Euler:
\begin{equation}\label{lim}\lim_{n\to \infty}\left(1+\frac{1}{n}\right)^n=e= 2,718281828459...\end{equation}

Sabemos também que a sequência produzida por (\ref{def_lim}) é crescente, isto é:
$$\left(1+\frac{1}{1}\right)^1< \left(1+\frac{1}{2}\right)^2< \left(1+\frac{1}{3}\right)^3 < \cdots $$

No entanto, quando calculamos essa expressão no \verb+Scilab+, nos defrontamos com o seguinte resultado:
$$\begin{array}{|c|c|c|c|c|}
\hline &&&&\\[-0.3cm]
n & \left(1+\frac{1}{n}\right)^n&~~~~&n & \left(1+\frac{1}{n}\right)^n\\
 &&&&\\[-0.3cm]
\hline\\[-0.3cm]
1 & 2,0000000000000 && 10^{2} & 2,7048138294215 \\
2 & 2,2500000000000 && 10^{4} & 2,7181459268249 \\
3 & 2,3703703703704 && 10^{6} & 2,7182804690957 \\
4 & 2,4414062500000 && 10^{8} & 2,7182817983391 \\
5 & 2,4883200000000 && 10^{10} & 2,7182820532348 \\
6 & 2,5216263717421 && 10^{12} & 2,7185234960372 \\
7 & 2,5464996970407 && 10^{14} & 2,7161100340870 \\
8 & 2,5657845139503 && 10^{16} & 1,0000000000000 \\
9 & 2,5811747917132 && 10^{18} & 1,0000000000000 \\
10 & 2,5937424601000 && 10^{20} & 1,0000000000000 \\
\hline
\end{array}
$$
Podemos resumir esses dados no seguinte gráfico de $\left(1+\frac{1}{n}\right)^n$ em função de $n$:

%\begin{figure}[htp]
\includegraphics[width=0.8\textwidth]{./cap_aritmetica/pics/cancelamento_euler}
%\caption{Gráfico de $\left(1+\frac{1}{n}\right)^n$ em função de $n$ em escala linear-logarítmica variando de $10^0$ até $10^{18}$ gerado no Scilab 5.4.1.}
%\end{figure}

Observe que quando $x$ se torna grande, da ordem de $10^{15}$, o gráfico da função deixa de se crescente e apresenta oscilações.  Observe também que a expressão se torna identicamente igual a $1$ depois de um certo limiar. Tais fenômenos não são intrínsecos da função $f(x)=(1+1/x)^x$, mas \emph{\uline{oriundas de erros de arredondamento}}, isto é, são resultados numéricos espúrios. A fim de pôr o comportamento numérico de tal expressão, apresentamos abaixo o gráfico da mesma função, porém restrito à região entre $10^{14}$ e $10^{16}$.

%\begin{figure}
\includegraphics[width=0.9\textwidth]{./cap_aritmetica/pics/cancelamento_euler2}
%\caption{Gráfico de $\left(1+\frac{1}{n}\right)^n$ em função de $n$ em escala linear-logarítmica variando de $10^{14}$ até $10^{16}$ gerado no Scilab 5.4.1.}
¨%\end{figure}
\end{ex}

Para compreendermos melhor por que existe um limiar $N$ que, quando atingido torna a expressão do exemplo acima identicamente igual a $1$, observamos a sequência de operações realizadas pelo computador:
\begin{equation}\label{seq_oper}
x~\to ~1/x ~\to ~1+1/x ~\to ~(1+1/x)^x
\end{equation}
Devido ao limite de precisão da representação de números em ponto flutuante, existe um menor número representável que é maior do que 1. Este número é $1 + $\verb+eps+, onde \verb+eps+ é chamado de {\bf épsilon de máquina} e é o menor número que somado a 1 produz um resultado superior a 1 no sistema de numeração usado. O épsilon de máquina no sistema de numeração ``double'' vale aproximadamente $2,22\times 10^{-16}$.
\ifisscilab
No \verb+Scilab+, o epsilon de máquina é a constante \verb+eps+. Observe que:
\begin{verbatim}
-->1+%eps
 ans  =
    1.0000000000000002220446 
\end{verbatim}
\fi
Quando somamos a $1$ um número positivo inferior ao épsilon de máquina, obtemos o número 1. Dessa forma, o resultado obtido pela operação de ponto flutuante $1+x$ para $0<x<2,22 \times 10^{-16}$ é 1. 

Portanto, quando realizamos a sequência de operações dada em (\ref{seq_oper}), toda informação contida no número $x$ é perdida na soma com $1$ quando $1/x$ é menor que o épsilon de máquina, o que ocorre quando $x>5\times 10^{15}$. Assim $(1+1/x)$ é aproximado para $1$ e a última operação se resume a $1^x$, o que é igual a $1$ mesmo quando $x$ é grande.

Um erro comum é acreditar que o perda de significância se deve ao fato de $1/x$ ser muito pequeno para ser representado e é aproximando para $0$. Isto é falso, o sistema de ponto de flutuante permite representar números de magnitude muito inferior ao épsilon de máquina. O problema surge da limitação no tamanho da mantissa. Observe como a seguinte sequência de operações não perde significância para números positivos x muito menores que o épsilon de máquina:
\begin{equation}\label{seq_oper2}
x ~\to ~1/x ~\to ~1/(1/x) 
\end{equation}
 compare o desempenho numérico desta sequência de operações para valores pequenos de $x$ com o da seguinte sequência:
\begin{equation}\label{seq_oper3}
x ~\to ~1+x ~\to ~(1+x)-1.
\end{equation}
Finalmente, notamos que quando tentamos calcular $\left(1+\frac{1}{n}\right)^n$ para $n$ grande, existe perda de significância no cálculo de $1+1/n$. 
\ifisscilab
Para entendermos isso melhor, vejamos o que acontece no \verb+Scilab+ quando $n=7\times 10^{13}$:
\begin{verbatim}
-->n=7e13
 n  =
     7.000000000000000000D+13  
 
-->1/n
 ans  =
     1.428571428571428435D-14  
 
-->y=1+1/n
 y  =
 
    1.000000000000014211D+00  
\end{verbatim}
Observe a perda de informação ao deslocar a mantissa de $1/n$. Para evidenciar o fenômenos, observamos o que acontece quando tentamos recalcular $n$ subtraindo $1$ de $1+1/n$ e invertendo o resultado:
\begin{verbatim}
-->y-1
 ans  =
     1.421085471520200372D-14  
 
-->1/(y-1)
 ans  =
     7.036874417766400000D+13  
\end{verbatim}
\fi

\begin{ex}[Analogia da balança] Observe a seguinte comparação interessante que pode ser feita para ilustrar os sistemas de numeração com ponto fixo e flutuante: o sistema de ponto fixo é como uma balança cujas marcas estão igualmente espaçadas; o sistema de ponto flutuante é como uma balança cuja distância entre as marcas é proporcional à massa medida. Assim, podemos ter uma balança de ponto fixo cujas marcas estão sempre distanciadas de $100$g ($100$g, $200$g, $300$g, ..., $1$Kg, $1,1$Kg,...) e outra balança de ponto flutuante cujas marcas estão distanciadas sempre de aproximadamente um décimo do valor lido ($100$g, $110$g, $121$g, $133$g, ..., $1$Kg, $1,1$Kg, $1,21$Kg, ...) A balança de ponto fixo apresenta uma resolução baixa para pequenas medidas, porém uma resolução alta para grandes medidas. A balança de ponto flutuante distribui a resolução de forma proporcional ao longo da escala.    

Seguindo nesta analogia, o fenômeno de perda de significância pode ser interpretado como a seguir: imagine que você deseje obter o peso de um gato (aproximadamente $4$Kg). Dois processos estão disponíveis: colocar o gato diretamente na balança ou medir seu peso com o gato e, depois, sem o gato. Na balança de ponto flutuante, a incerteza associada na medida do peso do gato (sozinho) é aproximadamente $10\%$ de $4$Kg, isto é, $400$g. Já a incerteza associada à medida da uma pessoa (aproximadamente $70$Kg) com o gato é de $10\%$ do peso total, isto é, aproximadamente $7$Kg. Esta incerteza é da mesma ordem de grandeza da medida a ser realizada, tornado o processo impossível de ser realizado, já que teríamos uma incerteza da ordem de $14$Kg (devido à dupla medição) sobre uma grandeza de $4$Kg.    
\end{ex}

\section*{Exercícios}

\begin{Exercise} Considere as expressões:
  \begin{equation*}
    \frac{\exp(1/\mu)}{1+\exp(1/\mu)}  
  \end{equation*}
e
\begin{equation*}
  \frac{1}{\exp(-1/\mu)+1}
\end{equation*}
com $\mu>0$. Verifique que elas são idênticas como funções reais. Qual dessas expressões é mais adequada quando $\mu$ é um número pequeno. Teste no computador para $\mu=0,1$, $\mu=0,01$ e $\mu=0,001$.
\end{Exercise}

\begin{Exercise} Encontre expressões alternativas para calcular o valor das seguintes funções quando $x$ é próximo de zero.
\begin{itemize}
\item[a)] $f(x)=\frac{1-\cos(x)}{x^2}$
\item[b)] $g(x)=\sqrt{1+x}-1$
\item[c)] $h(x)=\sqrt{x+10^6}-10^3$
\item[d)] $i(x)=\sqrt{1+e^{x}}-\sqrt{2}$ ~~~~~~ Dica: Faça $y=e^{x}-1$
\end{itemize}
\end{Exercise}
\begin{Answer}
  \begin{tiny}
    a)~$\frac{1}{2}+\frac{x^2}{4!}+O(x^4)$; b)~$x/2+O(x^2)$; c)~$5\cdot 10^{-4}x+O(x^2)$; d)~$\frac{\sqrt{2}}{4}y+O(y^{2})=\frac{\sqrt{2}}{4}x+O(x^2)$
  \end{tiny}
\end{Answer}

\begin{Exercise} Use uma identidade trigonométrica adequada para mostrar que:
  \begin{equation*}
    \frac{1-\cos(x)}{x^2}= \frac{1}{2} \left(\frac{\sin(x/2)}{x/2}\right)^2.
  \end{equation*}
Analise o desempenho destas duas expressões no computador quando $x$ vale $10^{-5}$, $10^{-6}$, $10^{-7}$, $10^{-8}$, $10^{-9}$, $10^{-200}$ e $0$. Discuta o resultado.
{\bf Dica:} Para $|x|<10^{-5}$, $f(x)$ pode ser aproximada por $1/2-x^2/24$ com erro de truncamento inferior a $10^{-22}$.
\end{Exercise}

\begin{Exercise} Considere a expressão
$$
f(x)=\frac{1-\cos(x)}{x^2}
$$
para $x$ pequeno. Verifique que
$$
\lim_{x\to 0}f(x)=0,5
$$
Depois calcule no scilab $f(x)$ para $x=10^{-5}$, $x=10^{-6}$, $x=10^{-7}$, $x=10^{-8}$, $x=10^{-9}$ e $x=10^{-10}$. Finalmente, faça uma aproximação analítica que elimine o efeito catastrófico.
\end{Exercise}

\begin{Exercise}[title=Notas do prof. Guidi] Reescreva as expressões:
  $$\sqrt{e^{2x}+1}-e^x \qquad\hbox{e}\qquad \sqrt{e^{2x}+x^2}-e^x $$
  de modo que seja possível calcular seus valores para $x=100$ utilizando a aritmética de ponto flutuante ("Double") no computador.
\end{Exercise}

\begin{Exercise} Na teoria da relatividade restrita, a energia cinética de uma partícula e sua velocidade se relacionam pela seguinte fórmula:
  \begin{equation*}
    E=mc^2\left(\frac{1}{\sqrt{1-(v/c)^2}}-1\right),
  \end{equation*}
onde $E$ é a energia cinética da partícula, $m$ é a massa de repouso, $v$ o módulo da velocidade e $c$ a velocidade da luz no vácuo dada por $c=299792458 m/s$. Considere que a massa de repouso $m=9,10938291\times 10^{-31} Kg$ do elétron seja conhecida com erro relativo de $10^{-9}$. Qual é o valor da energia e o erro relativo associado a essa grandeza quando $v=0,1 c$, $v=0,5 c$, $v=0,99c$ e $v=0,999c$ sendo que a incerteza relativa na medida da velocidade é $10^{-5}$?
\end{Exercise}
\begin{Answer}
  \begin{tiny}
    $4,12451228\times 10^{-16}$~J; $0,002\%$; $0,26654956\times 10^{-14}$~J; $0,002\%$; $4,98497440\times 10^{-13}$~J; $0,057\%$; $1,74927914\times 10^{-12}$~J; $0,522\%$.
  \end{tiny}
\end{Answer}

%%%%% \begin{Exercise} Calcule o valor da energia cinética $E$ de um corpo de $1$~Kg que se move a uma velocidade de $10$~m/s usando a fórmula relativística. Para fazer esse cálculo, use o software {\it Maple} com precisão de 10 dígitos, 12 dígitos, 15 dígitos, 20 dígitos e 50 dígitos. Explique o que está acontecendo e proponha uma fórmula alternativa para a energia cinética mais adequada para pequenas velocidades.
%%%%% \end{Exercise}
%%%%% \begin{Answer}
%%%%% $E= \frac{m}{2} v^2 \left(1+\frac{3}{4}\left(\frac{v}{c}\right)^2+\ldots \right)$
%%%%% \end{Answer}

% \begin{Exercise}Considere a seguinte rotina escrita para ser usada no Scilab:
% \begin{verbatim}
%     x=1
%     while x+1>x
%         x=x+1
%     end
% \end{verbatim}
% Explique se esta rotina finaliza em tempo finito, em caso afirmativo calcule a ordem de grandeza do tempo de execução supondo que cada passo do laço demore $10^{-7}s$. Justifique sua reposta.
% \end{Exercise}


\begin{Exercise} Deseja-se medir a concentração de dois diferentes oxidantes no ar. Três sensores eletroquímicos estão disponíveis para a medida e apresentam a seguintes respostas:
$$v_1= 270 [A] +  30 [B],~~~ v_2= 140 [A] +  20 [B] ~~ \hbox{e}~~ v_3= 15 [A] +  200 [B]$$
as tensões $v_1$, $v_2$ e $v_3$ são dadas em $mV$ e as concentrações em $milimol/l$.
\begin{itemize}
\item [a)] Encontre uma expressão para os valores de $[A]$ e $[B]$ em termos de $v_1$ e $v_2$ e, depois, em termos de $v_1$ e $v_3$. Dica:
Se $ad\neq bc$, então a matriz $A$ dada por
$$A=\left[\begin{array}{cc}a&b\\c&d\end{array}\right]$$
é inversível e sua inversa é dada por
$$A^{-1}= \frac{1}{ad-bc} \left[\begin{array}{cc}d&-b\\-c&a\end{array}\right].$$

\item[b)] Sabendo que incerteza relativa associada às sensibilidades dos sensores 1 e 2 é de $2\%$ e que a incerteza relativa associada às sensibilidades do sensor 3 é $10\%$, verifique a incerteza associada à medida feita com o par $1-2$ e o par $1-3$. Use $[A]=[B]=10milimol/l$. Dica: Você deve diferenciar as grandezas $[A]$ e $[B]$ em relação aos valores das tensões.
\end{itemize}
\end{Exercise}
\begin{Answer}
  \begin{tiny}
Em ambos casos, temos a seguinte estrutura:
$$\left[\begin{array}{cc}
S_{11}& S_{12}\\
S_{21}& S_{22}
\end{array}
\right] \left[\begin{array}{c}
\left[ A\right]\\
\left[ B\right]
\end{array}
\right]= \left[\begin{array}{c}
v_1\\
v_2
\end{array}
\right]$$
De forma que
$$ \left[\begin{array}{c}
\left[ A\right]\\
\left[ B\right]
\end{array}\right]
=\left[\begin{array}{cc}
S_{11}& S_{12}\\
S_{21}& S_{22}
\end{array}
\right]^{-1}
\left[\begin{array}{c}
v_1\\
v_2
\end{array}
\right]=\frac{1}{S_{11}S_{22}-S_{12}S_{21}}\left[\begin{array}{cc}
S_{22}& -S_{12}\\
-S_{21}& S_{11}
\end{array}
\right]\left[\begin{array}{c}
v_1\\
v_2
\end{array}
\right]
$$
Portanto
\begin{eqnarray*}
[ A ]&=&\frac{S_{22}v_1-S_{12}v_2}{S_{11}S_{22}-S_{12}S_{21}}\\
\left[ {B} \right]&=&\frac{-S_{21}v_1+S_{11}v_2}{S_{11}S_{22}-S_{12}S_{21}}
\end{eqnarray*}

Usando derivação logarítmica, temos

\begin{eqnarray*}
\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{11}}&=&-\frac{S_{22}}{S_{11}S_{22}-S_{12}S_{21}}\\
\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{12}}&=&-\frac{v_2}{S_{22}v_1-S_{12}v_2}+\frac{S_{21}}{S_{11}S_{22}-S_{12}S_{21}}=-\frac{[A]}{\left[B\right]}\cdot \frac{S_{22}}{S_{11}S_{22}-S_{12}S_{21}}\\
\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{21}}&=&\frac{S_{12}}{S_{11}S_{22}-S_{12}S_{21}}\\
\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{22}}&=&\frac{v_1}{S_{22}v_1-S_{12}v_2}-\frac{S_{11}}{S_{11}S_{22}-S_{12}S_{21}}=\frac{[A]}{\left[B\right]}\cdot \frac{S_{12}}{S_{11}S_{22}-S_{12}S_{21}}
\end{eqnarray*}
e
\begin{eqnarray*}
\frac{1}{\left[ B \right]}\frac{\partial \left[ B \right]}{\partial S_{11}}&=&\frac{v_2}{-S_{21}v_1+S_{11}v_2}-\frac{S_{22}}{S_{11}S_{22}-S_{12}S_{21}}=\frac{\left[B\right]}{[A]} \frac{S_{21}}{S_{11}S_{22}-S_{12}S_{21}}\\
\frac{1}{\left[ B \right]}\frac{\partial \left[ B \right]}{\partial S_{12}}&=&\frac{S_{21}}{S_{11}S_{22}-S_{12}S_{21}}\\
\frac{1}{\left[ B \right]}\frac{\partial \left[ B \right]}{\partial S_{21}}&=&-\frac{v_1}{-S_{21}v_1+S_{11}v_2}+\frac{S_{21}}{S_{11}S_{22}-S_{12}S_{21}}=-\frac{\left[B\right]}{[A]}\frac{S_{11}}{S_{11}S_{22}-S_{12}S_{21}}\\
\frac{1}{\left[ B \right]}\frac{\partial \left[ B \right]}{\partial S_{22}}&=&-\frac{S_{11}}{S_{11}S_{22}-S_{12}S_{21}}\\
\end{eqnarray*}


E o erro associado às medidas pode ser aproximado por
\begin{eqnarray*}
\frac{1}{[A]}\delta_{[A]}&=&\left|\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{11}}\right| \delta_{S_{11}}+\left|\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{12}}\right| \delta_{S_{12}}+\left|\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{21}}\right| \delta_{S_{21}}+\left|\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{22}}\right| \delta_{S_{22}}\\
&=&\frac{1}{\left|\det{S}\right|}\left[S_{22}\delta_{S_{11}}+\frac{[A]}{\left[B\right]}S_{22}\delta_{S_{12}}+S_{12}\delta_{S_{21}}+\frac{[A]}{\left[B\right]}S_{12}\delta_{S_{22}}\right]
\end{eqnarray*}
Analogamente, temos:
\begin{eqnarray*}
\frac{1}{[B]}\delta_{[B]}&=&\frac{1}{\left|\det{S}\right|}\left[\frac{[B]}{\left[A\right]}S_{21}\delta_{S_{11}}+S_{21}\delta_{S_{11}}+\frac{\left[B\right]}{[A]}S_{11}\delta_{S_{21}}+S_{11}\delta_{S_{22}}\right]
\end{eqnarray*}

onde não se indicou $|S_{ij}|$ nem $|[.]|$ pois são todos positivos.


Fazemos agora a aplicação numérica:

{\bf Caso do par 1-2:}
$$\det{S}=\left|\begin{array}{cc}270&30\\140&20\end{array}\right|=1200$$
\begin{eqnarray*}
\frac{1}{[A]}\delta_{[A]}
&=&\frac{1}{1200}\left[20\times 270\times 2\%+20\times 30\times 2\%+30\times 140\times 2\%+30\times 20\times 2\%\right]\\&=&\frac{216}{1200}=0.18=18\%\\
\frac{1}{[B]}\delta_{[B]}
&=&\frac{1}{1200}\left[140\times 270\times 2\%+140\times 30\times 2\%+270\times 140\times 2\%+270\times 20\times 2\%\right]\\&=&\frac{426}{1200}=0.355=35.5\%
\end{eqnarray*}

{\bf Caso do par 1-3:}
$$\det{S}=\left|\begin{array}{cc}270&30\\15&200\end{array}\right|=53550$$
\begin{eqnarray*}
\frac{1}{[A]}\delta_{[A]}
&=&\frac{1}{53550}\left[200\times 270\times 2\%+200\times 30\times 2\%+30\times 15\times 10\%+30\times 200\times 10\%\right]\\&=&\frac{1804,6}{52550}\approx 0.0337=3.37\%\\
\frac{1}{[B]}\delta_{[B]}
&=&\frac{1}{53550}\left[15\times 270\times 2\%+15\times 30\times 2\%+270\times 15\times 10\%+270\times 200\times 10\%\right]\\&=&	\frac{5895}{53550}\approx   0.11=11\%
\end{eqnarray*}

Conclusão, apesar de o sensor $3$ apresentar uma incerteza cinco vezes maior na sensibilidade, a escolha do sensor $3$ para fazer par ao sensor $1$ parece mais adequada.    
  \end{tiny}
\end{Answer}

\end{document} 