<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html xml:lang="pt" > 
<head><title>Derivaçao Numerica</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- html,3,notoc*,info --> 
<meta name="src" content="main.tex"> 
<link rel="stylesheet" type="text/css" href="main.css"> 
</head><body 
>
   <!--l. 8--><div class="crosslinks"><p class="noindent">[<a 
href="mainse47.html" >next</a>] [<a 
href="mainse20.html#tailmainse33.html">tail</a>] [<a 
href="mainap1.html#mainse46.html" >up</a>] </p></div>
   <h3 class="sectionHead"><span class="titlemark">7.1   </span> <a 
 id="x72-1140007.1"></a>Derivação Numérica</h3>
<a 
 id="dx72-114001"></a>
<!--l. 10--><p class="noindent" >Dado um conjunto de pontos <span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><sub><span 
class="lmmi-8">i</span></sub><span 
class="lmmi-12">,y</span><sub><span 
class="lmmi-8">i</span></sub><span 
class="rm-lmr-12">)</span><sub><span 
class="lmmi-8">i</span><span 
class="rm-lmr-8">=1</span></sub><sup><span 
class="lmmi-8">n</span></sup>, a derivada <img 
src="main1841x.png" alt="(dy)
 dx"  class="left" align="middle"><sub><span 
class="lmmi-8">i</span></sub> pode ser calculada de várias
formas. Na próxima seção trabalharemos com diferenças finitas, que é mais adequada
quando as abcissas estão próximas e os dados não sofrem perturbações significativas.
Na seção subsequente trataremos os casos quando os dados oscilam via ajuste ou
interpolações de curvas.
<!--l. 12--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">7.1.1   </span> <a 
 id="x72-1150007.1.1"></a>Aproximação da derivada por diferenças finitas</h4>
<a 
 id="dx72-115001"></a>
<!--l. 14--><p class="noindent" >A derivada <span 
class="lmmi-12">f</span><span 
class="lmsy-10x-x-120">&#x2032;</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub><span 
class="rm-lmr-12">) </span>de uma função <span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) </span>no ponto <span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub> é
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main1842x.png" alt="f &#x2032;(x ) = lim  f(x0-+-h)---f(x0)-.
    0    h&#x2192;0         h
" class="math-display" ></center></td></tr></table>
                                                                                <img 
src="main1844x.png" alt="PICT" >
<img 
src="main1847x.png" alt="PICT" >
                                                                                
<!--l. 17--><p class="nopar" >
Da definição, se <span 
class="lmmi-12">h</span><span 
class="lmmi-12">&#x2260;</span><span 
class="rm-lmr-12">0 </span>é pequeno (não muito pequeno para evitar o cancelamento
catastrófico), é esperado que uma aproximação para a derivada no ponto <span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub> seja dada
por:
   <table 
class="equation"><tr><td><a 
 id="x72-115002r1"></a>
   <center class="math-display" >
<img 
src="main1845x.png" alt=" &#x2032;       f(x0-+-h-) --f-(x0-)
f (x0) &#x2248;         h         .
" class="math-display" ></center></td><td class="equation-label">(7.1)</td></tr></table>
<!--l. 21--><p class="nopar" >
   <div class="newtheorem">
<!--l. 23--><p class="noindent" ><span class="head">
<a 
 id="x72-115003r1"></a>
<span 
class="ec-lmbx-12">Exemplo 7.1.1.</span>  </span> Calcule a derivada numérica da função <span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) =</span> <span 
class="rm-lmr-12">cos</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) </span>no ponto
<span 
class="lmmi-12">x </span><span 
class="rm-lmr-12">= 1 </span>usando <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">1</span>, <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">01</span>, <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">001 </span>e <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">0001</span>.
   </div>
<!--l. 26--><p class="indent" >
   <div class="proof">
<!--l. 26--><p class="indent" >   <span class="head">
<span 
class="ec-lmbx-12">Solu</span><span 
class="ec-lmbx-12">ç</span><span 
class="ec-lmbx-12">ão.</span> </span> Usando a fórmula de diferenças dada pela Equação&#x00A0;(<a 
href="#x72-115002r1">7.1<!--tex4ht:ref: eq:dp --></a>), devemos
calcular:
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
                                                                                <img 
src="main1848x.png" alt="PICT" >
<img 
src="main1854x.png" alt="PICT" >
                                                                                
<img 
src="main1846x.png" alt="        cos(1 + h) - cos(1)
f&#x2032;(x) &#x2248; -------------------
                 h
" class="math-display" ></center></td></tr></table>
<!--l. 30--><p class="nopar" >
para cada valor de <span 
class="lmmi-12">h </span>solicitado, obtemos a Tabela&#x00A0;<span 
class="ec-lmbx-12">??</span>.
   <div class="table">
<!--l. 34--><p class="indent" >   <a 
 id="x72-1150041"></a><hr class="float"><div class="float" 
><!--tex4ht:inline--><div class="tabular"> <table id="TBL-25" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-25-1g"><col 
id="TBL-25-1"></colgroup><colgroup id="TBL-25-2g"><col 
id="TBL-25-2"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-25-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-25-1-1"  
class="td11">  <span 
class="lmmi-12">h  </span></td><td  style="white-space:nowrap; text-align:center;" id="TBL-25-1-2"  
class="td11">         <img 
src="main1849x.png" alt="f-(1 +-h-) --f-(1)
       h" >            </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-25-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-25-2-1"  
class="td11"> 0,1  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-25-2-2"  
class="td11"><img 
src="main1850x.png" alt="0,4535961----0,5403023-
         0,1" > <span 
class="rm-lmr-12">= </span><span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">8670618</span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-25-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-25-3-1"  
class="td11"> 0,01  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-25-3-2"  
class="td11"><img 
src="main1851x.png" alt="0,5318607  - 0,5403023
---------0,01----------" > <span 
class="rm-lmr-12">= </span><span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">8441584</span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-25-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-25-4-1"  
class="td11"> 0,001 </td><td  style="white-space:nowrap; text-align:center;" id="TBL-25-4-2"  
class="td11"><img 
src="main1852x.png" alt="0,5403023 -  0,5403023
----------------------
         0,001" > <span 
class="rm-lmr-12">= </span><span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">841741 </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-25-5-"><td  style="white-space:nowrap; text-align:center;" id="TBL-25-5-1"  
class="td11">0,0001</td><td  style="white-space:nowrap; text-align:center;" id="TBL-25-5-2"  
class="td11"><img 
src="main1853x.png" alt="0,5403023 -  0,5403023
----------------------
        0,0001" > <span 
class="rm-lmr-12">= </span><span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">841498 </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-25-6-"><td  style="white-space:nowrap; text-align:center;" id="TBL-25-6-1"  
class="td11">     </td></tr></table></div>
<br /> <div class="caption" 
><span class="id">Tabela&#x00A0;7.1: </span><span  
class="content">Exercício&#x00A0;<a 
href="#x72-115003r1">7.1.1<!--tex4ht:ref: ex:dp --></a>.</span></div><!--tex4ht:label?: x72-1150041 -->
   </div><hr class="endfloat" />
   </div>
<!--l. 46--><p class="indent" >   No <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-12">Scilab</span></span></span>, podemos calcular a aproximação da derivada <span 
class="lmmi-12">f</span><span 
class="lmsy-10x-x-120">&#x2032;</span><span 
class="rm-lmr-12">(1) </span>com <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">1 </span>usando
as seguintes linhas de código:
                                                                                <img 
src="main1855x.png" alt="PICT" >
<img 
src="main1858x.png" alt="PICT" >
                                                                                
   <div class="verbatim" id="verbatim-45">
deff(&#8217;y&#x00A0;=&#x00A0;f(x)&#8217;,&#8217;y&#x00A0;=&#x00A0;cos(x)&#8217;)
&#x00A0;<br />x0&#x00A0;=&#x00A0;1
&#x00A0;<br />h&#x00A0;=&#x00A0;0.1
&#x00A0;<br />dp&#x00A0;=&#x00A0;(f(x0+h)&#x00A0;-&#x00A0;f(x0))/h
</div>
<!--l. 52--><p class="nopar" >E, similarmente, para outros valores de <span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub> e <span 
class="lmmi-12">h</span>.                                            <span 
class="msam-10x-x-120">&#x2662;</span>
   </div>
<!--l. 57--><p class="indent" >   Observe que, no exemplo anterior, quanto menor <span 
class="lmmi-12">h</span>, melhor é a aproximação, visto
que o valor exato para a derivada é <span 
class="lmmi-12">f</span><span 
class="lmsy-10x-x-120">&#x2032;</span><span 
class="rm-lmr-12">(1) = </span><span 
class="lmsy-10x-x-120">-</span> <span 
class="rm-lmr-12">sin</span><span 
class="rm-lmr-12">(1) = </span><span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">8414710</span>. Porém, quando
<span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 10</span><sup><span 
class="lmsy8-">-</span><span 
class="rm-lmr-8">13</span></sup>, a derivada numérica é <span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">8404388 </span>(usando aritmética <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-12">double</span></span></span>), resultado
pior que aquele para <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">0001</span>. Além disso, na mesma aritmética, quando <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 10</span><sup><span 
class="lmsy8-">-</span><span 
class="rm-lmr-8">16</span></sup> a
derivada numérica calculada é zero (cancelamento catastrófico). Isso nos motiva a
pensar qual é o melhor <span 
class="lmmi-12">h</span>.
<!--l. 59--><p class="indent" >   Essa aproximação para a derivada é denominada diferenças progressivas. A derivada
numérica também pode ser aproximada usando definições equivalentes:
   <center class="math-display" >
<img 
src="main1856x.png" alt="          f(x ) - f(x -  h)   y  - y
f &#x2032;(x0) &#x2248;  ---0-------0------= -i----i-1
                  h               h  " class="math-display" ></center> que
é denominada diferenças regressivas ou
   <center class="math-display" >
<img 
src="main1857x.png" alt="  &#x2032;      f-(x0 +-h) --f(x0 --h)   yi+1---yi-1
f (x0) &#x2248;           2h           =     2h  " class="math-display" ></center> que
é denominada diferenças centrais.
                                                                                <img 
src="main1859x.png" alt="PICT" >
<img 
src="main1866x.png" alt="PICT" >
                                                                                
   <div class="newtheorem">
<!--l. 68--><p class="noindent" ><span class="head">
<a 
 id="x72-115005r2"></a>
<span 
class="ec-lmbx-12">Exemplo 7.1.2.</span>  </span>Calcule a derivada numérica da função <span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) =</span> <span 
class="rm-lmr-12">cos</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) </span>no ponto
<span 
class="lmmi-12">x </span><span 
class="rm-lmr-12">= 1 </span>usando diferenças progressivas, diferenças regressivas e diferenças centrais
com <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">1</span>, <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">01 </span>e <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">001</span>.
   </div>
<!--l. 71--><p class="indent" >
   <div class="proof">
<!--l. 71--><p class="indent" >   <span class="head">
<span 
class="ec-lmbx-12">Solu</span><span 
class="ec-lmbx-12">ç</span><span 
class="ec-lmbx-12">ão.</span> </span> A tabela abaixo mostra a derivada numérica para cada valor de
<span 
class="lmmi-12">h</span>.
<div class="center" 
>
<!--l. 73--><p class="noindent" >
<div class="tabular"> <table id="TBL-26" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-26-1g"><col 
id="TBL-26-1"></colgroup><colgroup id="TBL-26-2g"><col 
id="TBL-26-2"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-26-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-26-1-1"  
class="td11">Diferenças </td><td  style="white-space:nowrap; text-align:center;" id="TBL-26-1-2"  
class="td11">             h=0,1                     </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-26-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-26-2-1"  
class="td11">Progressivas</td><td  style="white-space:nowrap; text-align:center;" id="TBL-26-2-2"  
class="td11">           <span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">8670618                 </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-26-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-26-3-1"  
class="td11">Regressivas </td><td  style="white-space:nowrap; text-align:center;" id="TBL-26-3-2"  
class="td11">   <img 
src="main1860x.png" alt="cos(1)---cos(0,9-)
       0,1"  class="frac" align="middle"> <span 
class="rm-lmr-12">= </span><span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">8130766    </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-26-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-26-4-1"  
class="td11">Centrais     </td><td  style="white-space:nowrap; text-align:center;" id="TBL-26-4-2"  
class="td11">  <img 
src="main1861x.png" alt="cos(1,1) --cos(0,9)
        0,2"  class="frac" align="middle"> <span 
class="rm-lmr-12">= </span><span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">8400692   </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-26-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-26-5-1"  
class="td11">Diferenças  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-26-5-2"  
class="td11">             h=0,01                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-26-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-26-6-1"  
class="td11">Progressivas</td><td  style="white-space:nowrap; text-align:center;" id="TBL-26-6-2"  
class="td11">           <span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">8441584                 </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-26-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-26-7-1"  
class="td11">Regressivas </td><td  style="white-space:nowrap; text-align:center;" id="TBL-26-7-2"  
class="td11">  <img 
src="main1862x.png" alt="cos(1) - cos(0,99)
------0,01--------"  class="frac" align="middle"> <span 
class="rm-lmr-12">= </span><span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">8387555   </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-26-8-"><td  style="white-space:nowrap; text-align:left;" id="TBL-26-8-1"  
class="td11">Centrais     </td><td  style="white-space:nowrap; text-align:center;" id="TBL-26-8-2"  
class="td11"> <img 
src="main1863x.png" alt="cos(1,01) - cos(0,99 )
---------------------
        0,02"  class="frac" align="middle"> <span 
class="rm-lmr-12">= </span><span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">8414570  </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-26-9-"><td  style="white-space:nowrap; text-align:left;" id="TBL-26-9-1"  
class="td11">Diferenças  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-26-9-2"  
class="td11">             h=0,01                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-26-10-"><td  style="white-space:nowrap; text-align:left;" id="TBL-26-10-1"  
class="td11">Progressivas</td><td  style="white-space:nowrap; text-align:center;" id="TBL-26-10-2"  
class="td11">           <span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">841741                  </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-26-11-"><td  style="white-space:nowrap; text-align:left;" id="TBL-26-11-1"  
class="td11">Regressivas </td><td  style="white-space:nowrap; text-align:center;" id="TBL-26-11-2"  
class="td11">  <img 
src="main1864x.png" alt="cos(1) - cos(0,999 )
-------------------
       0,001"  class="frac" align="middle"> <span 
class="rm-lmr-12">= </span><span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">8412007   </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-26-12-"><td  style="white-space:nowrap; text-align:left;" id="TBL-26-12-1"  
class="td11">Centrais     </td><td  style="white-space:nowrap; text-align:center;" id="TBL-26-12-2"  
class="td11"><img 
src="main1865x.png" alt="cos(1,001) --cos(0,999-)
         0,002"  class="frac" align="middle"> <span 
class="rm-lmr-12">= </span><span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">8414708</span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-26-13-"><td  style="white-space:nowrap; text-align:left;" id="TBL-26-13-1"  
class="td11">          </td></tr></table></div></div>
                                                                              <span 
class="msam-10x-x-120">&#x2662;</span>
   </div>
                                                                                <img 
src="main1867x.png" alt="PICT" >
<img 
src="main1870x.png" alt="PICT" >
                                                                                
<!--l. 91--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">7.1.2   </span> <a 
 id="x72-1160007.1.2"></a>Erros de truncamento</h4>
<a 
 id="dx72-116001"></a>
<!--l. 92--><p class="noindent" >Seja <span 
class="lmmi-12">D</span><sub><span 
class="rm-lmr-8">+</span><span 
class="lmmi-8">,h</span></sub><span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub><span 
class="rm-lmr-12">) </span>a aproximação da derivada de <span 
class="lmmi-12">f </span>em <span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub> por diferenças progressivas,
<span 
class="lmmi-12">D</span><sub><span 
class="lmsy8-">-</span><span 
class="lmmi-8">,h</span></sub><span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub><span 
class="rm-lmr-12">) </span>a aproximação por diferenças regressivas e <span 
class="lmmi-12">D</span><sub><span 
class="rm-lmr-8">0</span><span 
class="lmmi-8">,h</span></sub><span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub><span 
class="rm-lmr-12">) </span>a aproximação por
diferenças centrais, então <div class="eqnarray">
   <center class="math-display" >
<img 
src="main1868x.png" alt="D+,hf (x0) - f &#x2032;(x0) =   f(x0-+-h)---f(x0-)- f &#x2032;(x0)
                                h
                        f(x0) + hf &#x2032;(x0) + h2f&#x2032;&#x2032;(x0) + O (h3) - f(x0)
                    =   -------------------2----------------------- - f&#x2032;(x0)
                                             h
                    =   h-f&#x2032;&#x2032;(x ) + O(h2) = O (h).
                        2     0
" class="math-display" ></center>
</div>Analogamente: <div class="eqnarray">
   <center class="math-display" >
<img 
src="main1869x.png" alt="              &#x2032;         f(x0) - f(x0 - h)     &#x2032;
D- ,hf (x0 ) - f (x0) =   ------------------- f (x0)
                                h(                   2               )
                        f(x0) -  f(x0) - hf &#x2032;(x0) + h2 f&#x2032;&#x2032;(x0 ) + O (h3)   &#x2032;
                    =   ----------------------h------------------------ f (x0)

                    =   - hf&#x2032;&#x2032;(x0 ) + O (h2) = O (h).
                          2
" class="math-display" ></center>
                                                                                <img 
src="main1871x.png" alt="PICT" >
<img 
src="main1875x.png" alt="PICT" >
                                                                                
</div>Também: <div class="eqnarray">
   <center class="math-display" >
<img 
src="main1872x.png" alt="              &#x2032;         f(x0 + h) - f(x0 - h)     &#x2032;
D0,hf(x0 ) - f (x0) =   ---------2h------------ f (x0)
                                  &#x2032;       h2 &#x2032;&#x2032;          3
                    =   f(x0)-+-hf-(x0) +-2-f-(x0)-+-O-(h--)
                                        2h
                        f(x ) - hf &#x2032;(x ) + h2f&#x2032;&#x2032;(x ) + O (h3)
                    -   ---0---------0----2-----0-----------  f&#x2032;(x0 )
                                        2h
                    =   O(h2).
" class="math-display" ></center>
</div>
   <div class="newtheorem">
<!--l. 112--><p class="noindent" ><span class="head">
<a 
 id="x72-116005r3"></a>
<span 
class="ec-lmbx-12">Exemplo 7.1.3.</span>  </span>Calcule a derivada numérica e o erro de truncamento de <span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) =</span>
<span 
class="lmmi-12">e</span><sup><span 
class="lmsy8-">-</span><span 
class="lmmi-8">x</span></sup> em <span 
class="lmmi-12">x </span><span 
class="rm-lmr-12">= 1</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">5 </span>pela fórmula de diferença progressiva para <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">1</span>, <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">01 </span>e
<span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">001</span>.
   </div>
<!--l. 115--><p class="indent" >
   <div class="proof">
<!--l. 115--><p class="indent" >   <span class="head">
<span 
class="ec-lmbx-12">Solu</span><span 
class="ec-lmbx-12">ç</span><span 
class="ec-lmbx-12">ão.</span> </span> Como <span 
class="lmsy-10x-x-120">|</span><span 
class="lmmi-12">f</span><span 
class="lmsy-10x-x-120">&#x2032;&#x2032;</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">)</span><span 
class="lmsy-10x-x-120">| </span><span 
class="rm-lmr-12">= </span><span 
class="lmsy-10x-x-120">|</span><span 
class="lmmi-12">e</span><sup><span 
class="lmsy8-">-</span><span 
class="lmmi-8">x</span></sup><span 
class="lmsy-10x-x-120">| </span><span 
class="lmmi-12">&#x003C; </span><span 
class="rm-lmr-12">1</span>, então <span 
class="lmsy-10x-x-120">|</span><span 
class="lmmi-12">f</span><span 
class="lmsy-10x-x-120">&#x2032;</span><sub>
<span 
class="rm-lmr-8">+</span></sub><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub><span 
class="rm-lmr-12">) </span><span 
class="lmsy-10x-x-120">- </span><span 
class="lmmi-12">f</span><span 
class="lmsy-10x-x-120">&#x2032;</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub><span 
class="rm-lmr-12">)</span><span 
class="lmsy-10x-x-120">| </span><span 
class="lmmi-12">&#x003C;</span> <img 
src="main1873x.png" alt="h
2"  class="frac" align="middle">.
   <center class="math-display" >
                                                                                <img 
src="main1876x.png" alt="PICT" >
<img 
src="main1879x.png" alt="PICT" >
                                                                                
<img 
src="main1874x.png" alt="|------|-----------------------|---------|
|  h   |diferenças progressivas|erro = h2 |
|------|-----------------------|---------|
|-0,1--|-------0,2123364-------|--0,05---|
|      |                       |         |
|-0,01--|-------0,2220182-------|--0,005---|
|      |                       |         |
-0,001---------0,2230186---------0,0005---
" class="math-display" ></center> O valor exato da derivada é <span 
class="lmmi-12">f</span><span 
class="lmsy-10x-x-120">&#x2032;</span><span 
class="rm-lmr-12">(1</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">5) = </span><span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">2231302</span>.                                     <span 
class="msam-10x-x-120">&#x2662;</span>
   </div>
<!--l. 133--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">7.1.3   </span> <a 
 id="x72-1170007.1.3"></a>Erros de arredondamento</h4>
<a 
 id="dx72-117001"></a>
<!--l. 134--><p class="noindent" >Para entender como os erros de arredondamento se propagam ao calcular as derivadas
numéricas vamos considerar o operador de diferenças finitas progressivas
   <center class="math-display" >
<img 
src="main1877x.png" alt="             f(x-+-h)---f(x)-
D+,hf (x) =         h       .  " class="math-display" ></center>
Nesse contexto temos o valor exato <span 
class="lmmi-12">f</span><span 
class="lmsy-10x-x-120">&#x2032;</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) </span>para a derivada, a sua aproximação numérica
<span 
class="lmmi-12">D</span><sub><span 
class="rm-lmr-8">+</span><span 
class="lmmi-8">,h</span></sub><span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) </span>e a representação em número de máquina do operador <span 
class="lmmi-12">D</span><sub><span 
class="rm-lmr-8">+</span><span 
class="lmmi-8">,h</span></sub><span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) </span>que
denotaremos por <span class="overline"><span 
class="lmmi-12">D</span><sub><span 
class="rm-lmr-8">+</span><span 
class="lmmi-8">,h</span></sub><span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">)</span></span>. Seja <span 
class="lmmi-12">&#x03B5;</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x,h</span><span 
class="rm-lmr-12">) </span>o erro de arredondamento ao calcularmos a
derivada e consideremos
   <center class="math-display" >
<img 
src="main1878x.png" alt="---------                           f(x-+-h) - f(x)-
D+,hf (x) = D+,hf (x)(1 + &#x03B5;(x,h )) =  ---------------(1 + &#x03B5;(x,h)).
                                           h  " class="math-display" ></center>
Também, consideremos
   <center class="math-display" >
<img 
src="main1881x.png" alt="---------
|f (x + h) - f(x + h)| = &#x03B4;(x,h ) &#x2264; &#x03B4;  " class="math-display" ></center>
e
   <center class="math-display" >
<img 
src="main1882x.png" alt="-----
|f (x ) - f (x)| = &#x03B4;(x,0) &#x2264; &#x03B4;,  " class="math-display" ></center>
onde <span class="overline"><span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x </span><span 
class="rm-lmr-12">+ </span><span 
class="lmmi-12">h</span><span 
class="rm-lmr-12">)</span></span> e <span class="overline"><span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">)</span></span> são as representação em ponto flutuante dos números <span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x </span><span 
class="rm-lmr-12">+ </span><span 
class="lmmi-12">h</span><span 
class="rm-lmr-12">) </span>e
<span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">)</span>, respectivamente. A diferença do valor da derivada e sua aproximação
representada em ponto flutuante pode ser estimada da seguinte forma: <div class="eqnarray">
   <center class="math-display" >
<img 
src="main1883x.png" alt="|        ---------|     ||       f-(x +-h) - f(x)-           ||
||f&#x2032;(x) - D+,hf (x )|| =   ||f &#x2032;(x) - ----------------(1 + &#x03B5;(x,h))||
                        |         ------h--  -----          |
                        ||       ( f(x + h) - f(x )   f(x + h) - f(x + h)
                    =   ||f &#x2032;(x) -   ----------------+  --------------------
                        |           )    h   |                h
                         f(x) - f(x)         ||
                    +    ------------ (1 + &#x03B5;)||
                        |     h (                     ---------
                        || &#x2032;         f(x + h) - f(x)   f (x + h) - f(x + h)
                    =   ||f (x) +   - -------h--------- ----------h---------
                         -----      )        |
                         f(x) --f(x)-        ||
                    +         h       (1 + &#x03B5;)||
                        |                       |   (|---------           |
                        || &#x2032;     f-(x +-h) --f(x)||    ||f(x-+-h)---f(x-+-h-)||
                    &#x2264;   ||f (x) -         h       || +  ||         h          ||
                        |-----       |)          |                |
                        ||f(x)---f(x-)||          ||f(x-+-h-) --f-(x-)||
                    +   ||     h      || |1 + &#x03B5;| + ||      h        ||&#x03B5;
                              ( || ||   || ||)
                    &#x2264;   M h +   ||&#x03B4;||+  ||&#x03B4;|| |1 + &#x03B5;| + |f&#x2032;(x)|&#x03B5;
                                |h|   |h |
                              (   )
                    &#x2264;   M h +   2&#x03B4;- |1 + &#x03B5;| + |f&#x2032;(x)|&#x03B5;
                                h
" class="math-display" ></center>
</div>onde
   <center class="math-display" >
<img 
src="main1886x.png" alt="      1-         &#x2032;&#x2032;
M  =  2x&#x2264;mya&#x2264;xx+h |f (y)| " class="math-display" ></center> está
relacionado com o erro de truncamento.
<!--l. 168--><p class="indent" >   Esta estimativa mostra que se o valor de <span 
class="lmmi-12">h </span>for muito pequeno o erro ao calcular a
aproximação numérica cresce. Isso nos motiva a procurar o valor ótimo de <span 
class="lmmi-12">h </span>que
minimiza o erro.
   <div class="newtheorem">
                                                                                <img 
src="main1888x.png" alt="PICT" >
<img 
src="main1892x.png" alt="PICT" >
                                                                                
<!--l. 170--><p class="noindent" ><span class="head">
<a 
 id="x72-117003r4"></a>
<span 
class="ec-lmbx-12">Exemplo 7.1.4.</span>  </span>Estude o comportamento da derivada de <span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) = </span><span 
class="lmmi-12">e</span><sup><span 
class="lmsy8-">-</span><span 
class="lmmi-8">x</span><sup><span 
class="rm-lmr-6">2</span></sup></sup>  no ponto
<span 
class="lmmi-12">x </span><span 
class="rm-lmr-12">= 1</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">5 </span>quando <span 
class="lmmi-12">h </span>fica pequeno.
   </div>
<!--l. 172--><p class="indent" >
   <div class="proof">
<!--l. 172--><p class="indent" >   <span class="head">
<span 
class="ec-lmbx-12">Solu</span><span 
class="ec-lmbx-12">ç</span><span 
class="ec-lmbx-12">ão.</span> </span> Segue a tabela com os valores da derivada para vários valores de
<span 
class="lmmi-12">h</span>.
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main1889x.png" alt="|--------|--------|--------|--------|--------|--------|--------|
|---h----|--10-2---|--10-4---|--10-6---|--10-7---|--10-8---|--10-9---|
-D+,hf(1,5)---0,3125246---0,3161608---0,3161973---0,3161976---0,3161977---0,3161977--
" class="math-display" ></center></td></tr></table>
<!--l. 183--><p class="nopar" >
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main1890x.png" alt="|--------|--------|--------|--------|--------|--------|--------|
|---h----|--10-10--|--10-11--|--10-12--|--10-13--|--10-14--|--10-15--|
-D+,hf(1,5)---0,3161976---0,3161971---0,3162332---0,3158585---0,3178013---0,3747003--
" class="math-display" ></center></td></tr></table>
<!--l. 192--><p class="nopar" >
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main1891x.png" alt="|---h----|--10-2---|--10-4---|--10-6---|--10-7---|--10-8---|--10-9---|
-D+,hf(1,5)---0,3125246---0,3161608---0,3161973---0,3161976---0,3161977---0,3161977--
" class="math-display" ></center></td></tr></table>
<!--l. 201--><p class="nopar" >
<!--l. 204--><p class="indent" >   Observe que o valor exato é <span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">3161977 </span>e o <span 
class="lmmi-12">h </span>ótimo é algo entre <span 
class="rm-lmr-12">10</span><sup><span 
class="lmsy8-">-</span><span 
class="rm-lmr-8">8</span></sup> e
<span 
class="rm-lmr-12">10</span><sup><span 
class="lmsy8-">-</span><span 
class="rm-lmr-8">9</span></sup>.                                                                                                  <span 
class="msam-10x-x-120">&#x2662;</span>
   </div>
<!--l. 208--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">7.1.4   </span> <a 
 id="x72-1180007.1.4"></a>Aproximações de alta ordem</h4>
<a 
 id="dx72-118001"></a>
<!--l. 210--><p class="noindent" >Para aproximar a derivada de uma função <span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) </span>em <span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub>, <span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">1</span></sub> ou <span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">2</span></sub> usaremos os três pontos
vizinhos <span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub><span 
class="lmmi-12">,f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub><span 
class="rm-lmr-12">))</span>, <span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">1</span></sub><span 
class="lmmi-12">,f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">1</span></sub><span 
class="rm-lmr-12">)) </span>e <span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">2</span></sub><span 
class="lmmi-12">,f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">2</span></sub><span 
class="rm-lmr-12">))</span>. Uma interpolação usando polinômios de
Lagrange para esses três pontos é da forma: <div class="eqnarray">
   <center class="math-display" >
<img 
src="main1894x.png" alt="                (x - x1)(x - x2)          (x - x0)(x - x2)
f(x)  =   f(x0)------------------ + f(x1)------------------
               (x0 - x1)(x0 - x2)     &#x2032;&#x2032;&#x2032;  (x1 - x0)(x1 - x2)
               -(x---x0)(x---x1)-   f--(&#x03BE;(x))
      +   f(x2)(x2 - x0)(x2 - x1) +     6    (x - x0)(x - x1)(x - x2).
" class="math-display" ></center>
</div>A derivada de <span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) </span>é
   <table 
class="equation"><tr><td><a 
 id="x72-118003r2"></a>
   <center class="math-display" >
                                                                                <img 
src="main1897x.png" alt="PICT" >
<img 
src="main1899x.png" alt="PICT" >
                                                                                
<img 
src="main1895x.png" alt="                2x - x1 - x2              2x - x0 - x2
f&#x2032;(x) = f(x0)------------------ + f(x1) ------------------
             (x0 - x1)(x0 - x2)         (x1 - x0 )(x1 - x2)
             ---2x---x0---x1---
     +  f(x2)(x2 - x0)(x2 - x1)
         &#x2032;&#x2032;&#x2032;
     +  f--(&#x03BE;(x-))((x - x1)(x - x2) + (x -  x0)(2x -  x1 - x2))
           (6        )
             f&#x2032;&#x2032;&#x2032;(&#x03BE;(x))
     +  Dx   --------- (x - x0)(x - x1)(x - x2).
                6
" class="math-display" ></center></td><td class="equation-label">(7.2)</td></tr></table>
<!--l. 226--><p class="nopar" >
Trocando <span 
class="lmmi-12">x </span>por <span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub>, temos
   <table 
class="equation-star"><tr><td>
   <center class="math-display" >
<img 
src="main1898x.png" alt="  &#x2032;           ---2x0---x1---x2--         --2x0---x0---x2---
f (x0) = f(x0)(x  - x  )(x  - x ) + f (x1 )(x -  x )(x - x  )
                 0    1   0   2            1    0   1    2
      +  f(x2)---2x0 --x0 --x1--
              (x2 - x0)(x2 - x1)
         f&#x2032;&#x2032;&#x2032;(&#x03BE;(x0))
      +  ----------((x0 - x1)(x0 - x2) + (x0 - x0 )(2x0 - x1 - x2))
            (6 &#x2032;&#x2032;&#x2032;      )
              f-(&#x03BE;(x0))-
      +  Dx       6      (x0 - x0)(x0 - x1)(x0 - x2).
" class="math-display" ></center></td></tr></table>
<!--l. 236--><p class="nopar" >
Considerando uma malha equiespaçada onde <span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">1</span></sub> <span 
class="rm-lmr-12">= </span><span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub> <span 
class="rm-lmr-12">+ </span><span 
class="lmmi-12">h </span>e <span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">2</span></sub> <span 
class="rm-lmr-12">= </span><span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub> <span 
class="rm-lmr-12">+ 2</span><span 
class="lmmi-12">h</span>,
temos:
   <table 
class="equation-star"><tr><td>
                                                                                <img 
src="main1900x.png" alt="PICT" >
<img 
src="main1904x.png" alt="PICT" >
                                                                                
   <center class="math-display" >
<img 
src="main1901x.png" alt="f&#x2032;(x ) = f(x )----- 3h--- + f(x ) ---2h---
    0       0 (- h)(- 2h)       1 (h )(- h )
                          &#x2032;&#x2032;&#x2032;
      +  f(x2)----h---+  f-(&#x03BE;(x0))-((- h)(- 2h))
              (2h)(h)        6
         1 [  3                  1     ]    2 f&#x2032;&#x2032;&#x2032;(&#x03BE;(x0))
       = -- - -f (x0) + 2f (x1) --f(x2 ) + h  ----------
         h    2                  2                3
" class="math-display" ></center></td></tr></table>
<!--l. 244--><p class="nopar" >
Similarmente, trocando <span 
class="lmmi-12">x </span>por <span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">1</span></sub> ou trocando <span 
class="lmmi-12">x </span>por <span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">2</span></sub> na expressão (<a 
href="#x72-118003r2">7.2<!--tex4ht:ref: tres_pontos --></a>), temos outras
duas expressões <div class="eqnarray">
   <center class="math-display" >
<img 
src="main1902x.png" alt="             [                  ]
 &#x2032;         1-   1-        1-         2 f&#x2032;&#x2032;&#x2032;(&#x03BE;(x1))-
f (x1 ) =   h  - 2 f(x0) + 2f(x2 ) + h      6
           1 [1                  3      ]     f&#x2032;&#x2032;&#x2032;(&#x03BE;(x ))
f&#x2032;(x2 ) =   -- --f(x0) - 2f(x1) + --f(x2) +  h2-------2--
           h  2                  2                3
" class="math-display" ></center>
</div>Podemos reescrever as três fórmulas da seguinte forma: <div class="eqnarray">
   <center class="math-display" >
<img 
src="main1903x.png" alt="                 1 [  3                     1           ]     f &#x2032;&#x2032;&#x2032;(&#x03BE;(x0))
     f&#x2032;(x0)  =   -- - -f(x0) + 2f(x0 + h ) ---f(x0 + 2h)  + h2----------
                 h [  2                    ]2     &#x2032;&#x2032;&#x2032;               3
 f&#x2032;(x +  h)  =   1- - 1f(x ) + 1-f(x +  2h) +  h2f--(&#x03BE;(x0 +-h))
     0           h    2   0    2    0                  6
                 1 [1                      3          ]      f&#x2032;&#x2032;&#x2032;(&#x03BE;(x0 + 2h ))
f&#x2032;(x0 + 2h)  =   -- -f(x0 ) - 2f (x0 + h ) +-f(x0 + 2h ) + h2---------------
                 h  2                      2                       3
" class="math-display" ></center>
</div>ou ainda <div class="eqnarray">
   <center class="math-display" >
<img 
src="main1906x.png" alt=" &#x2032;          1--                                        2f&#x2032;&#x2032;&#x2032;(&#x03BE;(x0))-
f (x0)  =   2h [- 3f (x0 ) + 4f (x0 + h ) - f (x0 + 2h)] + h  3       (7.3)
            1                              f&#x2032;&#x2032;&#x2032;(&#x03BE;(x ))
f&#x2032;(x0)  =   ---[f (x0 + h ) - f (x0 - h)] + h2-----0---               (7.4)
            2h                                 6
 &#x2032;          1--                                      2f&#x2032;&#x2032;&#x2032;(&#x03BE;(x0))
f (x0)  =   2h [f (x0 - 2h ) - 4f(x0 - h) + 3f(x0)] + h     3         (7.5)
" class="math-display" ><a 
 id="x72-118006r7.3"></a><a 
 id="x72-118006r7.4"></a><a 
 id="x72-118006r7.5"></a></center>
</div>Observe que uma das fórmulas é exatamente as diferenças centrais obtida
anteriormente.
<!--l. 271--><p class="indent" >   Analogamente, para construir as fórmulas de cinco pontos tomamos o polinômio de
Lagrange para cinco pontos e chegamos a cinco fórmulas, sendo uma delas a
seguinte:
   <table 
class="equation"><tr><td><a 
 id="x72-118007r6"></a>
   <center class="math-display" >
<img 
src="main1907x.png" alt="          1                                                        h4
f&#x2032;(x0) = ----[f(x0 - 2h) - 8f(x0 - h ) + 8f (x0 + h ) - f (x0 + 2h)]+-f (5)(&#x03BE;(x0))
         12h                                                       30
" class="math-display" ></center></td><td class="equation-label">(7.6)</td></tr></table>
<!--l. 274--><p class="nopar" >
   <div class="newtheorem">
<!--l. 276--><p class="noindent" ><span class="head">
<a 
 id="x72-118008r5"></a>
<span 
class="ec-lmbx-12">Exemplo 7.1.5.</span>  </span>Calcule a derivada numérica de <span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) = </span><span 
class="lmmi-12">e</span><sup><span 
class="lmsy8-">-</span><span 
class="lmmi-8">x</span><sup><span 
class="rm-lmr-6">2</span></sup></sup>  em <span 
class="lmmi-12">x </span><span 
class="rm-lmr-12">= 1</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">5 </span>pela
fórmula de três e cinco pontos para <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">1</span>, <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">01 </span>e <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">001</span>.
   </div>
<!--l. 279--><p class="indent" >
   <div class="proof">
<!--l. 279--><p class="indent" >   <span class="head">
<span 
class="ec-lmbx-12">Solu</span><span 
class="ec-lmbx-12">ç</span><span 
class="ec-lmbx-12">ão.</span> </span> A tabela mostra os resultados:
   <center class="math-display" >
<img 
src="main1910x.png" alt="|--------------------------|------------|---------------|-------------------|
|------------h-------------|--h-=-0,1---|---h-=-0,01----|----h-=-0,001------|
|                          |            |               |                   |
|-diferenças-progressivas---|--0,2809448--|---0,3125246---|-----0,3158289------|
|                          |            |               |                   |
|--diferen-ças regressivas--|--0,3545920--|---0,3199024---|-----0,3165667------|
|três pontos usando  (7.3)  |- 0,3127746  | - 0,3161657   |   - 0,3161974      |
|--------------------------|------------|---------------|-------------------|
|três pontos usando  (7.4)  |- 0,3177684  | - 0,3162135   |   - 0,3161978      |
|--------------------------|------------|---------------|-------------------|
|três pontos usando  (7.5)  |- 0,3135824  | - 0,3161665   |   - 0,3161974      |
|--------------------------|------------|---------------|-------------------|
-cinco-pontos--usando-(7.6)----0,3162384-----0,316197677---- 0,3161976736860--|
" class="math-display" ></center> O valor exato da derivada é <span 
class="lmmi-12">f</span><span 
class="lmsy-10x-x-120">&#x2032;</span><span 
class="rm-lmr-12">(1</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">5) = </span><span 
class="lmsy-10x-x-120">-</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">3161976736856</span>.                            <span 
class="msam-10x-x-120">&#x2662;</span>
   </div>
<!--l. 303--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">7.1.5   </span> <a 
 id="x72-1190007.1.5"></a>Aproximação para a segunda derivada</h4>
<a 
 id="dx72-119001"></a>
<!--l. 305--><p class="noindent" >Para aproximar a derivada segunda, considere as expansões em série de Taylor
   <center class="math-display" >
<img 
src="main1913x.png" alt="                                2          3
f(x0 + h) = f (x0 ) + hf &#x2032;(x0) + h-f&#x2032;&#x2032;(x0) + h-f &#x2032;&#x2032;&#x2032;(x0) + O (h4 )
                               2          6
" class="math-display" ></center>
   <center class="math-display" >
<img 
src="main1914x.png" alt="                              h2          h3
f(x0 - h) = f(x0) - hf &#x2032;(x0) + --f &#x2032;&#x2032;(x0) - --f&#x2032;&#x2032;&#x2032;(x0) + O(h4).
                               2          6  " class="math-display" ></center>
Somando as duas expressões, temos:
   <center class="math-display" >
<img 
src="main1917x.png" alt="f (x +  h) + f(x -  h) = 2f(x ) + h2f &#x2032;&#x2032;(x  ) + O (h4)
    0           0             0          0  " class="math-display" ></center>
ou seja, uma aproximação de segunda ordem para a derivada segunda em <span 
class="lmmi-12">x</span><sub><span 
class="rm-lmr-8">0</span></sub>
é
   <center class="math-display" >
<img 
src="main1918x.png" alt="  &#x2032;&#x2032;       f(x0 + h) - 2f(x0) + f(x0 - h)       2       2             2
f  (x0 ) = ---------------2---------------+ O (h ) :=  D 0,hf(x0) + O (h  ),
                        h  " class="math-display" ></center>
onde
   <center class="math-display" >
<img 
src="main1919x.png" alt="            f (x0 + h ) - 2f (x0) + f(x0 - h)
D20,hf(x0) = ----------------2--------------.
                           h
" class="math-display" ></center>
   <div class="newtheorem">
<!--l. 324--><p class="noindent" ><span class="head">
                                                                                <img 
src="main1921x.png" alt="PICT" >
<img 
src="main1924x.png" alt="PICT" >
                                                                                
<a 
 id="x72-119002r6"></a>
<span 
class="ec-lmbx-12">Exemplo 7.1.6.</span>  </span>Calcule a derivada segunda numérica de <span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) = </span><span 
class="lmmi-12">e</span><sup><span 
class="lmsy8-">-</span><span 
class="lmmi-8">x</span><sup><span 
class="rm-lmr-6">2</span></sup></sup> em <span 
class="lmmi-12">x </span><span 
class="rm-lmr-12">= 1</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">5</span>
para <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">1</span>, <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">01 </span>e <span 
class="lmmi-12">h </span><span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">001</span>.
   </div>
<!--l. 327--><p class="indent" >
   <div class="proof">
<!--l. 327--><p class="indent" >   <span class="head">
<span 
class="ec-lmbx-12">Solu</span><span 
class="ec-lmbx-12">ç</span><span 
class="ec-lmbx-12">ão.</span> </span> A tabela mostra os resultados:
   <center class="math-display" >
<img 
src="main1922x.png" alt="|-----------|-----------|----------|-----------|
|           |           |          |           |
|-----h-----|--h-=-0,1--|-h =-0,01-|h-=--0,001-|
|D2   f(1,5)|0,7364712  |0,7377814 |0,7377944  |
---0,h-----------------------------------------
" class="math-display" ></center> Observe que <span 
class="lmmi-12">f</span><span 
class="lmsy-10x-x-120">&#x2032;&#x2032;</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) = (4</span><span 
class="lmmi-12">x</span><sup><span 
class="rm-lmr-8">2</span></sup> <span 
class="lmsy-10x-x-120">- </span><span 
class="rm-lmr-12">2)</span><span 
class="lmmi-12">e</span><sup><span 
class="lmsy8-">-</span><span 
class="lmmi-8">x</span><sup><span 
class="rm-lmr-6">2</span></sup></sup>  e <span 
class="lmmi-12">f</span><span 
class="lmsy-10x-x-120">&#x2032;&#x2032;</span><span 
class="rm-lmr-12">(1</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">5) = 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">7377946</span>.                           <span 
class="msam-10x-x-120">&#x2662;</span>
   </div>
<!--l. 341--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">7.1.6   </span> <a 
 id="x72-1200007.1.6"></a>Derivada via ajuste ou interpolação</h4>
<a 
 id="dx72-120001"></a>
<a 
 id="dx72-120002"></a>
<!--l. 343--><p class="noindent" >Dado os valores de uma função em pontos <span 
class="lmsy-10x-x-120">{</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><sub><span 
class="lmmi-8">i</span></sub><span 
class="lmmi-12">,y</span><sub><span 
class="lmmi-8">i</span></sub><span 
class="rm-lmr-12">)</span><span 
class="lmsy-10x-x-120">}</span><sub><span 
class="lmmi-8">i</span><span 
class="rm-lmr-8">=1</span></sub><sup><span 
class="lmmi-8">N</span></sup>, as derivadas <img 
src="main1923x.png" alt="(dy)
 dx"  class="left" align="middle"><sub><span 
class="lmmi-8">i</span></sub>
podem ser obtidas através da derivada de uma curva que melhor ajusta ou
interpola os pontos. Esse tipo de técnica é necessário quando os pontos são
muito espaçados entre si ou quando a função oscila muito. Por exemplo, dado
os pontos <span 
class="rm-lmr-12">(0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">1)</span>, <span 
class="rm-lmr-12">(1</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">2)</span>, <span 
class="rm-lmr-12">(2</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">5)</span>, <span 
class="rm-lmr-12">(3</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">9)</span>, a parábola que melhor ajusta os pontos
é
                                                                                <img 
src="main1925x.png" alt="PICT" >
<img 
src="main1930x.png" alt="PICT" >
                                                                                
   <center class="math-display" >
<img 
src="main1926x.png" alt="Q (x) = 0,95 + 0,45x +  0,75x2.  " class="math-display" ></center>
Usando esse ajuste para calcular as derivadas, temos:
   <center class="math-display" >
<img 
src="main1927x.png" alt="Q &#x2032;(x ) = 0,45 + 1,5x  " class="math-display" ></center> e
<div class="eqnarray">
   <center class="math-display" >
<img 
src="main1928x.png" alt="y&#x2032;(x ) &#x2248; Q&#x2032;(x ) = 0,45,         y&#x2032;(x  ) &#x2248; Q&#x2032;(x ) = 1,95,
 &#x2032;  1     &#x2032;  1                     &#x2032;2       &#x2032;2
y (x3) &#x2248; Q (x3) = 3,45     e     y (x4) &#x2248; Q (x4) = 4,95
" class="math-display" ></center>
</div>
<!--l. 356--><p class="indent" >   Agora olhe o gráfico da seguinte tabela de pontos.
   <center class="math-display" >
<img 
src="main1929x.png" alt="|---|------|
|-x-|--y---|
|   |      |
|-0-|-1,95-|
|   |      |
|-1-|-1,67-|
| 2 | 3,71 |
|---|------|
| 3 | 3,37 |
|---|------|
| 4 | 5,12 |
|---|------|
|-5-|-5,79-|
|   |      |
|-6-|-7,50-|
|   |      |
|-7-|-7,55-|
| 8 | 9,33 |
|---|------|
| 9 | 9,41 |
|---|------|
|10 |11,48 |
------------
" class="math-display" ></center>
<div class="center" 
>
<!--l. 386--><p class="noindent" >
<!--l. 387--><p class="noindent" ><img 
src="main1932x.png" alt="PIC" class="graphics" width="306.14374pt" height="230.86249pt" ><!--tex4ht:graphics  
name="main1932x.png" src="./cap_derint/pics/graf_der.eps"  
--></div>
<!--l. 390--><p class="indent" >   Observe que as derivadas calculadas por diferenças finitas oscilam entre um valor
                                                                                <img 
src="main1936x.png" alt="PICT" >
<img 
src="main1937x.png" alt="PICT" >
                                                                                
pequeno e um grande em cada intervalo e além disso, a fórmula progressiva
difere da regressiva significantemente. Por exemplo, por diferenças regressivas
<span 
class="lmmi-12">f</span><span 
class="lmsy-10x-x-120">&#x2032;</span><span 
class="rm-lmr-12">(7) </span><span 
class="lmsy-10x-x-120">&#x2248;</span><img 
src="main1933x.png" alt="(7,55-7,50)
----1----"  class="frac" align="middle"> <span 
class="rm-lmr-12">= 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">05 </span>e por diferenças progressivas <span 
class="lmmi-12">f</span><span 
class="lmsy-10x-x-120">&#x2032;</span><span 
class="rm-lmr-12">(7) </span><span 
class="lmsy-10x-x-120">&#x2248;</span><img 
src="main1934x.png" alt="(9,33-7,55)
----1----"  class="frac" align="middle"> <span 
class="rm-lmr-12">= 1</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">78</span>. A
melhor forma de calcular a derivada aqui é fazer um ajuste de curva. A reta que melhor
ajusta os dados da tabela é <span 
class="lmmi-12">y </span><span 
class="rm-lmr-12">= </span><span 
class="lmmi-12">f</span><span 
class="rm-lmr-12">(</span><span 
class="lmmi-12">x</span><span 
class="rm-lmr-12">) = 1</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">2522727 + 0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">9655455</span><span 
class="lmmi-12">x</span>. Usando esse ajuste,
temos <span 
class="lmmi-12">f</span><span 
class="lmsy-10x-x-120">&#x2032;</span><span 
class="rm-lmr-12">(7) </span><span 
class="lmsy-10x-x-120">&#x2248; </span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">9655455</span>.
                                                                                <img 
src="main1938x.png" alt="PICT" >
<img 
src="main1949x.png" alt="PICT" >
                                                                                
   <!--l. 392--><div class="crosslinks"><p class="noindent">[<a 
href="mainse47.html" >next</a>] [<a 
href="mainse33.html" >front</a>] [<a 
href="mainap1.html#mainse46.html" >up</a>] </p></div>
<!--l. 392--><p class="indent" >   <a 
 id="tailmainse33.html"></a>   
</body></html> 
