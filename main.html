<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Cálculo Numérico</title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<div id="header">
<h1 class="title">Cálculo Numérico<br /></h1>
</div>
<h1 id="organizadores" class="unnumbered">Organizadores</h1>
<ul>
<li><p>Dagoberto Adriano Rizzotto Justo - UFRGS</p></li>
<li><p>Esequia Sauter - UFRGS</p></li>
<li><p>Fabio Souto de Azevedo - UFRGS</p></li>
<li><p>Leonardo Fernandes Guidi - UFRGS</p></li>
<li><p>Matheus Correia dos Santos - UFRGS</p></li>
<li><p>Pedro Henrique de Almeida Konzen - UFRGS</p></li>
</ul>
<h1 id="licença" class="unnumbered">Licença</h1>
<p>Este trabalho está licenciado sob a Licença Creative Commons Atribuição-CompartilhaIgual 3.0 Não Adaptada. Para ver uma cópia desta licença, visite http://creativecommons.org/licenses/by-sa/3.0/ ou envie uma carta para Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.</p>
<h1 id="nota-dos-organizadores" class="unnumbered">Nota dos organizadores</h1>
<p>Este livro vem sendo construído de forma colaborativa desde 2011. Nosso intuito é melhorá-lo, expandi-lo e adaptá-lo às necessidades de um curso de cálculo numérico em nível de graduação.</p>
<p>Caso queira colaborar, tenha encontrado erros, tenha sugestões ou reclamações, entre em contato conosco pelo endereço de e-mail:</p>
<p><a href="livro_colaborativo@googlegroups.com" class="uri">livro_colaborativo@googlegroups.com</a></p>
<p>Alternativamente, abra um chamado no repositório GitHub do projeto:</p>
<p><a href="https://github.com/livroscolaborativos/CalculoNumerico" class="uri">https://github.com/livroscolaborativos/CalculoNumerico</a></p>
<h1 id="prefácio" class="unnumbered">Prefácio</h1>
<p>Este livro busca abordar os tópicos de um curso de introdução ao cálculo numérico moderno oferecido a estudantes de matemática, física, engenharias e outros. A ênfase é colocada na formulação de problemas, implementação em computador da resolução e interpretação de resultados. Pressupõe-se que o estudante domine conhecimentos e habilidades típicas desenvolvidas em cursos de graduação de cálculo, álgebra linear e equações diferenciais. Conhecimentos prévios em linguagem de computadores é fortemente recomendável, embora apenas técnicas elementares de programação sejam realmente necessárias.</p>
<p>Ao longo do livro, fazemos ênfase na utilização do <em>software</em> livre <code>Scilab</code> para a implementação dos métodos numéricos abordados. Recomendamos que o leitor tenha à sua disposição um computador com o <code>Scilab</code> instalado. Não é necessário estar familiarizado com a linguagem <code>Scilab</code>, mas recomendamos a leitura do Apêndice [cap:scilab], no qual apresentamos uma rápida introdução a este pacote computacional. Alternativamente, existem algumas soluções em nuvem que fornecem acesso ao Scilab via internet. Por exemplo, a plataforma virtual rollApp (<a href="https://www.rollapp.com/app/scilab" class="uri">https://www.rollapp.com/app/scilab</a>).</p>
<h1 id="introdução">Introdução</h1>
<p>Cálculo numérico é a disciplina que estuda as técnicas para a solução aproximada de problemas matemáticos. Estas técnicas são de natureza analítica e computacional. As principais preocupações normalmente envolvem exatidão e perfórmance.</p>
<p>Aliado ao aumento contínuo da capacidade de computação disponível, o desenvolvimento de métodos numéricos tornou a simulação computacional de modelos matemáticos uma prática usual nas mais diversas áreas científicas e tecnológicas. As então chamadas simulações numéricas são constituídas de um arranjo de vários esquemas numéricos dedicados a resolver problemas específicos como, por exemplo: resolver equações algébricas, resolver sistemas lineares, interpolar e ajustar pontos, calcular derivadas e integrais, resolver equações diferenciais ordinárias, etc.. Neste livro, abordamos o desenvolvimento, a implementação, utilização e aspectos teóricos de métodos numéricos para a resolução desses problemas.</p>
<p>Os problemas que discutiremos não formam apenas um conjunto de métodos fundamentais, mas são, também, problemas de interesse na engenharia e na matemática aplicada. A necessidade de aplicar aproximações numéricas decorre do fato de que esses problemas podem se mostrar intratáveis se dispomos apenas de meios puramente analíticos, como aqueles estudados nos cursos de cálculo e álgebra linear. Por exemplo, o teorema de Abel-Ruffini nos garante que não existe uma fórmula algébrica, isto é, envolvendo apenas operações aritméticas e radicais, para calcular as raízes de uma equação polinomial de qualquer grau, mas apenas casos particulares:</p>
<ul>
<li><p>Simplesmente isolar a incógnita para encontrar a raiz de uma equação do primeiro grau;</p></li>
<li><p>Fórmula de Bhaskara para encontrar raízes de uma equação do segundo grau;</p></li>
<li><p>Fórmula de Cardano para encontrar raízes de uma equação do terceiro grau;</p></li>
<li><p>Existe expressão para equações de quarto grau;</p></li>
<li><p>Casos simplificados de equações de grau maior que 4 onde alguns coeficientes são nulos também podem ser resolvidos.</p></li>
</ul>
<p>Equações não polinomiais podem ser ainda mais complicadas de resolver exatamente, por exemplo: <br /><span class="math">$$\cos(x)=x\qquad \hbox{e}\qquad xe^x= 10$$</span><br /></p>
<p>Para resolver o problema de valor inicial <br /><span class="math">$$\begin{array}{l}
y'+xy=x,\\
y(0)=2,
\end{array}$$</span><br /> podemos usar o método de fator integrante e obtemos <span class="math"><em>y</em> = 1 + <em>e</em><sup> − <em>x</em><sup>2</sup>/2</sup></span>. Já o cálculo da solução exata para o problema <br /><span class="math">$$\begin{array}{l}
y'+xy=e^{-y},\\
y(0)=2,
\end{array}$$</span><br /> não é possível.</p>
<p>Da mesma forma, resolvemos a integral <br /><span class="math">∫<sub>1</sub><sup>2</sup><em>x</em><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em></span><br /> pelo método da substituição e obtemos <span class="math">$\frac{1}{2}(e^{-1}-e^{-2})$</span>. Porém a integral <br /><span class="math">∫<sub>1</sub><sup>2</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em></span><br /> não pode ser resolvida analiticamente.</p>
<p>A maioria dos modelos de fenômenos reais chegam em problemas matemáticos onde a solução analítica é difícil (ou impossível) de ser encontrada, mesmo quando provamos que ela existe. Nesse curso propomos calcular aproximações numéricas para esses problemas, que apesar de, em geral, serem diferentes da solução exata, mostraremos que elas podem ser bem próximas.</p>
<p>Para entender a construção de aproximações é necessário estudar um pouco como funciona a aritmética de computador e erros de arredondamento. Como computadores, em geral, usam uma base binária para representar números, começaremos falando em mudança de base.</p>
<h1 id="aritmética-de-máquina">Aritmética de máquina</h1>
<h2 id="sistema-de-numeração-e-mudança-de-base">Sistema de numeração e mudança de base</h2>
<p>Usualmente, utilizamos o sistema de numeração decimal para representar números. Esse é um sistema de numeração posicional onde a posição do dígito indica a potência de <span class="math">10</span> que o dígito está representando.</p>
<p>O número <span class="math">293</span> é decomposto como <br /><span class="math">$$\begin{aligned}
    293&amp;=&amp;2\ \hbox{centenas}+9\ \hbox{dezenas}+3\ \hbox{unidades}\\
    &amp;=&amp;2\cdot 10^2+9\cdot 10^1+3\cdot 10^0.
  \end{aligned}$$</span><br /></p>
<p>O sistema de numeração posicional também pode ser usado com outras bases. Vejamos a seguinte definição.</p>
<p>[Sistema de numeração de base <span class="math"><em>b</em></span>][def:sistema<sub>d</sub>e<sub>n</sub>umeração] Dado um número natural <span class="math"><em>b</em> &gt; 1</span> e o conjunto de símbolos <span class="math">$\{\pmb{,}, \pmb{-},  \pmb{0}, \pmb{1}, \pmb{2},\dotsc, \pmb{b-1}\}$</span><a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>, a sequência de símbolos <br /><span class="math">(<em>d</em><sub><em>n</em></sub><em>d</em><sub><em>n</em> − 1</sub>⋯<em>d</em><sub>1</sub><em>d</em><sub>0</sub>, <em>d</em><sub> − 1</sub><em>d</em><sub> − 2</sub>⋯)<sub><em>b</em></sub></span><br /> representa o número positivo <br /><span class="math"><em>d</em><sub><em>n</em></sub> ⋅ <em>b</em><sup><em>n</em></sup> + <em>d</em><sub><em>n</em> − 1</sub> ⋅ <em>b</em><sup><em>n</em> − 1</sup> + ⋯ + <em>d</em><sub>0</sub> ⋅ <em>b</em><sup>0</sup> + <em>d</em><sub> − 1</sub> ⋅ <em>b</em><sup> − 1</sup> + <em>d</em><sub> − 2</sub> ⋅ <em>b</em><sup> − 2</sup> + ⋯</span><br /> Para representar números negativos usamos o símbolo <span class="math"> − </span> a esquerda do numeral.</p>
<p>[<span class="math"><em>b</em> ≥ 10</span>][obs:sistema<sub>d</sub>e<sub>n</sub>umeracao] Para sistemas de numeração com base <span class="math"><em>b</em> ≥ 10</span> é usual utilizar as seguintes notações:</p>
<ul>
<li><p>No sistema de numeração decimal (<span class="math"><em>b</em> = 10</span>), costumamos representar o número sem os parênteses e o subíndice, ou seja, <br /><span class="math"> ± <em>d</em><sub><em>n</em></sub><em>d</em><sub><em>n</em> − 1</sub>…<em>d</em><sub>1</sub><em>d</em><sub>0</sub>, <em>d</em><sub> − 1</sub><em>d</em><sub> − 2</sub>… :=  ± (<em>d</em><sub><em>n</em></sub><em>d</em><sub><em>n</em> − 1</sub>…<em>d</em><sub>1</sub><em>d</em><sub>0</sub>, <em>d</em><sub> − 1</sub><em>d</em><sub> − 2</sub>…)<sub>10</sub></span><br /></p></li>
<li><p>Se <span class="math"><em>b</em> &gt; 10</span>, usamos as letras <span class="math"><em>A</em>, <em>B</em>, <em>C</em>, ⋯</span> para completar os símbolos: <span class="math"><em>A</em> = 10</span>, <span class="math"><em>B</em> = 11</span>, <span class="math"><em>C</em> = 12</span>, <span class="math"><em>D</em> = 13</span>, <span class="math"><em>E</em> = 14</span>, <span class="math"><em>F</em> = 15</span>.</p></li>
</ul>
<p>[Sistema binário] O sistema de numeração em base dois é chamado de binário e os algarismos binários são conhecidos como <em>bits</em>, do inglês <em><strong><span>b</span>inary dig<strong><span>its</span></strong></strong></em>. Um <em>bit</em> pode assumir dois valores distintos: <span class="math">0</span> ou <span class="math">1</span>. Por exemplo: <br /><span class="math">$$\begin{aligned}
x &amp;=&amp; (1001,101)_{2} \\
  &amp;=&amp; 1\cdot 2^3 +0\cdot 2^2 +0\cdot 2^1 +1\cdot 2^0  +1\cdot 2^{-1} +0\cdot 2^{-2} +1\cdot 2^{-3} \\
  &amp;=&amp; 8+0+0+1+ 0,5+0+0,125 = 9,625\end{aligned}$$</span><br /> Ou seja, <span class="math">(1001, 101)<sub>2</sub></span> é igual a <span class="math">9, 625</span> no sistema decimal.</p>
<p>[Sistema quaternário] No sistema quaternário a base <span class="math"><em>b</em></span> é igual a <span class="math">4</span>. Por exemplo: <br /><span class="math">(301, 2)<sub>4</sub> = 3 ⋅ 4<sup>2</sup> + 0 ⋅ 4<sup>1</sup> + 1 ⋅ 4<sup>0</sup> + 2 ⋅ 4<sup> − 1</sup> = 49, 5</span><br /></p>
<p>[Sistema octal] No sistema octal a base é <span class="math"><em>b</em> = 8</span> e utilizamos os símbolos em <span class="math">{0, 1, 2, 3, 4, 5, 6, 7}</span>. Por exemplo: <br /><span class="math">$$\begin{aligned}
(1357,24)_{8}&amp;=&amp;1\cdot 8^3+3\cdot 8^2+5\cdot 8^1+7\cdot 8^{0}+2\cdot 8^{-1}+4\cdot 8^{-2}\\
             &amp;=&amp;512+192+40+7+0,25+0,0625=751,3125\end{aligned}$$</span><br /></p>
<p>[Sistema hexadecimal] O sistema de numeração cuja a base é <span class="math"><em>b</em> = 16</span> é chamado de sistema hexadecimal. O conjunto de símbolos necessários é <span class="math">$S=\{``,&quot;, -, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, A, B, C, D, E, F\}$</span>. Convertendo o número <span class="math">(<em>E</em>2<em>A</em><em>C</em>)<sub>16</sub></span> para a base <span class="math">10</span> temos <br /><span class="math">$$\begin{aligned}
  (E2AC)_{16} &amp;= 14\cdot 16^3+2\cdot 16^2+10\cdot 16^1+12\cdot 16^{0}\\
  &amp;=57344+512+160+12=58028\end{aligned}$$</span><br /></p>
<p>[Scilab] O <code>Scilab</code> oferece algumas funções para a conversão de números inteiros em dada base para a base decimal. Por exemplo, temos:</p>
<pre><code>--&gt;bin2dec(&#39;1001&#39;)
 ans  =
    9.  
--&gt;hex2dec(&#39;451&#39;)
 ans  =
    1105.  
--&gt;oct2dec(&#39;157&#39;)
 ans  =
    111.
--&gt;base2dec(&#39;BEBA&#39;,16)
 ans  =
    48826.  </code></pre>
<p>A partir da Definição [def:sistema<sub>d</sub>e<sub>n</sub>umeração] acabamos de mostrar vários exemplos de conversão de números de uma sistema de numeração de base <span class="math"><em>b</em></span> para o sistema decimal. Agora, vamos estudar como fazer o processo inverso. Isto é, dado um número decimal <span class="math">(<em>X</em>)<sub>10</sub></span> queremos escrevê-lo em uma outra base <span class="math"><em>b</em></span>, i.e., queremos obter a seguinte representação: <br /><span class="math">$$\begin{aligned}
  (X)_{10} &amp;= (d_nd_{n-1}\cdots d_0,d_{-1}\cdots)_{b} \\
  &amp;= d_n\cdot b^{n}+d_{n-1}\cdot b^{n-1}+\cdots + d_0\cdot b^0+d_{-1}\cdot b^{-1}+d_{-2}\cdot b^{-2}+\cdots        \end{aligned}$$</span><br /></p>
<p>Separando as partes inteira e fracionária de <span class="math"><em>X</em></span>, i.e. <span class="math"><em>X</em> = <em>X</em><sup><em>i</em></sup> + <em>X</em><sup><em>f</em></sup></span>, temos: <br /><span class="math">$$X^{\mbox{i}} = d_n\cdot b^{n}+ \cdots+d_{n-1}b^{n-1} \cdot  +d_1\cdot b^1 +d_0\cdot b^0 \qquad \hbox{e}\qquad X^{\mbox{f}}
= \frac{d_{-1}}{b^1} + \frac{d_{-2}}{b^{2}} + \cdots$$</span><br /> Nosso objetivo é determinar os algarismos <span class="math">{<em>d</em><sub><em>n</em></sub>, <em>d</em><sub><em>n</em> − 1</sub>, ...}</span>.</p>
<p>Primeiramente, vejamos como tratar a parte inteira <span class="math"><em>X</em><sup><em>i</em></sup></span>. Calculando sua divisão por <span class="math"><em>b</em></span>, temos: <br /><span class="math">$$\frac{X^{\mbox{i}}}{b}=   \frac{d_0}{b}+d_1+d_2 b^1\cdots+d_{n-1}\cdot b^{n-2} +d_n\cdot b^{n-1}.$$</span><br /> Observe que <span class="math"><em>d</em><sub>0</sub></span> é o resto da divisão de <span class="math"><em>X</em><sup><em>i</em></sup></span> por <span class="math"><em>b</em></span>, pois <span class="math"><em>d</em><sub>1</sub> + <em>d</em><sub>2</sub><em>b</em><sup>1</sup>⋯ + <em>d</em><sub><em>n</em> − 1</sub> ⋅ <em>b</em><sup><em>n</em> − 2</sup> + <em>d</em><sub><em>n</em></sub> ⋅ <em>b</em><sup><em>n</em> − 1</sup></span> é inteiro e <span class="math">$\frac{d_0}{b}$</span> é uma fração (lembramos que <span class="math"><em>d</em><sub>0</sub> &lt; <em>b</em></span>). Da mesma forma, o resto da divisão de <span class="math"><em>d</em><sub>1</sub> + <em>d</em><sub>2</sub><em>b</em><sup>1</sup>⋯ + <em>d</em><sub><em>n</em> − 1</sub> ⋅ <em>b</em><sup><em>n</em> − 2</sup> + <em>d</em><sub><em>n</em></sub> ⋅ <em>b</em><sup><em>n</em> − 1</sup></span> por <span class="math"><em>b</em></span> é <span class="math"><em>d</em><sub>1</sub></span>. Repetimos o processo até encontrar os símbolos <span class="math"><em>d</em><sub>0</sub>, <em>d</em><sub>1</sub>, <em>d</em><sub>2</sub>, …</span>.</p>
<p>[Conversão da parte inteira] Vamos escrever o número <span class="math">125</span> na base <span class="math">6</span>. Para tanto, fazemos sucessivas divisões por <span class="math">6</span> como segue: <br /><span class="math">$$\begin{aligned}
    125 &amp;= 20\cdot 6 + 5\quad(\mbox{$125$ dividido por $6$ é igual a $20$ e resta $5$})\\
    &amp;= (3\cdot 6 + 2)\cdot 6 + 5 = 3\cdot 6^2 + 2\cdot 6 + 5,
  \end{aligned}$$</span><br /> logo <span class="math">125 = (325)<sub>6</sub></span>.</p>
<p>Estes cálculos podem ser feitos no <code>Scilab</code> com o auxílio das funções <code>modulo</code> e <code>int</code>. A primeira calcula o resto da divisão entre dois números, enquanto que a segunda retorna a parte inteira de um número dado. No nosso exemplo, temos:</p>
<pre><code>--&gt;q = 125, d0 = modulo(q,6)
--&gt;q = int(q/6), d1 = modulo(q,6)
--&gt;q = int(q/6), d2 = modulo(q,6)</code></pre>
<p>Verifique!</p>
<p>[Scilab] O <code>Scilab</code> oferece algumas funções para a conversão de números inteiros em dada base para a base decimal. Assim, temos:</p>
<pre><code>--&gt;bin2dec(&#39;1001&#39;)
 ans  =
    9.  
--&gt;hex2dec(&#39;451&#39;)
 ans  =
    1105.  
--&gt;oct2dec(&#39;157&#39;)
 ans  =
    111.
--&gt;base2dec(&#39;BEBA&#39;,16)
 ans  =
    48826.  </code></pre>
<p>Vamos converter a parte fracionária de um número decimal em uma dada base <span class="math"><em>b</em></span>. Usando a notação <span class="math"><em>X</em> = <em>X</em><sup><em>i</em></sup> + <em>X</em><sup><em>f</em></sup></span> para as partes inteira e fracionária, respectivamente, temos: <br /><span class="math">$$bX^{\mbox{f}}=d_{-1}+\frac{d_{-2}}{b}+\frac{d_{-3}}{b^2}+\cdots$$</span><br /> Observe que a parte inteira desse produto é <span class="math"><em>d</em><sub> − 1</sub></span> e <span class="math">$\frac{d_{-2}}{b}+\frac{d_{-3}}{b^2}+\cdots$</span> é a parte fracionária. Quando multiplicamos <span class="math">$\frac{d_{-2}}{b}+\frac{d_{-3}}{b^2}+\cdots$</span> por <span class="math"><em>b</em></span> novamente, encontramos <span class="math"><em>d</em><sub> − 2</sub></span>. Repetimos o processo até encontrar todos os símbolos.</p>
<p>[Conversão da parte fracionária] Escrever o número <span class="math">$125,58\overline{3}$</span> na base <span class="math">6</span>. Do exemplo anterior temos que <span class="math">125 = (325)<sub>6</sub></span>. Assim, nos resta converter a parte fracionária. Para tanto, fazemos sucessivas multiplicações por <span class="math">6</span> como segue:] <br /><span class="math">$$\begin{aligned}
    0,58\overline{3} &amp;= 3,5\cdot 6^{-1}\quad(\mbox{$0,58\overline{3}$ multiplicado por $6$ é igual a $3,5$})\\
    &amp;= 3\cdot 6^{-1} + 0,5\cdot 6^{-1}\\
    &amp;= 3\cdot 6^{-1} + (3\cdot 6^{-1})\cdot 6^{-1}\\
    &amp;= 3\cdot 6^{-1} + 3\cdot 6^{-2},
  \end{aligned}$$</span><br /> logo <span class="math">$0,58\overline{3} = (0,33)_6$</span>. As contas feitas aqui, também podem ser feitas no <code>Scilab</code>. Você sabe como?</p>
<p>Uma maneira de converter um número dado numa base <span class="math"><em>b</em><sub>1</sub></span> para uma base <span class="math"><em>b</em><sub>2</sub></span> é fazer em duas partes: primeiro converter o número dado na base <span class="math"><em>b</em><sub>2</sub></span> para base decimal e depois converter para a base <span class="math"><em>b</em><sub>1</sub></span>.</p>
<h2 id="exercícios" class="unnumbered">Exercícios</h2>
<p>Converta para base decimal cada um dos seguintes números:</p>
<p><span>4</span></p>
<ul>
<li><p><span class="math">(100)<sub>2</sub></span></p></li>
<li><p><span class="math">(100)<sub>3</sub></span></p></li>
<li><p><span class="math">(100)<sub><em>b</em></sub></span></p></li>
<li><p><span class="math">(12)<sub>5</sub></span></p></li>
<li><p><span class="math">(<em>A</em><em>A</em>)<sub>16</sub></span></p></li>
<li><p><span class="math">(7, 1)<sub>8</sub></span></p></li>
<li><p><span class="math">(3, 12)<sub>5</sub></span></p></li>
</ul>
<p>a) <span class="math">4</span>; b) <span class="math">9</span>; c) <span class="math"><em>b</em><sup>2</sup></span>; d) <span class="math">7</span>; e) <span class="math">170</span>; f) <span class="math">7, 125</span>; g) <span class="math">3, 28</span></p>
<p>Escreva os números abaixo na base decimal.</p>
<ul>
<li><p><span class="math">(25, 13)<sub>8</sub></span></p></li>
<li><p><span class="math">(101, 1)<sub>2</sub></span></p></li>
<li><p><span class="math">(12<em>F</em>, 4)<sub>16</sub></span></p></li>
<li><p><span class="math">(11, 2)<sub>3</sub></span></p></li>
</ul>
<p>Escreva cada número decimal na base <span class="math"><em>b</em></span>.</p>
<ul>
<li><p><span class="math">$7,\overline{6}$</span> na base <span class="math"><em>b</em> = 5</span></p></li>
<li><p><span class="math">$29,1\overline{6}$</span> na base <span class="math"><em>b</em> = 6</span></p></li>
</ul>
<p>Escreva cada número dado para a base <span class="math"><em>b</em></span>.</p>
<ul>
<li><p><span class="math">(45, 1)<sub>8</sub></span> para a base <span class="math"><em>b</em> = 2</span></p></li>
<li><p><span class="math">(21, 2)<sub>8</sub></span> para a base <span class="math"><em>b</em> = 16</span></p></li>
<li><p><span class="math">(1001, 101)<sub>2</sub></span> para a base <span class="math"><em>b</em> = 8</span></p></li>
<li><p><span class="math">(1001, 101)<sub>2</sub></span> para a base <span class="math"><em>b</em> = 16</span></p></li>
</ul>
<p>Escreva o número <span class="math"><em>x</em> = 5, 5</span> em base binária.</p>
<p><span class="math">(101, 1)<sub>2</sub></span></p>
<p>Escreva o número <span class="math"><em>x</em> = 17, 109375</span> em base hexadecimal (16).</p>
<p><span class="math">(11, 1<em>C</em>)<sub>16</sub></span></p>
<p>Quantos algarismos são necessários para representar o número <span class="math">937163832173947</span> em base binária? E em base 7? Dica: Qual é o menor e o maior inteiro que pode ser escrito em dada base com <span class="math"><em>N</em></span> algarismos?</p>
<p><span class="math">50</span>; <span class="math">18</span></p>
<p>Escreva <span class="math"><em>x</em> = (12.4)<sub>8</sub></span> em base decimal e binária.</p>
<p><span class="math">10, 5</span>; <span class="math">(1010, 1)<sub>2</sub></span></p>
<h2 id="representação-de-números">Representação de números</h2>
<p>Os computadores, em geral, usam a base binária para representar os números, onde as posições, chamadas de bits, assume as condições “verdadeiro” ou “falso”, ou seja, <span class="math">0</span> ou <span class="math">1</span>. Cada computador tem um número de bits fixo e, portanto, representa uma quantidade finita de números. Os demais números são tomados por proximidade àqueles conhecidos, gerando erros de arredondamento. Por exemplo, em aritmética de computador, o número <span class="math">2</span> tem representação exata, logo <span class="math">2<sup>2</sup> = 4</span>, mas <span class="math">$\sqrt{3}$</span> não tem representação finita, logo <span class="math">$(\sqrt{3})^2\neq 3$</span>.</p>
<p>Veja isso no <code>Scilab</code>:</p>
<pre><code>--&gt;2^2 == 4
 ans  =
  T  
--&gt;sqrt(3)^2 == 3
 ans  =
  F  </code></pre>
<h3 id="números-inteiros">Números inteiros</h3>
<p>Tipicamente um número inteiro é armazenado num computador como uma sequência de dígitos binários de comprimento fixo denominado <em>registro</em>.</p>
<h4 id="representação-sem-sinal">Representação sem sinal</h4>
<p>Um registro com <span class="math"><em>n</em></span> bits da forma <br /><span class="math">$$\begin{array}{|c|c|c|c|c|} \hline
d_{n-1}&amp;d_{n-2}&amp;\cdots&amp;d_1&amp;d_0\\\hline
\end{array}$$</span><br /> representa o número <span class="math">(<em>d</em><sub><em>n</em> − 1</sub><em>d</em><sub><em>n</em> − 2</sub>...<em>d</em><sub>1</sub><em>d</em><sub>0</sub>)<sub>2</sub></span>.</p>
<p>Assim é possível representar números inteiros entre <br /><span class="math">$$\begin{array}{cl}
  (111...111)_2 &amp; = 2^{n-1}+2^{n-2}+\cdots+2^1+2^0=2^n-1.\\
    \vdots      &amp; = \\
  (000...011)_2 &amp;= (3)_{10} \\
  (000...010)_2 &amp;= (2)_{10} \\
  (000...001)_2 &amp;= (1)_{10} \\
  (000...000)_2 &amp; =(0)_{10} \\
\end{array}$$</span><br /></p>
<p>No <code>Scilab</code>,</p>
<pre><code>--&gt;uint8( bin2dec(&#39;00000011&#39;) )
   ans = 3
--&gt;uint8( bin2dec(&#39;11111110&#39;) )
   ans = 254</code></pre>
<h4 id="representação-com-bit-de-sinal">Representação com bit de sinal</h4>
<p>O bit mais significativo (o primeiro à esquerda) representa o sinal: por convenção, <span class="math">0</span> significa positivo e <span class="math">1</span> significa negativo. Um registro com <span class="math"><em>n</em></span> bits da forma <br /><span class="math">$$\begin{array}{|c|c|c|c|c|} \hline
    s &amp; d_{n-2} &amp; \cdots &amp; d_1 &amp; d_0 \\\hline
  \end{array}$$</span><br /> representa o número <span class="math">( − 1)<sup><em>s</em></sup>(<em>d</em><sub><em>n</em> − 2</sub>...<em>d</em><sub>1</sub><em>d</em><sub>0</sub>)<sub>2</sub></span>. Assim é possível representar números inteiros entre <span class="math"> − 2<sup><em>n</em> − 1</sup></span> e <span class="math">2<sup><em>n</em> − 1</sup></span>, com duas representações para o zero: <span class="math">(1000...000)<sub>2</sub></span> e <span class="math">(00000...000)<sub>2</sub></span>.</p>
<p>Em um registro com <span class="math">8</span> bits, teremos os números <br /><span class="math">$$\begin{array}{cl}
 (11111111)_2 &amp;= -(2^{6}+\cdots+2+1)=-127\\
     &amp;\vdots    \\
 (10000001)_2 &amp;= -1 \\
 (10000000)_2 &amp;= -0 \\
 (01111111)_2 &amp;= 2^6+\cdots+2+1=127 \\
     &amp;\vdots    \\
 (00000010)_2 &amp;= 2 \\
 (00000001)_2 &amp;= 1 \\
 (00000000)_2 &amp;= 0 \\
\end{array}$$</span><br /></p>
<h4 id="representação-complemento-de-dois">Representação complemento de dois</h4>
<p>O bit mais significativo (o primeiro à esquerda) representa o coeficiente de <span class="math"> − 2<sup><em>n</em> − 1</sup></span>. Um registro com <span class="math"><em>n</em></span> bits da forma <br /><span class="math">$$\begin{array}{|c|c|c|c|c|} \hline
    d_{n-1}&amp;d_{n-2}&amp;\cdots&amp;d_1&amp;d_0\\\hline
  \end{array}$$</span><br /> representa o número <span class="math"> − <em>d</em><sub><em>n</em> − 1</sub>2<sup><em>n</em> − 1</sup> + (<em>d</em><sub><em>n</em> − 2</sub>...<em>d</em><sub>1</sub><em>d</em><sub>0</sub>)<sub>2</sub></span>.</p>
<p>Note que todo registro começando com <span class="math">1</span> será um número negativo.</p>
<p>O registro com <span class="math">8</span> bits <span class="math">[01000011]</span> representa o número <br /><span class="math"> − 0(2<sup>7</sup>) + (1000011)<sub>2</sub> = 64 + 2 + 1 = 67.</span><br /></p>
<p>O registro com <span class="math">8</span> bits <span class="math">[10111101]</span> representa o número <br /><span class="math"> − 1(2<sup>7</sup>) + (0111101)<sub>2</sub> =  − 128 + 32 + 16 + 8 + 4 + 1 =  − 67.</span><br /></p>
<p>Note que podemos obter a representação de <span class="math"> − 67</span> invertendo os dígitos de <span class="math">67</span> em binário e somando 1.</p>
<p>Em um registro com <span class="math">8</span> bits, teremos os números <br /><span class="math">$$\begin{aligned}
 (11111111)_2 &amp;= -2^7+2^{6}+\cdots+2+1=-1\\
     &amp;\vdots   \\
 (10000001)_2 &amp;= -2^7+1 = -127 \\
 (10000000)_2 &amp;= -2^7   = -128 \\
 (01111111)_2 &amp;= 2^6+\cdots+2+1=127 \\
     &amp;\vdots   \\
 (00000010)_2 &amp;= 2 \\
 (00000001)_2 &amp;= 1 \\
 (00000000)_2 &amp;= 0 \\\end{aligned}$$</span><br /></p>
<p>No <code>Scilab</code>,</p>
<pre><code>--&gt;int8( bin2dec(&#39;00000011&#39;) )
   ans = 3
--&gt;int8( bin2dec(&#39;11111110&#39;) )
   ans = -2</code></pre>
<h3 id="sistema-de-ponto-fixo">Sistema de ponto fixo</h3>
<p>O sistema de ponto fixo representa as partes inteira e fracionária do número com uma quantidade fixas de dígitos.</p>
<p>Em um computador de 32 bits que usa o sistema de ponto fixo, o registro <br /><span class="math">$$\begin{array}{|c|c|c|c|c|c|} \hline
d_{31}&amp;d_{30}&amp;d_{29}&amp;\cdots&amp;d_1&amp;d_0\\\hline
\end{array}$$</span><br /> pode representar o número</p>
<ul>
<li><p><span class="math">( − 1)<sup><em>d</em><sub>31</sub></sup>(<em>d</em><sub>30</sub><em>d</em><sub>29</sub>⋯<em>d</em><sub>17</sub><em>d</em><sub>16</sub>, <em>d</em><sub>15</sub><em>d</em><sub>14</sub>⋯<em>d</em><sub>1</sub><em>d</em><sub>0</sub>)<sub>2</sub></span> se o sinal for representado por um dígito. Observe que nesse caso o zero possui duas representações possíveis: <br /><span class="math">10000000000000000000000000000000</span><br /> e <br /><span class="math">00000000000000000000000000000000</span><br /></p></li>
<li><p><span class="math">(<em>d</em><sub>30</sub><em>d</em><sub>29</sub>⋯<em>d</em><sub>17</sub><em>d</em><sub>16</sub>)<sub>2</sub> − <em>d</em><sub>31</sub>(2<sup>15</sup> − 2<sup> − 16</sup>) + (0, <em>d</em><sub>15</sub><em>d</em><sub>14</sub>⋯<em>d</em><sub>1</sub><em>d</em><sub>0</sub>)<sub>2</sub></span> se o sinal do número estiver representado por uma implementação em complemento de um. Observe que o zero também possui duas representações possíveis: <br /><span class="math">11111111111111111111111111111111</span><br /> e <br /><span class="math">00000000000000000000000000000000</span><br /></p></li>
<li><p><span class="math">(<em>d</em><sub>30</sub><em>d</em><sub>29</sub>⋯<em>d</em><sub>17</sub><em>d</em><sub>16</sub>)<sub>2</sub> − <em>d</em><sub>31</sub>2<sup>15</sup> + (0, <em>d</em><sub>15</sub><em>d</em><sub>14</sub>⋯<em>d</em><sub>1</sub><em>d</em><sub>0</sub>)<sub>2</sub></span> se o sinal do número estiver representado por uma implementação em complemento de dois. Nesse caso o zero é unicamente representado por <br /><span class="math">00000000000000000000000000000000</span><br /></p></li>
</ul>
<p>Observe que <span class="math">16</span> dígitos são usados para representar a parte fracionária, <span class="math">15</span> são para representar a parte inteira e um dígito, o <span class="math"><em>d</em><sub>31</sub></span>, está relacionado ao sinal do número.</p>
<h3 id="normalização">Normalização</h3>
<p>Os números <span class="math"><em>h</em> = 6.626 × 10<sup> − 34</sup></span> e <span class="math"><em>N</em><sub><em>A</em></sub> = 6.0221 × 10<sup>23</sup></span> não podem ser armazenados na máquina em ponto fixo do exemplo anterior.</p>
<p>Entretanto, a constante <br /><span class="math">$$\begin{aligned}
   h &amp;=6626  \times 10^{-37} \\
   h &amp;=6.626  \times 10^{-34} \\
   h &amp;=0.6626 \times 10^{-33} \\
   h &amp;=0.006626\times 10^{-31}\end{aligned}$$</span><br /> pode ser escrita de várias formas diferentes. Para termos uma <em>representação única</em> definimos como notação normalizada a segunda opção (<span class="math">1 ≤ <em>m</em> &lt; 10</span>) que apresenta apenas um dígito diferente de zero a esquerda do ponto decimal (<span class="math"><em>m</em> = 6.626</span>).</p>
<p>Definimos que <br /><span class="math"><em>x</em> = ( − 1)<sup><em>s</em></sup>(<em>M</em>)<sub><em>b</em></sub> × <em>b</em><sup><em>E</em></sup>, </span><br /> está na <em>notação normalizada</em><a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> quando <span class="math">1 ≤ (<em>M</em>)<sub><em>b</em></sub> &lt; <em>b</em></span>, onde</p>
<ul>
<li><p><span class="math"><em>s</em></span> é o <em>sinal</em> (<span class="math">0</span> para positivo e <span class="math">1</span> para negativo),</p></li>
<li><p><span class="math"><em>E</em></span> é o <em>expoente</em>,</p></li>
<li><p><span class="math"><em>b</em></span> é a base (por ex. <span class="math">2</span>, <span class="math">8</span>, <span class="math">10</span> ou <span class="math">16</span>),</p></li>
<li><p><span class="math">(<em>M</em>)<sub><em>b</em></sub></span> é o significando. O <em>significando</em> (também chamado de mantissa ou coeficiente) contém os dígitos significativos do número.</p></li>
</ul>
<p>Os números abaixo estão em notação normalizada: <br /><span class="math"><em>x</em><sub>1</sub> = ( − 1.011101)<sub>2</sub> × 2<sup>(100)<sub>2</sub></sup></span><br /> <br /><span class="math"><em>x</em><sub>2</sub> = ( − 2.325)<sub>10</sub> × 10<sup>1</sup></span><br /></p>
<p>Represente os números <span class="math">$0,00\overline{51}$</span> e <span class="math">$1205,41\overline{54}$</span> em um sistema de ponto fixo de 4 dígitos para a parte inteira e 4 dígitos para a parte fracionária. Depois represente os mesmos números utilizando notação normalizada com 7 dígitos significativos.</p>
<p>As representações dos números <span class="math">$0,00\overline{51}$</span> e <span class="math">$1205,41\overline{54}$</span> no sistema de ponto fixo são <span class="math">0, 0051</span> e <span class="math">1205, 4154</span>, respectivamente. Em notação normalizada, as representações são <span class="math">5, 151515 ⋅ 10<sup> − 3</sup></span> e <span class="math">1, 205415 ⋅ 10<sup>3</sup></span>, respectivamente.</p>
<p>No <code>Scilab</code>, a representação em ponto flutuante com <span class="math"><em>n</em></span> dígitos é dada na forma <span class="math"> ± <em>d</em><sub>1</sub>, <em>d</em><sub>2</sub><em>d</em><sub>3</sub>…<em>d</em><sub><em>n</em></sub> × 10<sup><em>E</em></sup></span>. Consulte sobre o comando <code>format</code>!</p>
<h3 id="sistema-de-ponto-flutuante">Sistema de ponto flutuante</h3>
<p>O sistema de ponto flutuante não possui quantidade fixa de dígitos para as partes inteira e fracionária do número.</p>
<p>Podemos definir uma máquina <span class="math"><em>F</em></span> em ponto flutuante de dois modos: <br /><span class="math"><em>F</em>(<em>β</em>, |<em>M</em>|, |<em>E</em>|, <em>B</em><em>I</em><em>A</em><em>S</em>) ou <em>F</em>(<em>β</em>, |<em>M</em>|, <em>E</em><sub><em>M</em><em>I</em><em>N</em></sub>, <em>E</em><sub><em>M</em><em>A</em><em>X</em></sub>)</span><br /> onde</p>
<ul>
<li><p><span class="math"><em>β</em></span> é a base (em geral <span class="math">2</span> ou <span class="math">10</span>),</p></li>
<li><p><span class="math">|<em>M</em>|</span> é o número de dígitos da mantissa,</p></li>
<li><p><span class="math">|<em>E</em>|</span> é o número de dígitos do expoente,</p></li>
<li><p><span class="math"><em>B</em><em>I</em><em>A</em><em>S</em></span> é um valor de deslocamento do expoente (veja a seguir),</p></li>
<li><p><span class="math"><em>E</em><sub><em>M</em><em>I</em><em>N</em></sub></span> é o menor expoente,</p></li>
<li><p><span class="math"><em>E</em><sub><em>M</em><em>A</em><em>X</em></sub></span> é o maior expoente.</p></li>
</ul>
<p>Considere uma máquina com um registro de <span class="math">64</span> bits e base <span class="math"><em>β</em> = 2</span>. Pelo padrão IEEE754, <span class="math">1</span> bit é usado para o sinal, <span class="math">11</span> bits para o expoente e <span class="math">52</span> bits são usados para o significando tal que</p>
<p><br /><span class="math">$$\begin{array}{|c|c|c|c|c|c|c|c|c|c|}
\hline
s&amp;c_{10}&amp;c_{9}&amp;\cdots&amp;c_{0}&amp;m_1&amp;m_2&amp;\cdots &amp;m_{51}&amp;m_{52}\\
\hline
\end{array}$$</span><br /> represente o número (o <span class="math"><em>B</em><em>I</em><em>A</em><em>S</em> = 1023</span> por definição) <br /><span class="math"><em>x</em> = ( − 1)<sup><em>s</em></sup><em>M</em> × 2<sup><em>c</em> − <em>B</em><em>I</em><em>A</em><em>S</em></sup>, </span><br /> onde a <em>característica</em> é representada por <br /><span class="math"><em>c</em> = (<em>c</em><sub>10</sub><em>c</em><sub>9</sub>⋯<em>c</em><sub>1</sub><em>c</em><sub>0</sub>)<sub>2</sub> = <em>c</em><sub>10</sub>2<sup>10</sup> + ⋯ + <em>c</em><sub>12</sub><sup>1</sup> + <em>c</em><sub>02</sub><sup>0</sup></span><br /> e o significando por <br /><span class="math"><em>M</em> = (1.<em>m</em><sub>1</sub><em>m</em><sub>2</sub>⋯<em>m</em><sub>51</sub><em>m</em><sub>52</sub>)<sub>2</sub>.</span><br /></p>
<p>Em base <span class="math">2</span> não é necessário armazenar o primeiro dígito (por quê?).</p>
<p>Por exemplo, o registro <br /><span class="math">$$[0|\RED{100~0000~0000} |\BLU{101}0~0000~0000...0000~0000]$$</span><br /> representa o número <br /><span class="math">$$(-1)^0(1+\BLU{2^{-1}+2^{-3}})\times  2^{\RED{1024}-1023}=(1+0.5+0.125)2=3.25.$$</span><br /></p>
<h4 id="o-expoente-deslocado">O expoente deslocado</h4>
<p>Uma maneira de representar os expoentes inteiros é deslocar todos eles uma mesma quantidade. Desta forma permitimos a representação de números negativos e a ordem deles continua crescente. O expoente é representado por um inteiro sem sinal do qual é deslocado o <em>BIAS</em>.</p>
<p>Tendo <span class="math">|<em>E</em>|</span> dígitos para representar o expoente, geralmente o <span class="math"><em>B</em><em>I</em><em>A</em><em>S</em></span> é predefinido de tal forma a dividir a tabela ao meio de tal forma que o expoente <em>um</em> seja representado pelo sequência <span class="math">[100...000]</span>.</p>
<p>Com <span class="math">64</span> bits, pelo padrão <span class="math"><em>I</em><em>E</em><em>E</em><em>E</em>754</span>, temos que <span class="math">|<em>E</em>| := 11</span>. Assim <span class="math">(100 0000 0000)<sub>2</sub> = 2<sup>10</sup> = 1024</span>. Como queremos que esta sequência represente o <span class="math">1</span>, definimos <span class="math"><em>B</em><em>I</em><em>A</em><em>S</em> := 1023</span>, pois <br /><span class="math">1024 − <em>B</em><em>I</em><em>A</em><em>S</em> = 1.</span><br /></p>
<p>Com <span class="math">32</span> bits, temos <span class="math">|<em>E</em>| := 8</span> e <span class="math"><em>B</em><em>I</em><em>A</em><em>S</em> := 127</span>. E com <span class="math">128</span> bits, temos <span class="math">|<em>E</em>| := 15</span> e <span class="math"><em>B</em><em>I</em><em>A</em><em>S</em> := 16383</span>.</p>
<p>Com <span class="math">11</span> bits temos <br /><span class="math">$$\begin{aligned}
 [111~1111~1111] &amp;= reservado\\
 [111~1111~1110] &amp;= 2046-BIAS      = 1023_{10}= E_{MAX}\\
     \vdots      &amp;=  \\
 [100~0000~0001] &amp;= 2^{10}+1  -BIAS =  2_{10} \\
 [100~0000~0000] &amp;= 2^{10}~~~~-BIAS =  1_{10} \\
 [011~1111~1111] &amp;= 1023   ~~ -BIAS =  0_{10} \\
 [011~1111~1110] &amp;= 1022   ~~ -BIAS = -1_{10} \\
     \vdots      &amp;=  \\
% [000~0000~0010] &amp;= 2-BIAS = -1021 \\
 [000~0000~0001] &amp;= 1-BIAS = -1022 = E_{MIN}\\
 [000~0000~0000] &amp;= reservado\end{aligned}$$</span><br /></p>
<p>O maior expoente é dado por <span class="math"><em>E</em><sub><em>M</em><em>A</em><em>X</em></sub> = 1023</span> e o menor expoente é dado por <span class="math"><em>E</em><sub><em>M</em><em>I</em><em>N</em></sub> =  − 1022</span>.</p>
<p>O menor número representável positivo é dado pelo registro <br /><span class="math">$$[0|000~0000~000\RED{1} |\BLU{0000~0000~0000...0000~0000}]$$</span><br /> quando <span class="math"><em>s</em> = 0</span>, <span class="math">$c=\RED{1}$</span> e <span class="math">$M=(1.\BLU{000...000})_2$</span>, ou seja, <br /><span class="math">$$MINR=(1+\BLU{0})_2\times 2^{\RED{1}-1023} \approx 0.2225\times 10^{-307}.$$</span><br /></p>
<p>O maior número representável é dado por <br /><span class="math">$$[0|\RED{111~1111~1110} |\BLU{1111~1111~...1111~1111}]$$</span><br /> quando <span class="math"><em>s</em> = 0</span>, <span class="math"><em>c</em> = 2046</span> e <span class="math"><em>M</em> = (1.1111 1111....1111)<sub>2</sub> = 2 − 2<sup> − 52</sup></span>, ou seja, <br /><span class="math"><em>M</em><em>A</em><em>X</em><em>R</em> = (2 − 2<sup> − 52</sup>) × 2<sup>2046 − 1023</sup> ≈ 2<sup>1024</sup> ≈ 0.17977 × 10<sup>309</sup>.</span><br /></p>
<h4 id="casos-especiais">Casos especiais</h4>
<p>O <em>zero</em> é um caso especial representado pelo registro <br /><span class="math">$$[0|\RED{000~0000~0000} |0000~0000~0000...0000~0000]$$</span><br /></p>
<p>Os expoentes <em>reservados</em> são usados para casos especiais:</p>
<ul>
<li><p><span class="math"><em>c</em> = [0000...0000]</span> é usado para representar o zero (se <span class="math"><em>m</em> = 0</span>) e os números subnormais (se <span class="math"><em>m</em> ≠ 0</span>).</p></li>
<li><p><span class="math"><em>c</em> = [1111...1111]</span> é usado para representar o infinito (se <span class="math"><em>m</em> = 0</span>) e NaN (se <span class="math"><em>m</em> ≠ 0</span>).</p></li>
</ul>
<p>Os números subnormais<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a> tem a forma <br /><span class="math">$$x=(-1)^{s}(\RED{0}.m_{1}m_{2}\cdots m_{51}m_{52})_2 \times 2^{1-BIAS}.$$</span><br /></p>
<p>O menor número positivo, o maior número e o menor número subnormal representáveis no <code>Scilab</code> são:</p>
<pre><code>--&gt;MINR=number_properties(&#39;tiny&#39;)
--&gt;MAXR=number_properties(&#39;huge&#39;)
--&gt;number_properties(&#39;tiniest&#39;)</code></pre>
<p>Outras informações sobre a representação em ponto flutuante podem ser obtidas com <code>help number_properties</code>.</p>
<h3 id="a-precisão-e-o-epsilon-de-máquina">A precisão e o epsilon de máquina</h3>
<p>A <em>precisão</em> <span class="math"><em>p</em></span> de uma máquina é o número de dígitos significativos usado para representar um número. Note que <span class="math"><em>p</em> = |<em>M</em>| + 1</span> em binário e <span class="math"><em>p</em> = |<em>M</em>|</span> para outras bases.</p>
<p>O <em>epsilon de máquina</em>, <span class="math"><em>ϵ</em><sub><em>m</em><em>a</em><em>c</em><em>h</em></sub> = <em>ϵ</em></span>, é definido de forma que <span class="math">1 + <em>ϵ</em></span> seja o menor número representável maior que <span class="math">1</span>, isto é, <span class="math">1 + <em>ϵ</em></span> é representável, mas não existem números representáveis em <span class="math">(1, 1 + <em>ϵ</em>)</span>.</p>
<p>Com <span class="math">64</span> bits, temos que o epsilon será dado por <br /><span class="math">$$\begin{aligned}
  1      &amp;\rightarrow ~~(1.0000~0000....0000)_2\times 2^{0} \\
\epsilon &amp;\rightarrow  +(0.0000~0000....0001)_2\times 2^{0}  = 2^{-52} \\ \hline
         &amp;      ~~~~~~~ (1.0000~0000....0001)_2\times 2^{0} \neq 1\end{aligned}$$</span><br /> Assim <span class="math"><em>ϵ</em> = 2<sup> − 52</sup></span>.</p>
<h3 id="a-distribuição-dos-números">A distribuição dos números</h3>
<p>Utilizando uma máquina em ponto flutuante temos um número finito de números que podemos representar.</p>
<p>Um número muito pequeno geralmente é aproximado por zero (underflow) e um número muito grande (overflow) geralmente faz o cálculo parar. Além disso, os números não estão uniformemente espaçados no eixo real. Números pequenos estão bem próximos enquanto que números com expoentes grandes estão bem distantes.</p>
<p>Se tentarmos armazenar um número que não é representável, devemos utilizar o número mais próximo, gerando os erros de arredondamento.</p>
<p>Por simplicidade, a partir daqui nós adotaremos <span class="math"><em>b</em> = 10</span>.</p>
<p>O chamado modo de exceção de ponto flutuante é controlado pela função <code>ieee</code>. O padrão do <code>Scilab</code> é <code>ieee(0)</code>. Estude os seguintes resultados das seguintes operações usando os diferentes modos de exceção:</p>
<pre><code>--&gt;2*number_properties(&#39;huge&#39;), 1/2^999, 1/0, 1/-0</code></pre>
<h2 id="exercícios-1" class="unnumbered">Exercícios</h2>
<p>Explique a diferença entre o sistema de ponto fixo e ponto flutuante.</p>
<p>Considere a seguinte rotina escrita para ser usada no Scilab:</p>
<pre><code>     x=1
     while x+1&gt;x
         x=x+1
     end
 </code></pre>
<p>Explique se esta rotina finaliza em tempo finito, em caso afirmativo calcule a ordem de grandeza do tempo de execução supondo que cada passo do laço demore <span class="math">10<sup> − 7</sup><em>s</em></span>. Justifique sua reposta.</p>
<h2 id="tipos-de-erros">Tipos de Erros</h2>
<p>Em geral, os números não são representados de forma exata nos computadores. Isto nos leva ao chamado erro de arredondamento. Quando resolvemos problemas com técnicas numéricas estamos sujeitos a este e outros tipos de erros. Nesta seção, veremos quais são estes erros e como controlá-los, quando possível.</p>
<p>Quando fazemos aproximações numéricas, os erros são gerados de várias formas, sendo as principais delas as seguintes:</p>
<ol>
<li><p><em>Incerteza dos dados</em>: equipamentos de medição possuem precisão finita, acarretando erros nas medidas físicas.</p></li>
<li><p><em>Erros de Arredondamento</em>: são aqueles relacionados com as limitações que existem na forma representar números de máquina.</p></li>
<li><p><em>Erros de Truncamento</em>: surgem quando aproximamos um procedimento formado por uma sequência infinita de passos através de um procedimento finito. Por exemplo, a definição de integral é dada por uma soma infinita e a aproximamos por um soma finita. O erro de truncamento deve ser analisado para cada método empregado.</p></li>
</ol>
<p>Uma questão fundamental é a quantificação dos erros que estamos sujeitos ao computar a solução de um dado problema. Para tanto, precisamos definir medidas de erros (ou de exatidão). As medidas de erro mais utilizadas são o <em>erro absoluto</em> e o <em>erro relativo</em>.</p>
<p>[Erro absoluto e relativo] Seja <span class="math"><em>x</em></span> um número real e <span class="math">$\overline{x}$</span> sua aproximação. O <em>erro absoluto</em> da aproximação <span class="math">$\overline{x}$</span> é definido como <br /><span class="math">$$|x-\overline{x}|.$$</span><br /> O <em>erro relativo</em> da aproximação <span class="math">$\overline{x}$</span> é definido como <br /><span class="math">$$\frac{|x-\overline{x}|}{|x|},\quad x\neq 0.$$</span><br /></p>
<p>Observe que o erro relativo é adimensional e, muitas vezes, é dado em porcentagem. Mais precisamente, o erro relativo em porcentagem da aproximação <span class="math">$\overline{x}$</span> é dado por <br /><span class="math">$$\frac{|x-\bar{x}|}{|x|}\times 100 \%.$$</span><br /></p>
<p>Sejam <span class="math"><em>x</em> = 123456, 789</span> e sua aproximação <span class="math">$\bar{x}=123000$</span>. O erro absoluto é <br /><span class="math">$$|x-\bar{x}|=|123456,789-123000|=456,789$$</span><br /> e o erro relativo é <br /><span class="math">$$\frac{|x-\bar{x}|}{|x|}=\frac{456,789}{123456,789}\approx 0,00369999 \text{ ou }0,36\%$$</span><br /></p>
<p>Sejam <span class="math"><em>y</em> = 1, 23456789</span> e <span class="math">$\bar{y}=1,13$</span>. O erro absoluto é <br /><span class="math">$$|y-\bar{y}|=|1,23456789-1,13|=0,10456789$$</span><br /> que parece pequeno se compararmos com o exemplo anterior. Entretanto o erro relativo é <br /><span class="math">$$\frac{|y-\bar{y}|}{|y|}=\frac{0,10456789}{1,23456789}\approx 0,08469999 \text{ ou }8,4\%$$</span><br /> Note que o erro relativo leva em consideração a escala do problema.</p>
<p>Observe os erros absolutos e relativos em cada caso <br /><span class="math">$$\begin{array}{|c|c|c|c|} \hline
 x &amp; \bar{x} &amp;\hbox{erro absoluto}&amp;\hbox{erro relativo}\\
\hline
0,\overline{3}\cdot 10^{-2} &amp; 0,3\cdot 10^{-2}&amp;0,\overline{3}\cdot 10^{-3}&amp;\frac{0,\overline{3}\cdot 10^{-3}}{0,\overline{3}\cdot 10^{-2}}=10^{-1}=10\%\\ \hline
0,\overline{3}              &amp; 0,3&amp;0,\overline{3}\cdot 10^{-1}&amp;\frac{0,\overline{3}\cdot 10^{-1}}{0,\overline{3}}=10^{-1}=10\%\\ \hline
0,\overline{3}\cdot 10^{2}\ &amp; 0,3\cdot 10^{2}&amp;0,\overline{3}\cdot 10^{1}&amp;\frac{0,\overline{3}\cdot 10^{1}}{0,\overline{3}\cdot 10^{2}}=10^{-1}=10\%\\ \hline
\end{array}$$</span><br /></p>
<p>Outra forma de medir a exatidão de uma aproximação numérica é contar o <em>número de dígitos significativos corretos</em> em relação ao valor exato.</p>
<p>[Número de dígitos significativos corretos] A aproximação <span class="math">$\overline{x}$</span> de um número <span class="math"><em>x</em></span> tem <span class="math"><em>s</em></span> <em>dígitos significativos corretos</em> quando<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a> <br /><span class="math">$$\frac{|x-\overline{x}|}{|x|} &lt; 5\times 10^{-s}.$$</span><br /></p>
<p>Vejamos os seguintes casos:</p>
<ul>
<li><p>A aproximação de <span class="math"><em>x</em> = 0, 333333</span> por <span class="math">$\overline{x}=0,333$</span> tem <span class="math">3</span> dígitos significativos corretos, pois <br /><span class="math">$$\frac{|x-\overline{x}|}{|x|} = \frac{0,000333}{0,333333} \approx 0,000999 \leq 5\times 10^{-\pmb{3}}.$$</span><br /></p></li>
<li><p>Considere as aproximações <span class="math">$\bar{x}_1=0,666$</span> e <span class="math">$\bar{x}_2=0,667$</span> de <span class="math"><em>x</em> = 0, 666888</span>. Os erros relativos são <br /><span class="math">$$\frac{|x-\bar{x}_1|}{|x|} = \frac{|0,666888-0,666|}{0,666888} \approx 0,00133...&lt; 5\times 10^{-3}.$$</span><br /> <br /><span class="math">$$\frac{|x-\bar{x}_2|}{|x|} = \frac{|0,666888-0,667|}{0,666888} \approx 0,000167...&lt; 5\times 10^{-\RED{4}}.$$</span><br /> Note que <span class="math">$\bar{x}_1$</span> possui <span class="math">3</span> dígitos significativos corretos e <span class="math">$\bar{x}_2$</span> possui <span class="math">4</span> dígitos significativos (o quarto dígito é o dígito <span class="math">0</span> que não aparece a direita, i.e, <span class="math">$\bar{x}_2=0.\RED{6670}$</span>. Isto também leva a conclusão que <span class="math"><em>x</em><sub>2</sub></span> aproxima melhor o valor de <span class="math"><em>x</em></span> do que <span class="math"><em>x</em><sub>1</sub></span> pois está mais próximo de <span class="math"><em>x</em></span>.</p></li>
<li><p><span class="math">$\overline{x} = 9,999$</span> aproxima <span class="math"><em>x</em> = 10</span> com <span class="math">4</span> dígitos significativos corretos, pois <br /><span class="math">$$\frac{|x-\overline{x}|}{|x|} = \frac{|10 - 9,999|}{10} \approx 0,0000999...&lt; 5\times 10^{-4}.$$</span><br /></p></li>
<li><p>Considere as aproximações <span class="math">$\overline{x}_1 = 1,49$</span> e <span class="math">$\overline{x}_2 = 1,5$</span> de <span class="math"><em>x</em> = 1</span>. Da definição, temos que <span class="math">1, 49</span> aproxima <span class="math">1</span> com um dígito significativo correto (verifique), equanto <span class="math">1, 5</span> tem zero dígito significativo correto, pois: <br /><span class="math">$$\frac{|1-1,5|}{|1|} = 5\times 10^{-1} &lt; 5\times 10^{0}.$$</span><br /></p></li>
</ul>
<h3 id="erros-de-arredondamento">Erros de arredondamento</h3>
<p><span>[arredondamento<sub>s</sub>ec]</span> Os erros de arredondamento são aqueles gerados quando aproximamos um número real por um número com representação finita.</p>
<p>Existem várias formas de arredondar <br /><span class="math"><em>x</em> =  ± <em>d</em><sub>0</sub>, <em>d</em><sub>1</sub><em>d</em><sub>2</sub>…<em>d</em><sub><em>k</em> − 1</sub><em>d</em><sub><em>k</em></sub><em>d</em><sub><em>k</em> + 1</sub>…<em>d</em><sub><em>n</em></sub> × 10<sup><em>e</em></sup></span><br /> usando <span class="math"><em>k</em></span> dígitos significativos. As duas principais são as seguintes:</p>
<ol>
<li><p><em>Arredondamento por truncamento</em> (ou corte): aproximamos <span class="math"><em>x</em></span> por <br /><span class="math">$$\bar{x} = \pm d_{0},d_{1}d_{2}\ldots d_{k}\times 10^e$$</span><br /> simplesmente descartando os dígitos <span class="math"><em>d</em><sub><em>j</em></sub></span> com <span class="math"><em>j</em> &gt; <em>k</em></span>.</p></li>
<li><p><em>Arredondamento por proximidade</em>: se <span class="math"><em>d</em><sub><em>k</em> + 1</sub> &lt; 5</span> aproximamos <span class="math"><em>x</em></span> por <br /><span class="math">$$\bar{x} = \pm d_0,d_1d_2\ldots d_{k}\times 10^{e}$$</span><br /> senão aproximamos <span class="math"><em>x</em></span> por<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a> <br /><span class="math">$$\bar{x} = \pm(d_0,d_1d_2\ldots d_{k} + 10^{-k}) \times 10^{e}$$</span><br /></p></li>
</ol>
<p>Observe que o arredondamento pode mudar todos os dígitos e o expoente da representação em ponto flutuante de um número dado.</p>
<p>Represente os números <span class="math"><em>x</em><sub>1</sub> = 0, 567</span>, <span class="math"><em>x</em><sub>2</sub> = 0, 233</span>, <span class="math"><em>x</em><sub>3</sub> =  − 0, 675</span> e <span class="math"><em>x</em><sub>4</sub> = 0, 314159265… × 10<sup>1</sup></span> com dois dígitos significativos por truncamento e arredondamento.</p>
<p>Vejamos cada caso:</p>
<ul>
<li><p>Por truncamento: <br /><span class="math"><em>x</em><sub>1</sub> = 0, 56,  <em>x</em><sub>2</sub> = 0, 23,  <em>x</em><sub>3</sub> =  − 0, 67 <em>e</em> <em>x</em><sub>4</sub> = 3, 1.</span><br /> No <code>Scilab</code>, podemos obter a representação de <span class="math"><em>x</em><sub>3</sub> =  − 0, 675</span> fazendo (verifique):</p>
<pre><code>--&gt;format(&#39;e&#39;,8)
--&gt;int(-0.675*1e2)/1e2</code></pre></li>
<li><p>Por arredondamento: <br /><span class="math"><em>x</em><sub>1</sub> = 0, 57;  <em>x</em><sub>2</sub> = 0, 23;  <em>x</em><sub>3</sub> =  − 0, 68 <em>e</em> <em>x</em><sub>4</sub> = 3, 1.</span><br /> No <code>Scilab</code>, a representação de números por arredondamento é o padrão. Assim, para obtermos a representação desejada de <span class="math"><em>x</em><sub>3</sub> = 0, 675</span> fazemos: podemos obter a representação de <span class="math"><em>x</em><sub>3</sub> =  − 0, 675</span> fazemos (verifique):</p>
<pre><code>--&gt;format(&#39;e&#39;,8)
--&gt;-0.675</code></pre></li>
</ul>
<p>O arredondamento de <span class="math">0, 9999 × 10<sup> − 1</sup></span> com <span class="math">3</span> dígitos significativos é <span class="math">0, 1 × 10<sup>0</sup></span>.</p>
<h2 id="exercícios-2" class="unnumbered">Exercícios</h2>
<p>Calcule os erros absoluto e relativo das aproximações <span class="math">$\bar{x}$</span> para <span class="math"><em>x</em></span>.</p>
<ul>
<li><p><span class="math"><em>x</em> = <em>π</em> = 3, 14159265358979⋯</span> e <span class="math">$\bar{x}=3,141$</span></p></li>
<li><p><span class="math"><em>x</em> = 1, 00001</span> e <span class="math">$\bar{x}=1$</span></p></li>
<li><p><span class="math"><em>x</em> = 100001</span> e <span class="math">$\bar{x}=100000$</span></p></li>
</ul>
<p>Arredonde os seguintes números para cinco algarismos significativos corretos:</p>
<p><span>3</span></p>
<ul>
<li><p><span class="math">1, 7888544</span></p></li>
<li><p><span class="math">1788, 8544</span></p></li>
<li><p><span class="math">0, 0017888544</span></p></li>
<li><p><span class="math">0, 004596632</span></p></li>
<li><p><span class="math">2, 1754999 × 10<sup> − 10</sup></span></p></li>
<li><p><span class="math">2, 1754999 × 10<sup>10</sup></span></p></li>
</ul>
<p>a) <span class="math">1, 7889</span>; b) <span class="math">1788, 9</span>; c) <span class="math">0, 0017889</span>; d) <span class="math">0, 0045966</span>; e) <span class="math">2, 1755 × 10<sup> − 10</sup></span>; f) <span class="math">2, 1755 × 10<sup>10</sup></span></p>
<p>Verifique quantos são os dígitos significativos corretos em cada aproximação <span class="math">$\bar{x}$</span> para <span class="math"><em>x</em></span>.</p>
<ul>
<li><p><span class="math"><em>x</em> = 2, 5834</span> e <span class="math">$\bar{x}=2,6$</span></p></li>
<li><p><span class="math"><em>x</em> = 100</span> e <span class="math">$\bar{x}=99$</span></p></li>
</ul>
<p>Represente os números <span class="math">3276</span>; <span class="math">42, 55</span> e <span class="math">0, 00003331</span> com três dígitos significativos por truncamento e arredondamento.</p>
<p>Resolva a equação <span class="math">0, 1<em>x</em> − 0, 01 = 12</span> usando arredondamento com três dígitos significativos em cada passo e compare com o resultado analítico</p>
<p>Calcule o erro relativo e absoluto envolvido nas seguintes aproximações e expresse as respostas com três algarismos significativos corretos.</p>
<ul>
<li><p><span class="math"><em>x</em> = 3, 1415926535898</span> e <span class="math">$\tilde{x}=3,141593$</span></p></li>
<li><p><span class="math">$x=\frac{1}{7}$</span> e <span class="math">$\tilde{x}=1,43\times 10^{-1}$</span></p></li>
</ul>
<p>a) <span class="math"><em>δ</em><sub><em>a</em><em>b</em><em>s</em></sub> = 3, 46 × 10<sup> − 7</sup></span>, <span class="math"><em>δ</em><sub><em>r</em><em>e</em><em>l</em></sub> = 1, 10 × 10<sup> − 7</sup></span>; b) <span class="math"><em>δ</em><sub><em>a</em><em>b</em><em>s</em></sub> = 1, 43 × 10<sup> − 4</sup></span>, <span class="math"><em>δ</em><sub><em>r</em><em>e</em><em>l</em></sub> = 1, 00 × 10<sup> − 3</sup></span></p>
<h2 id="erros-nas-operações-elementares">Erros nas operações elementares</h2>
<p>O erro presente relativo nas operações elementares de adição, subtração, multiplicação e divisão é da ordem do epsilon de máquina. Se estivermos usando uma máquina com 64 bits, temos que <span class="math"><em>ϵ</em> = 2<sup> − 52</sup> ≈ 2, 22<em>E</em>16</span>.</p>
<p>Este erro é bem pequeno! Assumindo que <span class="math"><em>x</em></span> e <span class="math"><em>y</em></span> são representados com todos dígitos corretos, temos aproximadamente 15 dígitos significativos corretos quando fizemos uma das operações <span class="math"><em>x</em> + <em>y</em></span>, <span class="math"><em>x</em> − <em>y</em></span>, <span class="math"><em>x</em> × <em>y</em></span> ou <span class="math"><em>x</em>/<em>y</em></span>.</p>
<p>Mesmo que fizéssemos, por exemplo, <span class="math">1000</span> operações elementares em ponto flutuante sucessivas, teríamos no pior dos casos acumulado todos esses erros e perdido <span class="math">3</span> casas decimais (<span class="math">1000 × 10<sup> − 15</sup> ≈ 10<sup> − 12</sup>)</span>.</p>
<p>Entretanto, quando subtraímos números muito próximos, os problemas aumentam.</p>
<h2 id="cancelamento-catastrófico">Cancelamento catastrófico</h2>
<p>Quando fazemos subtrações com números muito próximos entre si ocorre o cancelamento catastrófico, onde podemos perder vários dígitos de precisão em uma única subtração.</p>
<p>Efetue a operação <br /><span class="math">0, 987624687925 − 0, 987624 = 0, 687925 × 10<sup> − 6</sup></span><br /> usando arredondamento com seis dígitos significativos e observe a diferença se comparado com resultado sem arredondamento.</p>
<p>Os números arredondados com seis dígitos para a mantissa resultam na seguinte diferença <br /><span class="math">0, 987625 − 0, 987624 = 0, 100000 × 10<sup> − 5</sup></span><br /> Observe que os erros relativos entre os números exatos e aproximados no lado esquerdo são bem pequenos, <br /><span class="math">$$\frac{|0,987624687925-0,987625|}{|0,987624687925|}=0,00003159$$</span><br /> e <br /><span class="math">$$\frac{|0,987624-0,987624|}{|0,987624|}=0\%,$$</span><br /> enquanto no lado direito o erro relativo é enorme: <br /><span class="math">$$\frac{|0,100000\times 10^{-5}-0,687925\times 10^{-6}|}{0,687925\times 10^{-6}}=45,36\%.$$</span><br /></p>
<p>Considere o problema de encontrar as raízes da equação de segundo grau <br /><span class="math"><em>x</em><sup>2</sup> + 300<em>x</em> − 0, 014 = 0, </span><br /> usando seis dígitos significativos.</p>
<p>Aplicando a fórmula de Bhaskara com <span class="math"><em>a</em> = 0, 100000 × 10<sup>1</sup></span>, <span class="math"><em>b</em> = 0, 300000 × 10<sup>3</sup></span> e <span class="math"><em>c</em> = 0, 140000 × 10<sup> − 1</sup></span>, temos o discriminante: <br /><span class="math">$$\begin{aligned}
  \Delta &amp;= b^2 - 4\cdot a\cdot c\\
  &amp;=0,300000\times 10^3\times 0,300000\times 10^3 \\
  &amp;+ 0,400000\times 10^1\times 0,100000\times 10^1\times 0,140000\times 10^{-1}\\
  &amp;=0,900000\times 10^5 +0,560000\times  10^{-1}\\
  &amp;=0,900001\times 10^5\end{aligned}$$</span><br /> e as raízes: <br /><span class="math">$$\begin{aligned}
x_1,x_2 &amp;=\frac{-0,300000\times 10^3\pm \sqrt{\Delta}}{0,200000\times 10^1} \\
&amp;=\frac{-0,300000\times 10^3\pm \sqrt{0,900001\times 10^5}}{0,200000\times 10^1} \\
&amp;=\frac{-0,300000\times 10^3\pm 0,300000\times 10^3}{0,200000\times 10^1}\\\end{aligned}$$</span><br /> Então, as duas raízes são: <br /><span class="math">$$\begin{aligned}
  \tilde{x}_1 &amp;= \frac{-0,300000\times 10^3- 0,300000\times 10^3}{0,200000\times 10^1}\\
  &amp;=-\frac{0,600000\times 10^3}{0,200000\times 10^1}=-0,300000\times 10^3\end{aligned}$$</span><br /> e <br /><span class="math">$$\tilde{x}_2=\frac{-0,300000\times 10^3+ 0,300000\times 10^3}{0,200000\times 10^1}=0,000000\times 10^{0}$$</span><br /> Agora, os valores das raízes com seis dígitos significativos deveriam ser <br /><span class="math">$$x_1=-0,300000\times 10^{3}\quad\hbox{e}\quad x_2=0,466667\times 10^{-4}.$$</span><br /> Observe que um raiz saiu com seis dígitos significativos corretos, mas a outra não possui nenhum dígito significativo correto.</p>
<p>No exemplo anterior <span class="math"><em>b</em><sup>2</sup></span> é muito maior que <span class="math">4<em>a</em><em>c</em></span>, ou seja, <span class="math">$b\approx \sqrt{b^2-4ac}$</span>, logo a diferença <br /><span class="math">$$-b+\sqrt{b^2-4ac}$$</span><br /> estará próxima de zero. Uma maneira padrão de evitar o cancelamento catastrófico é usar procedimentos analíticos para eliminar essa diferença. Abaixo veremos alguns exemplos.</p>
<p>Para eliminar o cancelamento catastrófico do exemplo anterior, usamos a seguinte expansão em série de Taylor em torno da origem <br /><span class="math">$$\sqrt{1-x}=1-{\frac {1}{2}}x+O(x^2) .$$</span><br /> Substituindo na fórmula de Bhaskara, temos: <br /><span class="math">$$\begin{aligned}
x&amp;=&amp;\frac{-b\pm \sqrt{b^2-4ac}}{2a}\\
&amp;=&amp;\frac{-b\pm b\sqrt{1-\frac{4ac}{b^2}}}{2a}\\
&amp;\approx&amp;\frac{-b\pm b\left(1-\frac{4ac}{2b^2}\right)}{2a}\\\end{aligned}$$</span><br /> Observe que <span class="math">$\frac{4ac}{b^2}$</span> é um número pequeno e por isso a expansão faz sentido. Voltamos no exemplo anterior e calculamos as duas raízes com o nova expressão <br /><span class="math">$$\begin{aligned}
\tilde{x}_1&amp;=&amp; \frac{-b- b+\frac{4ac}{2b}}{2a} = -\frac{b}{a}+\frac{c}{b}\\
&amp;=&amp; -\frac{0,300000\times 10^{3}}{0,100000\times 10^{1}}-\frac{0,140000\times 10^{-1}}{0,300000\times 10^3}\\
&amp;=&amp; -0,300000\times 10^{3}-0,466667\times 10^{-4}\\
&amp;=&amp; -0,300000\times 10^{3}\end{aligned}$$</span><br /> <br /><span class="math">$$\begin{aligned}
\tilde{x}_2&amp;=&amp; \frac{-b+ b-\frac{4ac}{2b}}{2a}\\
&amp;=&amp;-\frac{4ac}{4ab}\\
&amp;=&amp;-\frac{c}{b}=-\frac{-0,140000\times 10^{-1}}{0,300000\times 10^3}=0,466667\times 10^{-4}\\\end{aligned}$$</span><br /> Observe que o efeito catastrófico foi eliminado.</p>
<h2 id="condicionamento-de-um-problema">Condicionamento de um problema</h2>
<p>Geralmente podemos pensar um problema como um mapeamento <span class="math"><em>f</em></span> onde a partir de valores de entrada <span class="math"><em>x</em></span> devemos encontrar a saída, a solução <span class="math"><em>y</em></span>, ou seja, <span class="math"><em>f</em> : <em>x</em> → <em>y</em></span>, ou simplesmente <br /><span class="math">$$\begin{aligned}
   y=f(x)\end{aligned}$$</span><br /> Entretanto, a entrada do problema <span class="math"><em>x</em></span> normalmente terá erros (por exemplo, erros na coleta dos dados ou erros na representação dos dados devido a arredondamentos). Assim, ao invés de usar <span class="math"><em>x</em></span> estamos usando <span class="math"><em>x</em><sup> * </sup></span> para resolver o problema e encontrar a solução <span class="math"><em>y</em><sup> * </sup></span>, ou seja, estamos resolvendo <br /><span class="math">$$\begin{aligned}
   y^*=f(x^*)\end{aligned}$$</span><br /></p>
<p>Estamos interessados em saber se os erros cometidos na entrada <span class="math">Δ<em>x</em> = <em>x</em> − <em>x</em><sup> * </sup></span> influenciaram na saída do problema <span class="math">Δ<em>y</em> = <em>y</em> − <em>y</em><sup> * </sup></span>.</p>
<p>No caso mais simples, temos que <span class="math"><em>x</em> ∈ ℝ</span> e <span class="math"><em>y</em> ∈ ℝ</span>. Assumindo que <span class="math"><em>f</em></span> seja diferenciável, a partir da série de Taylor <br /><span class="math">$$\begin{aligned}
 f(x+\Delta x) \approx f(x) + f'(x) \Delta x\end{aligned}$$</span><br /> obtemos (subtraindo <span class="math"><em>f</em>(<em>x</em>)</span> dos dois lados) <br /><span class="math">$$\begin{aligned}
 \Delta y = f(x+\Delta x)-f(x) \approx f'(x) \Delta x\end{aligned}$$</span><br /> Para relacionarmos os erros relativos, dividimos o lado esquerdo por <span class="math"><em>y</em></span>, o lado direito por <span class="math"><em>f</em>(<em>x</em>) = <em>y</em></span> e obtemos <br /><span class="math">$$\begin{aligned}
 \frac{ \Delta y}{y} \approx \frac{f'(x)}{f(x)}  \frac{x \Delta x}{x} \end{aligned}$$</span><br /> sugerindo a definição de número de condicionamento de um problema.</p>
<p>Seja <span class="math"><em>f</em></span> uma função diferenciável. O <em>número de condicionamento</em> de um problema é definido como <br /><span class="math">$$\begin{aligned}
  \kappa_f(x) := \left| \frac{ x f'(x)}{f(x)} \right|\end{aligned}$$</span><br /> e fornece uma estimativa de quanto os erros relativos na entrada <span class="math">$\left|\frac{\Delta x}{x}\right|$</span> serão amplificados na saída <span class="math">$\left|\frac{\Delta y}{y}\right|$</span>.</p>
<p>De modo geral, quando <span class="math"><em>f</em></span> depende de várias variáveis, podemos obter</p>
<p><br /><span class="math">$$\delta_f=|f(x_1,x_2,...,x_n)-f(\bar{x}_1, \bar{x}_2,...,\bar{x}_n)|\approx \sum_{i=1}^n\left|\frac{\partial f}{\partial x_i}(x_1, x_2,...,x_n)\right|\delta_{x_i}$$</span><br /></p>
<p>Uma matriz de números de condicionamento também poderia ser obtida como em <span class="citation"></span>.</p>
<p>Considere o problema de calcular <span class="math">$\sqrt{x}$</span> em <span class="math"><em>x</em> = 2</span>. Se usarmos <span class="math"><em>x</em><sup> * </sup> = 1, 999</span>, quanto será o erro relativo na saída? O erro relativo na entrada é <br /><span class="math">$$\begin{aligned}
   \left|\frac{\Delta x}{x}\right| = \left|\frac{2-1,999}{2}\right| = 0,0005\end{aligned}$$</span><br /> O número de condicionamento do problema calcular a raiz é <br /><span class="math">$$\begin{aligned}
   \kappa_f(x) := \left| \frac{ x f'(x)}{f(x)} \right| =\left| \frac{ x \frac{1}{2\sqrt{x}}}{\sqrt{x}} \right|=\frac{1}{2}\end{aligned}$$</span><br /> Ou seja, os erros na entrada serão diminuídos pela metade. De fato, usando <span class="math">$y=\sqrt{2}=1,4142136...$</span> e <span class="math">$y^*=\sqrt{1,999}=1,41386...$</span>, obtemos <br /><span class="math">$$\begin{aligned}
   \frac{\Delta y}{y} = \frac{\sqrt{2}-\sqrt{1,999}}{\sqrt{2}} \approx  0,000250031...\end{aligned}$$</span><br /></p>
<p>Considere a função <span class="math">$f(x) = \frac{10}{1-x^2}$</span> e <span class="math"><em>x</em><sup> * </sup> = 0, 9995</span> com um erro absoluto na entrada de <span class="math">0, 0001</span>.</p>
<p>Calculando <span class="math"><em>y</em><sup> * </sup> = <em>f</em>(<em>x</em><sup> * </sup>)</span> temos <br /><span class="math">$$\begin{aligned}
   y^* = \frac{10}{1-(0,9995)^2} \approx 10002,500625157739705173\end{aligned}$$</span><br /> Mas qual é a estimativa de erro nessa resposta? Quantos dígitos significativos temos nessa resposta?</p>
<p>Sabendo que <span class="math"><em>f</em>′(<em>x</em>) =  − 10/(1 − <em>x</em><sup>2</sup>)<sup>2</sup></span>, o número de condicionamento é <br /><span class="math">$$\begin{aligned}
   \kappa_f(x) := \left| \frac{ x f'(x)}{f(x)} \right| = \left| \frac{ 2x^2}{1-x^2} \right|\end{aligned}$$</span><br /> o que nos fornece para <span class="math"><em>x</em><sup> * </sup> = 0, 9995</span>, <br /><span class="math">$$\begin{aligned}
   \kappa_f(0,9995) \approx 1998,5\end{aligned}$$</span><br /> Como o erro relativo na entrada é <br /><span class="math">$$\begin{aligned}
   \left|\frac{\Delta x}{x}\right| = \left|\frac{0,0001}{0,9995}\right| \approx  0,00010005...\end{aligned}$$</span><br /> temos que o erro na saída será aproximadamente <br /><span class="math">$$\begin{aligned}
   \left|\frac{\Delta y}{y}\right| \approx \kappa_f(x) \left|\frac{\Delta x}{x}\right| \approx  1998,5 \times 0,00010005... \approx 0,1999\end{aligned}$$</span><br /> ou seja um erro relativo de aproximadamente <span class="math">19, 99%</span>.</p>
<p>Note que se usarmos <span class="math"><em>x</em><sub>1</sub> = 0, 9994</span> e <span class="math"><em>x</em><sub>2</sub> = 0, 9996</span> (ambos no intervalo do erro absoluto da entrada) encontramos <br /><span class="math">$$\begin{aligned}
   y_1^*  &amp;\approx  8335,83 \\
   y_2^*  &amp;\approx 12520,50\end{aligned}$$</span><br /> confirmando a estimativa de <span class="math">19, 99%</span>.</p>
<p>Seja <span class="math"><em>f</em>(<em>x</em>) = <em>x</em>exp(<em>x</em>)</span>. Calcule o erro absoluto em se calcular <span class="math"><em>f</em>(<em>x</em>)</span> sabendo que <span class="math"><em>x</em> = 2 ± 0, 05</span>.</p>
<p>Temos que <span class="math"><em>x</em> ≈ 2</span> com erro absoluto de <span class="math"><em>δ</em><sub><em>x</em></sub> = 0, 05</span>. Neste caso, calculamos <span class="math"><em>δ</em><sub><em>f</em></sub></span>, i.e. o erro absoluto em se calcular <span class="math"><em>f</em>(<em>x</em>)</span>, por: <br /><span class="math"><em>δ</em><sub><em>f</em></sub> = |<em>f</em>′(<em>x</em>)|<em>δ</em><sub><em>x</em></sub>.</span><br /> Como <span class="math"><em>f</em>′(<em>x</em>) = (1 + <em>x</em>)<em>e</em><sup><em>x</em></sup></span>, temos: <br /><span class="math">$$\begin{aligned}
  \delta_f &amp;= |(1 + x)e^{x}|\cdot\delta_x\\
  &amp;= |3e^2|\cdot 0,05 = 1,1084.\end{aligned}$$</span><br /> Portanto, o erro absoluto em se calcular <span class="math"><em>f</em>(<em>x</em>)</span> quando <span class="math"><em>x</em> = 2 ± 0, 05</span> é de <span class="math">1, 084</span>.</p>
<p>Calcule o erro relativo ao medir <span class="math">$f(x,y)=\frac{x^2+1}{x^2}e^{2y}$</span> sabendo que <span class="math"><em>x</em> ≈ 3</span> é conhecido com <span class="math">10%</span> de erro e <span class="math"><em>y</em> ≈ 2</span> é conhecido com <span class="math">3%</span> de erro.</p>
<p>Calculamos as derivadas parciais de <span class="math"><em>f</em></span>: <br /><span class="math">$$\frac{\partial f}{\partial x}=\frac{2x^3-(2x^3+2x)}{x^4}e^{2y}=-\frac{2e^{2y}}{x^3}$$</span><br /> e <br /><span class="math">$$\frac{\partial f}{\partial y}=2\frac{x^2+1}{x^2}e^{2y}$$</span><br /> Calculamos o erro absoluto em termos do erro relativo: <br /><span class="math">$$\frac{\delta_x}{|x|}=0,1\Rightarrow \delta_x= 3\cdot 0,1=0,3$$</span><br /> <br /><span class="math">$$\frac{\delta_y}{|y|}=0,03\Rightarrow \delta_y= 2\cdot 0,03=0,06$$</span><br /> Aplicando a expressão para estimar o erro em <span class="math"><em>f</em></span> temos <br /><span class="math">$$\begin{aligned}
\delta_f &amp;= \left|\frac{\partial f}{\partial x}\right|\delta_x+\left|\frac{\partial f}{\partial y}\right|\delta_y\\
&amp;= \frac{2e^{4}}{27}\cdot 0,3+2\frac{9+1}{9}e^{4}\cdot 0,06=8,493045557\end{aligned}$$</span><br /> Portanto, o erro relativo ao calcular <span class="math"><em>f</em></span> é estimado por <br /><span class="math">$$\frac{\delta f}{|f|}=\frac{8,493045557}{\frac{9+1}{9}e^{4}}=14\%$$</span><br /></p>
<p>No exemplo anterior, reduza o erro relativo em <span class="math"><em>x</em></span> pela metade e calcule o erro relativo em <span class="math"><em>f</em></span>. Depois, repita o processo reduzindo o erro relativo em <span class="math"><em>y</em></span> pela metade.</p>
<p>Na primeira situação temos <span class="math"><em>x</em> = 3</span> com erro relativo de <span class="math">5%</span> e <span class="math"><em>δ</em><sub><em>x</em></sub> = 0, 05 ⋅ 3 = 0, 15</span>. Calculamos <span class="math"><em>δ</em><sub><em>f</em></sub> = 7, 886399450</span> e o erro relativo em <span class="math"><em>f</em></span> de <span class="math">13%</span>. Na segunda situação, temos <span class="math"><em>y</em> = 2</span> com erro de <span class="math">1, 5%</span> e <span class="math"><em>δ</em><sub><em>y</em></sub> = 2 ⋅ 0, 015 = 0, 03</span>. Calculamos <span class="math"><em>δ</em><sub><em>f</em></sub> = 4, 853168892</span> e o erro relativo em <span class="math"><em>f</em></span> de <span class="math">8%</span>. Observe que mesma o erro relativo em <span class="math"><em>x</em></span> sendo maior, o erro em <span class="math"><em>y</em></span> é mais significante na função.</p>
<p>Considere um triângulo retângulo onde a hipotenusa e um dos catetos são conhecidos a menos de um erro: hipotenusa <span class="math"><em>a</em> = 3 ± 0, 01</span> metros e cateto <span class="math"><em>b</em> = 2 ± 0, 01</span> metros. Calcule o erro absoluto ao calcular a área dessa triângulo.</p>
<p>Primeiro vamos encontrar a expressão para a área em função da hipotenusa <span class="math"><em>a</em></span> e um cateto <span class="math"><em>b</em></span>. A tamanho de segundo cateto <span class="math"><em>c</em></span> é dado pelo teorema de Pitágoras, <span class="math"><em>a</em><sup>2</sup> = <em>b</em><sup>2</sup> + <em>c</em><sup>2</sup></span>, ou seja, <span class="math">$c=\sqrt{a^2-b^2}$</span>. Portanto a área é <br /><span class="math">$$A=\frac{bc}{2}=\frac{b\sqrt{a^2-b^2}}{2}.$$</span><br /> Agora calculamos as derivadas <br /><span class="math">$$\frac{\partial A}{\partial a}=\frac{ab}{2\sqrt{a^2-b^2}},$$</span><br /> <br /><span class="math">$$\frac{\partial A}{\partial b}=\frac{\sqrt{a^2-b^2}}{2}-\frac{b^2}{2\sqrt{a^2-b^2}},$$</span><br /> e substituindo na estimativa para o erro <span class="math"><em>δ</em><sub><em>A</em></sub></span> em termos de <span class="math"><em>δ</em><sub><em>a</em></sub> = 0, 01</span> e <span class="math"><em>δ</em><sub><em>b</em></sub> = 0, 01</span>: <br /><span class="math">$$\begin{aligned}
\delta_A&amp;\approx &amp; \left|\frac{\partial A}{\partial a}\right|\delta_a+\left|\frac{\partial A}{\partial b}\right|\delta_b\\
&amp;\approx &amp;\frac{3\sqrt{5}}{5}\cdot 0,01+\frac{\sqrt{5}}{10}\cdot 0,01=0,01565247584\end{aligned}$$</span><br /> Em termos do erro relativo temos erro na hipotenusa de <span class="math">$\frac{0,01}{3}\approx 0,333\%$</span>, erro no cateto de <span class="math">$\frac{0,01}{2}= 0,5\%$</span> e erro na área de <br /><span class="math">$$\frac{0,01565247584}{\frac{2\sqrt{3^2-2^2}}{2}}=0,7\%$$</span><br /></p>
<h2 id="exercícios-3" class="unnumbered">Exercícios</h2>
<p>Considere que a variável <span class="math"><em>x</em> ≈ 2</span> é conhecida com um erro relativo de <span class="math">1%</span> e a variável <span class="math"><em>y</em> ≈ 10</span> com um erro relativo de <span class="math">10%</span>. Calcule o erro relativo associado a <span class="math"><em>z</em></span> quando: <br /><span class="math">$$z=\frac{y^4}{1+y^4}e^x.$$</span><br /> Suponha que você precise conhecer o valor de <span class="math"><em>z</em></span> com um erro de <span class="math">0, 5%</span>. Como engenheiro, você propõe uma melhoria na medição da variável <span class="math"><em>x</em></span> ou <span class="math"><em>y</em></span>? Explique.</p>
<p><span class="math">2%</span></p>
<p>A corrente <span class="math"><em>I</em></span> em ampères e a tensão <span class="math"><em>V</em></span> em volts em uma lâmpada se relacionam conforme a seguinte expressão: <br /><span class="math">$$I=\left(\frac{V}{V_0}\right)^\alpha,$$</span><br /> onde <span class="math"><em>α</em></span> é um número entre <span class="math">0</span> e <span class="math">1</span> e <span class="math"><em>V</em><sub>0</sub></span> é tensão nominal em volts. Sabendo que <span class="math"><em>V</em><sub>0</sub> = 220 ± 3%</span> e <span class="math"><em>α</em> =  − , 8 ± 4%</span>, calcule a corrente e o erro relativo associado quando a tensão vale <span class="math">220 ± 1%</span>.<br /><em>Obs:.</em> Este problema pode ser resolvido de duas formas distintas: usando a expressão aproximada para a propagação de erro e inspecionando os valores máximos e mínimos que a expressão pode assumir. Pratique os dois métodos.</p>
<p><span class="math">3, 2%</span> pela aproximação ou <span class="math">3, 4%</span> pela segundo método <span class="math">(0, 96758 ≤ <em>I</em> ≤ 1, 0342)</span>.</p>
<p>A corrente <span class="math"><em>I</em></span> em ampères e a tensão <span class="math"><em>V</em></span> em volts em uma lâmpada se relacionam conforme a seguinte expressão: <br /><span class="math">$$I=\left(\frac{V}{V_0}\right)^\alpha$$</span><br /> Onde <span class="math"><em>α</em></span> é um número entre 0 e 1 e <span class="math"><em>V</em><sub>0</sub></span> é a tensão nominal em volts. Sabendo que <span class="math"><em>V</em><sub>0</sub> = 220 ± 3%</span> e <span class="math"><em>α</em> = 0, 8 ± 4%</span> Calcule a corrente e o erro relativo associado quando a tensão vale <span class="math">220 ± 1%</span>. <em>Dica:</em> lembre que <span class="math"><em>x</em><sup><em>α</em></sup> = <em>e</em><sup><em>α</em>ln(<em>x</em>)</sup></span></p>
<h2 id="mais-exemplos">Mais exemplos</h2>
<p>Considere o seguinte processo iterativo: <br /><span class="math">$$\left\{\begin{array}{l}
x_0=\frac{1}{3}\\
x_{n+1}=4x_n-1,\qquad n\in\mathbb{N}
\end{array}\right..$$</span><br /> Observe que <span class="math">$x_0=\frac{1}{3}$</span>, <span class="math">$x_1=4\cdot \frac{1}{3}-1=\frac{1}{3}$</span>, <span class="math">$x_2=\frac{1}{3}$</span>, ou seja, temos uma sequência constante igual a <span class="math">$\frac{1}{3}$</span>. No entanto, ao calcularmos no computador, usando o sistema de numeração ’double’, a sequencia obtida não é constante e, de fato, diverge. Faça o teste no <code>Scilab</code>, colocando:</p>
<pre><code>--&gt;x = 1/3</code></pre>
<p>e itere algumas vezes a linha de comando:</p>
<pre><code>--&gt;x = 4*x-1</code></pre>
<p>Para compreender o que acontece, devemos levar em consideração que o número <span class="math">$\frac{1}{3}=0,\overline{3}$</span> possui um representação infinita tanto na base decimal quanto na base binária. Logo, sua representação de máquina incliu um erro de arredondamento. Seja <span class="math"><em>ϵ</em></span> a diferença entre o valor exato de <span class="math">$\frac{1}{3}$</span> e sua representação de máquina, isto é, <span class="math">$\tilde{x}_0=\frac{1}{3}+\epsilon$</span>. A sequência efetivamente calculada no computador é: <br /><span class="math">$$\begin{aligned}
\tilde{x}_0&amp;=&amp;\frac{1}{3}+\epsilon\\
\tilde{x}_1&amp;=&amp;4x_0-1=4\left(\frac{1}{3}+\epsilon\right)-1=\frac{1}{3}+4\epsilon\\
\tilde{x}_2&amp;=&amp;4x_1-1=4\left(\frac{1}{3}+4\epsilon\right)-1=\frac{1}{3}+4^2\epsilon\\
&amp;\vdots&amp;\\
\tilde{x}_n&amp;=&amp;\frac{1}{3}+4^n\epsilon\end{aligned}$$</span><br /> Portanto o limite da sequência diverge, <br /><span class="math">$$\lim_{x\to\infty}|\tilde{x}_n|=\infty$$</span><br /> Qual o número de condicionamento desse problema?</p>
<p>Observe a seguinte identidade <br /><span class="math">$$f(x)=\frac{(1+x)-1}{x}=1$$</span><br /> Calcule o valor da expressão à esquerda para <span class="math"><em>x</em> = 10<sup> − 12</sup></span>, <span class="math"><em>x</em> = 10<sup> − 13</sup></span>, <span class="math"><em>x</em> = 10<sup> − 14</sup></span>, <span class="math"><em>x</em> = 10<sup> − 15</sup></span>, <span class="math"><em>x</em> = 10<sup> − 16</sup></span> e <span class="math"><em>x</em> = 10<sup> − 17</sup></span>. Observe que quando <span class="math"><em>x</em></span> se aproxima do <span class="math"><em>ϵ</em></span> de máquina a expressão perde o significado. Veja abaixo o gráfico de <span class="math"><em>f</em>(<em>x</em>)</span> em escala logarítmica.</p>
<p><embed src="./cap_aritmetica/pics/cancelamento_0.eps" /></p>
<p>Neste exemplo, estamos interessados em compreender mais detalhadamente o comportamento da expressão <br /><span class="math">$$\label{def_lim}\left(1+\frac{1}{n}\right)^n$$</span><br /> quando <span class="math"><em>n</em></span> é um número grande ao computá-la em sistemas de numeral de ponto flutuante com acurácia finita. Um resultado bem conhecido do cálculo nos diz que o limite de ([def<sub>l</sub>im]) quando <span class="math"><em>n</em></span> tende a infinito é o número de Euler: <br /><span class="math">$$\label{lim}\lim_{n\to \infty}\left(1+\frac{1}{n}\right)^n=e= 2,718281828459...$$</span><br /></p>
<p>Sabemos também que a sequência produzida por ([def<sub>l</sub>im]) é crescente, isto é: <br /><span class="math">$$\left(1+\frac{1}{1}\right)^1&lt; \left(1+\frac{1}{2}\right)^2&lt; \left(1+\frac{1}{3}\right)^3 &lt; \cdots$$</span><br /></p>
<p>No entanto, quando calculamos essa expressão no <code>Scilab</code>, nos defrontamos com o seguinte resultado: <br /><span class="math">$$\begin{array}{|c|c|c|c|c|}
\hline &amp;&amp;&amp;&amp;\\[-0.3cm]
n &amp; \left(1+\frac{1}{n}\right)^n&amp;~~~~&amp;n &amp; \left(1+\frac{1}{n}\right)^n\\
 &amp;&amp;&amp;&amp;\\[-0.3cm]
\hline\\[-0.3cm]
1 &amp; 2,0000000000000 &amp;&amp; 10^{2} &amp; 2,7048138294215 \\
2 &amp; 2,2500000000000 &amp;&amp; 10^{4} &amp; 2,7181459268249 \\
3 &amp; 2,3703703703704 &amp;&amp; 10^{6} &amp; 2,7182804690957 \\
4 &amp; 2,4414062500000 &amp;&amp; 10^{8} &amp; 2,7182817983391 \\
5 &amp; 2,4883200000000 &amp;&amp; 10^{10} &amp; 2,7182820532348 \\
6 &amp; 2,5216263717421 &amp;&amp; 10^{12} &amp; 2,7185234960372 \\
7 &amp; 2,5464996970407 &amp;&amp; 10^{14} &amp; 2,7161100340870 \\
8 &amp; 2,5657845139503 &amp;&amp; 10^{16} &amp; 1,0000000000000 \\
9 &amp; 2,5811747917132 &amp;&amp; 10^{18} &amp; 1,0000000000000 \\
10 &amp; 2,5937424601000 &amp;&amp; 10^{20} &amp; 1,0000000000000 \\
\hline
\end{array}$$</span><br /> Podemos resumir esses dados no seguinte gráfico de <span class="math">$\left(1+\frac{1}{n}\right)^n$</span> em função de <span class="math"><em>n</em></span>:</p>
<p><embed src="./cap_aritmetica/pics/cancelamento_euler.eps" /> Observe que quando <span class="math"><em>x</em></span> se torna grande, da ordem de <span class="math">10<sup>15</sup></span>, o gráfico da função deixa de se crescente e apresenta oscilações. Observe também que a expressão se torna identicamente igual a <span class="math">1</span> depois de um certo limiar. Tais fenômenos não são intrínsecos da função <span class="math"><em>f</em>(<em>x</em>) = (1 + 1/<em>x</em>)<sup><em>x</em></sup></span>, mas <em></em>, isto é, são resultados numéricos espúrios. A fim de pôr o comportamento numérico de tal expressão, apresentamos abaixo o gráfico da mesma função, porém restrito à região entre <span class="math">10<sup>14</sup></span> e <span class="math">10<sup>16</sup></span>.</p>
<p><embed src="./cap_aritmetica/pics/cancelamento_euler2.eps" /> ¨</p>
<p>Para compreendermos melhor por que existe um limiar <span class="math"><em>N</em></span> que, quando atingido torna a expressão do exemplo acima identicamente igual a <span class="math">1</span>, observamos a sequência de operações realizadas pelo computador: <br /><span class="math"><em>x</em>  →  1/<em>x</em>  →  1 + 1/<em>x</em>  →  (1 + 1/<em>x</em>)<sup><em>x</em></sup></span><br /> Devido ao limite de precisão da representação de números em ponto flutuante, existe um menor número representável que é maior do que 1. Este número é <span class="math">1 + </span><code>eps</code>, onde <code>eps</code> é chamado de <em>épsilon de máquina</em> e é o menor número que somado a 1 produz um resultado superior a 1 no sistema de numeração usado. O épsilon de máquina no sistema de numeração <em>double</em> vale aproximadamente <span class="math">2, 22 × 10<sup> − 16</sup></span>. No <code>Scilab</code>, o epsilon de máquina é a constante <code>eps</code>. Observe que:</p>
<pre><code>--&gt;1+%eps
 ans  =
    1.0000000000000002220446 </code></pre>
<p>Quando somamos a <span class="math">1</span> um número positivo inferior ao épsilon de máquina, obtemos o número 1. Dessa forma, o resultado obtido pela operação de ponto flutuante <span class="math">1 + <em>x</em></span> para <span class="math">0 &lt; <em>x</em> &lt; 2, 22 × 10<sup> − 16</sup></span> é 1.</p>
<p>Portanto, quando realizamos a sequência de operações dada em ([seq<sub>o</sub>per]), toda informação contida no número <span class="math"><em>x</em></span> é perdida na soma com <span class="math">1</span> quando <span class="math">1/<em>x</em></span> é menor que o épsilon de máquina, o que ocorre quando <span class="math"><em>x</em> &gt; 5 × 10<sup>15</sup></span>. Assim <span class="math">(1 + 1/<em>x</em>)</span> é aproximado para <span class="math">1</span> e a última operação se resume a <span class="math">1<sup><em>x</em></sup></span>, o que é igual a <span class="math">1</span> mesmo quando <span class="math"><em>x</em></span> é grande.</p>
<p>Um erro comum é acreditar que o perda de significância se deve ao fato de <span class="math">1/<em>x</em></span> ser muito pequeno para ser representado e é aproximando para <span class="math">0</span>. Isto é falso, o sistema de ponto de flutuante permite representar números de magnitude muito inferior ao épsilon de máquina. O problema surge da limitação no tamanho da mantissa. Observe como a seguinte sequência de operações não perde significância para números positivos x muito menores que o épsilon de máquina: <br /><span class="math"><em>x</em>  →  1/<em>x</em>  →  1/(1/<em>x</em>)</span><br /> compare o desempenho numérico desta sequência de operações para valores pequenos de <span class="math"><em>x</em></span> com o da seguinte sequência: <br /><span class="math"><em>x</em>  →  1 + <em>x</em>  →  (1 + <em>x</em>) − 1.</span><br /> Finalmente, notamos que quando tentamos calcular <span class="math">$\left(1+\frac{1}{n}\right)^n$</span> para <span class="math"><em>n</em></span> grande, existe perda de significância no cálculo de <span class="math">1 + 1/<em>n</em></span>. Para entendermos isso melhor, vejamos o que acontece no <code>Scilab</code> quando <span class="math"><em>n</em> = 7 × 10<sup>13</sup></span>:</p>
<pre><code>--&gt;n=7e13
 n  =
     7.000000000000000000D+13  
 
--&gt;1/n
 ans  =
     1.428571428571428435D-14  
 
--&gt;y=1+1/n
 y  =
 
    1.000000000000014211D+00  </code></pre>
<p>Observe a perda de informação ao deslocar a mantissa de <span class="math">1/<em>n</em></span>. Para evidenciar o fenômenos, observamos o que acontece quando tentamos recalcular <span class="math"><em>n</em></span> subtraindo <span class="math">1</span> de <span class="math">1 + 1/<em>n</em></span> e invertendo o resultado:</p>
<pre><code>--&gt;y-1
 ans  =
     1.421085471520200372D-14  
 
--&gt;1/(y-1)
 ans  =
     7.036874417766400000D+13  </code></pre>
<p>[Analogia da balança] Observe a seguinte comparação interessante que pode ser feita para ilustrar os sistemas de numeração com ponto fixo e flutuante: o sistema de ponto fixo é como uma balança cujas marcas estão igualmente espaçadas; o sistema de ponto flutuante é como uma balança cuja distância entre as marcas é proporcional à massa medida. Assim, podemos ter uma balança de ponto fixo cujas marcas estão sempre distanciadas de <span class="math">100</span>g (<span class="math">100</span>g, <span class="math">200</span>g, <span class="math">300</span>g, ..., <span class="math">1</span>Kg, <span class="math">1, 1</span>Kg,...) e outra balança de ponto flutuante cujas marcas estão distanciadas sempre de aproximadamente um décimo do valor lido (<span class="math">100</span>g, <span class="math">110</span>g, <span class="math">121</span>g, <span class="math">133</span>g, ..., <span class="math">1</span>Kg, <span class="math">1, 1</span>Kg, <span class="math">1, 21</span>Kg, ...) A balança de ponto fixo apresenta uma resolução baixa para pequenas medidas, porém uma resolução alta para grandes medidas. A balança de ponto flutuante distribui a resolução de forma proporcional ao longo da escala.</p>
<p>Seguindo nesta analogia, o fenômeno de perda de significância pode ser interpretado como a seguir: imagine que você deseje obter o peso de um gato (aproximadamente <span class="math">4</span>Kg). Dois processos estão disponíveis: colocar o gato diretamente na balança ou medir seu peso com o gato e, depois, sem o gato. Na balança de ponto flutuante, a incerteza associada na medida do peso do gato (sozinho) é aproximadamente <span class="math">10%</span> de <span class="math">4</span>Kg, isto é, <span class="math">400</span>g. Já a incerteza associada à medida da uma pessoa (aproximadamente <span class="math">70</span>Kg) com o gato é de <span class="math">10%</span> do peso total, isto é, aproximadamente <span class="math">7</span>Kg. Esta incerteza é da mesma ordem de grandeza da medida a ser realizada, tornado o processo impossível de ser realizado, já que teríamos uma incerteza da ordem de <span class="math">14</span>Kg (devido à dupla medição) sobre uma grandeza de <span class="math">4</span>Kg.</p>
<h2 id="exercícios-4" class="unnumbered">Exercícios</h2>
<p>Considere as expressões: <br /><span class="math">$$\frac{\exp(1/\mu)}{1+\exp(1/\mu)}$$</span><br /> e <br /><span class="math">$$\frac{1}{\exp(-1/\mu)+1}$$</span><br /> com <span class="math"><em>μ</em> &gt; 0</span>. Verifique que elas são idênticas como funções reais. Teste no computador cada uma delas para <span class="math"><em>μ</em> = 0, 1</span>, <span class="math"><em>μ</em> = 0, 01</span> e <span class="math"><em>μ</em> = 0, 001</span>. Qual dessas expressões é mais adequada quando <span class="math"><em>μ</em></span> é um número pequeno? Por quê?</p>
<p>Quando <span class="math"><em>μ</em></span> é pequeno, <span class="math"><em>e</em><sup>1/<em>m</em><em>u</em></sup></span> é um número grande. A primeira expressão produz um ”overflow” (número maior que o máximo representável) quando <span class="math"><em>μ</em></span> é pequeno. A segunda expressão, no entanto, reproduz o limite <span class="math">1</span> quando <span class="math"><em>μ</em> → 0 + </span>.</p>
<p>Encontre expressões alternativas para calcular o valor das seguintes funções quando <span class="math"><em>x</em></span> é próximo de zero.</p>
<ul>
<li><p><span class="math">$f(x)=\frac{1-\cos(x)}{x^2}$</span></p></li>
<li><p><span class="math">$g(x)=\sqrt{1+x}-1$</span></p></li>
<li><p><span class="math">$h(x)=\sqrt{x+10^6}-10^3$</span></p></li>
<li><p><span class="math">$i(x)=\sqrt{1+e^{x}}-\sqrt{2}$</span>        Dica: Faça <span class="math"><em>y</em> = <em>e</em><sup><em>x</em></sup> − 1</span></p></li>
</ul>
<p>a) <span class="math">$\frac{1}{2}+\frac{x^2}{4!}+O(x^4)$</span>; b) <span class="math"><em>x</em>/2 + <em>O</em>(<em>x</em><sup>2</sup>)</span>; c) <span class="math">5 ⋅ 10<sup> − 4</sup><em>x</em> + <em>O</em>(<em>x</em><sup>2</sup>)</span>; d) <span class="math">$\frac{\sqrt{2}}{4}y+O(y^{2})=\frac{\sqrt{2}}{4}x+O(x^2)$</span></p>
<p>Use uma identidade trigonométrica adequada para mostrar que: <br /><span class="math">$$\frac{1-\cos(x)}{x^2}= \frac{1}{2} \left(\frac{\sin(x/2)}{x/2}\right)^2.$$</span><br /> Analise o desempenho destas duas expressões no computador quando <span class="math"><em>x</em></span> vale <span class="math">10<sup> − 5</sup></span>, <span class="math">10<sup> − 6</sup></span>, <span class="math">10<sup> − 7</sup></span>, <span class="math">10<sup> − 8</sup></span>, <span class="math">10<sup> − 9</sup></span>, <span class="math">10<sup> − 200</sup></span> e <span class="math">0</span>. Discuta o resultado. <em>Dica:</em> Para <span class="math">|<em>x</em>| &lt; 10<sup> − 5</sup></span>, <span class="math"><em>f</em>(<em>x</em>)</span> pode ser aproximada por <span class="math">1/2 − <em>x</em><sup>2</sup>/24</span> com erro de truncamento inferior a <span class="math">10<sup> − 22</sup></span>.</p>
<p>[title=Notas do prof. Guidi] Reescreva as expressões: <br /><span class="math">$$\sqrt{e^{2x}+1}-e^x \qquad\hbox{e}\qquad \sqrt{e^{2x}+x^2}-e^x$$</span><br /> de modo que seja possível calcular seus valores para <span class="math"><em>x</em> = 100</span> utilizando a aritmética de ponto flutuante (“Double”) no computador.</p>
<p>Na teoria da relatividade restrita, a energia cinética de uma partícula e sua velocidade se relacionam pela seguinte fórmula: <br /><span class="math">$$E=mc^2\left(\frac{1}{\sqrt{1-(v/c)^2}}-1\right),$$</span><br /> onde <span class="math"><em>E</em></span> é a energia cinética da partícula, <span class="math"><em>m</em></span> é a massa de repouso, <span class="math"><em>v</em></span> o módulo da velocidade e <span class="math"><em>c</em></span> a velocidade da luz no vácuo dada por <span class="math"><em>c</em> = 299792458<em>m</em>/<em>s</em></span>. Considere que a massa de repouso <span class="math"><em>m</em> = 9, 10938291 × 10<sup> − 31</sup><em>K</em><em>g</em></span> do elétron seja conhecida com erro relativo de <span class="math">10<sup> − 9</sup></span>. Qual é o valor da energia e o erro relativo associado a essa grandeza quando <span class="math"><em>v</em> = 0, 1<em>c</em></span>, <span class="math"><em>v</em> = 0, 5<em>c</em></span>, <span class="math"><em>v</em> = 0, 99<em>c</em></span> e <span class="math"><em>v</em> = 0, 999<em>c</em></span> sendo que a incerteza relativa na medida da velocidade é <span class="math">10<sup> − 5</sup></span>?</p>
<p><span class="math">4, 12451228 × 10<sup> − 16</sup></span> J; <span class="math">0, 002%</span>; <span class="math">0, 26654956 × 10<sup> − 14</sup></span> J; <span class="math">0, 002%</span>; <span class="math">4, 98497440 × 10<sup> − 13</sup></span> J; <span class="math">0, 057%</span>; <span class="math">1, 74927914 × 10<sup> − 12</sup></span> J; <span class="math">0, 522%</span>.</p>
<p>Deseja-se medir a concentração de dois diferentes oxidantes no ar. Três sensores eletroquímicos estão disponíveis para a medida e apresentam a seguintes respostas: <br /><span class="math">$$v_1= 270 [A] +  30 [B],~~~ v_2= 140 [A] +  20 [B] ~~ \hbox{e}~~ v_3= 15 [A] +  200 [B]$$</span><br /> as tensões <span class="math"><em>v</em><sub>1</sub></span>, <span class="math"><em>v</em><sub>2</sub></span> e <span class="math"><em>v</em><sub>3</sub></span> são dadas em <span class="math"><em>m</em><em>V</em></span> e as concentrações em <span class="math"><em>m</em><em>i</em><em>l</em><em>i</em><em>m</em><em>o</em><em>l</em>/<em>l</em></span>.</p>
<ul>
<li><p>Encontre uma expressão para os valores de <span class="math">[<em>A</em>]</span> e <span class="math">[<em>B</em>]</span> em termos de <span class="math"><em>v</em><sub>1</sub></span> e <span class="math"><em>v</em><sub>2</sub></span> e, depois, em termos de <span class="math"><em>v</em><sub>1</sub></span> e <span class="math"><em>v</em><sub>3</sub></span>. Dica: Se <span class="math"><em>a</em><em>d</em> ≠ <em>b</em><em>c</em></span>, então a matriz <span class="math"><em>A</em></span> dada por <br /><span class="math">$$A=\left[\begin{array}{cc}a&amp;b\\c&amp;d\end{array}\right]$$</span><br /> é inversível e sua inversa é dada por <br /><span class="math">$$A^{-1}= \frac{1}{ad-bc} \left[\begin{array}{cc}d&amp;-b\\-c&amp;a\end{array}\right].$$</span><br /></p></li>
<li><p>Sabendo que incerteza relativa associada às sensibilidades dos sensores 1 e 2 é de <span class="math">2%</span> e que a incerteza relativa associada às sensibilidades do sensor 3 é <span class="math">10%</span>, verifique a incerteza associada à medida feita com o par <span class="math">1 − 2</span> e o par <span class="math">1 − 3</span>. Use <span class="math">[<em>A</em>] = [<em>B</em>] = 10<em>m</em><em>i</em><em>l</em><em>i</em><em>m</em><em>o</em><em>l</em>/<em>l</em></span>. Dica: Você deve diferenciar as grandezas <span class="math">[<em>A</em>]</span> e <span class="math">[<em>B</em>]</span> em relação aos valores das tensões.</p></li>
</ul>
<p>Em ambos casos, temos a seguinte estrutura: <br /><span class="math">$$\left[\begin{array}{cc}
S_{11}&amp; S_{12}\\
S_{21}&amp; S_{22}
\end{array}
\right] \left[\begin{array}{c}
\left[ A\right]\\
\left[ B\right]
\end{array}
\right]= \left[\begin{array}{c}
v_1\\
v_2
\end{array}
\right]$$</span><br /> De forma que <br /><span class="math">$$\left[\begin{array}{c}
\left[ A\right]\\
\left[ B\right]
\end{array}\right]
=\left[\begin{array}{cc}
S_{11}&amp; S_{12}\\
S_{21}&amp; S_{22}
\end{array}
\right]^{-1}
\left[\begin{array}{c}
v_1\\
v_2
\end{array}
\right]=\frac{1}{S_{11}S_{22}-S_{12}S_{21}}\left[\begin{array}{cc}
S_{22}&amp; -S_{12}\\
-S_{21}&amp; S_{11}
\end{array}
\right]\left[\begin{array}{c}
v_1\\
v_2
\end{array}
\right]$$</span><br /> Portanto <br /><span class="math">$$\begin{aligned}
[ A ]&amp;=&amp;\frac{S_{22}v_1-S_{12}v_2}{S_{11}S_{22}-S_{12}S_{21}}\\
\left[ {B} \right]&amp;=&amp;\frac{-S_{21}v_1+S_{11}v_2}{S_{11}S_{22}-S_{12}S_{21}}\end{aligned}$$</span><br /></p>
<p>Usando derivação logarítmica, temos</p>
<p><br /><span class="math">$$\begin{aligned}
\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{11}}&amp;=&amp;-\frac{S_{22}}{S_{11}S_{22}-S_{12}S_{21}}\\
\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{12}}&amp;=&amp;-\frac{v_2}{S_{22}v_1-S_{12}v_2}+\frac{S_{21}}{S_{11}S_{22}-S_{12}S_{21}}=-\frac{[A]}{\left[B\right]}\cdot \frac{S_{22}}{S_{11}S_{22}-S_{12}S_{21}}\\
\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{21}}&amp;=&amp;\frac{S_{12}}{S_{11}S_{22}-S_{12}S_{21}}\\
\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{22}}&amp;=&amp;\frac{v_1}{S_{22}v_1-S_{12}v_2}-\frac{S_{11}}{S_{11}S_{22}-S_{12}S_{21}}=\frac{[A]}{\left[B\right]}\cdot \frac{S_{12}}{S_{11}S_{22}-S_{12}S_{21}}\end{aligned}$$</span><br /></p>
<p>e <br /><span class="math">$$\begin{aligned}
\frac{1}{\left[ B \right]}\frac{\partial \left[ B \right]}{\partial S_{11}}&amp;=&amp;\frac{v_2}{-S_{21}v_1+S_{11}v_2}-\frac{S_{22}}{S_{11}S_{22}-S_{12}S_{21}}=\frac{\left[B\right]}{[A]} \frac{S_{21}}{S_{11}S_{22}-S_{12}S_{21}}\\
\frac{1}{\left[ B \right]}\frac{\partial \left[ B \right]}{\partial S_{12}}&amp;=&amp;\frac{S_{21}}{S_{11}S_{22}-S_{12}S_{21}}\\
\frac{1}{\left[ B \right]}\frac{\partial \left[ B \right]}{\partial S_{21}}&amp;=&amp;-\frac{v_1}{-S_{21}v_1+S_{11}v_2}+\frac{S_{21}}{S_{11}S_{22}-S_{12}S_{21}}=-\frac{\left[B\right]}{[A]}\frac{S_{11}}{S_{11}S_{22}-S_{12}S_{21}}\\
\frac{1}{\left[ B \right]}\frac{\partial \left[ B \right]}{\partial S_{22}}&amp;=&amp;-\frac{S_{11}}{S_{11}S_{22}-S_{12}S_{21}}\\\end{aligned}$$</span><br /></p>
<p>E o erro associado às medidas pode ser aproximado por <br /><span class="math">$$\begin{aligned}
\frac{1}{[A]}\delta_{[A]}&amp;=&amp;\left|\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{11}}\right| \delta_{S_{11}}+\left|\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{12}}\right| \delta_{S_{12}}+\left|\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{21}}\right| \delta_{S_{21}}+\left|\frac{1}{[ A ]}\frac{\partial [ A ]}{\partial S_{22}}\right| \delta_{S_{22}}\\
&amp;=&amp;\frac{1}{\left|\det{S}\right|}\left[S_{22}\delta_{S_{11}}+\frac{[A]}{\left[B\right]}S_{22}\delta_{S_{12}}+S_{12}\delta_{S_{21}}+\frac{[A]}{\left[B\right]}S_{12}\delta_{S_{22}}\right]\end{aligned}$$</span><br /> Analogamente, temos: <br /><span class="math">$$\begin{aligned}
\frac{1}{[B]}\delta_{[B]}&amp;=&amp;\frac{1}{\left|\det{S}\right|}\left[\frac{[B]}{\left[A\right]}S_{21}\delta_{S_{11}}+S_{21}\delta_{S_{11}}+\frac{\left[B\right]}{[A]}S_{11}\delta_{S_{21}}+S_{11}\delta_{S_{22}}\right]\end{aligned}$$</span><br /></p>
<p>onde não se indicou <span class="math">|<em>S</em><sub><em>i</em><em>j</em></sub>|</span> nem <span class="math">|[.]|</span> pois são todos positivos.</p>
<p>Fazemos agora a aplicação numérica:</p>
<p><span><strong>Caso do par 1-2:</strong></span> <br /><span class="math">$$\det{S}=\left|\begin{array}{cc}270&amp;30\\140&amp;20\end{array}\right|=1200$$</span><br /> <br /><span class="math">$$\begin{aligned}
\frac{1}{[A]}\delta_{[A]}
&amp;=&amp;\frac{1}{1200}\left[20\times 270\times 2\%+20\times 30\times 2\%+30\times 140\times 2\%+30\times 20\times 2\%\right]\\&amp;=&amp;\frac{216}{1200}=0.18=18\%\\
\frac{1}{[B]}\delta_{[B]}
&amp;=&amp;\frac{1}{1200}\left[140\times 270\times 2\%+140\times 30\times 2\%+270\times 140\times 2\%+270\times 20\times 2\%\right]\\&amp;=&amp;\frac{426}{1200}=0.355=35.5\%\end{aligned}$$</span><br /></p>
<p><span><strong>Caso do par 1-3:</strong></span> <br /><span class="math">$$\det{S}=\left|\begin{array}{cc}270&amp;30\\15&amp;200\end{array}\right|=53550$$</span><br /> <br /><span class="math">$$\begin{aligned}
\frac{1}{[A]}\delta_{[A]}
&amp;=&amp;\frac{1}{53550}\left[200\times 270\times 2\%+200\times 30\times 2\%+30\times 15\times 10\%+30\times 200\times 10\%\right]\\&amp;=&amp;\frac{1804,6}{52550}\approx 0.0337=3.37\%\\
\frac{1}{[B]}\delta_{[B]}
&amp;=&amp;\frac{1}{53550}\left[15\times 270\times 2\%+15\times 30\times 2\%+270\times 15\times 10\%+270\times 200\times 10\%\right]\\&amp;=&amp;	\frac{5895}{53550}\approx   0.11=11\%\end{aligned}$$</span><br /></p>
<p>Conclusão, apesar de o sensor <span class="math">3</span> apresentar uma incerteza cinco vezes maior na sensibilidade, a escolha do sensor <span class="math">3</span> para fazer par ao sensor <span class="math">1</span> parece mais adequada.</p>
<h1 id="solução-de-equações-de-uma-variável">Solução de equações de uma variável</h1>
<p>Neste capítulo buscaremos aproximações numéricas para a solução de <em>equações de uma variável real</em>. Observamos que obter uma solução para uma tal dada equação é equivalente a encontrar um <em>zero de uma função</em> apropriada. Com isso, iniciamos este capítulo discutindo sobre condições de existência e unicidade de raízes de funções de uma variável real. Então, apresentamos o <em>método da bisseção</em> como uma primeira abordagem numérica para a solução de tais equações.</p>
<p>Em seguida, exploramos uma outra abordagem via <em>iteração do ponto fixo</em>. Desta, obtemos o <em>método de Newton</em><a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a>, para o qual discutimos sua aplicação e convergência. Por fim, apresentamos o <em>método das secantes</em> como uma das possíveis variações do método de Newton.</p>
<h2 id="existência-e-unicidade">Existência e unicidade</h2>
<p>O <em>teorema de Bolzano</em><a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a> nos fornece condições suficientes para a existência do zero de uma função. Este é uma aplicação direta do <em>teorema do valor intermediário</em>.</p>
<p>[Teorema de Bolzano][teo:teorema<sub>d</sub>e<sub>B</sub>olzano] Se <span class="math"><em>f</em> : [<em>a</em>, <em>b</em>] → ℝ</span>, <span class="math"><em>y</em> = <em>f</em>(<em>x</em>)</span>, é uma função contínua tal que <span class="math"><em>f</em>(<em>a</em>) ⋅ <em>f</em>(<em>b</em>) &lt; 0</span>, então existe <span class="math"><em>x</em><sup> * </sup> ∈ (<em>a</em>, <em>b</em>)</span> tal que <span class="math"><em>f</em>(<em>x</em><sup> * </sup>) = 0</span>.</p>
<p>O resultado é uma consequência imediata do teorema do valor intermediário que estabelece que dada uma função contínua <span class="math"><em>f</em> : [<em>a</em>, <em>b</em>] → ℝ</span>, <span class="math"><em>y</em> = <em>f</em>(<em>x</em>)</span>, tal que <span class="math"><em>f</em>(<em>a</em>) &lt; <em>f</em>(<em>b</em>)</span> (ou <span class="math"><em>f</em>(<em>b</em>) &lt; <em>f</em>(<em>a</em>)</span>), então para qualquer <span class="math"><em>d</em> ∈ (<em>f</em>(<em>a</em>), <em>f</em>(<em>b</em>))</span> (ou <span class="math"><em>k</em> ∈ (<em>f</em>(<em>b</em>), <em>f</em>(<em>a</em>))</span>) existe <span class="math"><em>x</em><sup> * </sup> ∈ (<em>a</em>, <em>b</em>)</span> tal que <span class="math"><em>f</em>(<em>x</em><sup> * </sup>) = <em>k</em></span>. Ou seja, nestas notações, se <span class="math"><em>f</em>(<em>a</em>) ⋅ <em>f</em>(<em>b</em>) &lt; 0</span>, então <span class="math"><em>f</em>(<em>a</em>) &lt; 0 &lt; <em>f</em>(<em>b</em>)</span> (ou <span class="math"><em>f</em>(<em>b</em>) &lt; 0 &lt; <em>f</em>(<em>a</em>)</span>). Logo, tomando <span class="math"><em>k</em> = 0</span>, temos que existe <span class="math"><em>x</em><sup> * </sup> ∈ (<em>a</em>, <em>b</em>)</span> tal que <span class="math"><em>f</em>(<em>x</em><sup> * </sup>) = <em>k</em> = 0</span>.</p>
<p>Em outras palavras, se <span class="math"><em>f</em>(<em>x</em>)</span> é uma função contínua em um dado intervalo no qual ela troca de sinal, então ela têm pelo menos um zero neste intervalo (veja a Figura [fig:teorema<sub>d</sub>e<sub>B</sub>olzano]).</p>
<div class="figure">
<embed src="./cap_equacao1d/pics/teorema_de_Bolzano/teorema_de_Bolzano.eps" />
<p class="caption">Teorema de Bolzano.<span data-label="fig:teoremadeBolzano"></span></p>
</div>
<p>[ex:teorema<sub>d</sub>e<sub>B</sub>olzano] Mostre que existe pelo menos uma solução da equação <span class="math"><em>e</em><sup><em>x</em></sup> = <em>x</em> + 2</span> no intervalo <span class="math">( − 2, 0)</span>.</p>
<p>Primeiramente, observamos que resolver a equação <span class="math"><em>e</em><sup><em>x</em></sup> = <em>x</em> + 2</span> é equivalente a resolver <span class="math"><em>f</em>(<em>x</em>) = 0</span> com <span class="math"><em>f</em>(<em>x</em>) = <em>e</em><sup><em>x</em></sup> − <em>x</em> − 2</span>. Agora, como <span class="math"><em>f</em>( − 2) = <em>e</em><sup> − 2</sup> &gt; 0</span> e <span class="math"><em>f</em>(0) =  − 2 &lt; 0</span>, temos do teorema de Bolzano que existe pelo menos um zero de <span class="math"><em>f</em>(<em>x</em>)</span> no intervalo <span class="math">( − 2, 0)</span>. E, portanto, existe pelo menos uma solução da equação dada no intervalo <span class="math">( − 2, 0)</span>.</p>
<p>Podemos usar o <code>Scilab</code> para estudarmos esta função. Por exemplo, podemos definir a função <span class="math"><em>f</em>(<em>x</em>)</span> e computá-la nos extremos do intervalo dado com os seguintes comandos:</p>
<pre><code>--&gt;deff(&#39;y=f(x)&#39;,&#39;y=exp(x)-x-2&#39;)
--&gt;f(-2),f(0)
 ans  =
    0.1353353  
 ans  =
  - 1.  </code></pre>
<p>Alternativamente (e com maior precisão), podemos verificar diretamente o sinal da função nos pontos desejados com comando <code>sign</code>:</p>
<pre><code>--&gt;sign(f(-2)),sign(f(0))
 ans  =
    1.  
 ans  =
  - 1.  </code></pre>
<p>Quando procuramos aproximações para zeros de funções, é aconselhável isolar cada raiz em um intervalo. Desta forma, gostaríamos de poder garantir a existência e a unicidade da raiz dentro de um dado intervalo. A seguinte proposição nos fornece condições suficientes para tanto.</p>
<p>[prop:existencia<sub>eu</sub>nicidade] Se <span class="math"><em>f</em> : [<em>a</em>, <em>b</em>] → ℝ</span> é um função diferenciável, <span class="math"><em>f</em>(<em>a</em>) ⋅ <em>f</em>(<em>b</em>) &lt; 0</span> e <span class="math"><em>f</em>′(<em>x</em>) &gt; 0</span> (ou <span class="math"><em>f</em>′(<em>x</em>) &lt; 0</span>) para todo <span class="math"><em>x</em> ∈ (<em>a</em>, <em>b</em>)</span>, então existe um único <span class="math"><em>x</em><sup> * </sup> ∈ (<em>a</em>, <em>b</em>)</span> tal que <span class="math"><em>f</em>(<em>x</em><sup> * </sup>) = 0</span>.</p>
<p>Em outras palavras, para garantirmos que exista um único zero de uma dada função diferenciável num intervalo, é suficiente que ela troque de sinal e seja monótona neste intervalo.</p>
<p>No Exemplo [ex:teorema<sub>d</sub>e<sub>B</sub>olzano], mostramos que existe pelo menos um zero de <span class="math"><em>f</em>(<em>x</em>) = <em>e</em><sup><em>x</em></sup> − <em>x</em> − 2</span> no intervalo <span class="math">( − 2, 0)</span>, pois <span class="math"><em>f</em>(<em>x</em>)</span> é contínua e <span class="math"><em>f</em>( − 2) ⋅ <em>f</em>(0) &lt; 0</span>. Agora, observamos que, além disso, <span class="math"><em>f</em>′(<em>x</em>) = <em>e</em><sup><em>x</em></sup> − 1</span> e, portanto, <span class="math"><em>f</em>′(<em>x</em>) &lt; 0</span> para todo <span class="math"><em>x</em> ∈ ( − 2, 0)</span>. Logo, da Proposição [prop:existencia<sub>eu</sub>nicidade], temos garantida a existência de um único zero no intervalo dado.</p>
<p>Podemos inspecionar o comportamento da função <span class="math"><em>f</em>(<em>x</em>) = <em>e</em><sup><em>x</em></sup> − <em>x</em> − 2</span> e de sua derivada fazendo seus gráficos no Scilab. Para tanto, podemos fazer o seguinte teste:</p>
<pre><code>--&gt;x = linspace(-2,0,50);
--&gt;deff(&#39;y = f(x)&#39;,&#39;y=exp(x)-x-2&#39;)  // define f
--&gt;plot(x,f(x));xgrid               // grafico de f
--&gt;deff(&#39;y = fl(x)&#39;,&#39;y=exp(x)-1&#39;)   // a derivada
--&gt;plot(x,fl(x));xgrid              // grafico de f&#39;</code></pre>
<p>A discussão feita nesta seção, especialmente o teorema de Bolzano, nos fornece os fundamentos para o método da bisseção, o qual discutimos na próxima seção.</p>
<h2 id="exercícios-5" class="unnumbered">Exercícios</h2>
<p>[exer:existencia<sub>s</sub>ol1] Mostre que <span class="math">cos<em>x</em> = <em>x</em></span> tem solução no intervalo <span class="math">[0, <em>π</em>/2]</span>.</p>
<p>Observamos que a equação é equivalente a <span class="math">cos(<em>x</em>) − <em>x</em> = 0</span>. Tomando, então, <span class="math"><em>f</em>(<em>x</em>) = cos(<em>x</em>) − <em>x</em></span>, temos que <span class="math"><em>f</em>(<em>x</em>)</span> é contínua em <span class="math">[0, <em>π</em>/2]</span>, <span class="math"><em>f</em>(0) = 1</span> e <span class="math"><em>f</em>(<em>π</em>/2) =  − <em>π</em>/2 &lt; 0</span>. Logo, do teorema de Bolzano [teo:teorema<sub>d</sub>e<sub>B</sub>olzano], concluímos que a equação dada tem pelo menos uma solução no intervalo <span class="math">(0, <em>π</em>/2)</span>.</p>
<p>Mostre que <span class="math">cos<em>x</em> = <em>x</em></span> tem uma única solução no intervalo <span class="math">[0, <em>π</em>/2]</span>.</p>
<p>No Exercício [exer:existencia<sub>s</sub>ol1], mostramos que a função <span class="math"><em>f</em>(<em>x</em>) = cos(<em>x</em>) − <em>x</em></span> tem um zero no intervalo <span class="math">[0, <em>π</em>/2]</span>. Agora, observamos que <span class="math">$f'(x) = -\sen(x) - 1$</span>. Como <span class="math">$0 &lt; \sen x &lt; 1$</span> para todo <span class="math"><em>x</em> ∈ (0, <em>π</em>/2)</span>, temos que <span class="math"><em>f</em>′(<em>x</em>) &lt; 0</span> em <span class="math">(0, <em>π</em>/2)</span>, i.e. <span class="math"><em>f</em>(<em>x</em>)</span> é monotonicamente decrescente neste intervalo. Logo, da Proposição [prop:existencia<sub>eu</sub>nicidade], temos que existe um único zero da função neste intervalo.</p>
<p>Interprete a equação <span class="math">cos(<em>x</em>) = <em>k</em><em>x</em></span> como o problema de encontrar a intersecção da curva <span class="math"><em>y</em> = cos(<em>x</em>)</span> com <span class="math"><em>y</em> = <em>k</em><em>x</em></span>. Encontre o valor positivo <span class="math"><em>k</em></span> para o qual essa equação admite exatamente duas raízes positivas distintas.</p>
<p><span class="math"><em>k</em> ≈ 0, 161228</span></p>
<p>Mostre que a equação: <br /><span class="math">$$\ln(x)+x^3-\frac{1}{x}=10$$</span><br /> possui uma única solução positiva.</p>
<p>[exer:teorema<sub>d</sub>e<sub>B</sub>olzano<sub>e</sub>xatidao] Use o teorema de Bolzano para mostrar que o erro absoluto ao aproximar o zero da função <span class="math"><em>f</em>(<em>x</em>) = <em>e</em><sup><em>x</em></sup> − <em>x</em> − 2</span> por <span class="math">$\overline{x}=-1,841$</span> é menor que <span class="math">10<sup> − 3</sup></span>.</p>
<p>Escolhendo o intervalo <span class="math">[<em>a</em>, <em>b</em>] = [ − 1, 841 − 10<sup> − 3</sup>,  − 1, 841 + 10<sup> − 3</sup>]</span>, temos <span class="math"><em>f</em>(<em>a</em>) ≈ 5 × 10<sup> − 4</sup> &gt; 0</span> e <span class="math"><em>f</em>(<em>b</em>) ≈  − 1, 2 × 10<sup> − 3</sup> &lt; 0</span>, i.e. <span class="math"><em>f</em>(<em>a</em>) ⋅ <em>f</em>(<em>b</em>) &lt; 0</span>. Então, o teorema de Bolzano nos garante que o zero exato <span class="math"><em>x</em><sup> * </sup></span> de <span class="math"><em>f</em>(<em>x</em>)</span> está no intervalo <span class="math">(<em>a</em>, <em>b</em>)</span>. Logo, da escolha feita, <span class="math">| − 1, 841 − <em>x</em><sup> * </sup>| &lt; 10<sup> − 3</sup></span>.</p>
<p>Mostre que o erro absoluto associado à aproximação <span class="math">$\overline{x} = 1,962$</span> para a solução exata <span class="math"><em>x</em><sup> * </sup></span> de: <br /><span class="math"><em>e</em><sup><em>x</em></sup> + sin(<em>x</em>) + <em>x</em> = 10</span><br /> é menor que <span class="math">10<sup> − 4</sup></span>.</p>
<p>Basta aplicar as ideias da solução do Exercício [exer:teorema<sub>d</sub>e<sub>B</sub>olzano<sub>e</sub>xatidao].</p>
<p>[existe<sub>u</sub>nica] Mostre que a equação <br /><span class="math">$$\ln(x)+x-\frac{1}{x}=v$$</span><br /> possui uma solução para cada <span class="math"><em>v</em></span> real e que esta solução é única.</p>
<h2 id="método-da-bisseção">Método da bisseção</h2>
<p>O <em>método da bisseção</em> explora o fato de que uma função contínua <span class="math"><em>f</em> : [<em>a</em>, <em>b</em>] → ℝ</span> com <span class="math"><em>f</em>(<em>a</em>) ⋅ <em>f</em>(<em>b</em>) &lt; 0</span> tem um zero no intervalo <span class="math">(<em>a</em>, <em>b</em>)</span> (veja o teorema de Bolzano [teo:teorema<sub>d</sub>e<sub>B</sub>olzano]). Assim, a ideia para aproximar o zero de uma tal função <span class="math"><em>f</em>(<em>x</em>)</span> é tomar, como primeira aproximação, o ponto médio do intervalo <span class="math">[<em>a</em>, <em>b</em>]</span>, i.e.: <br /><span class="math">$$x^{(0)} = \frac{(a + b)}{2}.$$</span><br /> Pode ocorrer de <span class="math"><em>f</em>(<em>x</em><sup>(0)</sup>) = 0</span> e, neste caso, o zero de <span class="math"><em>f</em>(<em>x</em>)</span> é <span class="math"><em>x</em><sup> * </sup> = <em>x</em><sup>(0)</sup></span>. Caso contrário, se <span class="math"><em>f</em>(<em>a</em>) ⋅ <em>f</em>(<em>x</em><sup>(0)</sup>) &lt; 0</span>, então <span class="math"><em>x</em><sup> * </sup> ∈ (<em>a</em>, <em>x</em><sup>(0)</sup>)</span>. Neste caso, tomamos como segunda aproximação do zero de <span class="math"><em>f</em>(<em>x</em>)</span> o ponto médio do intervalo <span class="math">[<em>a</em>, <em>x</em><sup>(0)</sup>]</span>, i.e. <span class="math"><em>x</em><sup>(1)</sup> = (<em>a</em> + <em>x</em><sup>(0)</sup>)/2</span>. Noutro caso, temos <span class="math"><em>f</em>(<em>x</em><sup>(0)</sup>) ⋅ <em>f</em>(<em>b</em>) &lt; 0</span> e, então, tomamos <span class="math"><em>x</em><sup>(1)</sup> = (<em>x</em><sup>(0)</sup> + <em>b</em>)/2</span>. Repetimos este procedimento até obtermos a aproximação desejada (veja, Figura [fig:metodo<sub>d</sub>a<sub>b</sub>issecao]).</p>
<div class="figure">
<embed src="./cap_equacao1d/pics/metodo_da_bissecao/metodo_da_bissecao.eps" />
<p class="caption">Método da bisseção.<span data-label="fig:metododabissecao"></span></p>
</div>
<p>De forma mais precisa, suponha que queiramos calcular uma aproximação com uma certa precisão <span class="math"><em>T</em><em>O</em><em>L</em></span> para um zero <span class="math"><em>x</em><sup> * </sup></span> de uma dada função contínua <span class="math"><em>f</em> : [<em>a</em>, <em>b</em>] → ℝ</span> tal que <span class="math"><em>f</em>(<em>a</em>) ⋅ <em>f</em>(<em>b</em>) &lt; 0</span>. Iniciamos, setamos <span class="math"><em>n</em> = 0</span> e: <br /><span class="math">$$a^{(n)} = a,\quad b^{(n)} = b\quad\text{e}\quad x^{(n)} = \frac{a^{(n)} + b^{(n)}}{2}.$$</span><br /> Verificamos o <em>critério de parada</em>, i.e. se <span class="math"><em>f</em>(<em>x</em><sup>(<em>n</em>)</sup>) = 0</span> ou: <br /><span class="math">$$\displaystyle \frac{|b^{(n)} - a^{(n)}|}{2} &lt; TOL,$$</span><br /> então <span class="math"><em>x</em><sup>(<em>n</em>)</sup></span> é a aproximação desejada. Caso contrário, preparamos a próxima iteração <span class="math"><em>n</em> + 1</span> da seguinte forma: se <span class="math"><em>f</em>(<em>a</em><sup>(<em>n</em>)</sup>) ⋅ <em>f</em>(<em>x</em><sup>(<em>n</em>)</sup>) &lt; 0</span>, então setamos <span class="math"><em>a</em><sup>(<em>n</em> + 1)</sup> = <em>a</em><sup>(<em>n</em>)</sup></span> e <span class="math"><em>b</em><sup>(<em>n</em> + 1)</sup> = <em>x</em><sup>(<em>n</em>)</sup></span>; noutro caso, se <span class="math"><em>f</em>(<em>x</em><sup>(<em>n</em>)</sup>) ⋅ <em>f</em>(<em>b</em><sup>(<em>n</em>)</sup>) &lt; 0</span>, então setamos <span class="math"><em>a</em><sup>(<em>n</em> + 1)</sup> = <em>x</em><sup>(<em>n</em>)</sup></span> e <span class="math"><em>b</em><sup>(<em>n</em> + 1)</sup> = <em>b</em><sup>(<em>n</em>)</sup></span>. Trocando <span class="math"><em>n</em></span> por <span class="math"><em>n</em> + 1</span>, temos a nova aproximação do zero de <span class="math"><em>f</em>(<em>x</em>)</span> dada por: <br /><span class="math">$$x^{(n+1)} = \frac{a^{(n+1)} + b^{(n+1)}}{2}.$$</span><br /> Voltamos a verificar o critério de parada acima e, caso não satisfeito, iteramos novamente. Iteramos até obtermos a aproximação desejada ou o número máximo de iterações ter sido atingido.</p>
<p>[ex:metodo<sub>d</sub>a<sub>b</sub>issecao]Use o método da bisseção para calcular uma solução de <span class="math"><em>e</em><sup><em>x</em></sup> = <em>x</em> + 2</span> no intervalo <span class="math">[ − 2, 0]</span> com precisão <span class="math"><em>T</em><em>O</em><em>L</em> = 10<sup> − 1</sup></span>.</p>
<p>Primeiramente, observamos que resolver a equação dada é equivalente a calcular o zero de <span class="math"><em>f</em>(<em>x</em>) = <em>e</em><sup><em>x</em></sup> − <em>x</em> − 2</span>. Além disso, temos <span class="math"><em>f</em>( − 2) ⋅ <em>f</em>(0) &lt; 0</span>. Desta forma, podemos iniciar o método da bisseção tomando o intervalo inicial <span class="math">[<em>a</em><sup>(0)</sup>, <em>b</em><sup>(0)</sup>] = [ − 2, 0]</span> e: <br /><span class="math">$$x^{(0)} = \frac{a^{(0)} + b^{(0)}}{2} = -1.$$</span><br /> Apresentamos as iterações na Tabela [tab:metodo<sub>d</sub>a<sub>b</sub>issecao]. Observamos que a precisão <span class="math"><em>T</em><em>O</em><em>L</em> = 10<sup> − 1</sup></span> foi obtida na quarta iteração com o zero de <span class="math"><em>f</em>(<em>x</em>)</span> sendo aproximado por <span class="math"><em>x</em><sup>(4)</sup> = 1, 8125</span>.</p>
<table>
<caption>Iteração do método da bisseção para o Exemplo [ex:metodo<sub>d</sub>a<sub>b</sub>issecao].<span data-label="tab:metododabissecao"></span></caption>
<thead>
<tr class="header">
<th align="left"><span class="math"><em>n</em></span></th>
<th align="center"><span class="math"><em>a</em><sup>(<em>n</em>)</sup></span></th>
<th align="center"><span class="math"><em>b</em><sup>(<em>n</em>)</sup></span></th>
<th align="center"><span class="math"><em>x</em><sup>(<em>n</em>)</sup></span></th>
<th align="center"><span class="math"><em>f</em>(<em>a</em><sup>(<em>n</em>)</sup>)<em>f</em>(<em>x</em><sup>(<em>n</em>)</sup>)</span></th>
<th align="center"><span class="math">$\displaystyle \frac{|b^{(n)}-a^{(n)}|}{2}$</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math">0</span></td>
<td align="center"><span class="math"> − 2</span></td>
<td align="center"><span class="math">0</span></td>
<td align="center"><span class="math"> − 1</span></td>
<td align="center"><span class="math"> &lt; 0</span></td>
<td align="center"><span class="math">1</span></td>
</tr>
<tr class="even">
<td align="left"><span class="math">1</span></td>
<td align="center"><span class="math"> − 2</span></td>
<td align="center"><span class="math"> − 1</span></td>
<td align="center"><span class="math"> − 1, 5</span></td>
<td align="center"><span class="math"> &lt; 0</span></td>
<td align="center"><span class="math">0, 5</span></td>
</tr>
<tr class="odd">
<td align="left"><span class="math">2</span></td>
<td align="center"><span class="math"> − 2</span></td>
<td align="center"><span class="math"> − 1, 5</span></td>
<td align="center"><span class="math"> − 1, 75</span></td>
<td align="center"><span class="math"> &lt; 0</span></td>
<td align="center"><span class="math">0, 25</span></td>
</tr>
<tr class="even">
<td align="left"><span class="math">3</span></td>
<td align="center"><span class="math"> − 2</span></td>
<td align="center"><span class="math"> − 1, 75</span></td>
<td align="center"><span class="math"> − 1, 875</span></td>
<td align="center"><span class="math"> &gt; 0</span></td>
<td align="center"><span class="math">0, 125</span></td>
</tr>
<tr class="odd">
<td align="left"><span class="math">4</span></td>
<td align="center"><span class="math"> − 1, 875</span></td>
<td align="center"><span class="math"> − 1, 75</span></td>
<td align="center"><span class="math"> − 1, 8125</span></td>
<td align="center"><span class="math"> &lt; 0</span></td>
<td align="center"><span class="math">0, 0625</span></td>
</tr>
</tbody>
</table>
<p>Usando o <code>Scilab</code> neste exemplos, temos:</p>
<pre><code>--&gt;deff(&#39;y = f(x)&#39;,&#39;y = exp(x) - x - 2&#39;)
--&gt;a=-2, b=0, x=(a+b)/2, TOL = (b-a)/2, sign(f(a)*f(x))
--&gt;b=x, x=(a+b)/2, TOL = (b-a)/2, sign(f(a)*f(x))</code></pre>
<p>e, assim, sucessivamente.</p>
<p>Vamos, agora, discutir sobre a <em>convergência</em> do método da bisseção. O próximo Teorema [teo:convergencia<sub>b</sub>issecao] nos garante a convergência do método da bisseção.</p>
<p>[Convergência do método da bisseção][teo:convergencia<sub>b</sub>issecao] Sejam <span class="math"><em>f</em> : [<em>a</em>, <em>b</em>] → ℝ</span> uma função contínua tal que <span class="math"><em>f</em>(<em>a</em>) ⋅ <em>f</em>(<em>b</em>) &lt; 0</span> e <span class="math"><em>x</em><sup> * </sup></span> o único zero de <span class="math"><em>f</em>(<em>x</em>)</span> no intervalo <span class="math">(<em>a</em>, <em>b</em>)</span>. Então, a sequência <span class="math">{<em>x</em><sup>(<em>n</em>)</sup>}<sub><em>n</em> &gt;  = 0</sub></span> do método da bisseção satisfaz: <br /><span class="math">$$|x^{(n)} - x^{*}| &lt; \frac{b - a}{2^{n+1}},\quad\forall n\geq 0,$$</span><br /> i.e., <span class="math"><em>x</em><sup>(<em>n</em>)</sup> → <em>x</em><sup> * </sup></span> quando <span class="math"><em>n</em> → ∞</span>.</p>
<p>Notemos que, a cada iteração, a distância entre a aproximação <span class="math"><em>x</em><sup>(<em>n</em>)</sup></span> e o zero <span class="math"><em>x</em><sup> * </sup></span> da função é menor que a metade do tamanho do intervalo <span class="math">[<em>a</em><sup>(<em>n</em>)</sup>, <em>b</em><sup>(<em>n</em>)</sup>]</span> (veja Figura [fig:metodo<sub>d</sub>a<sub>b</sub>issecao]), i.e.: <br /><span class="math">$$|x^{(n)}-x^*| &lt; \frac{b^{(n)}-a^{(n)}}{2}.$$</span><br /> Por construção do método, temos <span class="math">[<em>a</em><sup>(<em>n</em>)</sup>, <em>b</em><sup>(<em>n</em>)</sup>] ⊂ [<em>a</em><sup>(<em>n</em> − 1)</sup>, <em>b</em><sup>(<em>n</em> − 1)</sup>]</span> e: <br /><span class="math">$$b^{(n)} - a^{(n)} = \frac{b^{(n-1)}-a^{(n-1)}}{2}.$$</span><br /> Desta forma: <br /><span class="math">$$|x^{(n)}-x^*|  &lt; \frac{b^{(n)}-a^{(n)}}{2} = \frac{b^{(n-1)}-a^{(n-1)}}{2^2} = \cdots = \frac{b^{(0)}-a^{(0)}}{2^{n+1}},\quad \forall n\geq 1.$$</span><br /> Logo, vemos que: <br /><span class="math">$$|x^{(n)}-x^*|  &lt; \frac{b-a}{2^{n+1}},\quad \forall n\geq 0.$$</span><br /></p>
<p>Observamos que a hipótese de que <span class="math"><em>f</em>(<em>x</em>)</span> tenha um único zero no intervalo não é necessária. Se a função tiver mais de um zero no intervalo inicial, as iterações irão convergir para um dos zeros. Veja o Exercício [exer:raizes<sub>m</sub>ultiplas].</p>
<p>O Teorema [teo:convergencia<sub>b</sub>issecao] nos fornece uma estimativa para a convergência do método da bisseção. Aproximadamente, temos: <br /><span class="math">$$|x^{(n+1)} - x^*| \lesssim \frac{1}{2}|x^{(n+1)} - x^*|.$$</span><br /> Isto nos leva a concluir que o método da bisseção tem <em>taxa de convergência</em> linear.</p>
<p>No Exemplo [ex:metodo<sub>d</sub>a<sub>b</sub>issecao], precisamos de <span class="math">4</span> iterações do método da bisseção para computar uma aproximação com precisão de <span class="math">10<sup> − 1</sup></span> do zero de <span class="math"><em>f</em>(<em>x</em>) = <em>e</em><sup><em>x</em></sup> − <em>x</em> − 2</span> tomando como intervalo inicial <span class="math">[<em>a</em>, <em>b</em>] = [ − 2, 0]</span>. Poderíamos ter estimado o número de iterações <em>a priori</em>, pois, como vimos acima: <br /><span class="math">$$|x^{(n)}-x^*|\leq \frac{b-a}{2^{n+1}},\quad n\geq 0.$$</span><br /> Logo, temos: <br /><span class="math">$$\begin{aligned}
  |x^{(n)} - x^*| &amp;&lt; \frac{b - a}{2^{n+1}} = \frac{2}{2^{n+1}}\\
  &amp;= 2^{-n} &lt; 10^{-1} \Rightarrow  n &gt; -\log_2 10^{-1} \approx 3,32.\end{aligned}$$</span><br /> O que está de acordo com o experimento numérico realizado naquele exemplo.</p>
<p>O método da bisseção tem a boa propriedade de garantia de convergência, bem como de fornecer uma simples estimativa da precisão da aproximação calculada. Entretanto, a taxa de convergência linear é superada por outros métodos. A construção de tais métodos está, normalmente, associada a iteração do ponto fixo, a qual exploramos na próxima seção.</p>
<h3 id="código-scilab-método-da-bisseção">Código Scilab: método da bisseção</h3>
<p>O seguinte código é uma implementação no <code>Scilab</code> do algoritmo da bisseção. As variáveis de entrada são:</p>
<ul>
<li><p><code>f</code> - função objetivo</p></li>
<li><p><code>a</code> - extremo esquerdo do intervalo de inspeção <span class="math">[<em>a</em>, <em>b</em>]</span></p></li>
<li><p><code>b</code> - extremo direito do intervalo de inspeção <span class="math">[<em>a</em>, <em>b</em>]</span></p></li>
<li><p><code>TOL</code> - tolerância (critério de parada)</p></li>
<li><p><code>N</code> - número máximo de iterações</p></li>
</ul>
<p>A variável de saída é:</p>
<ul>
<li><p><code>p</code> - aproximação da raiz de <code>f</code>, i.e. <span class="math"><em>f</em>(<em>p</em>) ≈ 0</span>.</p></li>
</ul>
<h2 id="exercícios-6" class="unnumbered">Exercícios</h2>
<p>Considere a equação <span class="math">$\sqrt{x}=\cos(x)$</span>. Use o método da bisseção com intervalo inicial <span class="math">[<em>a</em>, <em>b</em>] = [0, 1]</span> e <span class="math"><em>x</em><sup>(1)</sup> = (<em>a</em> + <em>b</em>)/2</span> para calcular a aproximação <span class="math"><em>x</em><sup>(4)</sup></span> da solução desta equação.</p>
<p>Trace o gráfico e isole as três primeiras raízes positivas da função: <br /><span class="math">$$f(x)=5\sin(x^2)-\exp\left({\frac{x}{10}}\right)$$</span><br /> em intervalos de comprimento <span class="math">0, 1</span>. Então, use o método da bisseção para obter aproximações dos zeros desta função com precisão de <span class="math">10<sup> − 5</sup></span>.</p>
<p>A primeira raiz se encontra no intervalo <span class="math">(0, 4, 0, 5)</span>. A segunda raiz no intervalo <span class="math">(1, 7, 1, 8)</span>. A terceira raiz se encontra no intervalo <span class="math">(2, 5, 2, 6)</span>.</p>
<p>[exer:raizes<sub>m</sub>ultiplas] O polinômio <span class="math"><em>p</em>(<em>x</em>) =  − 4 + 8<em>x</em> − 5<em>x</em><sup>2</sup> + <em>x</em><sup>3</sup></span> tem raízes <span class="math"><em>x</em><sub>1</sub> = 1</span> e <span class="math"><em>x</em><sub>2</sub> = <em>x</em><sub>3</sub> = 2</span> no intervalo <span class="math">[1/2, 3]</span>.</p>
<ul>
<li><p>Se o método da bisseção for usando com o intervalo inicial <span class="math">[1/2, 3]</span>, para qual raiz as iterações convergem?</p></li>
<li><p>É possível usar o método da bisseção para a raiz <span class="math"><em>x</em> = 2</span>? Justifique sua resposta.</p></li>
</ul>
<p>Mostre que a equação do problema [existe<sub>u</sub>nica] possui uma solução no intervalo <span class="math">[1, <em>v</em> + 1]</span> para todo <span class="math"><em>v</em></span> positivo. Dica: defina <span class="math">$f(x)=\ln(x)+x-\frac{1}{x}-v$</span> e considere a seguinte estimativa: <br /><span class="math"><em>f</em>(<em>v</em> + 1) = <em>f</em>(1) + ∫<sub>1</sub><sup><em>v</em> + 1</sup><em>f</em>′(<em>x</em>)<em>d</em><em>x</em> ≥  − <em>v</em> + ∫<sub>1</sub><sup><em>v</em> + 1</sup><em>d</em><em>x</em> = 0.</span><br /> Use esta estimativa para iniciar o método de bisseção e obtenha o valor da raiz com pelo menos 6 algarismos significativos para <span class="math"><em>v</em> = 1, 2, 3, 4</span> e <span class="math">5</span>.</p>
<p><span class="math">1, 390054</span>; <span class="math">1, 8913954</span>; <span class="math">2, 4895673</span>; <span class="math">3, 1641544</span>; <span class="math">3, 8965468</span></p>
<p>[title=Estática] Considere o seguinte problema físico: uma plataforma está fixa a uma parede através de uma dobradiça cujo momento é dado por: <br /><span class="math"><em>τ</em> = <em>k</em><em>θ</em>, </span><br /> onde <span class="math"><em>θ</em></span> é angulo da plataforma com a horizontal e <span class="math"><em>k</em></span> é uma constante positiva. A plataforma é feita de material homogêneo, seu peso é <span class="math"><em>P</em></span> e sua largura é <span class="math"><em>l</em></span>. Modele a relação entre o ângulo <span class="math"><em>θ</em></span> e o peso <span class="math"><em>P</em></span> próprio da plataforma. Encontre o valor de <span class="math"><em>θ</em></span> quando <span class="math"><em>l</em> = 1 <em>m</em></span>, <span class="math"><em>P</em> = 200 <em>N</em></span>, <span class="math"><em>k</em> = 50 <em>N</em><em>m</em>/<em>r</em><em>a</em><em>d</em></span>, sabendo que o sistema está em equilíbrio. Use o método da bisseção e expresse o resultado com 4 algarismos significativos.</p>
<p><span class="math">$k\theta=\frac{lP}{2}\cos(\theta)$</span> com <span class="math"><em>θ</em> ∈ (0, <em>π</em>/2)</span>; <span class="math">1, 030</span>.</p>
<p>Considere a equação de Lambert dada por: <br /><span class="math"><em>x</em><em>e</em><sup><em>x</em></sup> = <em>t</em>, </span><br /> onde <span class="math"><em>t</em></span> é um número real positivo. Mostre que esta equação possui uma única solução <span class="math"><em>x</em><sup> * </sup></span> que pertence ao intervalo <span class="math">[0, <em>t</em>]</span>. Usando esta estimativa como intervalo inicial, quantos passos são necessário para obter o valor numérico de <span class="math"><em>x</em><sup> * </sup></span> com erro absoluto inferior a <span class="math">10<sup> − 6</sup></span> quando <span class="math"><em>t</em> = 1</span>, <span class="math"><em>t</em> = 10</span> e <span class="math"><em>t</em> = 100</span> através do método da bisseção? Obtenha esses valores.</p>
<p><span class="math">19</span>; <span class="math">23</span>; <span class="math">26</span>; <span class="math">0, 567143</span>; <span class="math">1, 745528</span>; <span class="math">3, 385630</span></p>
<p>[prob<sub>r</sub>aiz<sub>d</sub>upla] O polinômio <span class="math"><em>f</em>(<em>x</em>) = <em>x</em><sup>4</sup> − 4<em>x</em><sup>2</sup> + 4</span> possui raízes duplas em <span class="math">$\sqrt{2}$</span> e <span class="math">$-\sqrt{2}$</span>. O método da bisseção pode ser aplicados a <span class="math"><em>f</em></span>? Explique.</p>
<p>[title=Eletrônica][prob<sub>d</sub>iodo] O desenho abaixo mostra um circuito não linear envolvendo uma fonte de tensão constante, um diodo retificador e um resistor. Sabendo que a relação entre a corrente (<span class="math"><em>I</em><sub><em>d</em></sub>)</span> e a tensão (<span class="math"><em>v</em><sub><em>d</em></sub></span>) no diodo é dada pela seguinte expressão: <br /><span class="math">$$I_d=I_R\left(\exp\left(\frac{v_d}{v_t}\right)-1\right),$$</span><br /> onde <span class="math"><em>I</em><sub><em>R</em></sub></span> é a corrente de condução reversa e <span class="math"><em>v</em><sub><em>t</em></sub></span>, a tensão térmica dada por <span class="math">$v_t=\frac{kT}{q}$</span> com <span class="math"><em>k</em></span>, a constante de Boltzmann, <span class="math"><em>T</em></span> a temperatura de operação e <span class="math"><em>q</em></span>, a carga do elétron. Aqui <span class="math"><em>I</em><sub><em>R</em></sub> = 1<em>p</em><em>A</em> = 10<sup> − 12</sup> <em>A</em></span>, <span class="math"><em>T</em> = 300 <em>K</em></span>. Escreva o problema como uma equação na incógnita <span class="math"><em>v</em><sub><em>d</em></sub></span> e, usando o método da bisseção, resolva este problema com 3 algarismos significativos para os seguintes casos:</p>
<p>[l]<span>0.6</span></p>
<ul>
<li><p><span class="math"><em>V</em> = 30 <em>V</em></span> e <span class="math"><em>R</em> = 1 <em>k</em>Ω</span>.</p></li>
<li><p><span class="math"><em>V</em> = 3 <em>V</em></span> e <span class="math"><em>R</em> = 1 <em>k</em>Ω</span>.</p></li>
<li><p><span class="math"><em>V</em> = 3 <em>V</em></span> e <span class="math"><em>R</em> = 10 <em>k</em>Ω</span>.</p></li>
<li><p><span class="math"><em>V</em> = 300 <em>m</em><em>V</em></span> e <span class="math"><em>R</em> = 1 <em>k</em>Ω</span>.</p></li>
<li><p><span class="math"><em>V</em> =  − 300 <em>m</em><em>V</em></span> e <span class="math"><em>R</em> = 1 <em>k</em>Ω</span>.</p></li>
<li><p><span class="math"><em>V</em> =  − 30 <em>V</em></span> e <span class="math"><em>R</em> = 1 <em>k</em>Ω</span>.</p></li>
<li><p><span class="math"><em>V</em> =  − 30 <em>V</em></span> e <span class="math"><em>R</em> = 10 <em>k</em>Ω</span>.</p></li>
</ul>
<p>[c]<span>0.4</span> <embed src="./cap_equacao1d/pics/circuito_diodo.eps" /></p>
<p><br />Dica: <span class="math"><em>V</em> = <em>R</em><em>I</em><sub><em>d</em></sub> + <em>v</em><sub><em>d</em></sub></span>.</p>
<p>a) <span class="math">0, 623</span>; b) <span class="math">0, 559</span>; c) <span class="math">0, 500</span>; d) <span class="math">0, 300</span>; e) <span class="math"> − 0, 3</span>; f) <span class="math"> − 30</span>; g) <span class="math"> − 30</span></p>
<p>[title= Propagação de erros] Obtenha os valores de <span class="math"><em>I</em><sub><em>d</em></sub></span> no problema [prob<sub>d</sub>iodo]. Lembre que existem duas expressões disponíveis: <br /><span class="math">$$I_d=I_R\left(\exp\left(\frac{v_d}{v_t}\right)-1\right)$$</span><br /> e <br /><span class="math">$$I_d=\frac{v-v_d}{R}$$</span><br /> Faça o estudo da propagação do erro e decida qual a melhor expressão em cada caso.</p>
<p>a) <span class="math">0, 0294</span>; b) <span class="math">2.44<em>e</em> − 3</span>; c) <span class="math">2.50<em>e</em> − 4</span>; d) <span class="math">1.09 ⋅ 10<sup> − 7</sup></span>; e) <span class="math"> − 10<sup> − 12</sup></span>; f) <span class="math"> − 10<sup> − 12</sup></span>; g) <span class="math"> − 10<sup> − 12</sup></span></p>
<h2 id="iteração-de-ponto-fixo">Iteração de Ponto Fixo</h2>
<p>Nesta seção, discutimos a abordagem da <em>iteração do ponto fixo</em> para a solução numérica de equações de uma variável real. Observamos que sempre podemos reescrever uma equação da forma <span class="math"><em>f</em>(<em>x</em>) = 0</span> (problema de encontrar os zeros de uma função) em uma equação equivalente na forma <span class="math"><em>g</em>(<em>x</em>) = <em>x</em></span> (<em>problema de ponto fixo</em>). Um ponto <span class="math"><em>x</em> = <em>x</em><sup> * </sup></span> tal que <span class="math"><em>g</em>(<em>x</em><sup> * </sup>) = <em>x</em><sup> * </sup></span> é chamado de <em>ponto fixo</em> da função <span class="math"><em>g</em>(<em>x</em>)</span>. Geometricamente, um ponto fixo de uma função é um ponto de interseção entre a reta <span class="math"><em>y</em> = <em>x</em></span> com o gráfico da função (veja, Figura [fig:defn<sub>p</sub>onto<sub>f</sub>ixo]).</p>
<div class="figure">
<embed src="./cap_equacao1d/pics/defn_ponto_fixo/defn_ponto_fixo.eps" />
<p class="caption">Ponto fixo <span class="math"><em>g</em>(<em>x</em><sup> * </sup>) = <em>x</em><sup> * </sup></span>.<span data-label="fig:defnpontofixo"></span></p>
</div>
<p>[ex:ponto<sub>f</sub>ixo<sub>1</sub>] Resolver a equação <span class="math"><em>e</em><sup><em>x</em></sup> = <em>x</em> + 2</span> é equivalente a resolver <span class="math"><em>f</em>(<em>x</em>) = 0</span>, com <span class="math"><em>f</em>(<em>x</em>) = <em>e</em><sup><em>x</em></sup> − <em>x</em> − 2</span>. Estes são equivalentes a resolver <span class="math"><em>g</em>(<em>x</em>) = <em>x</em></span>, com <span class="math"><em>g</em>(<em>x</em>) = <em>e</em><sup><em>x</em></sup> − 2</span>. Ou seja, temos: <br /><span class="math"><em>e</em><sup><em>x</em></sup> = <em>x</em> + 2 ⇔ <em>e</em><sup><em>x</em></sup> − <em>x</em> − 2 = 0 ⇔ <em>e</em><sup><em>x</em></sup> − 2 = <em>x</em></span><br /></p>
<p>Dada uma função <span class="math"><em>g</em>(<em>x</em>)</span>, a <em>iteração do ponto fixo</em> consiste em computar a seguinte sequência recursiva: <br /><span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>g</em>(<em>x</em><sup>(<em>n</em>)</sup>),  <em>n</em> ≥ 1, </span><br /> onde <span class="math"><em>x</em><sup>(1)</sup></span> é uma aproximação inicial do ponto fixo.</p>
<p>[Método babilônico] O método babilônico<a href="#fn8" class="footnoteRef" id="fnref8"><sup>8</sup></a> é de uma iteração de ponto fixo para extrair a raiz quadrada de um número positivo <span class="math"><em>A</em></span>, i.e. para resolver a equação <span class="math"><em>x</em><sup>2</sup> = <em>A</em></span>.</p>
<p>Seja <span class="math"><em>r</em> &gt; 0</span> uma aproximação para <span class="math">$\sqrt{A}$</span>. Temos três possibilidades:</p>
<ul>
<li><p><span class="math">$r&gt;\sqrt{A} \Longrightarrow \frac{A}{r}&lt;\sqrt{A} \Longrightarrow \sqrt{A}\in \left(\frac{A}{r}, r\right)$</span></p></li>
<li><p><span class="math">$r=\sqrt{A} \Longrightarrow \frac{A}{r}=\sqrt{A}$</span></p></li>
<li><p><span class="math">$r&lt;\sqrt{A} \Longrightarrow \frac{A}{r}&gt;\sqrt{A} \Longrightarrow \sqrt{A}\in \left(r, \frac{A}{r}\right)$</span></p></li>
</ul>
<p>Ou seja, uma aproximação melhor para <span class="math">$\sqrt{A}$</span> está no intervalo entre <span class="math"><em>r</em></span> e <span class="math">$\frac{A}{r}$</span> que pode ser aproximada como: <br /><span class="math">$$x=\frac{r+\frac{A}{r}}{2}$$</span><br /></p>
<p>Aplicando esse método repetidas vezes, podemos construir a iteração (de ponto fixo): <br /><span class="math">$$\begin{aligned}
x^{(1)}&amp;=&amp;r \\
x^{(n+1)}&amp;=&amp;\frac{x^{(n)}}{2}+\frac{A}{2x^{(n)}}, \quad n=1,2,3,...\end{aligned}$$</span><br /></p>
<p>Por exemplo, para obter uma aproximação para <span class="math">$\sqrt{5}$</span>, podemos iniciar com a aproximação inicial <span class="math"><em>r</em> = 2</span> e <span class="math"><em>A</em> = 5</span>. Então, tomamos <span class="math"><em>x</em><sup>(1)</sup> = 2</span> e daí seguem as aproximações: <br /><span class="math">$$\begin{aligned}
x^{(2)}=&amp;\frac{2}{2}+\frac{2,5}{2} = 2,25\\
x^{(3)}=&amp;\frac{2,25}{2}+\frac{2,5}{2,25}= 2,2361111  \\
x^{(4)}=&amp;\frac{2,2361111}{2}+\frac{2,5}{2,2361111}= 2,236068  \\
x^{(5)}=&amp;\frac{2,236068}{2}+\frac{2,5}{2,236068}= 2,236068\end{aligned}$$</span><br /></p>
<p>O método babilônico sugere que a iteração do ponto fixo pode ser uma abordagem eficiente para a solução de equações. Ficam, entretanto, as seguintes perguntas:</p>
<ol>
<li><p>Será que a iteração do ponto fixo é convergente?</p></li>
<li><p>Caso seja convergente, será que o limite <span class="math"><em>x</em><sup> * </sup> = lim<sub><em>n</em> → ∞</sub><em>x</em><sup>(<em>n</em>)</sup></span> é um ponto fixo?</p></li>
<li><p>Caso seja convergente, qual é a taxa de convergência?</p></li>
</ol>
<p>A segunda pergunta é a mais fácil de ser respondida. No caso de <span class="math"><em>g</em>(<em>x</em>)</span> ser contínua, se <span class="math">$x^{(n)}\to x^*\in\Dom(g)$</span>, então: <br /><span class="math"><em>x</em><sup> * </sup> = lim<sub><em>n</em> → ∞</sub><em>x</em><sup>(<em>n</em>)</sup> = lim<sub><em>n</em> → ∞</sub><em>g</em>(<em>x</em><sup>(<em>n</em> − 1)</sup>) = <em>g</em>(lim<sub><em>n</em> → ∞</sub><em>x</em><sup>(<em>n</em> − 1)</sup>) = <em>g</em>(<em>x</em><sup> * </sup>).</span><br /></p>
<p>Antes de respondermos as perguntas acima, vejamos mais um exemplo.</p>
<p>[ex:ponto<sub>f</sub>ixo<sub>2</sub>] Considere o problema de encontrar o zero da função <span class="math"><em>f</em>(<em>x</em>) = <em>x</em>exp(<em>x</em>) − 10</span>. Uma maneira geral de construir um problema de ponto fixo equivalente é o seguinte: <br /><span class="math"><em>f</em>(<em>x</em>) = 0 ⇒ <em>α</em><em>f</em>(<em>x</em>) = 0 ⇒ <em>x</em> − <em>α</em><em>f</em>(<em>x</em>) = <em>x</em>, </span><br /> para qualquer parâmetro <span class="math"><em>α</em> ≠ 0</span>. Consideremos, então, as seguintes duas funções: <br /><span class="math"><em>g</em><sub>1</sub>(<em>x</em>) = <em>x</em> − 0, 5<em>f</em>(<em>x</em>) e <em>g</em><sub>2</sub>(<em>x</em>) = <em>x</em> − 0, 05<em>f</em>(<em>x</em>).</span><br /> Notamos que o ponto fixo destas duas funções coincide com o zero de <span class="math"><em>f</em>(<em>x</em>)</span>. Construindo as iterações do ponto fixo: <br /><span class="math"><em>x</em><sub>1</sub><sup>(<em>n</em> + 1)</sup> = <em>g</em><sub>1</sub>(<em>x</em><sub>1</sub><sup>(<em>n</em>)</sup>) e <em>x</em><sub>2</sub><sup>(<em>n</em> + 1)</sup> = <em>g</em><sub>2</sub>(<em>x</em><sub>2</sub><sup>(<em>n</em>)</sup>), </span><br /> tomando <span class="math"><em>x</em><sub>1</sub><sup>(1)</sup> = <em>x</em><sub>2</sub><sup>(1)</sup> = 1, 7</span>, obtemos os resultados apresentados na Tabela [tab:ponto<sub>f</sub>ixo<sub>2</sub>]. Observamos que, enquanto, a iteração do ponto fixo com a função <span class="math"><em>g</em><sub>1</sub>(<em>x</em>)</span> (<span class="math"><em>α</em> = 0, 5</span>) parece divergir, a iteração com a função <span class="math"><em>g</em><sub>2</sub>(<em>x</em>)</span> (<span class="math"><em>α</em> = 0, 05</span>) parece convergir.</p>
<table>
<caption>Iterações do ponto fixo para o Exemplo [ex:ponto<sub>f</sub>ixo<sub>2</sub>].<span data-label="tab:pontofixo2"></span></caption>
<thead>
<tr class="header">
<th align="center"><span class="math"><em>n</em></span></th>
<th align="right"><span class="math"><em>x</em><sub>1</sub><sup>(<em>n</em>)</sup></span></th>
<th align="right"><span class="math"><em>x</em><sub>2</sub><sup>(<em>n</em>)</sup></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math">1</span></td>
<td align="right"><span class="math">1, 700</span></td>
<td align="right"><span class="math">1, 700</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">2</span></td>
<td align="right"><span class="math">2, 047</span></td>
<td align="right"><span class="math">1, 735</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">3</span></td>
<td align="right"><span class="math"> − 0, 8812</span></td>
<td align="right"><span class="math">1, 743</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">4</span></td>
<td align="right"><span class="math">4, 3013</span></td>
<td align="right"><span class="math">1, 746</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">5</span></td>
<td align="right"><span class="math"> − 149, 4</span></td>
<td align="right"><span class="math">1, 746</span></td>
</tr>
</tbody>
</table>
<p>Afim de estudarmos a convergência da iteração do ponto fixo, apresentamos o Teorema do ponto fixo.</p>
<h3 id="teorema-do-ponto-fixo">Teorema do ponto fixo</h3>
<p>O Teorema do ponto fixo nos fornece condições suficientes para a existência e unicidade do ponto fixo, bem como para a convergência das iterações do método.</p>
<p>Uma <em>contração</em> é uma função real <span class="math"><em>g</em> : [<em>a</em>, <em>b</em>] → [<em>a</em>, <em>b</em>]</span> tal que: <br /><span class="math">|<em>g</em>(<em>x</em>) − <em>g</em>(<em>y</em>)| ≤ <em>β</em>|<em>x</em> − <em>y</em>|,  0 ≤ <em>β</em> &lt; 1.</span><br /></p>
<p>Seja <span class="math"><em>g</em> : [<em>a</em>, <em>b</em>] → [<em>a</em>, <em>b</em>]</span>, y=g(x).</p>
<ul>
<li><p>Se <span class="math"><em>g</em>(<em>x</em>)</span> é uma contração, então <span class="math"><em>g</em>(<em>x</em>)</span> função contínua.</p></li>
<li><p>Se <span class="math">|<em>g</em>′(<em>x</em>)| &lt; <em>k</em></span>, <span class="math">0 &lt; <em>k</em> &lt; 1</span>, para todo <span class="math"><em>x</em> ∈ [<em>a</em>, <em>b</em>]</span>, então <span class="math"><em>g</em>(<em>x</em>)</span> é uma contração.</p></li>
</ul>
<p>[Teorema do ponto fixo] Se <span class="math"><em>g</em> : [<em>a</em>, <em>b</em>] → [<em>a</em>, <em>b</em>]</span> é uma contração, então existe um único ponto <span class="math"><em>x</em><sup> * </sup> ∈ [<em>a</em>, <em>b</em>]</span> tal que <span class="math"><em>g</em>(<em>x</em><sup> * </sup>) = <em>x</em><sup> * </sup></span>, i.e. <span class="math"><em>x</em><sup> * </sup></span> é ponto fixo de <span class="math"><em>g</em>(<em>x</em>)</span>. Além disso, a sequência <span class="math">{<em>x</em><sup>(<em>n</em>)</sup>}<sub><em>n</em> ∈ ℕ</sub></span> dada por: <br /><span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>g</em>(<em>x</em><sup>(<em>n</em>)</sup>)</span><br /> converge para <span class="math"><em>x</em><sup> * </sup></span> para qualquer <span class="math"><em>x</em><sup>(1)</sup> ∈ [<em>a</em>, <em>b</em>]</span>.</p>
<p>Começamos demonstrando que existe pelo menos um ponto fixo. Para tal definimos a função <span class="math"><em>f</em>(<em>x</em>) = <em>x</em> − <em>g</em>(<em>x</em>)</span> e observamos que: <br /><span class="math"><em>f</em>(<em>a</em>) = <em>a</em> − <em>g</em>(<em>a</em>) ≤ <em>a</em> − <em>a</em> = 0</span><br /> e <br /><span class="math"><em>f</em>(<em>b</em>) = <em>b</em> − <em>g</em>(<em>b</em>) ≥ <em>b</em> − <em>b</em> = 0</span><br /> Se <span class="math"><em>f</em>(<em>a</em>) = <em>a</em></span> ou <span class="math"><em>f</em>(<em>b</em>) = <em>b</em></span>, então o ponto fixo existe. Caso contrário, as desigualdades são estritas e a <span class="math"><em>f</em>(<em>x</em>)</span> muda de sinal no intervalo. Como esta função é contínua, pelo teorema de Bolzano [teo:teorema<sub>d</sub>e<sub>B</sub>olzano], existe um ponto <span class="math"><em>x</em><sup> * </sup></span> no intervalo <span class="math">(<em>a</em>, <em>b</em>)</span> tal que <span class="math"><em>f</em>(<em>x</em><sup> * </sup>) = 0</span>, ou seja, <span class="math"><em>g</em>(<em>x</em><sup> * </sup>) = <em>x</em><sup> * </sup></span>. Isto mostra a existência.</p>
<p>Para provar que o ponto fixo é único, observamos que se <span class="math"><em>x</em><sup> * </sup></span> e <span class="math"><em>x</em><sup> *  * </sup></span> são pontos fixos, eles devem ser iguais, pois: <br /><span class="math">|<em>x</em><sup> * </sup> − <em>x</em><sup> *  * </sup>| = |<em>g</em>(<em>x</em><sup> * </sup>) − <em>g</em>(<em>x</em><sup> *  * </sup>)| ≤ <em>β</em>|<em>x</em><sup> * </sup> − <em>x</em><sup> *  * </sup>|.</span><br /> A desigualdade <span class="math">|<em>x</em><sup> * </sup> − <em>x</em><sup> *  * </sup>| ≤ <em>β</em>|<em>x</em><sup> * </sup> − <em>x</em><sup> *  * </sup>|</span> com <span class="math">0 ≤ <em>β</em> &lt; 1</span> implica <span class="math">|<em>x</em><sup> * </sup> − <em>x</em><sup> *  * </sup>| = 0</span>.</p>
<p>Para demonstrar a convergência da sequência, observamos que: <br /><span class="math">|<em>x</em><sup>(<em>n</em> + 1)</sup> − <em>x</em><sup> * </sup>| = |<em>g</em>(<em>x</em><sup>(<em>n</em>)</sup>) − <em>x</em><sup> * </sup>| = |<em>g</em>(<em>x</em><sup>(<em>n</em>)</sup>) − <em>g</em>(<em>x</em><sup> * </sup>)| ≤ <em>β</em>|<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup> * </sup>|.</span><br /> Daí, temos: <br /><span class="math">|<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup> * </sup>| ≤ <em>β</em>|<em>x</em><sup>(<em>n</em> − 1)</sup> − <em>x</em><sup> * </sup>| ≤ <em>β</em><sup>2</sup>|<em>x</em><sup>(<em>n</em> − 2)</sup> − <em>x</em><sup> * </sup>| ≤ ⋯ ≤ <em>β</em><sup><em>n</em></sup>|<em>x</em><sup>(0)</sup> − <em>x</em><sup> * </sup>|.</span><br /> Portanto, como <span class="math">0 ≤ <em>β</em> &lt; 1</span>, temos: <br /><span class="math">lim<sub><em>n</em> → ∞</sub>|<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup> * </sup>| = 0, </span><br /> ou seja, <span class="math"><em>x</em><sup>(<em>n</em>)</sup> → <em>x</em><sup> * </sup></span> quando <span class="math"><em>n</em> → ∞</span>.</p>
<p>[ex:ponto<sub>f</sub>ixo<sub>3</sub>] Mostre que o Teorema do ponto fixo se aplica a função <span class="math"><em>g</em>(<em>x</em>) = cos(<em>x</em>)</span> no intervalo <span class="math">[1/2, 1]</span>, i.e. que a iteração do ponto fixo converge para a solução da equação <span class="math">cos<em>x</em> = <em>x</em></span>.</p>
<p>Basta mostrarmos que:</p>
<ol>
<li><p><span class="math"><em>g</em>([1/2, 1]) ⊆ [1/2, 1]</span>;</p></li>
<li><p><span class="math">|<em>g</em>′(<em>x</em>)| &lt; <em>β</em>,  0 &lt; <em>β</em> &lt; 1,  ∀<em>x</em> ∈ [1/2, 1]</span>.</p></li>
</ol>
<p>Para provar a), observamos que <span class="math"><em>g</em>(<em>x</em>)</span> é decrescente no intervalo, pelo que temos: <br /><span class="math">0, 54 &lt; cos(1) ≤ cos(<em>x</em>) ≤ cos(1/2) &lt; 0, 88</span><br /> Como <span class="math">[0, 54,  0, 88] ⊆ [0, 5,  1]</span>, temos o item a).</p>
<p>Para provar o item b), observamos que: <br /><span class="math"><em>g</em>′(<em>x</em>) =  − sin(<em>x</em>).</span><br /> Da mesma forma, temos a estimativa: <br /><span class="math"> − 0, 85 &lt;  − sin(1) ≤  − sin(<em>x</em>) ≤  − sin(1/2) &lt;  − 0, 47.</span><br /> Assim, <span class="math">|<em>g</em>′(<em>x</em>)| &lt; 0, 85</span> temos a desigualdade com <span class="math"><em>β</em> = 0, 85 &lt; 1</span>.</p>
<p>A Tabela [tab:ponto<sub>f</sub>ixo<sub>3</sub>] apresenta o comportamento numérico da iteração do ponto fixo: <br /><span class="math">$$\begin{aligned}
x^{(1)} &amp; = 0,7\\
x^{(n+1)} &amp;= \cos(x^{(n)}),\quad n\geq 1.\end{aligned}$$</span><br /></p>
<table>
<caption>Iteração do ponto fixo para o Exemplo [ex:ponto<sub>f</sub>ixo<sub>3</sub>].<span data-label="tab:pontofixo3"></span></caption>
<thead>
<tr class="header">
<th align="center"><span class="math"><em>n</em></span></th>
<th align="center"><span class="math"><em>x</em><sup>(<em>n</em>)</sup></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math">1</span></td>
<td align="center"><span class="math">0, 700</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">2</span></td>
<td align="center"><span class="math">0, 765</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">3</span></td>
<td align="center"><span class="math">0, 721</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">4</span></td>
<td align="center"><span class="math">0, 751</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">5</span></td>
<td align="center"><span class="math">0, 731</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">6</span></td>
<td align="center"><span class="math">0, 744</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">7</span></td>
<td align="center"><span class="math">0, 735</span></td>
</tr>
</tbody>
</table>
<h3 id="teste-de-convergência">Teste de convergência</h3>
<p>Seja <span class="math"><em>g</em> : [<em>a</em>, <em>b</em>]</span> uma função <span class="math"><em>C</em><sup>0</sup>[<em>a</em>, <em>b</em>]</span> e <span class="math"><em>x</em><sup> * </sup> ∈ (<em>a</em>, <em>b</em>)</span> um ponto fixo de <span class="math"><em>g</em></span>. Então <span class="math"><em>x</em><sup> * </sup></span> é dito estável se existe uma região <span class="math">(<em>x</em><sup> * </sup> − <em>δ</em>, <em>x</em><sup> * </sup> + <em>δ</em>)</span> chamada bacia de atração tal que <span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>g</em>(<em>x</em><sup>(<em>n</em>)</sup>)</span> é convergente sempre que <span class="math"><em>x</em><sup>(0)</sup> ∈ (<em>x</em><sup> * </sup> − <em>δ</em>, <em>x</em><sup> * </sup> + <em>δ</em>)</span>.</p>
<p>[Teste de convergência] Se <span class="math"><em>g</em> ∈ <em>C</em><sup>1</sup>[<em>a</em>, <em>b</em>]</span> e <span class="math">|<em>g</em>′(<em>x</em><sup> * </sup>)| &lt; 1</span>, então <span class="math"><em>x</em><sup> * </sup></span> é estável. Se <span class="math">|<em>g</em>′(<em>x</em><sup> * </sup>)| &gt; 1</span> é instável e o teste é inconclusivo quando <span class="math">|<em>g</em>′(<em>x</em><sup> * </sup>)| = 1</span>.</p>
<p>[b]<span>0.45</span> <embed src="./cap_equacao1d/pics/ponto_fixo_instavel/ponto_fixo_instavel.eps" title="fig:" /></p>
<p>[b]<span>0.45</span> <embed src="./cap_equacao1d/pics/ponto_fixo_estavel/ponto_fixo_estavel.eps" title="fig:" /></p>
<p>[ex:ponto<sub>f</sub>ixo<sub>4</sub>] No Exemplo [ex:ponto<sub>f</sub>ixo<sub>2</sub>] observamos que a função <span class="math"><em>g</em><sub>1</sub>(<em>x</em>)</span> nos forneceu uma iteração divergente, enquanto que a função <span class="math"><em>g</em><sub>2</sub>(<em>x</em>)</span> forneceu uma iteração convergente (veja a Figura [fig:teste<sub>d</sub>e<sub>c</sub>onvergencia]. A razão destes comportamentos é explicada pelo teste da convergência. Com efeito, sabemos que o ponto fixo destas funções está no intervalo <span class="math">[1, 6, 1, 8]</span> e temos: <br /><span class="math">|<em>g</em><sub>1</sub>′(<em>x</em>)| = |1 − 0, 5(<em>x</em> + 1)<em>e</em><sup><em>x</em></sup>| &gt; 4, 8,  ∀<em>x</em> ∈ [1, 6, 1, 8], </span><br /> enquanto: <br /><span class="math">|<em>g</em><sub>2</sub>′(<em>x</em>)| = |1 − 0, 05(<em>x</em> + 1)<em>e</em><sup><em>x</em></sup>| &lt; 0, 962,  ∀<em>x</em> ∈ [1, 6, 1, 8].</span><br /></p>
<h3 id="estabilidade-e-convergência">Estabilidade e convergência</h3>
<p>A fim de compreendermos melhor os conceitos de estabilidade e convergência, considere uma função <span class="math">Φ(<em>x</em>)</span> com um ponto fixo <span class="math"><em>x</em><sup> * </sup> = <em>g</em>(<em>x</em><sup> * </sup>)</span> e analisemos o seguinte processo iterativo: <br /><span class="math">$$\begin{aligned}
x^{(n+1)}&amp;=&amp;g\left(x^{(n)}\right)\\
x^{(0)}&amp;=&amp;x\end{aligned}$$</span><br /> Vamos supor que a função <span class="math"><em>g</em>(<em>x</em>)</span> pode ser aproximada por seu polinômio de Taylor em torno do ponto fixo: <br /><span class="math">$$\begin{aligned}
g(x)&amp;=&amp;g(x^*)+(x-x^*) g'(x^*)+O\left((x-x^*)^2\right), n\geq 0\\
&amp;=&amp;x^*+(x-x^*) g'(x^*)+O\left((x-x^*)^2\right)\\
&amp;\approx&amp; x^*+(x-x^*) g'(x^*)\end{aligned}$$</span><br /></p>
<p>Substituindo na relação de recorrência, temos <br /><span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>g</em>(<em>x</em><sup>(<em>n</em>)</sup>) ≈ <em>x</em><sup> * </sup> + (<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup> * </sup>)<em>g</em>′(<em>x</em><sup> * </sup>)</span><br /> Ou seja: <br /><span class="math">(<em>x</em><sup>(<em>n</em> + 1)</sup> − <em>x</em><sup> * </sup>) ≈ (<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup> * </sup>)<em>g</em>′(<em>x</em><sup> * </sup>)</span><br /> Tomando módulos, temos: <br /><span class="math">$$\underbrace{\left|x^{(n+1)}-x^*\right|}_{\epsilon_{n+1}}\approx \underbrace{\left|x^{(n)}-x^*\right|}_{\epsilon_n} \left|g'(x^*)\right|,$$</span><br /> onde <span class="math"><em>ϵ</em><sub><em>n</em></sub> = |<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup> * </sup>|</span>.</p>
<p>A análise acima, concluímos:</p>
<ul>
<li><p>Se <span class="math">|<em>g</em>′(<em>x</em><sup> * </sup>)| &lt; 1</span>, então, a distância de <span class="math"><em>x</em><sup>(<em>n</em>)</sup></span> até o ponto fixo <span class="math"><em>x</em><sup> * </sup></span> está diminuindo a cada passo.</p></li>
<li><p>Se <span class="math">|<em>g</em>′(<em>x</em><sup> * </sup>)| &gt; 1</span>, então, a distância de <span class="math"><em>x</em><sup>(<em>n</em>)</sup></span> até o ponto fixo <span class="math"><em>x</em><sup> * </sup></span> está aumentando a cada passo.</p></li>
<li><p>Se <span class="math">|<em>g</em>′(<em>x</em><sup> * </sup>)| = 1</span>, então, nossa aproximação de primeiro ordem não é suficiente para compreender o comportamento da sequência.</p></li>
</ul>
<h3 id="erro-absoluto-e-tolerância">Erro absoluto e tolerância</h3>
<p>Na prática, quando se aplica uma iteração como esta, não se conhece de antemão o valor do ponto fixo <span class="math"><em>x</em><sup> * </sup></span>. Assim, o erro <span class="math"><em>ϵ</em><sub><em>n</em></sub> = |<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup> * </sup>|</span> precisa ser estimado com base nos valores calculados <span class="math"><em>x</em><sup>(<em>n</em>)</sup></span>. Uma abordagem frequente é analisar a evolução da diferença entre dois elementos da sequência: <br /><span class="math">Δ<sub><em>n</em></sub> = |<em>x</em><sup>(<em>n</em> + 1)</sup> − <em>x</em><sup>(<em>n</em>)</sup>|</span><br /></p>
<p>A pergunta natural é: Será que o erro <span class="math"><em>ϵ</em><sub><em>n</em></sub> = |<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup> * </sup>|</span> é pequeno quando <span class="math">Δ<sub><em>n</em></sub> = |<em>x</em><sup>(<em>n</em> + 1)</sup> − <em>x</em><sup>(<em>n</em>)</sup>|</span> for pequeno?</p>
<p>Para responder a esta pergunta, observamos que <br /><span class="math"><em>x</em><sup> * </sup> = lim<sub><em>n</em> → ∞</sub><em>x</em><sup>(<em>n</em>)</sup></span><br /> portanto: <br /><span class="math">$$\begin{aligned}
x^*-x^{(N)}&amp;=&amp;  \left(x^{(N+1)}-x^{(N)}\right)+\left(x^{(N+2)}-x^{(N+1)}\right)+\left(x^{(N+3)}-x^{(N+2)}\right)+\ldots\\
&amp;=&amp;\sum_{k=0}^\infty \left(x^{(N+k+1)}-x^{(N+k)}\right)\end{aligned}$$</span><br /></p>
<p>Usamos também as expressões: <br /><span class="math">$$\begin{aligned}
x^{(n+1)}&amp;\approx&amp; x^*+(x^{(n)}-x^*) g'(x^*)\\
x^{(n)}&amp;\approx&amp; x^*+(x^{(n-1)}-x^*) g'(x^*)\end{aligned}$$</span><br /> Subtraindo uma da outra, temos: <br /><span class="math">$$\begin{aligned}
x^{(n+1)}-x^{(n)}&amp;\approx&amp; (x^{(n)}-x^{(n-1)}) g'(x^*)\end{aligned}$$</span><br /> Portanto: <br /><span class="math">$$\begin{aligned}
x^{(N+k+1)}-x^{(N+k)}&amp;\approx&amp; (x^{(N+1)}-x^{(N)}) \left(g'(x^*)\right)^{k}\end{aligned}$$</span><br /> E temos: <br /><span class="math">$$\begin{aligned}
x^*-x^{(N)}
&amp;=&amp;\sum_{k=0}^\infty \left(x^{(N+k+1)}-x^{(N+k)}\right)\\
&amp;\approx&amp;\sum_{k=0}^\infty (x^{(N+1)}-x^{(N)}) \left(g'(x^*)\right)^{k}\\
&amp;=&amp;(x^{(N+1)}-x^{(N)}) \frac{1}{1-g'(x^*)}, \quad \left|g'(x^*)\right|&lt;1\end{aligned}$$</span><br /> Tomando módulo, temos: <br /><span class="math">$$\begin{aligned}
\left|x^*-x^{(N)} \right|
&amp;\approx&amp;\left|x^{(N+1)}-x^{(N)}\right| \frac{1}{1-g'(x^*)}\\
\epsilon_N &amp;\approx&amp;  \frac{\Delta_N}{1-g'(x^*)}\end{aligned}$$</span><br /></p>
<p>Tendo em mente a relação <span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> − <em>x</em><sup>(<em>n</em>)</sup> ≈ (<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup>(<em>n</em> − 1)</sup>)<em>g</em>′(<em>x</em><sup> * </sup>)</span>, concluímos:</p>
<ul>
<li><p>Quando <span class="math"><em>g</em>′(<em>x</em><sup> * </sup>) &lt; 0</span>, o esquema é alternante, isto é, o sinal do erro se altera a cada passo. O erro <span class="math"><em>ϵ</em><sub><em>N</em></sub></span> pode ser estimado diretamente da diferença <span class="math">Δ<sub><em>N</em></sub></span>, pois o denominador <span class="math">1 − <em>g</em>′(<em>x</em><sup> * </sup>) &gt; 1</span>.</p></li>
<li><p>Quando <span class="math">0 &lt; <em>g</em>′(<em>x</em><sup> * </sup>) &lt; 1</span>, o esquema é monótono e <span class="math">$\frac{1}{1-g'(x^*)}&gt;1$</span>, pelo que o erro <span class="math"><em>ϵ</em><sub><em>N</em></sub></span> é maior que a diferença <span class="math">Δ<sub><em>N</em></sub></span>. A relação será tão mais importante quando mais próximo da unidade for <span class="math"><em>g</em>′(<em>x</em><sup> * </sup>)</span>, ou seja, quando mais lenta for a convergência. Para estimar o erro em função da diferença <span class="math">Δ<sub><em>N</em></sub></span>, observamos que <span class="math">$g'(x^*)\approx \frac{x^{(n+1)}-x^{(n)}}{x^{(n)}-x^{(n-1)}}$</span> e <br /><span class="math">$$\left|g'(x^*)\right|\approx \frac{\Delta_n}{\Delta_{n-1}}$$</span><br /> e portanto <br /><span class="math">$$\epsilon_N \approx \frac{\Delta_N}{1-\frac{\Delta_n}{\Delta_{n-1}}}.$$</span><br /></p></li>
</ul>
<h2 id="exercícios-7" class="unnumbered">Exercícios</h2>
<p>Resolver a equação <span class="math"><em>e</em><sup><em>x</em></sup> = <em>x</em> + 2</span> é equivalente a calcular os pontos fixos da função <span class="math"><em>g</em>(<em>x</em>) = <em>e</em><sup><em>x</em></sup> + 2</span> (veja o Exemplo [ex:ponto<sub>f</sub>ixo<sub>1</sub>]). Use a iteração do ponto fixo <span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>g</em>(<em>x</em><sup><em>n</em></sup>)</span> com <span class="math"><em>x</em><sup>(1)</sup> =  − 1, 8</span> para obter uma aproximação de uma das soluções da equação dada com <span class="math">8</span> dígitos significativos.</p>
<p><span class="math"> − 1, 8414057</span></p>
<p>Mostre que a equação: <br /><span class="math">cos(<em>x</em>) = <em>x</em></span><br /> possui uma única solução no intervalo <span class="math">[0, 1]</span>. Use a iteração do ponto fixo e encontre uma aproximação para esta solução com 4 dígitos significativos.</p>
<p><span class="math">0, 7391</span></p>
<p>Mostre que a equação <span class="math"><em>x</em><em>e</em><sup><em>x</em></sup> = 10</span> é equivalente às seguintes equações: <br /><span class="math">$$x=\ln\left(\frac{10}{x}\right)\quad\text{e}\quad x=10e^{-x}.$$</span><br /> Destas, considere as seguintes iterações de ponto fixo:</p>
<ol>
<li><p><span class="math">$\displaystyle x^{(n+1)}=\ln \left(\frac{10}{x^{(n)}}\right)$</span></p></li>
<li><p><span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = 10<em>e</em><sup> − <em>x</em><sup>(<em>n</em>)</sup></sup></span></p></li>
</ol>
<p>Tomando <span class="math"><em>x</em><sup>(1)</sup> = 1</span>, verifique se estas sequências são convergentes.</p>
<p>Tomemos <span class="math"><em>x</em><sup>(1)</sup> = 1</span> como aproximação inicial para a solução deste problema, iterando a primeira sequência a), obtemos: <br /><span class="math">$$\begin{aligned}
x^{(1)} &amp;=1\\
x^{(2)} &amp;=\ln\left(\frac{10}{1}\right)=2,3025851\\
x^{(3)} &amp;=\ln\left(\frac{10}{2,3025851}\right)=1,4685526\\
        &amp;\vdots\\
x^{(21)}&amp;= 1,7455151\\
x^{(31)}&amp;= 1,745528\\
x^{(32)}&amp;= 1,745528\end{aligned}$$</span><br /></p>
<p>Iterando a segunda sequência b), obtemos: <br /><span class="math">$$\begin{aligned}
x^{(1)}&amp;=1\\
x^{(2)}&amp;=10e^{-1}= 3,6787944   \\
x^{(3)}&amp;=10e^{- 3,6787944 }= 0,2525340     \\
x^{(4)}&amp;=10e^{-0,2525340}=  7,7682979      \\
x^{(5)}&amp;=10e^{-7,7682979}=  0,0042293      \\
x^{(6)}&amp;=10e^{-0,0042293}=  9,9577961\end{aligned}$$</span><br /></p>
<p>Este experimento numérico sugere que a iteração a) converge para <span class="math">1, 745528</span> e a iteração b) não é convergente.</p>
<p>Verifique (analiticamente) que a única solução real da equação: <br /><span class="math"><em>x</em><em>e</em><sup><em>x</em></sup> = 10</span><br /> é ponto fixo das seguintes funções:</p>
<ul>
<li><p><span class="math">$g(x)=\ln\left(\frac{10}{x}\right)$</span></p></li>
<li><p><span class="math">$g(x)=x-\frac{xe^{x}-10}{15}$</span></p></li>
<li><p><span class="math">$g(x)=x-\frac{xe^{x}-10}{10+e^{x}}$</span></p></li>
</ul>
<p>Implemente o processo iterativo <span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>g</em>(<em>x</em><sup>(<em>n</em>)</sup>)</span> para <span class="math"><em>n</em> ≥ 0</span> e compare o comportamento. Discuta os resultados com base na teoria estudada.</p>
<p>Verifique (analiticamente) que a única solução real da equação: <br /><span class="math">cos(<em>x</em>) = <em>x</em></span><br /> é ponto fixo das seguintes funções:</p>
<ul>
<li><p><span class="math"><em>g</em>(<em>x</em>) = cos(<em>x</em>)</span></p></li>
<li><p><span class="math"><em>g</em>(<em>x</em>) = 0, 4<em>x</em> + 0, 6cos(<em>x</em>)</span></p></li>
<li><p><span class="math">$g(x)=x+\frac{\cos(x)-x}{1+\sin(x)}$</span></p></li>
</ul>
<p>Implemente o processo iterativo <span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>g</em>(<em>x</em><sup>(<em>n</em>)</sup>)</span> para <span class="math"><em>n</em> ≥ 0</span> e compare o comportamento.Discuta os resultados com base na teoria estudada.</p>
<p>Encontre a solução de cada equação com erro absoluto inferior a <span class="math">10<sup> − 6</sup></span>.</p>
<ul>
<li><p><span class="math"><em>e</em><sup><em>x</em></sup> = <em>x</em> + 2</span> no intervalo <span class="math">( − 2, 0)</span>.</p></li>
<li><p><span class="math"><em>x</em><sup>3</sup> + 5<em>x</em><sup>2</sup> − 12 = 0</span> no intervalo <span class="math">(1, 2)</span>.</p></li>
<li><p><span class="math">$\sqrt{x}=\cos(x)$</span> no intervalo <span class="math">(0, 1)</span>.</p></li>
</ul>
<p>Encontre numericamente as três primeiras raízes positivas da equação dada por: <br /><span class="math">$$\cos(x)=\frac{x}{10+x^2}$$</span><br /> com erro absoluto inferior a <span class="math">10<sup> − 6</sup></span>.</p>
<p>Calcule uma equação da reta tangente a curva <span class="math"><em>y</em> = <em>e</em><sup> − (<em>x</em> − 1)<sup>2</sup></sup></span> que passa pelo ponto <span class="math">(3, 1/2)</span>.</p>
<p>Resolva numericamente a inequação: <br /><span class="math"><em>e</em><sup> − <em>x</em><sup>2</sup></sup> &lt; 2<em>x</em></span><br /></p>
<p><span class="math"><em>x</em> &gt; <em>a</em></span> com <span class="math"><em>a</em> ≈ 0, 4193648</span>.</p>
<p>Considere os seguintes processos iterativos: <br /><span class="math">$$\begin{array}{l}
a\left\{\begin{array}{rcl}
x^{(n+1)}&amp;=&amp;\cos(x^{(n)})\\
x^{(1)}&amp;=&amp;.5
\end{array}
\right. \\ \qquad \hbox { e }\\
b\left\{\begin{array}{rcl}
x^{(n+1)}&amp;=&amp;.4x^{(n)}+.6\cos(x^{(n)})\\
x^{(1)}&amp;=&amp;.5
\end{array}
\right.
\end{array}$$</span><br /></p>
<p>Use o teorema do ponto fixo para verificar que cada um desses processos converge para a solução da equação <span class="math"><em>x</em><sup> * </sup></span> de <span class="math">cos(<em>x</em>) = <em>x</em></span>. Observe o comportamento numérico dessas sequências. Qual estabiliza mais rápido com cinco casas decimais? Discuta.</p>
<p>Dica: Verifique que <span class="math">cos([0.5, 1]) ⊆ [0.5, 1]</span> e depois a mesma identidade para a função <span class="math"><em>f</em>(<em>x</em>) = .4<em>x</em> + .6cos(<em>x</em>)</span>.</p>
<p>Use o teorema do ponto fixo aplicado a um intervalo adequado para mostrar que a função <span class="math"><em>g</em>(<em>x</em>) = ln(100 − <em>x</em>)</span> possui um ponto fixo estável.</p>
<p>[title=Fluidos] Na hidráulica, o fator de atrito de Darcy é dado pela implicitamente pela equação de Colebrook-White: <br /><span class="math">$$\frac{1}{\sqrt{f}}= -2 \log_{10} \left( \frac{\varepsilon}{14.8 R_\mathrm{h}} + \frac{2.51}{\mathrm{Re}\sqrt{f}} \right)$$</span><br /> onde <span class="math"><em>f</em></span> é o fator de atrito, <span class="math"><em>ε</em></span> é a rugosidade do tubo em metros, <span class="math"><em>R</em><sub><em>h</em></sub></span> é o raio hidráulico em metros e <span class="math"><em>R</em><em>e</em></span> é o número de Reynolds. Considere <span class="math"><em>ε</em> = 2<em>m</em><em>m</em></span>, <span class="math"><em>R</em><sub><em>h</em></sub> = 5<em>c</em><em>m</em></span> e <span class="math"><em>R</em><em>e</em> = 10000</span> e obtenha o valor de <span class="math"><em>f</em></span> pela iteração: <br /><span class="math">$$x^{(n+1)}=-2 \log_{10} \left( \frac{\varepsilon}{14.8 R_\mathrm{h}} + \frac{2.51x^{(n)}}{\mathrm{Re}} \right)$$</span><br /></p>
<p><span class="math">0.0431266</span></p>
<p>Encontre uma solução aproximada para equação algébrica <br /><span class="math">180 − 100<em>x</em> = 0.052sinh<sup> − 1</sup>(10<sup>13</sup><em>x</em>)</span><br /> com erro absoluto inferior a <span class="math">10<sup> − 3</sup></span> usando um método iterativo. Estime o erro associado ao valor de <span class="math"><em>v</em> = 180 − 100<em>x</em> = 0.052sinh<sup> − 1</sup>(10<sup>13</sup><em>x</em>)</span>, usando cada uma dessas expressões. Discuta sucintamente o resultado obtido. Dica: Este caso é semelhante ao problema [prob<sub>d</sub>iodo].</p>
<p>Considere que <span class="math"><em>x</em><sub><em>n</em></sub></span> satisfaz a seguinte relação de recorrência: <br /><span class="math"><em>x</em><sub><em>n</em> + 1</sub> = <em>x</em><sub><em>n</em></sub> − <em>β</em>(<em>x</em><sub><em>n</em></sub> − <em>x</em><sup> * </sup>)</span><br /> onde <span class="math"><em>β</em></span> e <span class="math"><em>x</em><sup> * </sup></span> são constantes. Prove que <br /><span class="math"><em>x</em><sub><em>n</em></sub> − <em>x</em><sup> * </sup> = (1 − <em>β</em>)<sup><em>n</em> − 1</sup>(<em>x</em><sub>1</sub> − <em>x</em><sup> * </sup>).</span><br /> Conclua que <span class="math"><em>x</em><sub><em>n</em></sub> → <em>x</em><sup> * </sup></span> quando <span class="math">|1 − <em>β</em>| &lt; 1</span>.</p>
<p>[title=Convergência lenta] Considere o seguinte esquema iterativo: <br /><span class="math">$$\left\{\begin{array}{l}
x^{(n+1)}=x_n+q^n\\
x^{(0)}=0
\end{array}
\right.$$</span><br /> onde <span class="math"><em>q</em> = 1 − 10<sup> − 6</sup></span>.</p>
<ul>
<li><p>Calcule o limite <br /><span class="math"><em>x</em><sub>∞</sub> = lim<sub><em>n</em> → ∞</sub><em>x</em><sup>(<em>n</em>)</sup></span><br /> analiticamente.</p></li>
<li><p>Considere que o problema de obter o limite da sequência numericamente usando como critério de parada que <span class="math">|<em>x</em><sup>(<em>n</em> + 1)</sup> − <em>x</em><sup>(<em>n</em>)</sup>| &lt; 10<sup> − 5</sup></span>. Qual o valor é produzido pelo esquema numérico? Qual o desvio entre o valor obtido pelo esquema numérico e o valor do limite obtido no item a? Discuta. (Dica: Você não deve implementar o esquema iterativo, obtendo o valor de <span class="math"><em>x</em><sup>(<em>n</em>)</sup></span> analiticamente)</p></li>
<li><p>Qual deve ser a tolerância especificada para obter o resultado com erro relativo inferior a <span class="math">10<sup> − 2</sup></span>?</p></li>
</ul>
<p>[title=Convergência sublinear] Considere o seguinte esquema iterativo: <br /><span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>x</em><sup>(<em>n</em>)</sup> − [<em>x</em><sup>(<em>n</em>)</sup>]<sup>3</sup>,  <em>x</em><sup>(<em>n</em>)</sup> ≥ 0</span><br /> com <span class="math"><em>x</em><sup>(0)</sup> = 10<sup> − 2</sup></span>. Prove que <span class="math">{<em>x</em><sup>(<em>n</em>)</sup>}</span> é sequência de número reais positivos convergindo para zero. Verifique que são necessários mais de mil passos para que <span class="math"><em>x</em><sup>(<em>n</em>)</sup></span> se torne menor que <span class="math">0.9<em>x</em><sup>(0)</sup></span>.</p>
<p>[title=Taxa de convergência]</p>
<ul>
<li><p>Use o teorema do ponto fixo para mostrar que a função <span class="math"><em>g</em>(<em>x</em>) = 1 − sin(<em>x</em>)</span> possui um único ponto fixo estável o intervalo <span class="math">$[\frac{1}{10},1]$</span>. Construa um método iterativo <span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>g</em>(<em>x</em><sup>(<em>n</em>)</sup>)</span> para encontrar esse ponto fixo. Use o Scilab para encontrar o valor numérico do ponto fixo.</p></li>
<li><p>Verifique que função <span class="math">$\psi(x)=\frac{1}{2}\left[x+1-\sin(x)\right]$</span> possui um ponto fixo <span class="math"><em>x</em><sup> * </sup></span> que também é o ponto fixo da função <span class="math"><em>g</em></span> do item a. Use o Scilab para encontrar o valor numérico do ponto fixo através da iteração <span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>ψ</em>(<em>x</em><sup>(<em>n</em>)</sup>)</span>. Qual método é mais rápido?</p></li>
</ul>
<p>[title=Esquemas oscilantes](<em>Esquemas oscilantes</em>)</p>
<ul>
<li><p>Considere a função <span class="math"><em>g</em>(<em>x</em>)</span> e função composta <span class="math"><em>ψ</em>(<em>x</em>) = <em>g</em> ∘ <em>g</em> = <em>g</em>(<em>g</em>(<em>x</em>))</span>. Verifique todo ponto fixo de <span class="math"><em>g</em></span> também é ponto fixo de <span class="math"><em>ψ</em></span>.</p></li>
<li><p>Considere a função <br /><span class="math"><em>g</em>(<em>x</em>) = 10exp( − <em>x</em>)</span><br /> e função composta <span class="math"><em>ψ</em>(<em>x</em>) = <em>g</em> ∘ <em>g</em> = <em>g</em>(<em>g</em>(<em>x</em>))</span>. Mostre que <span class="math"><em>ψ</em></span> possui dois pontos fixos que não são pontos fixos de <span class="math"><em>g</em></span>.</p></li>
<li><p>No problema anterior, o que acontece quando o processo iterativo <span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>g</em>(<em>x</em><sup>(<em>n</em>)</sup>)</span> é inicializado com um ponto fixo de <span class="math"><em>ψ</em></span> que não é ponto fixo de <span class="math"><em>g</em></span>?</p></li>
</ul>
<p>[title= Aceleração de convergência - introdução ao método de Newton][int<sub>n</sub>ew1] Mostre que se <span class="math"><em>f</em>(<em>x</em>)</span> possui uma raiz <span class="math"><em>x</em><sup> * </sup></span> então a <span class="math"><em>x</em><sup> * </sup></span> é um ponto fixo de <span class="math"><em>ϕ</em>(<em>x</em>) = <em>x</em> + <em>γ</em>(<em>x</em>)<em>f</em>(<em>x</em>)</span>. Encontre uma condição em <span class="math"><em>γ</em>(<em>x</em>)</span> para que o ponto fixo <span class="math"><em>x</em><sup> * </sup></span> de <span class="math"><em>ϕ</em></span> seja estável. Encontre uma condição em <span class="math"><em>γ</em>(<em>x</em>)</span> para que <span class="math"><em>ϕ</em>′(<em>x</em><sup> * </sup>) = 0</span>.</p>
<p>[title=Aceleração de convergência - introdução ao método de Newton][int<sub>n</sub>ew2] Considere que <span class="math"><em>x</em><sup>(<em>n</em>)</sup></span> satisfaz a seguinte relação de recorrência: <br /><span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>x</em><sup>(<em>n</em>)</sup> − <em>γ</em><em>f</em>(<em>x</em><sup>(<em>n</em>)</sup>)</span><br /> onde <span class="math"><em>γ</em></span> é uma constante. Suponha que <span class="math"><em>f</em>(<em>x</em>)</span> possui um zero em <span class="math"><em>x</em><sup> * </sup></span>. Aproxime a função <span class="math"><em>f</em>(<em>x</em>)</span> em torno de <span class="math"><em>x</em><sup> * </sup></span> por <br /><span class="math"><em>f</em>(<em>x</em>) = <em>f</em>(<em>x</em><sup> * </sup>) + <em>f</em>′(<em>x</em><sup> * </sup>)(<em>x</em> − <em>x</em><sup> * </sup>) + <em>O</em>((<em>x</em> − <em>x</em><sup> * </sup>)<sup>2</sup>).</span><br /> Em vista do problema anterior, qual valor de <span class="math"><em>γ</em></span> você escolheria para que a sequência <span class="math"><em>x</em><sup>(<em>n</em>)</sup></span> convirja rapidamente para <span class="math"><em>x</em><sup> * </sup></span>.</p>
<p>Considere o problema da questão [prob<sub>d</sub>iodo] e dois seguintes esquemas iterativos. <br /><span class="math">$$\begin{array}{l}
A\left\{
\begin{array}{ll}
I^{(n+1)}=\frac{1}{R}\left[V-v_t\ln\left(1+\frac{I^{(n)}}{I_R}\right)\right],n&gt;0\\
I^{(0)}=0
\end{array}\right.\\ \hspace{2cm} \hbox{ e }\\
B\left\{
\begin{array}{ll}
I^{(n+1)}=I_R\left[\exp\left(\frac{V-RI^{(n)}}{v_t}\right)-1\right],n&gt;0\\
I^{(0)}=0
\end{array}\right.
\end{array}$$</span><br /> Verifique numericamente que apenas o processo A é convergente para a, b e c; enquanto apenas o processo B é convergente para os outros itens.</p>
<h2 id="método-de-newton-raphson">Método de Newton-Raphson</h2>
<p>Nesta seção, apresentamos o <em>método de Newton-Raphson</em><a href="#fn9" class="footnoteRef" id="fnref9"><sup>9</sup></a><a href="#fn10" class="footnoteRef" id="fnref10"><sup>10</sup></a> para calcular o zero de funções reais de uma variável real.</p>
<p>Assumimos que <span class="math"><em>x</em><sup> * </sup></span> é um zero de uma dada função <span class="math"><em>f</em>(<em>x</em>)</span> continuamente diferenciável, i.e. <span class="math"><em>f</em>(<em>x</em><sup> * </sup>) = 0</span>. Afim de usar a iteração do ponto fixo, observamos que, equivalentemente, <span class="math"><em>x</em><sup> * </sup></span> é um ponto fixo da função: <br /><span class="math"><em>g</em>(<em>x</em>) = <em>x</em> + <em>α</em>(<em>x</em>)<em>f</em>(<em>x</em>),  <em>γ</em>(<em>x</em>) ≠ 0, </span><br /> onde <span class="math"><em>α</em>(<em>x</em>)</span> é uma função arbitrária que queremos escolher de forma que a iteração do ponto fixo tenha ótima taxa de convergência.</p>
<p>Do <em>Teorema do ponto fixo</em> temos que a taxa de convergência é dada em função do valor absoluto da derivada de <span class="math"><em>g</em>(<em>x</em>)</span>. Calculando a derivada temos: <br /><span class="math"><em>g</em>′(<em>x</em>) = 1 + <em>α</em>(<em>x</em>)<em>f</em>′(<em>x</em>) + <em>α</em>′(<em>x</em>)<em>f</em>(<em>x</em>).</span><br /> No ponto <span class="math"><em>x</em> = <em>x</em><sup> * </sup></span>, temos: <br /><span class="math"><em>g</em>′(<em>x</em><sup> * </sup>) = 1 + <em>α</em>(<em>x</em><sup> * </sup>)<em>f</em>′(<em>x</em><sup> * </sup>) + <em>α</em>′(<em>x</em><sup> * </sup>)<em>f</em>(<em>x</em><sup> * </sup>).</span><br /> Como <span class="math"><em>f</em>(<em>x</em><sup> * </sup>) = 0</span>, temos: <br /><span class="math"><em>g</em>′(<em>x</em><sup> * </sup>) = 1 + <em>α</em>(<em>x</em><sup> * </sup>)<em>f</em>′(<em>x</em><sup> * </sup>).</span><br /></p>
<p>Sabemos que o processo iterativo converge tão mais rápido quanto menor for <span class="math">|<em>g</em>′(<em>x</em>)|</span> nas vizinhanças de <span class="math"><em>x</em><sup> * </sup></span>. Isto nos leva a escolher: <br /><span class="math"><em>g</em>′(<em>x</em><sup> * </sup>) = 0, </span><br /> e, então, temos: <br /><span class="math">$$\alpha(x^*) = -\frac{1}{f'(x^*)},$$</span><br /> se <span class="math"><em>f</em>′(<em>x</em><sup> * </sup>) ≠ 0</span>.</p>
<p>A discussão acima nos motiva a introduzir o método de Newton, cujas iterações são dada por: <br /><span class="math">$$\begin{aligned}
  x^{(n+1)} = x^{(n)} - \frac{f\left(x^{(n)}\right)}{f'\left(x^{n}\right)}, \quad n\geq 1,\end{aligned}$$</span><br /> sendo <span class="math"><em>x</em><sup>(1)</sup></span> uma aproximação inicial dada.</p>
<h3 id="interpretação-geométrica">Interpretação geométrica</h3>
<p>Seja dada uma função <span class="math"><em>f</em>(<em>x</em>)</span> conforme na Figura [fig:metodo<sub>d</sub>e<sub>N</sub>ewton]. Para tanto, escolhemos uma aproximação inicial <span class="math"><em>x</em><sup>(1)</sup></span> e computamos: <br /><span class="math">$$x^{(2)} = x^{(1)} - \frac{f(x^{(1)})}{f'(x^{(1)})}.$$</span><br /> Geometricamente, o ponto <span class="math"><em>x</em><sup>(2)</sup></span> é a interseção da reta tangente ao gráfico da função <span class="math"><em>f</em>(<em>x</em>)</span> no ponto <span class="math"><em>x</em> = <em>x</em><sup>(1)</sup></span> com o eixo das abscissas. Com efeito, a equação desta reta é: <br /><span class="math"><em>y</em> = <em>f</em>′(<em>x</em><sup>(1)</sup>)(<em>x</em> − <em>x</em><sup>(1)</sup>) + <em>f</em>(<em>x</em><sup>(1)</sup>).</span><br /> Assim, a interseção desta reta com o eixo das abscissas ocorre quando (<span class="math"><em>y</em> = 0</span>): <br /><span class="math">$$f'(x^{(1)})(x - x^{(1)}) + f(x^{(1)}) = 0\Rightarrow x = x^{(1)} - \frac{f(x^{(1)})}{f'(x^{(1)})}.$$</span><br /></p>
<div class="figure">
<embed src="./cap_equacao1d/pics/metodo_de_Newton/metodo_de_Newton.eps" />
<p class="caption">Interpretação do método de Newton.<span data-label="fig:metododeNewton"></span></p>
</div>
<p>Ou seja, dado <span class="math"><em>x</em><sup>(<em>n</em>)</sup></span> a próxima aproximação <span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup></span> é o ponto de interseção entre o eixo das abscissas e a reta tangente ao gráfico da função no ponto <span class="math"><em>x</em> = <em>x</em><sup>(<em>n</em>)</sup></span>. Observe a Figura [fig:metodo<sub>d</sub>e<sub>N</sub>ewton].</p>
<h3 id="análise-de-convergência">Análise de convergência</h3>
<p>Seja <span class="math"><em>f</em>(<em>x</em>)</span> um função com derivadas primeira e segunda contínuas tal que <span class="math"><em>f</em>(<em>x</em><sup> * </sup>) = 0</span> e <span class="math"><em>f</em>′(<em>x</em><sup> * </sup>) ≠ 0</span>. Seja também a função <span class="math"><em>g</em>(<em>x</em>)</span> definida como: <br /><span class="math">$$g(x)=x-\frac{f(x)}{f'(x)}.$$</span><br /> Expandimos em série de Taylor em torno de <span class="math"><em>x</em> = <em>x</em><sup> * </sup></span>, obtemos: <br /><span class="math">$$g(x)=g(x^*)+g'(x^*)(x-x^*) + \frac{g''(x^*)}{2}(x-x^*)^2 + O\left((x-x^*)^3\right).$$</span><br /> Observamos que: <br /><span class="math">$$\begin{aligned}
g(x^*) &amp;= x^*\\
g'(x^*) &amp;= 1 - \frac{f'(x^*)f'(x^*)-f(x^*)f''(x^*)}{\left(f'(x^*)\right)^2} = 0\end{aligned}$$</span><br /> Portanto: <br /><span class="math">$$g(x) = x^* + \frac{g''(x^*)}{2}(x-x^*)^2 + O\left((x-x^*)^3\right)\\$$</span><br /> Com isso, temos: <br /><span class="math">$$x^{(n+1)} = g(x^{(n)}) =  x^*+ \frac{g''(x^*)}{2}(x^{(n)}-x^*)^2 + O\left((x-x^*)^3\right),$$</span><br /> ou seja: <br /><span class="math">|<em>x</em><sup>(<em>n</em> + 1)</sup> − <em>x</em><sup> * </sup>| ≤ <em>C</em>|<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup> * </sup>|<sup>2</sup>, </span><br /> com constante <span class="math"><em>C</em> = |<em>g</em>″(<em>x</em><sup> * </sup>)/2|</span>. Isto mostra que o método de Newton tem <em>taxa de convergência quadrática</em>. Mais precisamente, temos o seguinte teorema.</p>
<p>[Método de Newton] Sejam <span class="math"><em>f</em> ∈ <em>C</em><sup>2</sup>([<em>a</em>, <em>b</em>])</span> com <span class="math"><em>x</em><sup> * </sup> ∈ (<em>a</em>, <em>b</em>)</span> tal que <span class="math"><em>f</em>(<em>x</em><sup> * </sup>) = 0</span> e: <br /><span class="math"><em>m</em> := min<sub><em>x</em> ∈ [<em>a</em>, <em>b</em>]</sub>|<em>f</em>′(<em>x</em>)| &gt; 0 e <em>M</em> := max<sub><em>x</em> ∈ [<em>a</em>, <em>b</em>]</sub>|<em>f</em>″(<em>x</em>)|.</span><br /> Escolhendo <span class="math"><em>ρ</em> &gt; 0</span> tal que: <br /><span class="math">$$q := \frac{M}{2m}\rho &lt; 1,$$</span><br /> definimos a <em>bacia de atração</em> do método de Newton pelo conjunto: <br /><span class="math"><em>K</em><sub><em>ρ</em></sub>(<em>x</em><sup> * </sup>) := {<em>x</em> ∈ ℝ;  |<em>x</em> − <em>x</em><sup> * </sup>| ≤ <em>ρ</em>} ⊂ [<em>a</em>, <em>b</em>].</span><br /> Então, para qualquer <span class="math"><em>x</em><sup>(1)</sup> ∈ <em>K</em><sub><em>ρ</em></sub>(<em>x</em><sup> * </sup>)</span> a iteração do método de Newton: <br /><span class="math">$$x^{(n+1)} = x^{(n)} - \frac{f(x^{(n)})}{f'(x^{(n)})},$$</span><br /> fornece uma sequência <span class="math"><em>x</em><sup>(<em>n</em>)</sup></span> que converge para <span class="math"><em>x</em><sup> * </sup></span>, i.e. <span class="math"><em>x</em><sup>(<em>n</em>)</sup> → <em>x</em><sup> * </sup></span> quando <span class="math"><em>n</em> → ∞</span>. Além disso, temos a seguinte estimativa de erro <em>a priori</em>: <br /><span class="math">$$|x^{(n)} - x^*| \leq \frac{2m}{M}q^{(2^{n-1})},\quad n\geq 2,$$</span><br /> e a seguinte estimativa de erro <em>a posteriori</em>: <br /><span class="math">$$|x^{(n)} - x^*| \leq \frac{M}{2m}|x^{(n)} - x^{(n-1)}|^2,\quad n\geq 2.$$</span><br /></p>
<p>Para <span class="math"><em>n</em> ∈ ℕ</span>, <span class="math"><em>n</em> ≥ 2</span>, temos: <br /><span class="math">$$\label{eq:forma}
    x^{n+1}-x^* = x^{(n)} - \frac{f(x^{(n)})}{f'(x^{(n)})} - x^* = -\frac{1}{f(x^{(n)})}\left[f(x^{(n)})+(x^*-x^{(n)})f'(x^{(n)}\right].$$</span><br /> Agora, para estimar o lado direito desta equação, usamos o polinômio de Taylor de grau <span class="math">1</span> da função <span class="math"><em>f</em>(<em>x</em>)</span> em torno de <span class="math"><em>x</em> = <em>x</em><sup>(<em>n</em>)</sup></span>, i.e.: <br /><span class="math"><em>f</em>(<em>x</em><sup> * </sup>) = <em>f</em>(<em>x</em><sup>(<em>n</em>)</sup>) + (<em>x</em><sup> * </sup> − <em>x</em><sup>(<em>n</em>)</sup>)<em>f</em>′(<em>x</em><sup>(<em>n</em>)</sup>) + ∫<sub><em>x</em><sup>(<em>n</em>)</sup></sub><sup><em>x</em><sup> * </sup></sup><em>f</em>″(<em>t</em>)(<em>x</em><sup> * </sup> − <em>t</em>) <em>d</em><em>t</em>.</span><br /> Pela mudança de variável <span class="math"><em>t</em> = <em>x</em><sup>(<em>n</em>)</sup> + <em>s</em>(<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup> * </sup>)</span>, observamos que o resto deste polinômio de Taylor na forma integral é igual a: <br /><span class="math"><em>R</em>(<em>x</em><sup> * </sup>, <em>x</em><sup>(<em>n</em>)</sup>) := (<em>x</em><sup> * </sup> − <em>x</em><sup>(<em>n</em>)</sup>)<sup>2</sup>∫<sub>0</sub><sup>1</sup><em>f</em>″(<em>x</em><sup>(<em>n</em>)</sup> + <em>s</em>(<em>x</em><sup> * </sup> − <em>x</em><sup>(<em>n</em>)</sup>))(1 − <em>s</em>) <em>d</em><em>s</em>.</span><br /> Assim, da cota da segunda derivada de <span class="math"><em>f</em>(<em>x</em>)</span>, temos: <br /><span class="math">$$\label{eq:est-resto}
  |R(x^*,x^{(n)})| \leq M|x^*-x^{(n)}|^2\int_0^1 (1-s)\,ds = \frac{M}{2}|x^* - x^{(n)}|^2.$$</span><br />[eq:quadratica] Se <span class="math"><em>x</em><sup>(<em>n</em>)</sup> ∈ <em>K</em><sub><em>ρ</em></sub>(<em>x</em><sup> * </sup>)</span>, então de e temos: <br /><span class="math">$$|x^{(n+1)} - x^*| \leq \frac{M}{2m}|x^{(n)} - x^*|^2 \leq \frac{M}{2m}\rho^2 &lt; \rho.$$</span><br /> Isto mostra que se <span class="math"><em>x</em><sup>(<em>n</em>)</sup> ∈ <em>K</em><sub><em>ρ</em></sub>(<em>x</em><sup> * </sup>)</span>, então <span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> ∈ <em>K</em><sub><em>ρ</em></sub>(<em>x</em><sup> * </sup>)</span>, i.e. <span class="math"><em>x</em><sup>(<em>n</em>)</sup> ∈ <em>K</em><sub><em>ρ</em></sub>(<em>x</em><sup> * </sup>)</span> para todo <span class="math"><em>n</em> ∈ ℝ</span>.</p>
<p>Agora, obtemos a estimativa <em>a priori</em> de , pois: <br /><span class="math">$$|x^{(n)} - x^*| \leq \frac{2m}{M}\left(\frac{M}{2m}|x^{(n-1)}-x^*|\right)^2 \leq \cdots \leq \frac{2m}{M}\left(\frac{M}{2m} |x^{(1)}-x^*|\right)^{2^{n-1}}.$$</span><br /> Logo: <br /><span class="math">$$|x^{(n)} - x^*| \leq \frac{2m}{M}q^{2^{n-1}},$$</span><br /> donde também vemos que <span class="math"><em>x</em><sup>(<em>n</em>)</sup> → <em>x</em><sup> * </sup></span> quando <span class="math"><em>n</em> → ∞</span>, pois <span class="math"><em>q</em> &lt; 1</span>.</p>
<p>Por fim, para provarmos a estimativa <em>a posteriori</em> tomamos a seguinte expansão em polinômio de Taylor: <br /><span class="math"><em>f</em>(<em>x</em><sup>(<em>n</em>)</sup>) = <em>f</em>(<em>x</em><sup>(<em>n</em> − 1)</sup>) + (<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup>(<em>n</em> − 1)</sup>)<em>f</em>′(<em>x</em><sup>(<em>n</em> − 1)</sup>) + <em>R</em>(<em>x</em><sup>(<em>n</em>)</sup>, <em>x</em><sup>(<em>n</em> − 1)</sup>).</span><br /> Aqui, temos: <br /><span class="math"><em>f</em>(<em>x</em><sup>(<em>n</em> − 1)</sup>) + (<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup>(<em>n</em> − 1)</sup>)<em>f</em>′(<em>x</em><sup>(<em>n</em> − 1)</sup>) = 0</span><br /> e, então, conforme acima: <br /><span class="math">$$|f(x^{(n)})| = |R(x^{(n)}),x^{(n-1)}| \leq \frac{M}{2}|x^{(n)} - x^{(n-1)}|^2.$$</span><br /> Com isso e do Teorema do valor médio, concluímos: <br /><span class="math">$$|x^{(n)} - x^*| \leq \frac{1}{m}|f(x^{(n)}) - f(x^*)| \leq \frac{M}{2m}|x^{(n)} - x^{(n-1)}|^2.$$</span><br /></p>
<p>Estime o raio <span class="math"><em>ρ</em></span> da bacia de atração <span class="math"><em>K</em><sub><em>ρ</em></sub>(<em>x</em><sup> * </sup>)</span> para a função <span class="math"><em>f</em>(<em>x</em>) = cos(<em>x</em>) − <em>x</em></span> restrita ao intervalo <span class="math">[0, <em>π</em>/2]</span>.</p>
<p>O raio da bacia de atração é tal que: <br /><span class="math">$$\rho &lt; \frac{2m}{M}$$</span><br /> onde <span class="math"><em>m</em> := min|<em>f</em>′(<em>x</em>)|</span> e <span class="math"><em>M</em> := max|<em>f</em>″(<em>x</em>)|</span> com o mínimo e o máximo tomados em um intervalo <span class="math">[<em>a</em>, <em>b</em>]</span> que contenha o zero da função <span class="math"><em>f</em>(<em>x</em>)</span>. Aqui, por exemplo, podemos tomar <span class="math">[<em>a</em>, <em>b</em>] = [0, <em>π</em>/2]</span>. Como, neste caso, <span class="math"><em>f</em>′(<em>x</em>) =  − sin(<em>x</em>) − 1</span>, temos que <span class="math"><em>m</em> = 1</span>. Também, como <span class="math"><em>f</em>″(<em>x</em>) =  − cos<em>x</em></span>, temos <span class="math"><em>M</em> = 1</span>. Assim, concluímos que <span class="math"><em>ρ</em> &lt; 2</span> (lembrando que <span class="math"><em>K</em><sub><em>ρ</em></sub>(<em>x</em><sup> * </sup>) ⊂ [0, <em>π</em>/2]</span>). Ou seja, neste caso as iterações de Newton convergem para o zero de <span class="math"><em>f</em>(<em>x</em>)</span> para qualquer escolha da aproximação inicial <span class="math"><em>x</em><sup>(1)</sup> ∈ [0, <em>π</em>/2]</span>.</p>
<h2 id="exercícios-8" class="unnumbered">Exercícios</h2>
<p>Considere o problema de calcular as soluções positivas da equação: <br /><span class="math">$$\tg(x)=2x^2.$$</span><br /></p>
<ul>
<li><p>Use o método gráfico para isolar as duas primeiras raízes positivas em pequenos intervalos. Use a teoria estudada em aula para argumentar quanto à existência e unicidade das raízes dentro intervalos escolhidos.</p></li>
<li><p>Calcule o número de iterações necessárias para que o método da bisseção aproxime cada uma das raízes com erro absoluto inferior a <span class="math">10<sup> − 8</sup></span>. Calcule as raízes por este método usando este número de passos.</p></li>
<li><p>Calcule cada uma das raízes pelo método de Newton com oito dígitos significativos e discuta a convergência comparando com o item b).</p></li>
</ul>
<p><span><strong>Obs:</strong></span> Alguns alunos encontraram como solução <span class="math"><em>x</em><sub>1</sub> ≈ 1, 5707963</span> e <span class="math"><em>x</em><sub>2</sub> ≈ 4, 7123890</span>. O que eles fizeram de errado?</p>
<ul>
<li><p>Primeiramente, deve-se observar que a função <span class="math">$\tg(x)$</span> não está definida quando <span class="math"><em>x</em></span> é um múltiplo ímpar de <span class="math">$\frac{\pi}{2}$</span>, pelo que devemos cuidado nas singularidades. Traçamos o gráfico da função <span class="math">$f(x)=\tg(x)-2x^2$</span> no <code>Scilab</code> usando os seguintes comandos:</p>
<pre><code>--&gt;deff(&#39;y=f(x)&#39;,&#39;y=tan(x)-2*x^2&#39;)
--&gt;plot([0:.01:1.3],f)</code></pre>
<p>Observamos facilmente uma raiz no intervalo <span class="math">(0, 5, 0, 6)</span> e outra no intervalo <span class="math">(1, 2, 1, 3)</span>. Como a função <span class="math"><em>f</em>(<em>x</em>)</span> é contínua fora dos pontos de singularidade da tangente, é fácil verificar que existe pelo menos uma solução nos intervalos dados pelo teorema de Bolzano [teo:teorema<sub>d</sub>e<sub>B</sub>olzano]: <br /><span class="math">$$\begin{aligned}
f(0,5) &amp;\approx&amp; 0,046302 &gt;0\\
f(0,6) &amp;\approx&amp; -0,035863 &lt;0\\
f(1,2) &amp;\approx&amp; -0,30784e-1 &lt;0\\
f(1,3) &amp;\approx&amp;  0,22210e-1&gt;0\\\end{aligned}$$</span><br /> Para provar a unicidade da solução em cada intervalo, precisamos mostra que a função é monótona, ou seja, a derivada não muda de sinal em cada intervalo: <br /><span class="math">$$\begin{aligned}
f'(x)=\sec^2(x)-4x=\frac{1}{\cos^2(x)}-4x\leq \frac{1}{\cos^2(0,6)}-4*0,5&lt;0, ~~x\in[ 0,5, 0,6]\\
f'(x)=\sec^2(x)-4x=\frac{1}{\cos^2(x)}-4x\geq \frac{1}{\cos^2(1,2)}-4*1,3&gt;0, ~~x\in[ 1,2, 1,3]\\\end{aligned}$$</span><br /></p></li>
<li><p>Já isolamos as raízes em intervalos de comprimento <span class="math">10<sup> − 1</sup></span> e a precisão requerida exige que as isolemos em intervalos de comprimento <span class="math">2 × 10<sup> − 8</sup></span>. Como cada passo da bisseção, confina a raiz em um intervalo com comprimento igual à metade do comprimento do intervalo anterior, temos a seguinte condição para o número de passos <span class="math"><em>N</em><sub><em>p</em></sub></span>: <br /><span class="math">$$\frac{10^{-1}}{2^N_p}\leq 2\times 10^{-8}$$</span><br /> isso é equivalente a <br /><span class="math">$$N_p\geq \log_2 \frac{10^{-1}}{2\times 10^{-8}}=\log_2 \frac{10^{7}}{2}=7\log_2 10 -1=\frac{7}{\log_10 2}-1\approx 22.22$$</span><br /> Como <span class="math"><em>N</em><sub><em>p</em></sub></span> é inteiro, o menor <span class="math"><em>N</em><sub><em>p</em></sub></span> que satisfaz a condição é <span class="math">23</span>.</p>
<p>As raízes obtidas são <span class="math">0.55970415</span> e <span class="math">1.2703426</span>.</p></li>
<li><p>Para recalcular as raízes pelo método de Newton, basta executar a interação <br /><span class="math">$$x^{(n+1)}=x^{(n)}-\frac{f(x^{(n)})}{f'(x^{(n)}}$$</span><br /></p></li>
</ul>
<p>Em relação à observação, o erro se deveu à falta de cuidado em compreender o problema antes de tentar resolvê-lo, em especial, à falta de observar que a função é descontínua em múltiplos ímpares de <span class="math">$\frac{\pi}{2}$</span>. Nestes pontos, a função <span class="math"><em>f</em>(<em>x</em>)</span> troca de sinal, mas não passa por zero.</p>
<p>[new1] Considere a equação <br /><span class="math"><em>e</em><sup> − <em>x</em><sup>2</sup></sup> = <em>x</em></span><br /> trace o gráfico com auxílio do <code>Scilab</code> e verifique que ela possui uma raiz positiva. Encontre uma aproximação para esta razão pelo gráfico e use este valor para inicializar o método de Newton e obtenha uma aproximação para a raiz com 8 dígitos significativos. (Use o comando <code>format('v',16)</code> para alterar a visualização no <code>Scilab</code>.)</p>
<p>0,65291864</p>
<p>[new2] Isole e encontre as cinco primeiras raízes positivas da equação com 6 dígitos corretos através de traçado de gráfico e do método de Newton. <br /><span class="math">cos(10<em>x</em>) = <em>e</em><sup> − <em>x</em></sup>.</span><br /> Dica: a primeira raiz positiva está no intervalo <span class="math">(0, 0.02)</span>. Fique atento.</p>
<p><span class="math">0.0198679</span>; <span class="math">0.533890</span>; <span class="math">0.735412</span>; <span class="math">1.13237</span>; <span class="math">1.38851</span>.</p>
<p>[new3] Encontre as raízes do polinômio <span class="math"><em>f</em>(<em>x</em>) = <em>x</em><sup>4</sup> − 4<em>x</em><sup>2</sup> + 4</span> através do método de Newton. O que você observa em relação ao erro obtido? Compare com a situação do problema [prob<sub>r</sub>aiz<sub>d</sub>upla].</p>
<p>[new4] Encontre as raízes reais do polinômio <span class="math">$f(x)=\frac{x^5}{100}+x^4+3x+1$</span> isolando-as pelo método do gráfico e depois usando o método de Newton. Expresse a solução com 7 dígitos significativos.</p>
<p><span class="math"> − 99.99970</span>, <span class="math"> − 0.3376513</span>; <span class="math"> − 1.314006</span>.</p>
<p>Considere o método de Newton aplicado para encontrar a raiz de <span class="math"><em>f</em>(<em>x</em>) = <em>x</em><sup>3</sup> − 2<em>x</em> + 2</span>. O que acontece quando <span class="math"><em>x</em><sup>(0)</sup> = 0</span>? Escolha um valor adequado para inicializar o método e obter a única raiz real desta equação.</p>
<p>Justifique a construção do processo iterativo do Método de Newton através do conceito de estabilidade de ponto fixo e convergência do método da iteração. Dica: Considere os problemas [int<sub>n</sub>ew1] e [int<sub>n</sub>ew2].</p>
<p>Entenda a interpretação geométrica ao método de Newton. Encontre uma valor para iniciar o método de Newton aplicado ao problema <span class="math"><em>f</em>(<em>x</em>) = <em>x</em><em>e</em><sup> − <em>x</em></sup> = 0</span> tal que o esquema iterativo divirja.</p>
<p><span class="math"><em>x</em><sub>0</sub> &gt; 1</span>.</p>
<p>[title= Computação]Aplique o método de Newton à função <span class="math">$f(x)=\frac{1}{x}-u$</span> e construa um esquema computacional para calcular a inversa de <span class="math"><em>u</em></span> com base em operações de multiplicação e soma/subtração.</p>
<p>[title=Computação]Aplique o método de Newton à função <span class="math"><em>f</em>(<em>x</em>) = <em>x</em><sup><em>n</em></sup> − <em>A</em></span> e construa um esquema computacional para calcular <span class="math">$\sqrt[n]{A}$</span> para <span class="math"><em>A</em> &gt; 0</span> com base em operações de multiplicação e soma/subtração.</p>
<p>Considere a função dada por <br /><span class="math">$$\begin{aligned}
\psi(x)&amp;=&amp;\ln\left(15-\ln(x)\right)\end{aligned}$$</span><br /> definida para <span class="math"><em>x</em> &gt; 0</span></p>
<ul>
<li><p>(1.5) Use o teorema do ponto fixo para provar que se <span class="math"><em>x</em><sub>0</sub></span> pertence ao intervalo <span class="math">[1, 3]</span>, então a sequência dada iterativamente por <br /><span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>ψ</em>(<em>x</em><sup>(<em>n</em>)</sup>), <em>n</em> ≥ 0</span><br /> converge para o único ponto fixo, <span class="math"><em>x</em><sup> * </sup></span>, de <span class="math"><em>ψ</em></span>. Construa a iteração <span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>ψ</em>(<em>x</em><sup>(<em>n</em>)</sup>)</span> e obtenha numericamente o valor do ponto fixo <span class="math"><em>x</em><sup> * </sup></span>. Expresse a resposta com 5 algarismos significativos corretos.</p></li>
<li><p>(1.0) Construa a iteração do método de Newton para encontrar <span class="math"><em>x</em><sup> * </sup></span>, explicitando a relação de recorrência e iniciando com <span class="math"><em>x</em><sub>0</sub> = 2</span>. Use o Scilab para obter a raiz e expresse a resposta com oito dígitos significativos corretos.</p></li>
</ul>
<h2 id="método-das-secantes">Método das Secantes</h2>
<p>O <em>método das secantes</em> é uma variação do método de Newton. Dada uma função <span class="math"><em>f</em>(<em>x</em>)</span>, a ideia é aproximar sua derivada pela razão fundamental: <br /><span class="math">$$f'(x)\approx \frac{f(x)-f(x_0)}{x-x_0},\quad x\approx x_0.$$</span><br /></p>
<p>Mais precisamente, o método de Newton é uma iteração de ponto fixo da forma: <br /><span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup> = <em>x</em><sup>(<em>n</em>)</sup> − <em>α</em>(<em>x</em><sup>(<em>n</em>)</sup>)<em>f</em>(<em>x</em><sup>(<em>n</em>)</sup>),  <em>n</em> ≥ 1, </span><br /> onde <span class="math"><em>x</em><sup>(1)</sup></span> é uma aproximação inicial dada e <span class="math"><em>α</em>(<em>x</em><sup>(<em>n</em>)</sup>) = 1/<em>f</em>′(<em>x</em><sup>(<em>n</em>)</sup>)</span>. Usando a aproximação da derivada acima, com <span class="math"><em>x</em> = <em>x</em><sup>(<em>n</em>)</sup></span> e <span class="math"><em>x</em><sub>0</sub> = <em>x</em><sup>(<em>n</em> − 1)</sup></span>, temos: <br /><span class="math">$$\alpha(x^{(n)}) = \frac{1}{f'(x^{(n)})} \approx  \frac{x^{(n)} - x^{(n-1)}}{f(x^{(n)}) - f(x^{(n-1)})}.$$</span><br /> Isto nos motiva a introduzir a <em>iteração do método das secantes</em> dada por: <br /><span class="math">$$x^{(n+1)} = x^{(n)} - f(x^{(n)})\frac{x^{(n)} - x^{(n-1)}}{f(x^{(n)}) - f(x^{(n-1)})},\quad n\geq 2.$$</span><br /> Observe que para inicializarmos a iteração acima precisamos de duas aproximações iniciais, a saber, <span class="math"><em>x</em><sup>(1)</sup></span> e <span class="math"><em>x</em><sup>(2)</sup></span>. Maneiras apropriadas de escolher estas aproximações podem ser inferidas da interpretação geométrica do método.</p>
<p>Encontre as raízes de <span class="math"><em>f</em>(<em>x</em>) = cos(<em>x</em>) − <em>x</em></span>.</p>
<p>Da inspeção do gráfico das funções <span class="math"><em>y</em> = cos(<em>x</em>)</span> e <span class="math"><em>y</em> = <em>x</em></span>, sabemos que esta equação possui uma raiz em torno de <span class="math"><em>x</em> = 0, 8</span>. Iniciamos o método com <span class="math"><em>x</em><sub>0</sub> = 0, 7</span> e <span class="math"><em>x</em><sub>1</sub> = 0, 8</span>.</p>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math"><em>x</em><sup>(<em>n</em> − 1)</sup></span></th>
<th align="center"><span class="math"><em>x</em><sup>(<em>n</em>)</sup></span></th>
<th align="center"><span class="math"><em>m</em></span></th>
<th align="center"><span class="math"><em>x</em><sup>(<em>n</em> + 1)</sup></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math">$\frac{f(0,8)-f(0,7)}{0,8-0,7} =$</span></td>
<td align="center"><span class="math">$0,8- \frac{f(0,8)}{-1,6813548}=$</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">0, 7</span></td>
<td align="center"><span class="math">0, 8</span></td>
<td align="center"><span class="math"> − 1, 6813548</span></td>
<td align="center"><span class="math">0, 7385654</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">0, 8</span></td>
<td align="center"><span class="math">0, 7385654</span></td>
<td align="center"><span class="math"> − 1, 6955107</span></td>
<td align="center"><span class="math">0, 7390784</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">0, 7385654</span></td>
<td align="center"><span class="math">0, 7390784</span></td>
<td align="center"><span class="math"> − 1, 6734174</span></td>
<td align="center"><span class="math">0, 7390851</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">0, 7390784</span></td>
<td align="center"><span class="math">0, 7390851</span></td>
<td align="center"><span class="math"> − 1, 6736095</span></td>
<td align="center"><span class="math">0, 7390851</span></td>
</tr>
</tbody>
</table>
<h3 id="interpretação-geométrica-1">Interpretação geométrica</h3>
<p>Enquanto, o método de Newton está relacionado às retas tangentes ao gráfico da função objetivo <span class="math"><em>f</em>(<em>x</em>)</span>, o método das secantes, como o próprio nome indica, está relacionado às retas secantes.</p>
<div class="figure">
<embed src="./cap_equacao1d/pics/metodo_das_secantes/metodo_das_secantes.eps" />
<p class="caption">Método das secantes.<span data-label="fig:metododassecantes"></span></p>
</div>
<p>Sejam <span class="math"><em>f</em>(<em>x</em>)</span> e as aproximações <span class="math"><em>x</em><sup>(1)</sup></span> e <span class="math"><em>x</em><sup>(2)</sup></span> do zero <span class="math"><em>x</em><sup> * </sup></span> desta função (veja Figura [fig:metodo<sub>d</sub>as<sub>s</sub>ecantes]). A iteração do método das secantes fornece: <br /><span class="math">$$x^{(3)} = x^{(2)} - f(x^{(2)})\frac{x^{(2)} - x^{(1)}}{f(x^{(2)}) - f(x^{(1)})}.$$</span><br /> De fato, <span class="math"><em>x</em><sup>(3)</sup></span> é o ponto de interseção da reta secante ao gráfico de <span class="math"><em>f</em>(<em>x</em>)</span> pelos pontos <span class="math"><em>x</em><sup>(1)</sup></span> e <span class="math"><em>x</em><sup>(2)</sup></span> com o eixo das abscissas. Com efeito, a equação desta reta secante é: <br /><span class="math">$$y = \frac{f(x^{(2)}) - f(x^{(1)})}{x^{(2)} - x^{(1)}}(x - x^{(2)}) + f(x^{(2)}).$$</span><br /> Esta reta intercepta o eixo das abscissas no ponto <span class="math"><em>x</em></span> tal que <span class="math"><em>y</em> = 0</span>, i.e.: <br /><span class="math">$$\frac{f(x^{(2)}) - f(x^{(1)})}{x^{(2)} - x^{(1)}}(x - x^{(2)}) + f(x^{(2)}) \Rightarrow x = x^{(2)} - f(x^{(2)})\frac{x^{(2)} - x^{(1)}}{f(x^{(2)}) - f(x^{(1)})}.$$</span><br /></p>
<h3 id="análise-de-convergência-1">Análise de convergência</h3>
<p>Uma análise assintótica semelhante aquela feita para o método de Newton nos indica que, para uma função <span class="math"><em>f</em>(<em>x</em>)</span> duas vezes diferenciável, as iterações do método da secante satisfazem: <br /><span class="math">|<em>x</em><sup>(<em>n</em> + 1)</sup> − <em>x</em><sup> * </sup>| ≈ <em>C</em>|<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup> * </sup>||<em>x</em><sup>(<em>n</em> − 1)</sup> − <em>x</em><sup> * </sup>|, </span><br /> para aproximações iniciais suficientemente próximas de <span class="math"><em>x</em><sup> * </sup></span>, onde <span class="math"><em>f</em>(<em>x</em><sup> * </sup>) = 0</span>. Além disso, veremos que: <br /><span class="math">|<em>x</em><sup>(<em>n</em> + 1)</sup> − <em>x</em><sup> * </sup>| ≤ <em>C</em>|<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup> * </sup>|<sup>1, 6</sup></span><br /> sob certas condições. Ou seja, o método das secantes tem <em>taxa de convergência superlinear</em>.</p>
<p>[Método das secantes][teo:metodo<sub>d</sub>as<sub>s</sub>ecantes] Seja <span class="math"><em>f</em> ∈ <em>C</em><sup>2</sup>([<em>a</em>, <em>b</em>])</span> uma função com <span class="math"><em>x</em><sup> * </sup> ∈ (<em>a</em>, <em>b</em>)</span> tal que <span class="math"><em>f</em>(<em>x</em><sup> * </sup>) = 0</span>. Sejam, também: <br /><span class="math"><em>m</em> := min<sub><em>x</em> ∈ [<em>a</em>, <em>b</em>]</sub>|<em>f</em>′(<em>x</em>)| &gt; 0 e <em>M</em> := max<sub><em>x</em> ∈ [<em>a</em>, <em>b</em>]</sub>|<em>f</em>″(<em>x</em>)| &lt; ∞.</span><br /> Além disso, seja <span class="math"><em>ρ</em> &gt; 0</span> tal que: <br /><span class="math">$$q := \frac{M}{2m}\rho &lt; 1,\quad K_\rho(x^*) := \{x\in\mathbb{R};~|x-x^*|\leq \rho\}\subset [a, b].$$</span><br /> Então, para aproximações iniciais <span class="math"><em>x</em><sup>(1)</sup>, <em>x</em><sup>(2)</sup> ∈ <em>K</em><sub><em>ρ</em></sub>(<em>x</em><sup> * </sup>)</span>, com <span class="math"><em>x</em><sup>(1)</sup> ≠ <em>x</em><sup>(2)</sup></span>, temos que as iterações do método das secantes <span class="math"><em>x</em><sup>(<em>n</em>)</sup> ∈ <em>K</em><sub><em>ρ</em></sub>(<em>x</em><sup> * </sup>)</span>, <span class="math"><em>n</em> ≥ 1</span>, e <span class="math"><em>x</em><sup>(<em>n</em>)</sup> → <em>x</em><sup> * </sup></span>, quando <span class="math"><em>n</em> → ∞</span>. Além disso, vale a seguinte estimativa de convergência <em>a priori</em>: <br /><span class="math">$$|x^{(n)} - x^*| \leq \frac{2m}{M}q^{\gamma_{n-1}},\quad n\geq 1,$$</span><br /> onde <span class="math">{<em>γ</em><sub><em>n</em></sub>}<sub><em>n</em> ∈ ℕ</sub></span> é a sequência de Fibonacci<a href="#fn11" class="footnoteRef" id="fnref11"><sup>11</sup></a><a href="#fn12" class="footnoteRef" id="fnref12"><sup>12</sup></a>, bem como vale a estimativa <em>a posteriori</em>: <br /><span class="math">$$|x^{(n)} - x^*| \leq \frac{M}{2m}|x^{(n)}-x^{(n-1)}||x^{(n-1)}-x^{(n-2)}|,\quad n\geq 3.$$</span><br /></p>
<p>Sejam <span class="math"><em>n</em> ∈ ℕ</span>, <span class="math"><em>n</em> ≥ 2</span>, e <span class="math"><em>x</em><sup>(<em>n</em>)</sup>, <em>x</em><sup>(<em>n</em> − 1)</sup> ∈ <em>K</em><sub><em>ρ</em></sub>(<em>x</em><sup> * </sup>)</span>, tal que <span class="math"><em>x</em><sup>(<em>n</em>)</sup> ≠ <em>x</em><sup>(<em>n</em> − 1)</sup></span>, <span class="math"><em>x</em><sup>(<em>n</em>)</sup> ≠ <em>x</em><sup> * </sup></span> e <span class="math"><em>x</em><sup>(<em>n</em> − 1)</sup> ≠ <em>x</em><sup> * </sup></span>. Seja, também: <br /><span class="math">$$g(x^{(n)},x^{(n-1)}) := x^{(n)} - f(x^{(n)})\frac{x^{(n)} - x^{(n-1)}}{f(x^{(n)}) - f(x^{(n-1)})}.$$</span><br /> Com isso, temos: <br /><span class="math">$$\begin{aligned}
    &amp;g(x^{(n)},x^{(n-1)}) - x^* = x^{(n)} - f(x^{(n)})\frac{x^{(n)} - x^{(n-1)}}{f(x^{(n)}) - f(x^{(n-1)})} - x^*\\
    &amp;= \frac{x^{(n)} - x^{(n-1)}}{f(x^{(n)}) - f(x^{(n-1)})}\left\{(x^{(n)} - x^*)\frac{f(x^{(n)}) - f(x^{(n-1)})}{x^{(n)} - x^{(n-1)}} - f(x^{(n)}) + f(x^*)\right\}.\\
  \end{aligned}$$</span><br /> Então, da cota assumida para primeira derivada de <span class="math"><em>f</em>(<em>x</em>)</span> e do Teorema do valor médio, temos: <br /><span class="math">$$\label{eq:secantes-est0}
  |g(x^{(n)},x^{(n-1)}) - x^*| \leq \frac{|x^{(n)} - x^*|}{m}\left|\frac{f(x^{(n)}) - f(x^{(n-1)})}{x^{(n)} - x^{(n-1)}} - \frac{f(x^{(n)}) - f(x^*)}{x^{(n)} - x^*}\right|.$$</span><br /> Agora, iremos estimar este último termo a direita. Para tanto, começamos observando que da expansão em polinômio de Taylor de ordem <span class="math">0</span> da função <span class="math"><em>f</em>(<em>x</em>)</span> com resto na forma integral, temos: <br /><span class="math">$$\begin{aligned}
  \frac{f(x^{(n)}) - f(x^{(n-1)})}{x^{(n)} - x^{(n-1)}} &amp;= -\int_0^1 \frac{d}{dr}f(x^{(n)} + r(x^{(n-1)} - x^{(n)}))\frac{dr}{x^{(n)} - x^{(n-1)}}\\
  &amp;= \int_0^1 f'(x^{(n)} + r(x^{(n-1)} - x^{(n)}))\,dr\end{aligned}$$</span><br /> De forma análogo, temos: <br /><span class="math">$$\frac{f(x^{(n)}) - f(x^*)}{x^{(n)} - x^*} = \int_0^1 f'(x^{(n)} + r(x^* - x^{(n)}))\,dr$$</span><br /> Logo, temos: <br /><span class="math">$$\label{eq:secantes-0}
  \begin{split}
  &amp;\frac{f(x^{(n)}) - f(x^{(n-1)})}{x^{(n)} - x^{(n-1)}} - \frac{f(x^{(n)}) - f(x^*)}{x^{(n)} - x^*} = \\
  &amp;\int_0^1 \left[f'(x^{(n)} + r(x^{(n-1)} - x^{(n)})) - f'(x^{(n)} + r(x^* - x^{(n)}))\right]\,dr.    
  \end{split}$$</span><br /> Agora, novamente temos: <br /><span class="math">$$\begin{split}
  &amp;f'(x^{(n)} + r(x^{(n-1)} - x^{(n)})) - f'(x^{(n)} + r(x^* - x^{(n)}))\\
  &amp;= \int_0^r \frac{d}{ds}f'(x^{(n)} + r(x^{(n-1)} - x^{(n)}) + s(x^* - x^{(n-1)}))\,ds\\
  &amp;= \int_0^r f''(x^{(n)} + r(x^{(n-1)} - x^{(n)}) + s(x^* - x^{(n-1)}))\,ds(x^* - x^{(n-1)}).
  \end{split}$$</span><br /> Então, retornando à Equação  e usando a assumida cota para a segunda derivada, obtemos: <br /><span class="math">$$\left|\frac{f(x^{(n)}) - f(x^{(n-1)})}{x^{(n)} - x^{(n-1)}} - \frac{f(x^{(n)}) - f(x^*)}{x^{(n)} - x^*} \right| \leq \frac{M}{2}|x^{(n-1)} - x^*|.$$</span><br /> Agora, retornando à Equação , obtemos: <br /><span class="math">$$|g(x^{(n)},x^{(n-1)})-x^*| \leq \frac{M}{2m}|x^{(n)}-x^*||x^{(n-1)}-x^*| \leq \frac{M}{2m}\rho^2 &lt; \rho.$$</span><br /> Portanto, concluímos que as iterações do método da secantes <span class="math"><em>x</em><sup>(<em>n</em>)</sup></span> permanecem no conjunto <span class="math"><em>K</em><sub><em>ρ</em></sub>(<em>x</em><sup> * </sup>)</span>, se começarem nele. Além disso, temos demonstrado que: <br /><span class="math">$$|x^{(n+1)} - x^*| \leq \frac{M}{2m}|x^{(n)} - x^*||x^{(n-1)} - x^*|.$$</span><br /> Com isso, temos: <br /><span class="math">$$\rho_n := \frac{M}{2m}|x^{(n)} - x^*| \Rightarrow \rho_{n+1} \leq \rho_{n}\rho_{n-1},\quad n\geq 2.$$</span><br /> Como <span class="math"><em>ρ</em><sub>1</sub> ≤ <em>q</em></span> e <span class="math"><em>ρ</em><sub>2</sub> ≤ <em>q</em></span>, temos <span class="math"><em>ρ</em><sub><em>n</em></sub> ≤ <em>q</em><sup><em>γ</em><sub><em>n</em> − 1</sub></sup></span>, <span class="math"><em>n</em> ≥ 1</span>. Isto mostra a estimativa de convergência <em>a priori</em>: <br /><span class="math">$$|x^{n} - x^*| \leq \frac{2m}{M}q^{\gamma_{n-1}}.$$</span><br /> Além disso, como <span class="math"><em>γ</em><sub><em>n</em></sub> → ∞</span> quando <span class="math"><em>n</em> → ∞</span> e <span class="math"><em>q</em> &lt; 1</span>, temos que as iterações do método das secantes <span class="math"><em>x</em><sup>(<em>n</em>)</sup> → <em>x</em><sup> * </sup></span> quando <span class="math"><em>n</em> → ∞</span>.</p>
<p>Por fim, mostramos a estimativa de convergência <em>a posteriori</em>. Para tanto, da cota assumida para a primeira derivada e do Teorema do valor médio, temos, para <span class="math"><em>n</em> ≥ 3</span>: <br /><span class="math">$$\begin{aligned}
  |x^{(n)} - x^*| &amp;\leq \frac{1}{m}|f(x^{(n)} - f(x^*)|\\
  &amp;= \frac{1}{m}\left|f(x^{(n-1)}) + (x^{(n)} - x^{(n-1)})\frac{f(x^{(n)}) - f(x^{(n-1)})}{x^{(n)} - x^{(n-1)}}\right|\\
  &amp;= \frac{1}{m}\left|x^{(n)} - x^{(n-1)}\right|\left|\frac{f(x^{(n)}) - f(x^{(n-1)})}{x^{(n)} - x^{(n-1)}} + \frac{f(x^{(n-1)})}{x^{(n)} - x^{(n-1)}}\right|.\end{aligned}$$</span><br /> Agora, da iteração do método das secantes: <br /><span class="math">$$x^{(n)} = x^{(n-1)} - f(x^{(n-1)})\frac{x^{(n-1)} - x^{(n-2)}}{f(x^{(n-1)}) - f(x^{(n-2)})},$$</span><br /> temos: <br /><span class="math">$$\frac{f(x^{(n-1)})}{x^{(n)} - x^{(n-1)}} = -\frac{f(x^{(n-1)}) - f(x^{(n-2)})}{x^{(n-1)} - x^{(n-2)}}.$$</span><br /> Logo: <br /><span class="math">$$|x^{(n)} - x^*| \leq \frac{1}{m}|x^{(n)} - x^{(n-1)}|\left|\frac{f(x^{(n-1)}) - f(x^{(n)})}{x^{(n-1)} - x^{(n)}} - \frac{f(x^{(n-1)}) - f(x^{(n-2)})}{x^{(n-1)} - x^{(n-2)}}\right|$$</span><br /> Observamos que o último termo pode ser estimado como feito acima para o termo análogo na Inequação . Com isso, obtemos a estimativa desejada: <br /><span class="math">$$|x^{(n)} - x^*| \leq \frac{M}{2m}|x^{(n)} - x^{(n-1)}||x^{(n)} - x^{(n-2)}|.$$</span><br /></p>
<p>[Sequência de Fibonacci][prop:sequencia<sub>d</sub>e<sub>F</sub>ibonacci] A sequência de Fibonacci <span class="math">{<em>γ</em><sub><em>n</em></sub>}<sub><em>n</em> ∈ ℕ</sub></span> é assintótica a <span class="math">$\gamma_n \sim \lambda_1^{n+1}/\sqrt{5}$</span> e: <br /><span class="math">$$\lim_{n\to\infty} \frac{\gamma_{n+1}}{\gamma_{n}} = \lambda_1,$$</span><br /> onde <span class="math">$\lambda_1 = (1+\sqrt{5})/2\approx 1,618$</span> é a porção áurea.</p>
<p>A sequência de Fibonacci <span class="math">{<em>γ</em><sub><em>n</em></sub>}<sub><em>n</em> ∈ ℕ</sub></span> é definida por <span class="math"><em>γ</em><sub>0</sub> = <em>γ</em><sub>1</sub> = 1</span> e <span class="math"><em>γ</em><sub><em>n</em> + 1</sub> = <em>γ</em><sub><em>n</em></sub> + <em>γ</em><sub><em>n</em> − 1</sub></span>, <span class="math"><em>n</em> ≥ 1</span>. Logo, satisfaz a seguinte equação de diferenças: <br /><span class="math"><em>γ</em><sub><em>n</em> + 2</sub> − <em>γ</em><sub><em>n</em> + 1</sub> − <em>γ</em><sub><em>n</em></sub> = 0,  <em>n</em> ∈ ℕ.</span><br /> Tomando <span class="math"><em>γ</em><sub><em>n</em></sub> = <em>λ</em><sup><em>n</em></sup></span>, <span class="math"><em>λ</em> ≠ 0</span> temos: <br /><span class="math">$$\lambda^n\left(\lambda^2 - \lambda - 1\right) = 0 \Rightarrow   \lambda^2 - \lambda - 1 = 0 \Rightarrow \lambda_{1,2} = \frac{1 \pm \sqrt{5}}{2}.$$</span><br /> Portanto, <span class="math"><em>γ</em><sub><em>n</em></sub> = <em>c</em><sub>1</sub><em>λ</em><sub>1</sub><sup><em>n</em></sup> + <em>c</em><sub>2</sub><em>λ</em><sub>2</sub><sup><em>n</em></sup></span>. Como <span class="math"><em>γ</em><sub>0</sub> = <em>γ</em><sub>1</sub> = 1</span>, as constantes satisfazem: <br /><span class="math">$$\begin{array}{l}
    c_1 + c_2 = 1\\
    c_1\lambda_1 + c_2\lambda_2 = 1
  \end{array}
    \Rightarrow
    c_1 = \frac{1+\sqrt{5}}{2\sqrt{5}},\quad c_2 = -\frac{1-\sqrt{5}}{2\sqrt{5}}.$$</span><br /> Ou seja, obtemos a seguinte forma explícita para os números de Fibonacci: <br /><span class="math">$$\gamma_n = \frac{1}{\sqrt{5}}\left[\left(\frac{1+\sqrt{5}}{2}\right)^{n+1} - \left(\frac{1-\sqrt{5}}{2}\right)^{n+1}\right].$$</span><br /> Daí, segue imediatamente o enunciado.</p>
<p>Sob as hipóteses do Teorema [teo:metodo<sub>d</sub>as<sub>s</sub>ecantes] e da Proposição [prop:sequencia<sub>d</sub>e<sub>F</sub>ibonacci], temos: <br /><span class="math">$$\begin{aligned}
    \lim_{n\to\infty} \frac{|x^{(n+1)}-x^*|}{|x^{(n)} - x^*|^{\lambda_1}} &amp;\leq \lim_{n\to\infty} \frac{M}{2m}|x^{(n)}-x^*|^{1-\lambda_1}|x^{(n-1)}-x^*| \\
    &amp;\leq \lim_{n\to\infty} \left(\frac{2m}{M}\right)^{1-\lambda_1}q^{(2-\lambda_1)\lambda_1^{n}/\sqrt{5}} = 0.
  \end{aligned}$$</span><br /> Isto mostra que o método das secantes (nestas hipóteses) tem taxa de convergência superlinear (<span class="math"><em>λ</em><sub>1</sub> ≈ 1, 6</span>).</p>
<h2 id="critérios-de-parada">Critérios de parada</h2>
<p>Quando usamos métodos iterativos precisamos determinar um critério de parada. A Tabela [tab:quadro<sub>c</sub>omparativo] indica critérios de parada usuais para os métodos que estudamos neste capítulo.</p>
<p>[h!]<span>cccc</span> Método &amp; Convergência &amp; Erro &amp; Critério de parada<br /> &amp; Linear &amp; &amp;<br />&amp; (<span class="math"><em>p</em> = 1</span>) &amp; &amp;<br />&amp; &amp; &amp;<br />Iteração &amp; Linear &amp; &amp;<br />linear &amp; (<span class="math"><em>p</em> = 1</span>) &amp; &amp;<br />&amp; &amp; &amp;<br /> &amp; Quadrática &amp; &amp;<br />&amp; (<span class="math"><em>p</em> = 2</span>) &amp; &amp;<br />&amp; &amp; &amp;<br /> &amp; &amp; &amp;<br />&amp; &amp; &amp;<br />&amp; &amp; &amp;<br />&amp; &amp; &amp;<br /></p>
<p>O erro na tabela sempre se refere ao erro absoluto esperado. Nos três últimos métodos, é comum que se exija como critério de parada que a condição seja satisfeita por alguns poucos passos consecutivos. Outros critérios podem ser usados. No métodos das secantes, deve-se ter o cuidado de evitar divisões por zero quando <span class="math"><em>x</em><sub><em>n</em> + 1</sub> − <em>x</em><sub><em>n</em></sub></span> muito pequeno em relação à resolução do sistema de numeração.</p>
<h2 id="exercícios-9" class="unnumbered">Exercícios</h2>
<p>Refaça as questões [new1], [new2], [new3] e [new4], usando o método das secantes.</p>
<p>Dê uma interpretação geométrica ao método das secantes. Qual a vantagem do método das secantes sobre o método de Newton?</p>
<p>Aplique o método das secantes para resolver a equação <br /><span class="math"><em>e</em><sup> − <em>x</em><sup>2</sup></sup> = 2<em>x</em></span><br /></p>
<p>Refaça o problema [prob<sub>d</sub>iodo] usando o método de Newton e das secantes.</p>
<p>Seja dada uma função <span class="math"><em>f</em>(<em>x</em>)</span> duas vezes continuamente diferenciável. Faça uma análise assintótica para mostrar que as iterações do método das secantes satisfazem: <br /><span class="math">|<em>x</em><sup>(<em>n</em> + 1)</sup> − <em>x</em><sup> * </sup>| ≈ <em>C</em>|<em>x</em><sup>(<em>n</em>)</sup> − <em>x</em><sup> * </sup>||<em>x</em><sup>(<em>n</em> − 1)</sup> − <em>x</em><sup> * </sup>|, </span><br /> para aproximações iniciais <span class="math"><em>x</em><sup>(1)</sup></span> e <span class="math"><em>x</em><sup>(2)</sup></span> suficientemente próximas de <span class="math"><em>x</em><sup> * </sup></span>, onde <span class="math"><em>f</em>(<em>x</em><sup> * </sup>) = 0</span>.</p>
<p>Seja <span class="math"><em>f</em>(<em>x</em>) ∈ <em>C</em><sup>2</sup></span> um função tal que <span class="math"><em>f</em>(<em>x</em><sup> * </sup>) = 0</span> e <span class="math"><em>f</em>′(<em>x</em><sup> * </sup>) ≠ 0</span>. Considere o processo iterativo do método das secantes: <br /><span class="math">$$x^{(n+1)}=x^{(n)}- \frac{f(x^{(n)})}{f(x^{(n)})-f(x^{(n-1)})}(x^{(n)}-x^{(n-1)})$$</span><br /> Esta expressão pode ser escrita como: <br /><span class="math">$$\begin{aligned}
x^{(n+1)}&amp;=&amp;x^{(n)}- \frac{f(x^{(n)})(x^{(n)}-x^{(n-1)})}{f(x^{(n)})-f(x^{(n-1)})}\\~\\
 &amp;=&amp;\frac{x^{(n)}\left(f(x^{(n)})-f(x^{(n-1)})\right)-f(x^{(n)})(x^{(n)}-x^{(n-1)})}{f(x^{(n)})-f(x^{(n-1)})}\\
 &amp;=&amp;\frac{x^{(n)} f(x^{(n-1)})-x^{(n-1)}f(x^{(n)})}{f(x^{(n)})-f(x^{(n-1)})}\end{aligned}$$</span><br /></p>
<p>Subtraindo <span class="math"><em>x</em><sup> * </sup></span> de ambos os lados temos: <br /><span class="math">$$\begin{aligned}
x^{(n+1)}-x^*
 &amp;=&amp;\frac{x^{(n)} f(x^{(n-1)})-x^{(n-1)}f(x^{(n)})}{f(x^{(n)})-f(x^{(n-1)})}-x^*\\
 &amp;=&amp;\frac{x^{(n)} f(x^{(n-1)})-x^{(n-1)}f(x^{(n)})-x^*\left(f(x^{(n)})-f(x^{(n-1)})\right)}{f(x^{(n)})-f(x^{(n-1)})}\\
 &amp;=&amp;\frac{(x^{(n)}-x^*) f(x^{(n-1)})-(x^{(n-1)}-x^*)f(x^{(n)})}{f(x^{(n)})-f(x^{(n-1)})}\end{aligned}$$</span><br /></p>
<p>Definimos <span class="math"><em>ϵ</em><sub><em>n</em></sub> = <em>x</em><sub><em>n</em></sub> − <em>x</em><sup> * </sup></span>, equivalente a <span class="math"><em>x</em><sub><em>n</em></sub> = <em>x</em><sup> * </sup> + <em>ϵ</em><sub><em>n</em></sub></span> <br /><span class="math">$$\begin{aligned}
\epsilon_{n+1}
 &amp;=&amp;\frac{\epsilon_n f(x^*+\epsilon_{n-1})-\epsilon_{n-1}f(x^*+\epsilon_n)}{f(x^*+\epsilon_n)-f(x^*+\epsilon_{n-1})}\end{aligned}$$</span><br /></p>
<p>Aproximamos a função <span class="math"><em>f</em>(<em>x</em>)</span> no numerador por <br /><span class="math">$$\begin{aligned}
f(x^*+\epsilon)&amp;\approx&amp; f(x^*)+\epsilon f'(x^*) + \epsilon^2 \frac{f''(x^*)}{2}\\
f(x^*+\epsilon)&amp;\approx&amp; \epsilon f'(x^*) + \epsilon^2 \frac{f''(x^*)}{2}\end{aligned}$$</span><br /></p>
<p><br /><span class="math">$$\begin{aligned}
\epsilon_{n+1}
 &amp;\approx&amp;\frac{\epsilon_n \left[\epsilon_{n-1} f'(x^*) + \epsilon_{n-1}^2 \frac{f''(x^*)}{2}\right]-\epsilon_{n-1}\left[\epsilon_{n} f'(x^*) + \epsilon_{n}^2 \frac{f''(x^*)}{2}\right]}{f(x^*+\epsilon_n)-f(x^*+\epsilon_{n-1})}\\
~\\ &amp;=&amp;\frac{\frac{f''(x^*)}{2}\left(\epsilon_{n}\epsilon_{n-1}^2-\epsilon_{n-1}\epsilon_{n}^2\right)}{f(x^*+\epsilon_n)-f(x^*+\epsilon_{n-1})}\\
~\\ &amp;=&amp;\frac{1}{2}\frac{{f''(x^*)}\epsilon_{n}\epsilon_{n-1}\left(\epsilon_{n-1}-\epsilon_{n}\right)}{f(x^*+\epsilon_n)-f(x^*+\epsilon_{n-1})}\end{aligned}$$</span><br /></p>
<p>Observamos, agora, que <br /><span class="math">$$\begin{split}
  f(x^*+\epsilon_n)-f(x^*+\epsilon_{n-1}) &amp;\approx \left[f(x^*)+f'(x^*)\epsilon_n\right]-\left[f(x^*)+f'(x^*)\epsilon_{n-1}\right] \\
  &amp;=f'(x^*)(\epsilon_n-\epsilon_{n-1})  
  \end{split}$$</span><br /></p>
<p>Portanto: <br /><span class="math">$$\epsilon_{n+1}\approx \frac{1}{2}\frac{f''(x^*)}{f'(x^*)} \epsilon_n \epsilon_{n-1}$$</span><br /> ou, equivalentemente: <br /><span class="math">$$x^{(n+1)}-x^*\approx \frac{1}{2}\frac{f''(x^*)}{f'(x^*)} \left(x^{(n)}-x^*\right) \left(x^{(n-1)}-x^*\right)$$</span><br /></p>
<h2 id="exercícios-finais" class="unnumbered">Exercícios finais</h2>
<p>A equação <br /><span class="math">cos(<em>π</em><em>x</em>) = <em>e</em><sup> − 2<em>x</em></sup></span><br /> tem infinitas raízes. Usando métodos numéricos encontre as primeiras raízes dessa equação. Verifique a j-ésima raiz (<span class="math"><em>z</em><sub><em>j</em></sub></span>) pode ser aproximada por <span class="math"><em>j</em> − 1/2</span> para <span class="math"><em>j</em></span> grande. Use o método de Newton para encontrar uma aproximação melhor para <span class="math"><em>z</em><sub><em>j</em></sub></span>.</p>
<p><span class="math"><em>z</em><sub>1</sub> ≈ 0.3252768</span>, <span class="math"><em>z</em><sub>2</sub> ≈ 1.5153738</span>, <span class="math"><em>z</em><sub>3</sub> ≈ 2.497846</span>, <span class="math"><em>z</em><sub>4</sub> ≈ 3.5002901</span>, <span class="math">$z_j\approx j-1/2-(-1)^j\frac{e^{-2j+1}}{\pi}, ~~~j&gt;4$</span></p>
<p>[title=Eletricidade]A corrente elétrica, <span class="math"><em>I</em></span>, em Ampères em uma lâmpada em função da tensão elétrica, <span class="math"><em>V</em></span>, é dada por <br /><span class="math">$$I=\left(\frac{V}{150}\right)^{0.8}$$</span><br /> Qual a potência da lâmpada quando ligada em série com uma resistência de valor R a uma fonte de 150V quando. (procure erro inferior a 1%)</p>
<ul>
<li><p><span class="math"><em>R</em> = 0Ω</span></p></li>
<li><p><span class="math"><em>R</em> = 10Ω</span></p></li>
<li><p><span class="math"><em>R</em> = 50Ω</span></p></li>
<li><p><span class="math"><em>R</em> = 100Ω</span></p></li>
<li><p><span class="math"><em>R</em> = 500Ω</span></p></li>
</ul>
<p><span class="math">150</span> W, <span class="math">133</span> W, <span class="math">87</span> W, <span class="math">55</span> W, <span class="math">6, 5</span> W</p>
<p>(Bioquímica) A concentração sanguínea de um medicamente é modelado pela seguinte expressão <br /><span class="math"><em>c</em>(<em>t</em>) = <em>A</em><em>t</em><em>e</em><sup> − <em>λ</em><em>t</em></sup></span><br /> onde <span class="math"><em>t</em> &gt; 0</span> é o tempo em minutos decorrido desde a administração da droga. <span class="math"><em>A</em></span> é a quantidade administrada em <span class="math"><em>m</em><em>g</em>/<em>m</em><em>l</em></span> e <span class="math"><em>λ</em></span> é a constante de tempo em min<span class="math"><em></em><sup> − 1</sup></span>. Responda:</p>
<ul>
<li><p>Sendo <span class="math"><em>λ</em> = 1/3</span>, em que instantes de tempo a concentração é metade do valor máximo. Calcule com precisão de segundos.</p></li>
<li><p>Sendo <span class="math"><em>λ</em> = 1/3</span> e <span class="math"><em>A</em> = 100<em>m</em><em>g</em>/<em>m</em><em>l</em></span>, durante quanto tempo a concentração permanece maior que <span class="math">10<em>m</em><em>g</em>/<em>m</em><em>l</em></span>.</p></li>
</ul>
<p>a) <span class="math">42</span> s e <span class="math">8</span> min<span class="math">2</span> s, b) <span class="math">14</span> min<span class="math">56</span> s.</p>
<p>[pop] Considere o seguinte modelo para crescimento populacional em um país: <br /><span class="math"><em>P</em>(<em>t</em>) = <em>A</em> + <em>B</em><em>e</em><sup><em>λ</em><em>t</em></sup>.</span><br /> onde <span class="math"><em>t</em></span> é dado em anos. Use <span class="math"><em>t</em></span> em anos e <span class="math"><em>t</em> = 0</span> para 1960. Encontre os parâmetros <span class="math"><em>A</em></span>, <span class="math"><em>B</em></span> e <span class="math"><em>λ</em></span> com base nos anos de 1960, 1970 e 1991 conforme tabela:<br /> </p>
<table>
<thead>
<tr class="header">
<th align="center">Ano</th>
<th align="center">população</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1960</td>
<td align="center">70992343</td>
</tr>
<tr class="even">
<td align="center">1970</td>
<td align="center">94508583</td>
</tr>
<tr class="odd">
<td align="center">1980</td>
<td align="center">121150573</td>
</tr>
<tr class="even">
<td align="center">1991</td>
<td align="center">146917459</td>
</tr>
</tbody>
</table>
<p>Use esses parâmetros para calcular a população em 1980 e compare com o valor do censo.</p>
<p><span class="math">118940992</span></p>
<p>[title=Fluidos][boiaesf] Uma boia esférica flutua na água. Sabendo que a boia tem <span class="math">10ℓ</span> de volume e 2Kg de massa. Calcule a altura da porção molhada da boia.</p>
<p><span class="math">7, 7</span> cm</p>
<p>[title= Fluidos][boiacil] Uma boia cilíndrica tem secção transversal circular de raio 10cm e comprimento 2m e pesa 10Kg. Sabendo que a boia flutua sobre água com o eixo do cilindro na posição horizontal, calcule a altura da parte molhada da boia.</p>
<p><span class="math">4, 32</span> cm</p>
<p>Encontre com 6 casas decimais o ponto da curva <span class="math"><em>y</em> = ln<em>x</em></span> mais próximo da origem.</p>
<p><span class="math">(0, 652919, 0, 426303)</span></p>
<p>[title= Matemática financeira] Um computador é vendido pelo valor a vista de R$2.000,00 ou em 1+15 prestações de R$200,00. Calcule a taxa de juros associada à venda a prazo.</p>
<p><span class="math">7, 19</span>% ao mês</p>
<p>[title= Matemática financeira] O valor de R$110.000,00 é financiado conforme a seguinte programa de pagamentos:</p>
<table>
<thead>
<tr class="header">
<th align="center">Mês</th>
<th align="center">pagamento</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">20.000,00</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">20.000,00</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">20.000,00</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">19.000,00</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">18.000,00</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">17.000,00</td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="center">16.000,00</td>
</tr>
</tbody>
</table>
<p>Calcule a taxa de juros envolvida. A data do empréstimo é o mês zero.</p>
<p><span class="math">4, 54</span>% ao mês.</p>
<p>[title=Controle de sistemas] Depois de acionado um sistema de aquecedores, a temperatura em um forno evolui conforme a seguinte equação <br /><span class="math"><em>T</em>(<em>t</em>) = 500 − 800<em>e</em><sup> − <em>t</em></sup> + 600<em>e</em><sup> − <em>t</em>/3</sup>.</span><br /> onde <span class="math"><em>T</em></span> é a temperatura em Kelvin e <span class="math"><em>t</em></span> é tempo em horas.</p>
<ul>
<li><p>Obtenha analiticamente o valor de <span class="math">lim<sub><em>t</em> → ∞</sub><em>T</em>(<em>t</em>)</span>.</p></li>
<li><p>Obtenha analiticamente o valor máximo de <span class="math"><em>T</em>(<em>t</em>)</span> e o instante de tempo quando o máximo acontece</p></li>
<li><p>Obtenha numericamente com precisão de minutos o tempo decorrido até que a temperatura passe pela primeira vez pelo valor de equilíbrio obtido no item a.</p></li>
<li><p>Obtenha numericamente com precisão de minutos a duração do período durante o qual a temperatura permanece pelo menos 20% superior ao valor de equilíbrio.</p></li>
</ul>
<p><span class="math">500</span> K, <span class="math">700</span> K em <span class="math"><em>t</em> = 3ln(2)</span>, <span class="math">26</span> min, <span class="math">4</span> h<span class="math">27</span> min.</p>
<p>Encontre os pontos onde a elipse que satisfaz <span class="math">$\frac{x^2}{3}+y^2=1$</span> intersepta a parábola <span class="math"><em>y</em> = <em>x</em><sup>2</sup> − 2</span>.</p>
<p><span class="math">( ± 1, 1101388,  − 0, 7675919)</span>, <span class="math">( ± 1, 5602111, 0, 342585)</span></p>
<p>[title= Otimização] Encontre a área do maior retângulo que é possível inscrever entre a curva <span class="math"><em>e</em><sup> − <em>x</em><sup>2</sup></sup>(1 + cos(<em>x</em>))</span> e o eixo <span class="math"><em>y</em> = 0</span>.</p>
<p><span class="math">1, 5318075</span></p>
<p>[title=Otimização] [usinas] Uma indústria consome energia elétrica de duas usinas fornecedoras. O custo de fornecimento em reais por hora como função da potência consumida em <span class="math"><em>k</em><em>W</em></span> é dada pelas seguintes funções <br /><span class="math">$$\begin{aligned}
C_1(x)&amp;=&amp; 500+.27 x + 4.1\cdot 10^{-5}x^2 +2.1\cdot 10^{-7}x^3+4.2\cdot 10^{-10}x^4 \\
C_2(x)&amp;=&amp; 1000+.22 x + 6.3\cdot 10^{-5}x^2 +8.5\cdot 10^{-7}x^3\end{aligned}$$</span><br /> Onde <span class="math"><em>C</em><sub>1</sub>(<em>x</em>)</span> e <span class="math"><em>C</em><sub>2</sub>(<em>x</em>)</span> são os custos de fornecimento das usinas 1 e 2, respectivamente. Calcule o custo mínimo da energia elétrica quando a potência total consumida é <span class="math">1500<em>k</em><em>W</em></span>.</p>
<p>Aproximadamente 2500 reais por hora.</p>
<p>[title= Termodinâmica] A pressão de saturação (em bar) de um dado hidrocarboneto pelo ser modelada pela equação de Antoine: <br /><span class="math">$$\ln\left(P^{sat}\right)=A-\frac{B}{T+C}$$</span><br /> onde <span class="math"><em>T</em></span> é a temperatura e <span class="math"><em>A</em></span>, <span class="math"><em>B</em></span> e <span class="math"><em>C</em></span> são constantes dadas conforme a seguir:</p>
<table>
<thead>
<tr class="header">
<th align="center">Hidrocarboneto</th>
<th align="center">A</th>
<th align="center">B</th>
<th align="center">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">N-pentano</td>
<td align="center">9.2131</td>
<td align="center">2477.07</td>
<td align="center">-39.94</td>
</tr>
<tr class="even">
<td align="center">N-heptano</td>
<td align="center">9.2535</td>
<td align="center">2911.32</td>
<td align="center">-56.51</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Calcule a temperatura de bolha de uma mistura de N-pentano e N-heptano à pressão de 1.2bar quando as frações molares dos gases são <span class="math"><em>z</em><sub>1</sub> = <em>z</em><sub>2</sub> = 0.5</span>. Para tal utilize a seguinte equação: <br /><span class="math"><em>P</em> = ∑<sub><em>i</em></sub><em>z</em><sub><em>i</em></sub><em>P</em><sub><em>i</em></sub><sup><em>s</em><em>a</em><em>t</em></sup></span><br /></p></li>
<li><p>Calcule a temperatura de orvalho de uma mistura de N-pentano e N-heptano à pressão de 1.2bar quando as frações molares dos gases são <span class="math"><em>z</em><sub>1</sub> = <em>z</em><sub>2</sub> = 0.5</span>. Para tal utilize a seguinte equação: <br /><span class="math">$$\frac{1}{P}=\sum_i \frac{z_i}{P_i^{sat}}$$</span><br /></p></li>
</ul>
<p>a) <span class="math">332, 74</span> K b) <span class="math">359, 33</span> K</p>
<p>Encontre os três primeiros pontos de mínimo da função <br /><span class="math"><em>f</em>(<em>x</em>) = <em>e</em><sup> − <em>x</em>/11</sup> + <em>x</em>cos(2<em>x</em>)</span><br /> para <span class="math"><em>x</em> &gt; 0</span> com erro inferior a <span class="math">10<sup> − 7</sup></span>.</p>
<p><span class="math">1, 2285751</span>, <span class="math">4, 76770758</span>, <span class="math">7, 88704085</span></p>
<h1 id="resolução-de-sistemas-lineares">Resolução de sistemas lineares</h1>
<p>Muitos problemas da engenharia, física e matemática estão associados a resolução de sistemas de equações lineares. Nesse capítulo trataremos das técnicas empregadas para obter a solução desses sistemas.</p>
<p>Considere o sistema de equações lineares <br /><span class="math">$$\begin{aligned}
a_{11}x_1 + a_{12}x_2 + \cdots +a_{1n}x_n &amp;= b_1\\
a_{21}x_1 + a_{22}x_2 + \cdots +a_{2n}x_n &amp;= b_2\\
                                          &amp;\vdots \\
a_{m1}x_1 + a_{m2}x_2 + \cdots +a_{mn}x_n &amp;= b_m\end{aligned}$$</span><br /> onde <span class="math"><em>m</em></span> é o número de equações e <span class="math"><em>n</em></span> é o número de incógnitas. Este sistema pode ser escrito na forma matricial <br /><span class="math"><em>A</em><em>x</em> = <em>b</em></span><br /> onde <br /><span class="math">$$A=\begin{bmatrix}
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n}\\
a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
a_{m1} &amp; a_{m2} &amp; \cdots &amp; a_{mn}
\end{bmatrix},
x=\begin{bmatrix}
x_{1} \\
x_{2} \\
\vdots \\
x_{n}
\end{bmatrix}
 \text{ e } b=\begin{bmatrix}
b_{1} \\
b_{2} \\
\vdots \\
b_{m}
\end{bmatrix}$$</span><br /></p>
<h2 id="eliminação-gaussiana">Eliminação gaussiana</h2>
<p>Lembramos que algumas operações feitas nas linhas de um sistema não alteram a solução:</p>
<ol>
<li><p>Multiplicação de um linha por um número</p></li>
<li><p>Troca de uma linha por ela mesma somada a um múltiplo de outra.</p></li>
<li><p>Troca de duas linhas.</p></li>
</ol>
<p>O processo que transforma um sistema em outro com mesma solução, mas que apresenta uma forma triangular é chamado eliminação Gaussiana. A solução do sistema pode ser obtida fazendo substituição regressiva.</p>
<p>[Eliminação Gaussiana sem pivotamento] Resolva o sistema <br /><span class="math">$$\begin{aligned}
    x+y+z  &amp;=1\\
    2x+y-z &amp;=0\\
    2x+2y+z&amp;=1
  \end{aligned}$$</span><br /></p>
<p>A matriz completa do sistema é escrita como <br /><span class="math">$$\left[\begin{array}{ccc|c}
      1 &amp;1&amp; 1&amp;1\\
      2 &amp;1&amp; -1&amp;0\\
      2 &amp; 2 &amp;1&amp;1
    \end{array}\right] \sim 
  \left[\begin{array}{ccc|c}
      1 &amp;1&amp; 1&amp;1\\
      0 &amp;-1&amp; -3&amp;-2\\
      0 &amp; 0 &amp;-1&amp;-1
    \end{array}\right]$$</span><br /> Encontramos <span class="math"> − <em>z</em> =  − 1</span>, ou seja, <span class="math"><em>z</em> = 1</span>. Substituindo na segunda equação, temos <span class="math"> − <em>y</em> − 3<em>z</em> =  − 2</span>, ou seja, <span class="math"><em>y</em> =  − 1</span> e finalmente <span class="math"><em>x</em> + <em>y</em> + <em>z</em> = 1</span>, resultando em <span class="math"><em>x</em> = 1</span>.</p>
<h3 id="eliminação-gaussiana-com-pivotamento-parcial">Eliminação Gaussiana com pivotamento parcial</h3>
<p>A Eliminação Gaussiana com <em>pivotamento parcial</em> consiste em fazer uma permutação de linhas de forma a escolher o maior pivô (em módulo) a cada passo.</p>
<p>[Eliminação Gaussiana com pivotamento parcial] Resolva o sistema <br /><span class="math">$$\begin{aligned}
  x+y+z &amp;=1\\
  2x+y-z&amp;=0\\
  2x+2z+z&amp;=1\end{aligned}$$</span><br /></p>
<p>A matriz completa do sistema é <br /><span class="math">$$\begin{aligned}
  \begin{bmatrix}
  1 &amp;1&amp;  1&amp;1\\
  \RED{2} &amp;1&amp; -1&amp;0\\
  2 &amp; 2 &amp;1&amp;1
  \end{bmatrix}
&amp;\sim
  \begin{bmatrix}
  2 &amp;1&amp; -1&amp;0\\
  1 &amp;1&amp;  1&amp;1\\
  2 &amp;2&amp;  1&amp;1
  \end{bmatrix} 
&amp;\sim 
  \begin{bmatrix}
  2 &amp;1&amp; -1&amp;0\\
  0 &amp;1/2&amp; 3/2&amp;1\\
  0 &amp; 1 &amp;2&amp;1
  \end{bmatrix}\\
&amp;\sim
  \begin{bmatrix}
  2 &amp;1&amp; -1&amp;0\\
  0 &amp; 1 &amp;2&amp;1\\
  0 &amp;1/2&amp; 3/2&amp;1
  \end{bmatrix}
&amp;\sim 
  \begin{bmatrix}
  2 &amp;1&amp; -1&amp;0\\
  0 &amp; 1 &amp;2&amp;1\\
  0 &amp;0&amp; 1/2&amp;1/2
  \end{bmatrix}\end{aligned}$$</span><br /></p>
<p>Encontramos <span class="math">1/2<em>z</em> = 1/2</span>, ou seja, <span class="math"><em>z</em> = 1</span>. Substituímos na segunda equação e temos <span class="math"><em>y</em> + 2<em>z</em> = 1</span>, ou seja, <span class="math"><em>y</em> =  − 1</span> e, finalmente <span class="math">2<em>x</em> + <em>y</em> − <em>z</em> = 0</span>, resultando em <span class="math"><em>x</em> = 1</span>.</p>
<p>Resolva o sistema por eliminação gaussiana com pivotamento parcial. <br /><span class="math">$$\left[
\begin{array}{ccc}
0 &amp;2&amp; 2\\
1 &amp;2&amp; 1\\
1 &amp; 1 &amp;1
\end{array}
\right]
\left[
\begin{array}{c}
x\\
y\\
z
\end{array}
\right]=
\left[
\begin{array}{c}
8\\
9\\
6
\end{array}
\right]$$</span><br /></p>
<p>Construímos a matriz completa: <br /><span class="math">$$\begin{aligned}
\left[
\begin{array}{ccc|c}
0 &amp;2&amp; 2&amp;8\\
1 &amp;2&amp; 1&amp;9\\
1 &amp; 1 &amp;1&amp;6
\end{array}
\right] &amp;\sim&amp;
\left[
\begin{array}{ccc|c}
1 &amp;2&amp; 1&amp;9\\
0 &amp;2&amp; 2&amp;8\\
1 &amp; 1 &amp;1&amp;6
\end{array}
\right] \\ 
&amp;\sim&amp;
\left[
\begin{array}{ccc|c}
1 &amp;2&amp; 1&amp;9\\
0 &amp;2&amp; 2&amp;8\\
0 &amp; -1 &amp;0&amp;-3
\end{array}
\right]\\
&amp;\sim&amp;
\left[
\begin{array}{ccc|c}
1 &amp;2&amp; 1&amp;9\\
0 &amp;2&amp; 2&amp;8\\
0 &amp; 0 &amp;1&amp;1
\end{array}
\right]\\
&amp;\sim&amp;
\left[
\begin{array}{ccc|c}
1 &amp;2&amp; 0&amp;8\\
0 &amp;2&amp; 0&amp;6\\
0 &amp; 0 &amp;1&amp;1
\end{array}
\right]\\
&amp;\sim&amp;
\left[
\begin{array}{ccc|c}
1 &amp;0&amp; 0&amp;2\\
0 &amp;2&amp; 0&amp;6\\
0 &amp; 0 &amp;1&amp;1
\end{array}
\right]\end{aligned}$$</span><br /> Portanto <span class="math"><em>x</em> = 2</span>, <span class="math"><em>y</em> = 3</span> e <span class="math"><em>z</em> = 1</span>.</p>
<p>[Problema com elementos com grande diferença de escala] <br /><span class="math">$$\left[\begin{array}{cc}
\varepsilon &amp; 2\\
1 &amp; \varepsilon
\end{array}\right]
\left[\begin{array}{c}x\\y
\end{array}\right]=
\left[\begin{array}{c}4\\3
\end{array}\right]$$</span><br /> Executamos a eliminação gaussiana sem pivotamento parcial para <span class="math"><em>ε</em> ≠ 0</span> e <span class="math">|<em>ε</em>| &lt;  &lt; 1</span>: <br /><span class="math">$$\left[\begin{array}{cc|c}
\varepsilon &amp; 2 &amp; 4\\
1 &amp; \varepsilon &amp; 3
\end{array}
\right]\sim\left[\begin{array}{cc|c}
\varepsilon &amp; 2 &amp; 4\\
0 &amp; \varepsilon-\frac{2}{\varepsilon} &amp; 3-\frac{4}{\varepsilon}
\end{array}
\right]
%\sim
%\left[\begin{array}{cc|c}
%\varepsilon &amp; 0 &amp; 4-\left(3-\frac{4}{\varepsilon}\right) \frac{2}{\varepsilon-\frac{2}{\varepsilon}}\\
%0 &amp; \varepsilon-\frac{2}{\varepsilon} &amp; 3-\frac{4}{\varepsilon}
%\end{array}
%\right]$$</span><br /></p>
<p>Temos <br /><span class="math">$$y=\frac{3-4/\varepsilon}{\varepsilon-2/\varepsilon}$$</span><br />e <br /><span class="math">$$x=\frac{4-2y}{\varepsilon}$$</span><br /> Observe que a expressão obtida para <span class="math"><em>y</em></span> se aproximada de <span class="math">2</span> quando <span class="math"><em>ε</em></span> é pequeno: <br /><span class="math">$$y=\frac{3-4/\varepsilon}{\varepsilon-2/\varepsilon}=\frac{3\varepsilon-4}{\varepsilon^2-2} \longrightarrow \frac{-4}{-2}=2, ~~\hbox{quando}~\varepsilon \to 0.$$</span><br /> Já expressão obtida para <span class="math"><em>x</em></span> depende justamente da diferença <span class="math">2 − <em>y</em></span>: <br /><span class="math">$$x=\frac{4-2y}{\varepsilon}=\frac{2}{\varepsilon} (2-y)$$</span><br /></p>
<p>Assim, quando <span class="math"><em>ε</em></span> é pequeno, a primeira expressão, implementado em um sistema de ponto flutuante de acurácia finita, produz <span class="math"><em>y</em> = 2</span> e, consequentemente, a expressão para <span class="math"><em>x</em></span> produz <span class="math"><em>x</em> = 0</span>. Isto é, estamos diante um problema de cancelamento catastrófico.</p>
<p>Agora, quando usamos a Eliminação Gaussiana com pivotamento parcial, fazemos uma permutação de linhas de forma a escolher o maior pivô a cada passo:</p>
<p><br /><span class="math">$$\left[\begin{array}{cc|c}
\varepsilon &amp; 2 &amp; 4\\
1 &amp; \varepsilon &amp; 3
\end{array}
\right]\sim
\left[\begin{array}{cc|c}
1 &amp; \varepsilon &amp; 3\\
\varepsilon &amp; 2 &amp; 4
\end{array}
\right]\sim
\left[\begin{array}{cc|c}
1 &amp; \varepsilon &amp; 3\\
0 &amp; 2-\varepsilon^2 &amp; 4-3\varepsilon
\end{array}
\right]$$</span><br /></p>
<p>Continuando o procedimento, temos: <br /><span class="math">$$y=\frac{4-4\varepsilon}{2-\varepsilon^2}$$</span><br /> e <br /><span class="math"><em>x</em> = 3 − <em>ε</em><em>y</em></span><br /></p>
<p>Observe que tais expressões são analiticamente idênticas às anteriores, no entanto, são mais estáveis numericamente. Quando <span class="math"><em>ε</em></span> converge a zero, <span class="math"><em>y</em></span> converge a <span class="math">2</span>, como no caso anterior. No entanto, mesmo que <span class="math"><em>y</em> = 2</span>, a segunda expressão produz <span class="math"><em>x</em> = 3 − <em>ε</em><em>y</em></span>, isto é, a aproximação <span class="math"><em>x</em> ≈ 3</span> não depende mais de obter <span class="math">2 − <em>y</em></span> com precisão.</p>
<h2 id="exercícios-10" class="unnumbered">Exercícios</h2>
<p>[prob<sub>g</sub>ausspp] Resolva o seguinte sistema de equações lineares <br /><span class="math">$$\begin{aligned}
x+y+z&amp;=&amp;0\\
x+10z&amp;=&amp;-48\\
10y+z&amp;=&amp;25\end{aligned}$$</span><br /> Usando eliminação gaussiana com pivoteamento parcial (não use o computador para resolver essa questão).</p>
<p>Escrevemos o sistema na forma matricial e resolvemos: <br /><span class="math">$$\begin{aligned}
\left[
\begin{array}{ccc|c}
1&amp;1&amp;1&amp;0\\
1&amp;0&amp;10&amp;-48\\
0&amp;10&amp;1&amp;25
\end{array}\right] &amp;\sim&amp;
\left[
\begin{array}{ccc|c}
1&amp;1&amp;1&amp;0\\
0&amp;-1&amp;9&amp;-48\\
0&amp;10&amp;1&amp;25
\end{array}\right] \sim
\left[
\begin{array}{ccc|c}
1&amp;1&amp;1&amp;0\\
0&amp;10&amp;1&amp;25\\
0&amp;-1&amp;9&amp;-48
\end{array}\right]\sim\\
&amp;\sim&amp;\left[
\begin{array}{ccc|c}
1&amp;1&amp;1&amp;0\\
0&amp;10&amp;1&amp;25\\
0&amp;0&amp;9.1&amp;-45.5
\end{array}\right]\sim
\left[
\begin{array}{ccc|c}
1&amp;1&amp;1&amp;0\\
0&amp;10&amp;1&amp;25\\
0&amp;0&amp;1&amp;-5
\end{array}\right]\sim\\
&amp;\sim&amp;\left[
\begin{array}{ccc|c}
1&amp;1&amp;0&amp;5\\
0&amp;10&amp;0&amp;30\\
0&amp;0&amp;1&amp;-5
\end{array}\right]
\sim\left[
\begin{array}{ccc|c}
1&amp;1&amp;0&amp;5\\
0&amp;1&amp;0&amp;3\\
0&amp;0&amp;1&amp;-5
\end{array}\right]\sim\\
&amp;\sim&amp;\left[
\begin{array}{ccc|c}
1&amp;0&amp;0&amp;2\\
0&amp;1&amp;0&amp;3\\
0&amp;0&amp;1&amp;-5
\end{array}\right]\end{aligned}$$</span><br /> Portanto <span class="math"><em>x</em> = 2</span>, <span class="math"><em>y</em> = 3</span>, <span class="math"><em>z</em> =  − 5</span></p>
<p>Resolva o seguinte sistema de equações lineares <br /><span class="math">$$\begin{aligned}
x+y+z&amp;=&amp;0\\
x+10z&amp;=&amp;-48\\
10y+z&amp;=&amp;25\end{aligned}$$</span><br /> Usando eliminação gaussiana com pivotamento parcial (não use o computador para resolver essa questão).</p>
<p>Calcule a inversa da matriz <br /><span class="math">$$A=\left[\begin{array}{ccc}
1&amp;2&amp;-1\\
-1&amp;2&amp;0\\
2&amp;1&amp;-1
\end{array}
\right]$$</span><br /> usando eliminação Gaussiana com pivotamento parcial.</p>
<p>[inv22] Demonstre que se <span class="math"><em>a</em><em>d</em> ≠ <em>b</em><em>c</em></span>, então a matriz <span class="math"><em>A</em></span> dada por: <br /><span class="math">$$A=\left[\begin{array}{cc}a&amp;b\\c&amp;d\end{array}\right]$$</span><br /> é inversível e sua inversa é dada por: <br /><span class="math">$$A^{-1}= \frac{1}{ad-bc} \left[\begin{array}{cc}d&amp;-b\\-c&amp;a\end{array}\right].$$</span><br /></p>
<p>Considere as matrizes <br /><span class="math">$$A=
\left[
\begin{array}{ccc}
0&amp;0&amp;1\\
0&amp;1&amp;0\\
1&amp;0&amp;0
\end{array}\right]$$</span><br /> e <br /><span class="math">$$E=
\left[
\begin{array}{ccc}
1&amp;1&amp;1\\
1&amp;1&amp;1\\
1&amp;1&amp;1
\end{array}\right]$$</span><br /> e o vetor <br /><span class="math">$$v=
\left[
\begin{array}{c}
2\\
3\\
4
\end{array}\right]$$</span><br /></p>
<ul>
<li><p>Resolva o sistema <span class="math"><em>A</em><em>x</em> = <em>v</em></span> sem usar o computador.</p></li>
<li><p>Sem usar o computador e através da técnica algébrica de sua preferência, resolva o sistema <span class="math">(<em>A</em> + <em>ε</em><em>E</em>)<em>x</em><sub><em>ε</em></sub> = <em>v</em></span> considerando <span class="math">|<em>ε</em>| &lt;  &lt; 1</span> e obtenha a solução exata em função do parâmetro <span class="math"><em>ε</em></span>.</p></li>
<li><p>Usando a expressão analítica obtida acima, calcule o limite <span class="math">lim<sub><em>ε</em> → 0</sub><em>x</em><sub><em>ε</em></sub></span>.</p></li>
<li><p>Resolva o sistema <span class="math">(<em>A</em> + <em>ε</em><em>E</em>)<em>x</em> = <em>v</em></span> no <code>Scilab</code> usando pivotamento parcial e depois sem usar pivotamento parcial para valores muito pequenos de <span class="math"><em>ε</em></span> como <span class="math">10<sup> − 10</sup>, 10<sup> − 15</sup>, …</span>. O que você observa?</p></li>
</ul>
<ul>
<li><p><span class="math"><em>x</em> = [4  3  2]<sup><em>T</em></sup></span></p></li>
<li><p>O sistema é equivalente a <br /><span class="math">$$\begin{array}{lclclcl}
\varepsilon x_1 &amp;+&amp; \varepsilon x_2 &amp;+&amp;(1+\varepsilon) x_3 &amp;=&amp; 2\\
\varepsilon x_1 &amp;+&amp; (1+\varepsilon) x_2 &amp;+&amp;\varepsilon x_3 &amp;=&amp; 3\\
(1+\varepsilon) x_1 &amp;+&amp; \varepsilon x_2 &amp;+&amp;\varepsilon x_3 &amp;=&amp; 4\\
\end{array}$$</span><br /> Somando as três equações temos <br /><span class="math">$$(1+3\varepsilon)(x_1+x_2+x_3)=9\Longrightarrow x_1+x_2+x_3=\frac{9}{1+3\varepsilon}$$</span><br /> Subtraímos <span class="math"><em>ε</em>(<em>x</em><sub>1</sub> + <em>x</em><sub>2</sub> + <em>x</em><sub>3</sub>)</span> da cada equação do sistema original e temos: <br /><span class="math">$$\begin{array}{l}
x_3=2-\frac{9\varepsilon}{1+3\varepsilon}\\[.4cm]
x_2=3-\frac{9\varepsilon}{1+3\varepsilon}\\[.4cm]
x_1=4-\frac{9\varepsilon}{1+3\varepsilon}
\end{array}$$</span><br /> Assim temos: <br /><span class="math">$$x_{\varepsilon}=\left[4 ~~3 ~~2\right]^T-\frac{9\varepsilon}{1+3\varepsilon}\left[1 ~~1 ~~1\right]^T$$</span><br /></p></li>
</ul>
<p>[trid] Resolva o seguinte sistema de <span class="math">5</span> equações lineares <br /><span class="math">$$\begin{aligned}
x_1-x_2&amp;=&amp;0\\
-x_{i-1}+2.5x_i-x_{i+1}&amp;=&amp;e^{-\frac{(i-3)^2}{20}},\qquad 2\leq i \leq 4\\
2x_{5}-x_{4}&amp;=&amp;0\end{aligned}$$</span><br /> representando-o como um problema do tipo <span class="math"><em>A</em><em>x</em> = <em>b</em></span> no <code>Scilab</code> e usando o comando de contra-barra para resolvê-lo. Repita usando a rotina que implementa eliminação gaussiana.</p>
<p><span class="math"><em>x</em> = [1.6890368  1.6890368  1.5823257  1.2667776  0.6333888]<sup><em>T</em></sup></span></p>
<p>Encontre a inversa da matriz <br /><span class="math">$$\left[
\begin{array}{ccc}
1&amp;1&amp;1\\
1&amp;-1&amp;2\\
1&amp;1&amp;4
\end{array}\right]$$</span><br /></p>
<ul>
<li><p>Usando Eliminação Gaussiana com pivotamento parcial à mão.</p></li>
<li><p>Usando a rotina ’gausspp()’.</p></li>
<li><p>Usando a rotina ’inv()’ do <code>Scilab</code>.</p></li>
</ul>
<p><br /><span class="math">$$\left[ \begin {array}{ccc} 1&amp;1/2&amp;-1/2\\1/3&amp;-1/2&amp;1/6
\\-1/3&amp;0&amp;1/3\end {array} \right]$$</span><br /></p>
<h2 id="complexidade-de-algoritmos-em-álgebra-linear">Complexidade de Algoritmos em Álgebra Linear</h2>
<p>Dados dois algoritmos diferentes para resolver o mesmo problema, como podemos escolher qual desses algoritmos é o melhor? Se pensarmos em termos de <em>eficiência</em> (ou custo computacional), queremos saber qual desses algoritmos consome menos recursos para realizar a mesma tarefa.</p>
<p>Em geral podemos responder essa pergunta de duas formas: em termos de tempo ou de espaço.</p>
<p>Quando tratamos de <em>eficiência espacial</em>, queremos saber quanta memória (em geral RAM) é utilizada pelo algoritmo para armazenar os dados, sejam matrizes, vetores ou escalares.</p>
<p>Quando tratamos de <em>eficiência temporal</em>, queremos saber quanto tempo um algoritmo leva para realizar determinada tarefa. Vamos nos concentrar nessa segunda opção, que em geral é a mais difícil de ser respondida.</p>
<p>Obviamente o tempo vai depender do tipo de computador utilizado. É razoável de se pensar que o tempo vai ser proporcional ao número de operações de ponto flutuante (flops) feito pelo algoritmo (observe que o tempo total não depende apenas disso, mas também de outros fatores como memória, taxas de transferências de dados da memória para o cpu, redes,...). Entretanto vamos nos concentrar na contagem do número de operações (flops) para realizar determinada tarefa.</p>
<p>No passado (antes dos anos 80), os computadores demoravam mais tempo para realizar operações como multiplicação e divisão, se comparados a adição ou subtração. Assim, em livros clássicos eram contados apenas o custo das operações <span class="math"> × </span> e <span class="math">/</span>. Nos computadores atuais as quatro operações básicas levam o mesmo tempo. Entretanto, na maioria dos algoritmos de álgebra linear o custo associado as multiplicações e divisões é proporcional ao custo das somas e subtrações (pois a maioria dessas operações podem ser escritas como a combinação de produtos internos). Dessa forma, na maior parte deste material levaremos em conta somente multiplicações e divisões, a não ser que mencionado o contrário.</p>
<p>Tenha em mente que a ideia é estimar o custo a medida que o tamanho dos vetores e matrizes cresce muito (para <span class="math"><em>n</em></span> grande).</p>
<p>[Produto escalar-vetor] Qual o custo para multiplicar um escalar por um vetor?</p>
<p>Seja <span class="math"><em>a</em> ∈ <strong>R</strong></span> e <span class="math">$\vec{x} \in \mathbf{R}^n$</span>, temos que <br /><span class="math">$$a \vec{x} = [a\times x_1 , a\times x_2 , ... ,a\times x_n]$$</span><br /> usando <span class="math"><em>n</em></span> multiplicações, ou seja, um custo computacional, <span class="math"><em>C</em></span>, de <br /><span class="math"><em>C</em> = <em>n</em> flops.</span><br /></p>
<p>[Produto vetor-vetor] Qual o custo para calcular o produto interno <span class="math">$\vec{x}\cdot\vec{y}$</span>?</p>
<p>Sejam <span class="math">$\vec{x}, \vec{y} \in \mathbf{R}^n$</span>, temos que <br /><span class="math">$$\vec{x}\cdot\vec{y} = x_1 \times y_1 + x_2\times y_2 + ... +x_n\times y_n$$</span><br /></p>
<p>São realizadas <span class="math"><em>n</em></span> multiplicações (cada produto <span class="math"><em>x</em><sub><em>i</em></sub></span> por <span class="math"><em>y</em><sub><em>i</em></sub></span>) e <span class="math"><em>n</em> − 1</span> somas, ou seja, o custo total de operações é de <br /><span class="math"><em>C</em> := (<em>n</em>) + (<em>n</em> − 1) = 2<em>n</em> − 1 flops</span><br /></p>
<p>[Produto matriz-vetor] Qual o custo para calcular o produto de matriz por vetor <span class="math">$A \vec{x}$</span>?</p>
<p>Sejam <span class="math"><em>A</em> ∈ <strong>R</strong><sup><em>n</em> × <em>n</em></sup></span> e <span class="math">$\vec{x} \in \mathbf{R}^n$</span>, temos que <br /><span class="math">$$\matddd{a_{11}}{a_{12}}{\cdots a_{1n}}{\vdots}{}{\vdots}{a_{n1}}{}{\cdots a_{nn}} \vetddd{x_1}{\vdots }{x_n}
  =\vetddd{ a_{11}\times x_1 + a_{12}x_2 +...+a_{1n}\times x_n }{\vdots }{a_{n1}\times x_1 + a_{n2}x_2 +...+a_{nn}\times x_n}$$</span><br /></p>
<p>Para obter o primeiro elemento do vetor do lado direito devemos multiplicar a primeira linha de <span class="math"><em>A</em></span> pelo vetor coluna <span class="math">$\vec{x}$</span>. Note que esse é exatamente o custo do produto vetor-vetor do exemplo anterior. Como o custo para cada elemento do vetor do lado direito é o mesmo e temos <span class="math"><em>n</em></span> elementos, teremos que o custo para multiplicar matriz-vetor é<a href="#fn13" class="footnoteRef" id="fnref13"><sup>13</sup></a> <br /><span class="math"><em>C</em> := <em>n</em> ⋅ (2<em>n</em> − 1) = 2<em>n</em><sup>2</sup> − <em>n</em> flops.</span><br /></p>
<p>A medida que <span class="math"><em>n</em> → ∞</span>, temos <br /><span class="math">𝒪(2<em>n</em><sup>2</sup> − <em>n</em>) = 𝒪(2<em>n</em><sup>2</sup>) = 𝒪(<em>n</em><sup>2</sup>) flops.</span><br /></p>
<p>[Produto matriz-matriz] Qual o custo para calcular o produto de duas matrizes <span class="math"><em>A</em><em>B</em></span>?</p>
<p>Sejam <span class="math"><em>A</em>, <em>B</em> ∈ <strong>R</strong><sup><em>n</em> × <em>n</em></sup></span> temos que <br /><span class="math">$$\matddd{a_{11}}{a_{12}}{\cdots a_{1n}}{\vdots}{}{\vdots}{a_{n1}}{}{\cdots a_{nn}}
  \matddd{b_{11}}{b_{12}}{\cdots a_{1n}}{\vdots}{}{\vdots}{b_{n1}}{}{\cdots b_{nn}} 
 =\matddd{c_{11}}{c_{12}}{\cdots c_{1n}}{\vdots}{}{\vdots}{c_{n1}}{}{\cdots c_{nn}}$$</span><br /> onde o elemento <span class="math"><em>d</em><sub><em>i</em><em>j</em></sub></span> é o produto da linha <span class="math"><em>i</em></span> de <span class="math"><em>A</em></span> pela coluna <span class="math"><em>j</em></span> de <span class="math"><em>B</em></span>, <br /><span class="math"><em>d</em><sub><em>i</em><em>j</em></sub> = <em>a</em><sub><em>i</em>1</sub> × <em>b</em><sub>1<em>j</em></sub> + <em>a</em><sub><em>i</em>2</sub> × <em>b</em><sub>2<em>j</em></sub> + ... + <em>a</em><sub><em>i</em>2</sub> × <em>b</em><sub>2<em>j</em></sub></span><br /> Note que esse produto tem o custo do produto vetor-vetor, ou seja, <span class="math">2<em>n</em> − 1</span>. Como temos <span class="math"><em>n</em> × <em>n</em></span> elementos em <span class="math"><em>D</em></span>, o custo total para multiplicar duas matrizes é<a href="#fn14" class="footnoteRef" id="fnref14"><sup>14</sup></a> <br /><span class="math"><em>C</em> = <em>n</em> × <em>n</em> × (2<em>n</em> − 1) = 2<em>n</em><sup>3</sup> − <em>n</em><sup>2</sup> flops.</span><br /></p>
<h2 id="sistemas-triangulares">Sistemas triangulares</h2>
<p>Considere um sistema linear onde a matriz é triangular superior, ou seja, <br /><span class="math">$$\begin{bmatrix}
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n}\\
0      &amp; a_{22} &amp; \cdots &amp; a_{2n}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
0      &amp; \dots  &amp; 0     &amp; a_{nn}
\end{bmatrix}
\begin{bmatrix}
x_{1} \\
x_{2} \\
\vdots \\
x_{n}
\end{bmatrix} 
 =\begin{bmatrix}
b_{1} \\
b_{2} \\
\vdots \\
b_{n}
\end{bmatrix}$$</span><br /> tal que todos elementos abaixo da diagonal são iguais a zero.</p>
<p>Podemos resolver esse sistema iniciando pela última equação e isolando <span class="math"><em>x</em><sub><em>n</em></sub></span> obtemos <br /><span class="math"><em>x</em><sub><em>n</em></sub> = <em>b</em><sub><em>n</em></sub>/<em>a</em><sub><em>n</em><em>n</em></sub></span><br /></p>
<p>Substituindo <span class="math"><em>x</em><sub><em>n</em></sub></span> na penúltima equação <br /><span class="math"><em>a</em><sub><em>n</em> − 1, <em>n</em> − 1</sub><em>x</em><sub><em>n</em> − 1</sub> + <em>a</em><sub><em>n</em> − 1, <em>n</em></sub><em>x</em><sub><em>n</em></sub> = <em>b</em><sub><em>n</em> − 1</sub></span><br /> e isolando <span class="math"><em>x</em><sub><em>n</em> − 1</sub></span> obtemos <br /><span class="math"><em>x</em><sub><em>n</em> − 1</sub> = (<em>b</em><sub><em>n</em> − 1</sub> − <em>a</em><sub><em>n</em> − 1, <em>n</em></sub><em>x</em><sub><em>n</em></sub>)/<em>a</em><sub><em>n</em> − 1, <em>n</em> − 1</sub></span><br /> e continuando desta forma até a primeira equação obteremos <br /><span class="math"><em>x</em><sub>1</sub> = (<em>b</em><sub>1</sub> − <em>a</em><sub>12</sub><em>x</em><sub>2</sub>⋯ − <em>a</em><sub>1<em>n</em></sub><em>x</em><sub><em>n</em></sub>)/<em>a</em><sub>11</sub>.</span><br /> De forma geral, temos que <br /><span class="math"><em>x</em><sub><em>i</em></sub> = (<em>b</em><sub><em>i</em></sub> − <em>a</em><sub><em>i</em>, <em>i</em> + 1</sub><em>x</em><sub><em>i</em> + 1</sub>⋯ − <em>a</em><sub><em>i</em>, <em>n</em></sub><em>x</em><sub><em>n</em></sub>)/<em>a</em><sub><em>i</em>, <em>i</em></sub>,  <em>i</em> = 2, …, <em>n</em>.</span><br /></p>
<h3 id="algoritmo-para-resolução-de-um-sistema-triangular-superior">Algoritmo para resolução de um sistema triangular superior</h3>
<p>Para resolver um sistema triangular superior iniciamos da última linha em direção a primeira.</p>
<pre><code>1.  function [x]=solveU(U,b)  # U:= matriz triangular superior
2.      n=size(U,1)           # b:= vetor
3.      x(n)=b(n)/U(n,n)
4.      for i=n-1:-1:1
5.          x(i)=(b(i)-U(i,i+1:n)*x(i+1:n)  )/U(i,i)
6.      end
7.  endfunction</code></pre>
<h3 id="algoritmo-para-resolução-de-um-sistema-triangular-inferior">Algoritmo para resolução de um sistema triangular inferior</h3>
<p>Para resolver um sistema triangular inferior podemos fazer o processo inverso iniciando da primeira equação.</p>
<pre><code>1. function [x]=solveL(L,b)   # L: matriz triangular inferior
2.    n=size(L,1)             # b: vetor
3.    x(1)=b(1)/L(1,1)
4.    for i=2:n
5.        x(i)=(b(i)-L(i,1:i-1)*x(1:i-1)  )/L(i,i)
6.    end
7.endfunction</code></pre>
<h4 id="custo-computacional">Custo computacional</h4>
<p>Vamos contar o número total de flops para resolver um sistema triangular inferior. Note que o custo para um sistema triangular superior será o mesmo.</p>
<p>Na linha 3, temos uma divisão, portanto 1 flop.</p>
<p>Na linha 5 quando <span class="math"><em>i</em> = 2</span>, temos</p>
<p><code>     x(2)=(b(2)-L(2,1:1)*x(1:1))/L(2,2)</code>,</p>
<p>ou seja, 1 subtração+1 multiplicação + 1 divisão <span class="math"> = 3</span> flops.</p>
<p>Quando <span class="math"><em>i</em> = 3</span>,</p>
<p><code>     x(3)=(b(3)-L(3,1:2)*x(1:2))/L(3,3)</code></p>
<p>temos 1 subtração+(2 multiplicações + 1 soma) +1 divisão <span class="math"> = 5</span> flops.</p>
<p>Quando <span class="math"><em>i</em> = 4</span>, temos 1 subtração+(3 multiplicações + 2 somas) +1 divisão <span class="math"> = 7</span> flops.</p>
<p>Até que para <span class="math"><em>i</em> = <em>n</em></span>, temos</p>
<p><code>     x(n)=(b(n)-L(n,1:n-1)*x(1:n-1))/L(n,n)</code>,</p>
<p>com <span class="math">1</span> subtração+(<span class="math"><em>n</em> − 1</span> multiplicações + <span class="math"><em>n</em> − 2</span> somas) + <span class="math">1</span> divisão, ou seja, <span class="math">1 + (<em>n</em> − 1 + <em>n</em> − 2) + 1 = 2<em>n</em> − 1</span> flops.</p>
<p>Somando todos esses custos<a href="#fn15" class="footnoteRef" id="fnref15"><sup>15</sup></a> temos que o custo para resolver um sistema triangular inferior é <br /><span class="math">$$1 +3+5+7+...+2n-1=  \sum_{k=1}^n(2k-1) = 2 \sum_{k=1}^nk -\sum_{k=1}^n1$$</span><br /> e utilizando que a soma dos <span class="math"><em>k</em></span> inteiros é uma progressão aritmética<a href="#fn16" class="footnoteRef" id="fnref16"><sup>16</sup></a> <br /><span class="math">2(<em>n</em>(<em>n</em> + 1)/2) − <em>n</em> = <em>n</em><sup>2</sup> flops.</span><br /></p>
<h2 id="fatoração-lu">Fatoração LU</h2>
<p>Considere um sistema linear onde a matriz <span class="math"><em>A</em></span> é densa<a href="#fn17" class="footnoteRef" id="fnref17"><sup>17</sup></a>. Para resolver o sistema, podemos transformar a matriz <span class="math"><em>A</em></span> nas matrizes <span class="math"><em>L</em></span>, triangular inferior, e <span class="math"><em>U</em></span>, triangular superior de tal forma que <span class="math"><em>A</em> = <em>L</em><em>U</em></span>.</p>
<p>Sendo assim o sistema pode ser reescrito tal que <br /><span class="math">$$\begin{aligned}
  Ax &amp;=b \\
  (LU)x &amp;=b \\
  L(Ux) &amp;=b \\
  L y = b \quad &amp; \text{ e } \quad Ux=y\end{aligned}$$</span><br /> Assim ao invés de resolvermos o sistema original, devemos resolver um sistema triangular inferior e um sistema triangular superior.</p>
<p>A matriz <span class="math"><em>U</em></span> da fatoração<a href="#fn18" class="footnoteRef" id="fnref18"><sup>18</sup></a> <span class="math"><em>L</em><em>U</em></span> é a matriz obtida ao final do escalonamento da matriz <span class="math"><em>A</em></span>.</p>
<p>A matriz <span class="math"><em>L</em></span> inicia igual a identidade <span class="math"><em>I</em></span>. Os elementos da matriz <span class="math"><em>L</em></span> são os múltiplos do primeiro elemento da linha de <span class="math"><em>A</em></span> dividido pelo pivô acima na mesma coluna.</p>
<p>Por exemplo, para zerar o primeiro elemento da segunda linha de <span class="math"><em>A</em></span>, calculamos <br /><span class="math"><em>L</em><sub>21</sub> = <em>A</em><sub>21</sub>/<em>A</em><sub>11</sub></span><br /> e fazemos <br /><span class="math"><em>A</em><sub>2,  : </sub> ⇐ <em>A</em><sub>2,  : </sub> − <em>L</em><sub>21</sub><em>A</em><sub>1,  : </sub></span><br /></p>
<p>Note que usaremos <span class="math"><em>A</em><sub><em>i</em>,  : </sub></span> para nos referenciarmos a linha <span class="math"><em>i</em></span> de <span class="math"><em>A</em></span>. Da mesma forma, se necessário usaremos <span class="math"><em>A</em><sub> : , <em>j</em></sub></span> para nos referenciarmos a linha <span class="math"><em>j</em></span> de <span class="math"><em>A</em></span>.</p>
<p>Para zerar o primeiro elemento da terceira linha de <span class="math"><em>A</em></span>, temos <br /><span class="math"><em>L</em><sub>31</sub> = <em>A</em><sub>31</sub>/<em>A</em><sub>11</sub></span><br /> e fazemos <br /><span class="math"><em>A</em><sub>3,  : </sub> ⇐ <em>A</em><sub>3,  : </sub> − <em>L</em><sub>31</sub><em>A</em><sub>1,  : </sub></span><br /> até chegarmos ao último elemento da primeira coluna de <span class="math"><em>A</em></span>.</p>
<p>Repetimos o processo para as próximas colunas, escalonando a matriz <span class="math"><em>A</em></span> e coletando os elementos <span class="math"><em>L</em><sub><em>i</em><em>j</em></sub></span> abaixo da diagonal<a href="#fn19" class="footnoteRef" id="fnref19"><sup>19</sup></a>.</p>
<h3 id="algoritmo-para-fatoração-lu">Algoritmo para fatoração LU</h3>
<p>O algoritmo para fatoração <span class="math"><em>L</em><em>U</em></span> pode ser escrito como</p>
<pre><code> 1. function [L,A]=fatoraLU(A)
 2.     n=size(A,1)
 3.     L=eye(n,n)
 4.     for j=1:n-1
 5.         for i=j+1:n
 6.             L(i,j    )=A(i,j)/A(j,j)
 7.             A(i,j+1:n)=A(i,j+1:n)-L(i,j)*A(j,j+1:n)
 8.             A(i,j    )=0
 9.         end
10.     end
11. endfunction</code></pre>
<h4 id="custo-computacional-1">Custo computacional</h4>
<p>Podemos analisar o custo computacional reduzindo o problema em problemas menores. Na linha 4, iniciamos com <span class="math"><em>j</em> = 1</span>. Desta forma <span class="math"><em>i</em></span> varia de <span class="math">2</span> até <span class="math"><em>n</em></span> na linha 5.</p>
<p>A linha 6 terá sempre 1 flop.</p>
<p>A linha 7, com <span class="math"><em>j</em> = 1</span> tem um bloco de tamanho <code>2:n</code> contabilizando <span class="math"><em>n</em> − 1</span> flops do produto e <span class="math"><em>n</em> − 1</span> flops da subtração.</p>
<p>Nas linhas 6-8 são feitas <span class="math">(2(<em>n</em> − 1) + 1) = 2<em>n</em> − 1</span> flops independente do valor de <span class="math"><em>i</em></span>. Como <span class="math"><em>i</em></span> varia de <span class="math">2</span> até <span class="math"><em>n</em></span>, teremos que o bloco é repetido <span class="math"><em>n</em> − 1</span> vezes, ou seja, o custo das linhas 5-9 é <br /><span class="math">(<em>n</em> − 1) × (2(<em>n</em> − 1) + 1) = 2(<em>n</em> − 1)<sup>2</sup> + (<em>n</em> − 1)</span><br /></p>
<p>Voltamos a linha 4 quando <span class="math"><em>j</em> = 2</span>. Das linhas 6-8 teremos <span class="math"><em>n</em> − 2</span> flops (o bloco terá um elemento a menos) que será repetido <span class="math"><em>n</em> − 2</span> vezes, pois <code>i=3:n</code>, ou seja, <br /><span class="math">(<em>n</em> − 2) × (2(<em>n</em> − 2) + 1) = 2(<em>n</em> − 2)<sup>2</sup> + (<em>n</em> − 2)</span><br /></p>
<p>Para <span class="math"><em>j</em> = 3</span>, temos <span class="math">2(<em>n</em> − 3)<sup>2</sup> + (<em>n</em> − 3)</span>.</p>
<p>Para <span class="math"><em>j</em> = <em>n</em> − 2</span>, temos <span class="math">2(2)<sup>2</sup> + 2</span>.</p>
<p>Finalmente, para <span class="math"><em>j</em> = <em>n</em> − 1</span>, temos <span class="math">2 ⋅ 1<sup>2</sup> + 1</span>.</p>
<p>Somando todos esses custos, temos <br /><span class="math">$$\begin{aligned}
  (n-1)+2(n-1)^2 + &amp; (n-2)+2(n-2)^2+... %\\&amp;
   + (2)+2(2)^2+1+2\cdot 1\\
 =&amp; \sum_{k=1}^{n-1}2k^2+k \\ 
 =&amp; 2\sum_{k=1}^{n-1}k^2+\sum_{k=1}^{n-1}k\\
 =&amp; 2 \frac{(n-1)n(2n-1)}{6}+ \frac{n(n-1)}{2} \\
 =&amp; \frac{2n^3}{3}-\frac{n^2}{2}-\frac{n}{6} \text{~flops}.\end{aligned}$$</span><br /></p>
<h3 id="custo-computacional-para-resolver-um-sistema-linear-usando-fatoração-lu">Custo computacional para resolver um sistema linear usando fatoração LU</h3>
<p>Para calcularmos o custo computacional de um algoritmo completo, uma estratégia é separar o algoritmo em partes menores mais fáceis de calcular.</p>
<p>Para resolver o sistema, devemos primeiro fatorar a matriz <span class="math"><em>A</em></span> nas matrizes <span class="math"><em>L</em></span> e <span class="math"><em>U</em></span>. Vimos que o custo é <br /><span class="math">$$\frac{2n^3}{3}-\frac{n^2}{2}-\frac{n}{6} \text{~flops}.$$</span><br /></p>
<p>Depois devemos resolver os sistemas <span class="math"><em>L</em><em>y</em> = <em>b</em></span> e <span class="math"><em>U</em><em>x</em> = <em>y</em></span>. O custo de resolver os dois sistemas é (devemos contar duas vezes) <br /><span class="math">2<em>n</em><sup>2</sup> flops.</span><br /></p>
<p>Somando esses <span class="math">3</span> custos, temos que o custo para resolver um sistema linear usando fatoração <span class="math"><em>L</em><em>U</em></span> é <br /><span class="math">$$\frac{2n^3}{3}+\frac{3n^2}{2}-\frac{n}{6} \text{~flops}.$$</span><br /></p>
<p>Quando <span class="math"><em>n</em></span> cresce, prevalessem os termos de mais alta ordem, ou seja, <br /><span class="math">$$\mathcal{O}(\frac{2n^3}{3}+\frac{3n^2}{2}-\frac{n}{6}) = \mathcal{O}(\frac{2n^3}{3}+\frac{3n^2}{2})=\mathcal{O}(\frac{2n^3}{3})$$</span><br /></p>
<h3 id="custo-para-resolver-m-sistemas-lineares">Custo para resolver m sistemas lineares</h3>
<p>Devemos apenas multiplicar <span class="math"><em>m</em></span> pelo custo de resolver um sistema linear usando fatoração <span class="math"><em>L</em><em>U</em></span>, ou seja, o custo será <br /><span class="math">$$m(\frac{2n^3}{3}+\frac{3n^2}{2}-\frac{n}{6})=\frac{2mn^3}{3}+\frac{3mn^2}{2}-\frac{mn}{6}$$</span><br /> e com <span class="math"><em>m</em> = <em>n</em></span> temos <br /><span class="math">$$\frac{2n^4}{3}+\frac{3n^3}{2}-\frac{n^2}{6}.$$</span><br /></p>
<p>Porém, se estivermos resolvendo <span class="math"><em>n</em></span> sistemas com <em>a mesma matriz <span class="math"><em>A</em></span></em> (e diferente lado direito <span class="math">$\vec b$</span> para cada sistema) podemos fazer a fatoração LU uma única vez e contar apenas o custo de resolver os sistemas triangulares obtidos.</p>
<p>Custo para fatoração LU de <span class="math"><em>A</em></span>: <span class="math">$\frac{2n^3}{3}-\frac{n^2}{2}-\frac{n}{6}$</span>.</p>
<p>Custo para resolver <span class="math"><em>m</em></span> sistemas triangulares inferiores: <span class="math"><em>m</em><em>n</em><sup>2</sup></span>.</p>
<p>Custo para resolver <span class="math"><em>m</em></span> sistemas triangulares superiores: <span class="math"><em>m</em><em>n</em><sup>2</sup></span>.</p>
<p>Somando esses custos obtemos <br /><span class="math">$$\frac{2n^3}{3}-\frac{n^2}{2}-\frac{n}{6}+2m n^2$$</span><br /> que quando <span class="math"><em>m</em> = <em>n</em></span> obtemos <br /><span class="math">$$\frac{8n^3}{3}-\frac{n^2}{2}-\frac{n}{6} \text{~flops}.$$</span><br /></p>
<h3 id="custo-para-calcular-a-matriz-inversa-de-a">Custo para calcular a matriz inversa de <span class="math"><em>A</em></span></h3>
<p>Como vemos em Álgebra Linear, um método para obter a matriz <span class="math"><em>A</em><sup> − 1</sup></span> é realizar o escalonamento da matriz <span class="math">[<em>A</em>|<em>I</em>]</span> onde <span class="math"><em>I</em></span> é a matriz identidade. Ao terminar o escalonamento, o bloco do lado direito conterá <span class="math"><em>A</em><sup> − 1</sup></span>.</p>
<p>Isto é equivalente a resolver <span class="math"><em>n</em></span> sistemas lineares com a mesma matriz <span class="math"><em>A</em></span> e os vetores da base canônica <span class="math">$\vec e_i = [0,...,0,1,0,....0]^T$</span> tal que <br /><span class="math">$$A \vec x_i = \vec e_i, \quad\quad i=1:n$$</span><br /> onde <span class="math">$\vec x_i$</span> serão as colunas da matriz <span class="math"><em>A</em></span> inversa, já que <span class="math"><em>A</em><em>X</em> = <em>I</em></span>.</p>
<p>O custo para resolver esses <span class="math"><em>n</em></span> sistemas lineares foi calculado na seção anterior como <br /><span class="math">$$\frac{8n^3}{3}-\frac{n^2}{2}-\frac{n}{6}.$$</span><br /></p>
<p>Qual o melhor método para resolver um sistema linear: via fatoração LU ou calculando a inversa de <span class="math"><em>A</em></span> e obtendo <span class="math"><em>x</em> = <em>A</em><sup> − 1</sup><em>b</em></span>?</p>
<h2 id="condicionamento-de-sistemas-lineares">Condicionamento de sistemas lineares</h2>
<p>Quando lidamos com matrizes no corpo do números reais (ou complexos), existem apenas duas alternativas: i) a matriz é inversível; ii) a matriz não é inversível e, neste caso, é chamada de matriz singular. Ao lidarmos em aritmética de precisão finita, encontramos uma situação mais sutil: alguns problema lineares são mais difíceis de serem resolvidos, pois os erros de arredondamento se propagam de forma mais significativa que em outros problemas. Neste caso falamos de problemas bem-condicionados e mal-condicionados. Intuitivamente falando, um problema bem-condicionado é um problema em que os erros de arredondamento se propagam de forma menos importante; enquanto problemas mal-condicionados são problemas em que os erros se propagam de forma mais relevante.</p>
<p>Um caso típico de sistema mal-condicionado é aquele cujos coeficiente estão muito próximos ao de um problema singular. Considere o seguinte exemplo:</p>
<p>Observe que o problema <br /><span class="math">$$\left\{ \begin{array}{l}71x+41y=100\\
\lambda x+30y=70
\end{array}
\right.$$</span><br /> é impossível quando <span class="math">$\lambda= \frac{71\times 30}{41}\approx 51,95122$</span>.</p>
<p>Agora, verifique o que acontece quando resolvemos os seguintes sistemas lineares: <br /><span class="math">$$\left\{ \begin{array}{l}71x+41y=100\\
52x+30y=70
\end{array}
\right. \\ \hbox{ e }
\left\{ \begin{array}{l}71x+41y=100\\
51x+30y=70
\end{array}
\right. \\$$</span><br /> A solução do primeiro problema é <span class="math"><em>x</em> =  − 65</span> e <span class="math"><em>y</em> = 115</span>. Já para o segundo problema é <span class="math">$x=\frac{10}{3}$</span> e <span class="math">$y=-\frac{10}{3}$</span>.</p>
<p>Igualmente, observe os seguintes dois problemas: <br /><span class="math">$$\left\{ \begin{array}{l}71x+41y=100\\
52x+30y=70
\end{array}
\right. \\ \hbox{ e }
\left\{ \begin{array}{l}71x+41y=100,4\\
52x+30y=69,3
\end{array}
\right. \\$$</span><br /> A solução do primeiro problema é <span class="math"><em>x</em> =  − 65</span> e <span class="math"><em>y</em> = 115</span> e do segundo problema é <span class="math"><em>x</em> =  − 85, 35</span> e <span class="math"><em>y</em> = 150, 25</span>.</p>
<p>Observe que pequenas variações nos coeficientes das matrizes fazem as soluções ficarem bem distintas, isto é, pequenas variações nos dados de entrada acarretaram em grandes variações na solução do sistema. Quando isso acontece, dizemos que o problema é mal-condicionados.</p>
<p>Para introduzir essa ideia formalmente, precisamos definir o número de condicionamento. Informalmente falando, o número de condicionamento mede o quanto a solução de um problema em função de alterações nos dados de entrada. Para construir matematicamente este conceito, precisamos de uma medida destas variações. Como tanto os dados de entrada como os dados de saída são expressos na forma vetorial, precisaremos do conceito de norma vetorial. Por isso, faremos uma breve interrupção de nossa discussão para introduzir as definições de norma de vetores e matrizes na próxima seção.</p>
<h3 id="norma-l_p-de-vetores">Norma <span class="math"><em>L</em><sub><em>p</em></sub></span> de vetores</h3>
<p>Definimos a norma <span class="math"><em>L</em><sub><em>p</em></sub></span> ou <span class="math"><em>L</em><sup><em>p</em></sup></span> de um vetor em <span class="math">ℝ<sup><em>n</em></sup></span> para <span class="math"><em>p</em> ≥ 1</span> como <br /><span class="math">∥<em>v</em>∥<sub><em>p</em></sub> = (|<em>v</em><sub>1</sub>|<sup><em>p</em></sup> + |<em>v</em><sub>2</sub>|<sup><em>p</em></sup> + ⋯|<em>v</em><sub><em>n</em></sub>|<sup><em>p</em></sup>)<sup>1/<em>p</em></sup></span><br /> E a norma <span class="math"><em>L</em><sub>∞</sub></span> ou <span class="math"><em>L</em><sup>∞</sup></span> como</p>
<p><br /><span class="math">$$\|v\|_\infty=\max_{j=1}^n|v_j|$$</span><br /></p>
<p><span><strong>Propriedades:</strong></span> Se <span class="math"><em>λ</em></span> é um real (ou complexo) e <span class="math"><em>u</em></span> e <span class="math"><em>v</em></span> são vetores, temos: <br /><span class="math">$$\begin{aligned}
\|v\|&amp;=&amp;0 \Longleftrightarrow v=0\\
\|\lambda v\|&amp;=&amp;|\lambda| \|v\|\\
\|u+v\| &amp;\leq &amp; \|u\| + \|v\|~~~~ (\hbox{desigualdade do triângulo})\\
\lim_{p\to\infty}\|u\|_p &amp;=&amp; \|u\|_{\infty}\end{aligned}$$</span><br /></p>
<p><span><strong>Exemplo:</strong> </span> Calcule a norma <span class="math"><em>L</em><sup>1</sup></span>, <span class="math"><em>L</em><sup>2</sup></span> e <span class="math"><em>L</em><sup>∞</sup></span> de <br /><span class="math">$$v=\left[\begin{array}{c}1\\2\\-3\\0
\end{array}\right]$$</span><br /></p>
<p><br /><span class="math">$$\begin{aligned}
\|v\|_1&amp;=&amp;1+2+3+0=6\\
\|v\|_2&amp;=&amp;\sqrt{1+2^2+3^2+0^2}=\sqrt{14}\\
\|v\|_\infty&amp;=&amp;\max\{1,2,3,0\}=3\end{aligned}$$</span><br /></p>
<h3 id="norma-matricial">Norma matricial</h3>
<p>Definimos a norma operacional em <span class="math"><em>L</em><sup><em>p</em></sup></span> de uma matriz <span class="math"><em>A</em> : ℝ<sup><em>n</em></sup> → ℝ<sup><em>n</em></sup></span> da seguinte forma: <br /><span class="math">∥<em>A</em>∥<sub><em>p</em></sub> = sup<sub>∥<em>v</em>∥<sub><em>p</em></sub> = 1</sub>∥<em>A</em><em>v</em>∥<sub><em>p</em></sub></span><br /> ou seja, a norma p de uma matriz é o máximo valor assumido pela norma de <span class="math"><em>A</em><em>v</em></span> entre todos os vetores de norma unitária.</p>
<p>Temos as seguintes propriedades, se <span class="math"><em>A</em></span> e <span class="math"><em>B</em></span> são matrizes, <span class="math"><em>I</em></span> é a matriz identidade, <span class="math"><em>v</em></span> é um vetor e <span class="math"><em>λ</em></span> é um real (ou complexo): <br /><span class="math">$$\begin{aligned}
\|A\|_p&amp;=&amp;0 \Longleftrightarrow A=0\\
\|\lambda A\|_p&amp;=&amp;|\lambda| \|A\|_p\\
\|A+B\|_p &amp;\leq &amp; \|A\|_p + \|B\|_p~~~~ (\hbox{desigualdade do triângulo})\\
\|Av\|_p &amp;\leq&amp; \|A\|_p\|v\|_p\\
\|AB\|_p &amp;\leq&amp; \|A\|_p\|B\|_p\\
\|I\|_p&amp;=&amp;1\\
1&amp;=&amp;\|I\|_p=\|AA^{-1}\|_p\leq \|A\|_p\|A^{-1}\|_p~~~~ \hbox{(se A é inversível)}\end{aligned}$$</span><br /></p>
<p>Casos especiais: <br /><span class="math">$$\begin{aligned}
\|A\|_1&amp;=&amp; \max_{j=1}^n\sum_{i=1}^n |A_{ij}|\\
\|A\|_2&amp;=&amp; \sqrt{\max\{|\lambda|: \lambda \in \sigma(AA^*)\}}\\
\|A\|_\infty&amp;=&amp; \max_{i=1}^n\sum_{j=1}^n |A_{ij}|\end{aligned}$$</span><br /> onde <span class="math"><em>σ</em>(<em>M</em>)</span> é o conjunto de autovalores da matriz <span class="math"><em>M</em></span>.</p>
<p><span><strong>Exemplo:</strong></span> Calcule as normas <span class="math">1</span>, <span class="math">2</span> e <span class="math">∞</span> da seguinte matriz: <br /><span class="math">$$A=\left[
\begin{array}{ccc}
3 &amp; -5 &amp; 7\\
1 &amp; -2 &amp; 4\\
-8 &amp; 1 &amp; -7\\
\end{array}
\right]$$</span><br /></p>
<p><span><strong>Solução</strong></span> <br /><span class="math">$$\begin{aligned}
\|A\|_1&amp;=&amp;\max\{12,8,18\}=18\\
\|A\|_\infty&amp;=&amp;\max\{15,7,16\}=16\\
\|A\|_2&amp;=&amp;\sqrt{\max\{0,5865124; 21,789128 ;195,62436\}}= 13,986578\end{aligned}$$</span><br /></p>
<h3 id="número-de-condicionamento">Número de condicionamento</h3>
<p>O condicionamento de um sistema linear é um conceito relacionado à forma como os erros se propagam dos dados de entrada para os dados de saída, ou seja, se o sistema <br /><span class="math"><em>A</em><em>x</em> = <em>y</em></span><br /> possui uma solução <span class="math"><em>x</em></span> para o vetor <span class="math"><em>y</em></span>, quando varia a solução <span class="math"><em>x</em></span> quando o dado de entrado <span class="math"><em>y</em></span> varia. Consideramos, então, o problema <br /><span class="math"><em>A</em>(<em>x</em> + <em>δ</em><sub><em>x</em></sub>) = <em>y</em> + <em>δ</em><sub><em>y</em></sub></span><br /> Aqui <span class="math"><em>δ</em><sub><em>x</em></sub></span> representa a variação em <span class="math"><em>x</em></span> e <span class="math"><em>δ</em><sub><em>y</em></sub></span> representa a respectiva variação em <span class="math"><em>y</em></span>. Temos: <br /><span class="math"><em>A</em><em>x</em> + <em>A</em><em>δ</em><sub><em>x</em></sub> = <em>y</em> + <em>δ</em><sub><em>y</em></sub></span><br /> e, portanto, <br /><span class="math"><em>A</em><em>δ</em><sub><em>x</em></sub> = <em>δ</em><sub><em>y</em></sub>.</span><br /></p>
<p>Queremos avaliar a magnitude do erro relativo em y, representado por <span class="math">∥<em>δ</em><sub><em>y</em></sub>∥/∥<em>y</em>∥</span> em função da magnitude do erro relativo <span class="math">∥<em>δ</em><sub><em>x</em></sub>∥/∥<em>x</em>∥</span>. <br /><span class="math">$$\begin{aligned}
\frac{\|\delta_x\|/\|x\|}{\|\delta_y\|/\|y\|} &amp;= \frac{\|\delta_x\|}{\|x\|}\frac{\|y\|}{\|\delta_y\|}\\ 
&amp;= \frac{\|A^{-1}\delta_y\|}{\|x\|}\frac{\|Ax\|}{\|\delta_y\|} \\
&amp;\leq \frac{\|A^{-1}\|\|\delta_y\|}{\|x\|}\frac{\|A\|\|x\|}{\|\delta_y\|}\\
&amp;=\|A\|\|A^{-1}\|  \end{aligned}$$</span><br /></p>
<p>Assim, definimos o número de condicionamento de uma matriz inversível <span class="math"><em>A</em></span> como <br /><span class="math"><em>k</em><sub><em>p</em></sub>(<em>A</em>) = ∥<em>A</em>∥<sub><em>p</em></sub>∥<em>A</em><sup> − 1</sup>∥<sub><em>p</em></sub></span><br /></p>
<p>O número de condicionamento, então, mede o quão instável é resolver o problema <span class="math"><em>A</em><em>x</em> = <em>y</em></span> frente a erros no vetor de entrada <span class="math"><em>x</em></span>.</p>
<p><span><strong>Obs:</strong></span> O número de condicionamento depende da norma escolhida.</p>
<p><span><strong>Obs:</strong></span> O número de condicionamento da matriz identidade é <span class="math">1</span>.</p>
<p><span><strong>Obs:</strong></span> O número de condicionamento de qualquer matriz inversível é igual ou maior que <span class="math">1</span>.</p>
<h2 id="exercícios-11" class="unnumbered">Exercícios</h2>
<p>Calcule o valor de <span class="math"><em>λ</em></span> para o qual o problema <br /><span class="math">$$\left\{ \begin{array}{l}71x+41y=10\\
\lambda x+30y=4
\end{array}
\right.$$</span><br /> é impossível, depois calcule os números de condicionamento com norma 1,2 e <span class="math">∞</span> quando <span class="math"><em>λ</em> = 51</span> e <span class="math"><em>λ</em> = 52</span>.</p>
<p><span class="math">$\lambda=\frac{71\times 30}{41}\approx  51.95122$</span>, para <span class="math"><em>λ</em> = 51</span>: <span class="math"><em>k</em><sub>1</sub> = <em>k</em><sub>∞</sub> = 350.4</span>, <span class="math"><em>k</em><sub>2</sub> = 262.1</span>. Para <span class="math"><em>λ</em> = 52</span>: <span class="math"><em>k</em><sub>1</sub> = <em>k</em><sub>∞</sub> = 6888</span>, <span class="math"><em>k</em><sub>2</sub> = 5163</span>.</p>
<p>Calcule o número de condicionamento da matriz <br /><span class="math">$$A=\left[
\begin{array}{ccc}
3 &amp; -5 &amp; 7\\
1 &amp; -2 &amp; 4\\
-8 &amp; 1 &amp; -7\\
\end{array}
\right]$$</span><br /> nas normas <span class="math">1</span>, <span class="math">2</span> e <span class="math">∞</span>.</p>
<p><span class="math"><em>k</em><sub>1</sub>(<em>A</em>) = 36</span>, <span class="math"><em>k</em><sub>2</sub>(<em>A</em>) = 18, 26</span>, <span class="math"><em>K</em><sub>∞</sub>(<em>A</em>) = 20, 8</span>.</p>
<p>Calcule o número de condicionamento das matrizes <br /><span class="math">$$\left[
\begin{array}{cc}
71 &amp; 41\\
52 &amp; 30
\end{array}\right]$$</span><br /> e <br /><span class="math">$$\left[
\begin{array}{ccc}
1 &amp; 2 &amp; 3\\
2 &amp; 3 &amp; 4\\
4 &amp; 5 &amp; 5
\end{array}\right]$$</span><br /> usando as normas <span class="math">1</span>,<span class="math">2</span> e <span class="math">∞</span>.</p>
<p><span class="math">$k_1=k_\infty=6888, k_2=\sqrt{26656567}$</span> e <span class="math"><em>k</em><sub>1</sub> = 180, <em>k</em><sub>2</sub> = 128, 40972</span> e <span class="math"><em>k</em><sub>∞</sub> = 210</span></p>
<p>Usando a norma <span class="math">1</span>, calcule o número de condicionameto da matriz <br /><span class="math">$$A=\left[
\begin{array}{cc}
1 &amp; 2\\
2+\varepsilon &amp; 4
\end{array}\right]$$</span><br /> em função de <span class="math"><em>ε</em></span> quando <span class="math">0 &lt; <em>ε</em> &lt; 1</span>. Interprete o limite <span class="math"><em>ε</em> → 0</span>.</p>
<p><span class="math">$\frac{18}{\varepsilon}+3$</span>. Quando <span class="math"><em>ε</em> → 0 + </span>, a matriz converge para uma matriz singular e o número de condicionamento diverge para <span class="math"> + ∞</span>.</p>
<p>Considere os sistemas: <br /><span class="math">$$\left\{
\begin{array}{rclcl}
100000 x  &amp;-&amp; 9999.99 y  &amp;=&amp;-10\\
-9999.99 x &amp;+&amp;  1000.1 y &amp;=&amp;1
\end{array}\right. ~~~~\hbox{e}~~~~
\left\{
\begin{array}{rclcl}
100000 x  &amp;-&amp; 9999.99 y  &amp;=&amp;-9.999\\
-9999.99 x &amp;+&amp;  1000.1 y &amp;=&amp;1.01
\end{array}\right.$$</span><br /> Encontre a solução de cada um e discuta.</p>
<p>As soluções são <span class="math">[ − 0.0000990  0.0000098]<sup><em>T</em></sup></span> e <span class="math">[0.0098029  0.0990294]<sup><em>T</em></sup></span>. A grande variação na solução em função de pequena variação nos dados é devido ao mau condicionamento da matriz (<span class="math"><em>k</em><sub>1</sub> ≈ 1186274.3</span>).</p>
<p>Exemplo de implementação:</p>
<pre><code>A=[1e5 -1e4+1e-2; -1e4+1e-2 1000.1]
b1=[-10 1]&#39;
b2=[-9.999 1.01]&#39;
A\b1
A\b2</code></pre>
<p>Considere os vetores de 10 entradas dados por <br /><span class="math">$$x_j=\sin(j/10),~~~y_j=j/10~~~~z_j=j/10-\frac{\left(j/10\right)^3}{6},~~ j=1,\ldots,10$$</span><br /> Use o <code>Scilab</code> para construir os seguintes vetores de erro: <br /><span class="math">$$e_{j}=\frac{|x_j-y_j|}{|x_j|}~~~ f_j=\frac{|x_j-z_j|}{x_j}$$</span><br /> Calcule as normas <span class="math">1</span>, <span class="math">2</span> e <span class="math">∞</span> de <span class="math"><em>e</em></span> e <span class="math"><em>f</em></span></p>
<p><span class="math">0, 695</span>; <span class="math">0, 292</span>; <span class="math">0, 188</span>; <span class="math">0, 0237</span>; <span class="math">0, 0123</span>; <span class="math">0, 00967</span></p>
<p>Exemplo de implementação:</p>
<pre><code>J=[1:1:10]
x=sin(J/10)
y=J/10
z=y-y.^3/6
e=abs(x-y)./x
f=abs(x-z)./x
norm(e,1)
norm(e,2)
norm(e,&#39;inf&#39;)
norm(f,1)
norm(f,2)
norm(f,&#39;inf&#39;)</code></pre>
<h2 id="métodos-iterativos-para-sistemas-lineares">Métodos iterativos para sistemas lineares</h2>
<h3 id="método-de-jacobi">Método de Jacobi</h3>
<p>Considere o problema <span class="math"><em>A</em><em>x</em> = <em>y</em></span>, ou seja, <br /><span class="math">$$\begin{aligned}
a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n&amp;=&amp;y_1\\
a_{21}x_1+a_{22}x_2+\cdots+a_{2n}x_n&amp;=&amp;y_2\\
\vdots \hspace{100pt}\vdots~~~~&amp;=&amp;~\vdots\\
a_{n1}x_1+a_{n2}x_2+\cdots+a_{nn}x_n&amp;=&amp;y_n\end{aligned}$$</span><br /></p>
<p>Os elementos <span class="math"><em>x</em><sub><em>j</em></sub></span> são calculados iterativamente conforme: <br /><span class="math">$$\begin{aligned}
x_1^{(k+1)}&amp;=&amp; \frac{y_1 - \left(a_{12}x_2^{(k)}+\cdots+a_{1n}x_n^{(k)}\right)}{a_{11}}\\
x_2^{(k+1)}&amp;=&amp;\frac{y_2 - \left(a_{21}x_1^{(k)}+\cdots+a_{2n}x_n^{(k)}\right)}{a_{22}}\\
&amp;\vdots&amp;\\
x_n^{(k+1)}&amp;=&amp;\frac{y_2 - \left(a_{n1}x_1^{(k)}+\cdots+a_{n(n-1)}x_{n-1}^{(k)}\right)}{a_{nn}}\end{aligned}$$</span><br /></p>
<p>Em notação mais compacta, o método de Jacobi consiste na iteração: <br /><span class="math">$$\begin{aligned}
  &amp;x^{(0)} = \text{aprox. inicial}\\
  &amp;x_i^{(k)} = \frac{y_i - \displaystyle{\sum_{\substack{j=1\\j\neq i}}^{n} a_{ij}x_j^{(k)}}}{a_{ii}}\end{aligned}$$</span><br /></p>
<p><span><strong>Exemplo:</strong></span> Resolva o sistema <br /><span class="math">$$\left\{\begin{array}{l}10x+y=23\\x+8y=26\end{array}\right.$$</span><br /> usando o método de Jacobi iniciando com <span class="math"><em>x</em><sup>(0)</sup> = <em>y</em><sup>(0)</sup> = 0</span>. <br /><span class="math">$$\begin{aligned}
x^{(k+1)}&amp;=&amp;\frac{23-y^{(k)}}{10}\\
y^{(k+1)}&amp;=&amp;\frac{26-x^{(k)}}{8}\\
\\
x^{(1)}&amp;=&amp;\frac{23-y^{(0)}}{10}=2,3\\
y^{(1)}&amp;=&amp;\frac{26-x^{(0)}}{8}=3,25\\
\\
x^{(2)}&amp;=&amp;\frac{23-y^{(1)}}{10}=1,975 \\
y^{(2)}&amp;=&amp;\frac{26-x^{(1)}}{8}=2,9625\\\end{aligned}$$</span><br /></p>
<h4 id="código-scilab-jacobi">Código Scilab: Jacobi</h4>
<h3 id="método-de-gauss-seidel">Método de Gauss-Seidel</h3>
<p>Considere o problema <span class="math"><em>A</em><em>x</em> = <em>y</em></span>, ou seja, <br /><span class="math">$$\begin{aligned}
a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n&amp;=&amp;y_1\\
a_{21}x_1+a_{22}x_2+\cdots+a_{2n}x_n&amp;=&amp;y_2\\
\vdots \hspace{100pt}\vdots~~~~&amp;=&amp;~\vdots\\
a_{n1}x_1+a_{22}x_2+\cdots+a_{nn}x_n&amp;=&amp;y_n\end{aligned}$$</span><br /></p>
<p>Os elementos <span class="math"><em>x</em><sub><em>j</em></sub></span> são calculados iterativamente conforme: <br /><span class="math">$$\begin{aligned}
x_1^{(k+1)}&amp;=&amp; \frac{y_1 - \left(a_{12}x_2^{(k)}+\cdots+a_{1n}x_n^{(k)}\right)}{a_{11}}\\
x_2^{(k+1)}&amp;=&amp;\frac{y_2 - \left(a_{11}x_1^{(k+1)}+\cdots+a_{1n}x_n^{(k)}\right)}{a_{22}}\\
&amp;\vdots&amp;\\
x_n^{(k+1)}&amp;=&amp;\frac{y_2 - \left(a_{n1}x_1^{(k+1)}+\cdots+a_{n(n-1)}x_{n-1}^{(k+1)}\right)}{A_{nn}}\end{aligned}$$</span><br /></p>
<p>Em notação mais compacta, o método de Gauss-Seidel consiste na iteração: <br /><span class="math">$$\begin{aligned}
  &amp;x^{(0)} = \text{aprox. inicial}\\
  &amp;x_i^{(k)} = \frac{y_i - \displaystyle{\sum_{j=1}^{i-1} a_{ij}x_j^{(k+1)}} - \displaystyle{\sum_{j=i+1}^{n} a_{ij}x_j^{(k)}}}{a_{ii}}\end{aligned}$$</span><br /></p>
<p><span><strong>Exemplo:</strong></span> Resolva o sistema <br /><span class="math">$$\left\{\begin{array}{l}10x+y=23\\x+8y=26\end{array}\right.$$</span><br /> usando o método de Guass-Seidel iniciando com <span class="math"><em>x</em><sup>(0)</sup> = <em>y</em><sup>(0)</sup> = 0</span>. <br /><span class="math">$$\begin{aligned}
x^{(k+1)}&amp;=&amp;\frac{23-y^{(k)}}{10}\\
y^{(k+1)}&amp;=&amp;\frac{26-x^{(k+1)}}{8}\\
\\
x^{(1)}&amp;=&amp;\frac{23-y^{(0)}}{10}=2,3\\
y^{(1)}&amp;=&amp;\frac{26-x^{(1)}}{8}=2,9625\\
\\
x^{(2)}&amp;=&amp;\frac{23-y^{(1)}}{10}=2,00375  \\
y^{(2)}&amp;=&amp;\frac{26-x^{(2)}}{8}=2,9995312\end{aligned}$$</span><br /></p>
<h4 id="código-scilab-gauss-seidel">Código Scilab: Gauss-Seidel</h4>
<h2 id="análise-de-convergência-2">Análise de convergência</h2>
<p>Uma condição suficiente porém não necessária para que os métodos de Gauss-Seidel e Jacobi convirjam é a que a matriz seja diagonal dominante estrita. Veja <span class="citation"></span>.</p>
<h2 id="exercícios-12" class="unnumbered">Exercícios</h2>
<p>Considere o problema de 5 incógnitas e cinco equações dado por</p>
<p><br /><span class="math">$$\begin{aligned}
x_1-x_2&amp;=&amp;1\\
-x_{1}+2x_2-x_{3}&amp;=&amp;1\\
-x_{2}+(2+\varepsilon) x_3-x_{4}&amp;=&amp;1\\
-x_{3}+2x_4-x_{5}&amp;=&amp;1\\
x_{4}-x_{5}&amp;=&amp;1\end{aligned}$$</span><br /></p>
<ul>
<li><p>Escreva na forma <span class="math"><em>A</em><em>x</em> = <em>b</em></span> e resolva usando Eliminação Gaussiana para <span class="math"><em>ε</em> = 10<sup> − 3</sup></span> no <code>Scilab</code>.</p></li>
<li><p>Obtenha o vetor incógnita <span class="math"><em>x</em></span> com <span class="math"><em>ε</em> = 10<sup> − 3</sup></span> usando o comando <span class="math"><em>A</em> ∖ <em>b</em></span>.</p></li>
<li><p>Obtenha o vetor incógnita <span class="math"><em>x</em></span> com <span class="math"><em>ε</em> = 10<sup> − 3</sup></span> usando Jacobi com tolerância <span class="math">10<sup> − 2</sup></span>. Compare o resultado com o resultado obtido no item d.</p></li>
<li><p>Obtenha o vetor incógnita <span class="math"><em>x</em></span> com <span class="math"><em>ε</em> = 10<sup> − 3</sup></span> usando Gauss-Seidel com tolerância <span class="math">10<sup> − 2</sup></span>. Compare o resultado com o resultado obtido no item d.</p></li>
<li><p>Discuta com base na relação esperada entre tolerância e exatidão conforme estudado na primeira área para problemas de uma variável.</p></li>
</ul>
<pre><code>epsilon=1e-3;

A=[1 -1 0 0 0; -1 2 -1 0 0; 0 -1 (2+epsilon) -1 0; 0 0 -1 2 -1; 0 0 0 1 -1]

v=[1 1 1 1 1]&#39;
xgauss=gauss([A v])

function x=q_Jacobi()
    x0=[0 0 0 0 0]&#39;

    i=0
    controle=0
    while controle&lt;3 &amp; i&lt;1000
    i=i+1

    x(1)=1+x0(2)
    x(2)=(1+x0(3)+x0(1))/2
    x(3)=(1+x0(2)+x0(4))/(2+epsilon)
    x(4)=(1+x0(3)+x0(5))/2
    x(5)=x0(4)-1

    delta=norm(x-x0,2)
    if delta&lt;1e-6 then
        controle=controle+1
    else
        controle=0
    end
    mprintf(&#39;i=%d, x1=%f, x5=%f, tol=%.12f\n&#39;,i,x(1),x(5),delta)
    x0=x;
    end

endfunction

function x=q_Gauss_Seidel()
    x0=[0 0 0 0 0]&#39;

    i=0
    controle=0
    while controle&lt;3 &amp; i&lt;15000
    i=i+1

    x(1)=1+x0(2)
    x(2)=(1+x0(3)+x(1))/2
    x(3)=(1+x(2)+x0(4))/(2+epsilon)
    x(4)=(1+x(3)+x0(5))/2
    x(5)=x(4)-1

    delta=norm(x-x0,2)
    if delta&lt;1e-2 then
        controle=controle+1
    else
        controle=0
    end
    mprintf(&#39;i=%d, x1=%f, x5=%f, tol=%.12f\n&#39;,i,x(1),x(5),delta)
    x0=x;
    end

endfunction</code></pre>
<p>Resolva o seguinte sistema pelo método de Jacobi e Gauss-Seidel: <br /><span class="math">$$\left\{\begin{array}{ll}
5x_1+x_2+x_3&amp;=50\\
-x_1+3x_2-x_3&amp;=10\\
x_1+2x_2+10x_3&amp;=-30
\end{array}\right.$$</span><br /> Use como critério de paragem tolerância inferior a <span class="math">10<sup> − 3</sup></span> e inicialize com <span class="math"><em>x</em><sup>0</sup> = <em>y</em><sup>0</sup> = <em>z</em><sup>0</sup> = 0</span>.</p>
<p>Refaça a questão [trid] construindo um algoritmo que implemente os métodos de Jacobi e Gauss-Seidel.</p>
<p>Considere o seguinte sistema de equações lineares: <br /><span class="math">$$\begin{aligned}
x_1-x_2&amp;=&amp;0\nonumber\\
-x_{j-1}+5x_j-x_{j+1}&amp;=&amp;\cos(j/10),~~ 2\leq j \leq 10\nonumber\\
x_{11}&amp;=&amp;x_{10}/2\end{aligned}$$</span><br /> Construa a iteração para encontrar a solução deste problema pelos métodos de Gauss-Seidel e Jacobi. Usando esses métodos, encontre uma solução aproximada com erro absoluto inferior a <span class="math">10<sup> − 5</sup></span>.</p>
<p><span class="math">0.324295</span>, <span class="math">0.324295</span>, <span class="math">0.317115</span>, <span class="math">0.305943</span>, <span class="math">0.291539</span>, <span class="math">0.274169</span>, <span class="math">0.253971</span>, <span class="math">0.230846</span>, <span class="math">0.203551</span>, <span class="math">0.165301</span>, <span class="math">0.082650</span></p>
<p>Exemplos de rotinas:</p>
<pre><code>function x=jacobi()
    x0=zeros(11,1)
    k=0;
    controle=0;
    while controle&lt;3 &amp; k&lt;1000
        k=k+1
        x(1)=x0(2)
        for j=2:10
        x(j)=(cos(j/10)+x0(j-1)+x0(j+1))/5
        end
        x(11)=x0(10)/2


        delta=norm(x-x0) //norma 2
        if delta&lt;1e-5 then
            controle=controle+1
        else
            controle=0;
        end
        mprintf(&#39;k=%d, x=[%f,%f,%f], tol=%.12f\n&#39;,k,x(1),x(2),x(3),delta)
        x0=x;
    end


endfunction

function x=gs()
    x0=zeros(11,1)
    k=0;
    controle=0;
    while controle&lt;3 &amp; k&lt;1000
        k=k+1
        x(1)=x0(2)
        for j=2:10
        x(j)=(cos(j/10)+x(j-1)+x0(j+1))/5
        end
        x(11)=x0(10)/2

        delta=norm(x-x0) //norma 2
        if delta&lt;1e-5 then
            controle=controle+1
        else
            controle=0;
        end
        mprintf(&#39;k=%d, x=[%f,%f,%f], tol=%.12f\n&#39;,k,x(1),x(2),x(3),delta)
        x0=x;
    end
endfunction</code></pre>
<p>Resolva o problema [circuito1] pelos métodos de Jacobi e Gauss-Seidel.</p>
<p>Faça uma permutação de linhas no sistema abaixo e resolva pelos métodos de Jacobi e Gauss-Seidel: <br /><span class="math">$$\begin{aligned}
x_1+10x_2+3x_3=27\\
4x_1+x_3=6\\
2x_1+x_2+4x_3=12\end{aligned}$$</span><br /></p>
<p>Permute as linhas 1 e 2.</p>
<h2 id="método-da-potência-para-cálculo-de-autovalores">Método da potência para cálculo de autovalores</h2>
<p>Consideremos uma matriz <span class="math"><em>A</em> ∈ ℝ<sup><em>n</em>, <em>n</em></sup></span> diagonalizável, isto é, existe um conjunto <span class="math">{<em>v</em><sub><em>j</em></sub>}<sub><em>j</em> = 1</sub><sup><em>n</em></sup></span> de autovetores de <span class="math"><em>A</em></span> tais que qualquer elemento <span class="math"><em>x</em> ∈ ℝ<sup><em>n</em></sup></span> pode ser escrito como uma combinação linear dos <span class="math"><em>v</em><sub><em>j</em></sub></span>. Sejam <span class="math">{<em>λ</em><sub><em>j</em></sub>}<sub><em>j</em> = 1</sub><sup><em>n</em></sup></span> o conjunto de autovalores associados aos autovetores tal que um deles seja dominante, ou seja, <br /><span class="math">|<em>λ</em><sub>1</sub>| &gt; |<em>λ</em><sub>2</sub>| ≥ |<em>λ</em><sub>3</sub>| ≥ ⋯|<em>λ</em><sub><em>n</em></sub>| &gt; 0</span><br /> Como os autovetores são LI, todo vetor <span class="math"><em>x</em> ∈ ℝ<sup><em>n</em></sup></span>, <span class="math"><em>x</em> = (<em>x</em><sub>1</sub>, <em>x</em><sub>2</sub>, ..., <em>x</em><sub><em>n</em></sub>)</span>, pode ser escrito com combinação linear dos autovetores da seguinte forma: <br /><span class="math">$$\label{met_pot_forma}
{x}=\sum_{j=1}^n\beta_j{v}_{j}.$$</span><br /></p>
<p>O método da potência permite o cálculo do autovetor dominante com base no comportamento assintótico (i.e. “no infinito”) da sequência <br /><span class="math"><em>x</em>, <em>A</em><em>x</em>, <em>A</em><sup>2</sup><em>x</em>, <em>A</em><sup>3</sup><em>x</em>, …</span><br />.</p>
<p>Por questões de convergência, consideramos a seguinte sequência semelhante à anterior, porém normalizada: <br /><span class="math">$$\frac{{x}}{\|{x}\|}, \frac{A{x}}{\|A{x}\|}, \frac{A^2{x}}{\|A^2{x}\|}, \frac{A^3{x}}{\|A^3{x}\|}, \ldots,$$</span><br /> que pode ser obtida pelo seguinte processo iterativo: <br /><span class="math">$${x}^{(k+1)}=\frac{A^{k}{x}}{\|A^{k}{x}\|}$$</span><br /> Observamos que se <span class="math"><em>x</em></span> está na forma ([met<sub>p</sub>ot<sub>f</sub>orma]), então <span class="math"><em>A</em><sup><em>k</em></sup><em>x</em></span> pode ser escrito como <br /><span class="math">$$A^{k}{x} = \sum_{j=1}^n\beta_j A^k {v}_{j}=\sum_{j=1}^n\beta_j \lambda_j^k {v}_{j}= \beta_1\lambda_1^k\left({v}_1+\sum_{j=2}^n\frac{\beta_j}{\beta_1} \left(\frac{\lambda_j}{\lambda_1}\right)^k {v}_{j}\right)$$</span><br /> Como <span class="math">$\left|\frac{\lambda_j}{\lambda_1}\right|&lt;1$</span> para todo <span class="math"><em>j</em> ≥ 2</span>, temos <br /><span class="math">$$\sum_{j=2}^n\frac{\beta_j}{\beta_1} \left(\frac{\lambda_j}{\lambda_1}\right)^k {v}_{j} \to 0.$$</span><br /> Assim <br /><span class="math">$$\label{met_pot_assim}\frac{A^k {x}}{\|A^k {x}\|} = \frac{\beta_1\lambda_1^k}{\|A^k {x}\|}\left( {v}_1 + O\left(\left|\frac{\lambda_2}{\lambda_1}\right|^k\right))\right)$$</span><br /> Como a norma de <span class="math">$\frac{A^k {x}}{\|A^k {x}\|}$</span> é igual a um, temos <br /><span class="math">$$\left\|\frac{\beta_1\lambda_1^k}{\|A^k x\|}{v}_1\right\| \to 1$$</span><br /> e, portanto, <br /><span class="math">$$\left|\frac{\beta_1\lambda_1^k}{\|A^k {x}\|}\right| \to \frac{1}{\|{v}_1\|}$$</span><br /> Ou seja, se definimos <span class="math">$\alpha^{(k)}=\frac{\beta_1\lambda_1^k}{\|A^k {x}\|}$</span>, então <br /><span class="math">|<em>α</em><sup>(<em>k</em>)</sup>| → 1</span><br /> Retornando a ([met<sub>p</sub>ot<sub>a</sub>ssim]), temos:</p>
<p><br /><span class="math">$$\frac{A^k {x}}{\|A^k {x}\|}-\alpha^{(k)}{v}_1 \to 0$$</span><br /></p>
<p>Observe que um múltiplo de autovetor também é um autovetor e, portanto, <br /><span class="math">$$\frac{A^k {x}}{\|A^k {x}\|}$$</span><br /> é um esquema que oscila entre os autovetores ou converge para o autovetor <span class="math"><em>v</em><sub>1</sub></span>.</p>
<p>Uma vez que temos o autovetor <span class="math"><em>v</em><sub>1</sub></span> de <span class="math"><em>A</em></span>, podemos calcular <span class="math"><em>λ</em><sub>1</sub></span> da seguinte forma: <br /><span class="math">$$A{v}_1=\lambda_1 {v}_1 ~\Longrightarrow~ {v}_1^TA{v}_1={v}_1^T\lambda_1 {v}_1 ~ \Longrightarrow~ \lambda_1=\frac{{v}_1^TA{v}_1}{{v}_1^T{v}_1}$$</span><br /> Observe que a última identidade é válida, pois <span class="math">∥<em>v</em><sub>1</sub>∥ = 1</span> por construção.</p>
<h2 id="exercícios-13" class="unnumbered">Exercícios</h2>
<p>Calcule o autovalor dominante e o autovetor associado da matriz <br /><span class="math">$$\left[\begin{array}{ccc}
 4&amp;     41  &amp;  78\\
 48   &amp; 28&amp;    21  \\
 26   &amp; 13 &amp;   11
\end{array}\right]$$</span><br /> Expresse sua resposta com seis dígitos significativos</p>
<p><span class="math"><em>λ</em> = 86.1785</span> associado ao autovetor dado por <span class="math"><em>v</em><sub>1</sub> = [0.65968  0.66834  0.34372]<sup><em>T</em></sup></span>.</p>
<p>Calcule o autovalor dominante e o autovetor associado da matriz <br /><span class="math">$$\left[\begin{array}{cc}
3&amp;4\\2&amp;-1
\end{array}\right]$$</span><br /> usando o método da potência inciando com o vetor <span class="math"><em>x</em> = [1  1]<sup><em>T</em></sup></span></p>
<p>A norma <span class="math"><em>L</em><sub>2</sub></span> de um matriz <span class="math"><em>A</em></span> é dada pela raiz quadrada do autovalor dominante da matriz <span class="math"><em>A</em><sup> * </sup><em>A</em></span>, isto é: <br /><span class="math">$$\|A\|_2=\sqrt{\max\{|\lambda|: \lambda\in\sigma(A^*A)\}}:$$</span><br /> Use o método da potência para obter a norma <span class="math"><em>L</em><sub>2</sub></span> da seguinte matriz: <br /><span class="math">$$A=\left[\begin{array}{ccc}

    69&amp;    84&amp;    88\\
    15&amp;  - 40&amp;    11\\
    70&amp;    41&amp;    20
\end{array}\right]$$</span><br /> Expresse sua resposta com seis dígitos significativos</p>
<p><span class="math">158, 726</span></p>
<p>Os autovalores de uma matriz triangular são os elementos da diagonal principal. Verifique o método da potência aplicada à seguinte matriz: <br /><span class="math">$$\left[\begin{array}{ccc}
2&amp;3&amp;1\\
0&amp;3&amp;-1\\
0&amp;0&amp;1
\end{array}\right].$$</span><br /></p>
<h2 id="exercícios-finais-1" class="unnumbered">Exercícios finais</h2>
<p>[title=Eletricidade][circuito1] O circuito linear da figura [circuitol8] pode ser modelado pelo sistema ([eq<sub>c</sub>irc]). Escreva esse sistema na forma matricial sendo as tensões <span class="math"><em>V</em><sub>1</sub></span>, <span class="math"><em>V</em><sub>2</sub></span>, <span class="math"><em>V</em><sub>3</sub></span>, <span class="math"><em>V</em><sub>4</sub></span> e <span class="math"><em>V</em><sub>5</sub></span> as cinco incógnitas. Resolva esse problema quando <span class="math"><em>V</em> = 127</span> e</p>
<ul>
<li><p><span class="math"><em>R</em><sub>1</sub> = <em>R</em><sub>2</sub> = <em>R</em><sub>3</sub> = <em>R</em><sub>4</sub> = 2</span> e <span class="math"><em>R</em><sub>5</sub> = <em>R</em><sub>6</sub> = <em>R</em><sub>7</sub> = 100</span> e <span class="math"><em>R</em><sub>8</sub> = 50</span></p></li>
<li><p><span class="math"><em>R</em><sub>1</sub> = <em>R</em><sub>2</sub> = <em>R</em><sub>3</sub> = <em>R</em><sub>4</sub> = 2</span> e <span class="math"><em>R</em><sub>5</sub> = 50</span> e <span class="math"><em>R</em><sub>6</sub> = <em>R</em><sub>7</sub> = <em>R</em><sub>8</sub> = 100</span></p></li>
</ul>
<p>[eq<sub>c</sub>irc] <br /><span class="math">$$\begin{aligned}
V_1&amp;=&amp;V\\
\frac{V_1-V_2}{R_1}+\frac{V_3-V_2}{R_2}-\frac{V_2}{R_5}&amp;=&amp;0\\
\frac{V_2-V_3}{R_2}+\frac{V_4-V_3}{R_3}-\frac{V_3}{R_6}&amp;=&amp;0\\
\frac{V_3-V_4}{R_3}+\frac{V_5-V_4}{R_4}-\frac{V_4}{R_7}&amp;=&amp;0\\
\frac{V_4-V_5}{R_4}-\frac{V_5}{R_8}&amp;=&amp;0\end{aligned}$$</span><br /></p>
<p><embed src="./cap_linsis/pics/circuito_linear_8.eps" />[circuitol8]</p>
<p>Complete a tabela abaixo representado a solução com 4 algarismos significativos:</p>
<p><span>|c|c|c|c|c|c|</span> Caso &amp; <span class="math"><em>V</em><sub>1</sub></span> &amp; <span class="math"><em>V</em><sub>2</sub></span> &amp; <span class="math"><em>V</em><sub>3</sub></span> &amp; <span class="math"><em>V</em><sub>4</sub></span> &amp; <span class="math"><em>V</em><sub>5</sub></span><br />a &amp;  </p>
<p> &amp;  </p>
<p> &amp;  </p>
<p> &amp;  </p>
<p> &amp;  </p>
<p> <br />b &amp; &amp; &amp; &amp; &amp;<br /></p>
<p>Então, refaça este problema reduzindo o sistema para apenas 4 incógnitas (<span class="math"><em>V</em><sub>2</sub></span>, <span class="math"><em>V</em><sub>3</sub></span>, <span class="math"><em>V</em><sub>4</sub></span> e <span class="math"><em>V</em><sub>5</sub></span>).</p>
<p>a)<span class="math"><em>V</em><sub>5</sub> = 98.44<em>V</em></span> b) <span class="math"><em>V</em><sub>5</sub> = 103.4<em>V</em></span></p>
<p>O problema com cinco incógnitas pode ser escrito na forma matricial conforme a seguir: <br /><span class="math">$$\left[\begin{array}{ccccc}
1&amp;0&amp;0&amp;0&amp;0\\[.5cm]
\frac{1}{R_1}&amp;-\left(\frac{1}{R_1}+\frac{1}{R_2}+\frac{1}{R_5}\right)&amp;\frac{1}{R_2}&amp;0&amp;0\\[.5cm]
0&amp;\frac{1}{R_2}&amp;-\left(\frac{1}{R_2}+\frac{1}{R_3}+\frac{1}{R_6}\right)&amp;\frac{1}{R_3}&amp;0\\[.5cm]
0&amp;0&amp;\frac{1}{R_3}&amp;-\left(\frac{1}{R_3}+\frac{1}{R_4}+\frac{1}{R_7}\right)&amp;\frac{1}{R_4}\\[.5cm]
0&amp;0&amp;0&amp;\frac{1}{R_4}&amp;-\left(\frac{1}{R_4}+\frac{1}{R_8}\right)
\end{array}
\right]
\left[\begin{array}{c}
V_1\\[.65cm]
V_2\\[.65cm]
V_3\\[.65cm]
v_4\\[.65cm]
V_5
\end{array}
\right]=
\left[\begin{array}{c}
V\\[.65cm]
0\\[.65cm]
0\\[.65cm]
0\\[.65cm]
0
\end{array}
\right]$$</span><br /> Este problema pode ser implementado no <code>Scilab</code> (para o item a) com o seguinte código:</p>
<pre><code>R1=2, R2=2, R3=2, R4=2, R5=100, R6=100, R7=100, R8=50, V=127

A=[1      0                  0                  0                 0;
   1/R1  -(1/R1+1/R2+1/R5)   1/R2               0                 0;
   0      1/R2              -(1/R2+1/R3+1/R6)   1/R3              0;
   0      0                  1/R3             -(1/R3+1/R4+1/R7)   1/R4;
   0      0                  0                  1/R4             -(1/R4+1/R8)]
v=[V; 0; 0; 0; 0]
y=A\v</code></pre>
<p>O problema com quatro incógnitas pode ser escrito na forma matricial conforme a seguir: <br /><span class="math">$$\left[\begin{array}{cccc}
-\left(\frac{1}{R_1}+\frac{1}{R_2}+\frac{1}{R_5}\right)&amp;\frac{1}{R_2}&amp;0&amp;0\\[.5cm]
\frac{1}{R_2}&amp;-\left(\frac{1}{R_2}+\frac{1}{R_3}+\frac{1}{R_6}\right)&amp;\frac{1}{R_3}&amp;0\\[.5cm]
0&amp;\frac{1}{R_3}&amp;-\left(\frac{1}{R_3}+\frac{1}{R_4}+\frac{1}{R_7}\right)&amp;\frac{1}{R_4}\\[.5cm]
0&amp;0&amp;\frac{1}{R_4}&amp;-\left(\frac{1}{R_4}+\frac{1}{R_8}\right)
\end{array}
\right]
\left[\begin{array}{c}
V_2\\[.65cm]
V_3\\[.65cm]
v_4\\[.65cm]
V_5
\end{array}
\right]=
\left[\begin{array}{c}
-\frac{V}{R1}\\[.65cm]
0\\[.65cm]
0\\[.65cm]
0
\end{array}
\right]$$</span><br /> Cuja implementação pode ser feita conforme</p>
<pre><code>A=[  -(1/R1+1/R2+1/R5)    1/R2               0                 0;
       1/R2              -(1/R2+1/R3+1/R6)   1/R3              0;
       0                  1/R3             -(1/R3+1/R4+1/R7)   1/R4;
       0                  0                  1/R4             -(1/R4+1/R8)]

v=[-V/R1; 0; 0; 0]
y=A\v</code></pre>
<p>[title= Interpolação] Resolva os seguintes problemas:</p>
<ul>
<li><p>Encontre o polinômio <span class="math"><em>P</em>(<em>x</em>) = <em>a</em><em>x</em><sup>2</sup> + <em>b</em><em>x</em> + <em>c</em></span> que passa pelos pontos <span class="math">( − 1,  − 3)</span>, <span class="math">(1,  − 1)</span> e <span class="math">(2, 9)</span>.</p></li>
<li><p>Encontre os coeficientes <span class="math"><em>A</em></span> e <span class="math"><em>B</em></span> da função <span class="math"><em>f</em>(<em>x</em>) = <em>A</em>sin(<em>x</em>) + <em>B</em>cos(<em>x</em>)</span> tais que <span class="math"><em>f</em>(1) = 1.4</span> e <span class="math"><em>f</em>(2) = 2.8</span>.</p></li>
<li><p>Encontre a função <span class="math"><em>g</em>(<em>x</em>) = <em>A</em><sub>1</sub>sin(<em>x</em>) + <em>B</em><sub>1</sub>cos(<em>x</em>) + <em>A</em><sub>2</sub>sin(2<em>x</em>) + <em>B</em><sub>2</sub>cos(2<em>x</em>)</span> tais que <span class="math"><em>f</em>(1) = 1</span>, <span class="math"><em>f</em>(2) = 2</span>, <span class="math"><em>f</em>(3) = 3</span> e <span class="math"><em>f</em>(4) = 4</span>.</p></li>
</ul>
<p>Dica: <span class="math"><em>P</em>( − 1) =  − 3</span>, <span class="math"><em>P</em>(1) =  − 1</span> e <span class="math"><em>P</em>(2) = 9</span> produzem três equações lineares para os coeficientes <span class="math"><em>a</em></span>, <span class="math"><em>b</em></span> e <span class="math"><em>c</em></span>. Resp: a) <span class="math"><em>P</em>(<em>x</em>) = 3<em>x</em><sup>2</sup> + <em>x</em> − 5</span>, b) <span class="math"><em>A</em> ≈ 2.49</span> e <span class="math"><em>B</em> ≈  − 1.29</span> c)<span class="math"><em>A</em><sub>1</sub> ≈ 1.2872058</span>, <span class="math"><em>A</em><sub>2</sub> ≈  − 4.3033034</span>, <span class="math"><em>B</em><sub>1</sub> ≈ 2.051533</span> e <span class="math"><em>B</em><sub>2</sub> ≈  − 0.9046921</span>.</p>
<h1 id="solução-de-sistemas-de-equações-não-lineares">Solução de sistemas de equações não lineares</h1>
<p>O método de Newton aplicado a encontrar a raiz <span class="math"><em>x</em><sup> * </sup></span> da função <span class="math"><em>y</em> = <em>f</em>(<em>x</em>)</span> estudado na primeira área de nossa disciplina consiste em um processo iterativo. Em cada passo deste processo, dispomos de uma aproximação <span class="math"><em>x</em><sup>(<em>k</em>)</sup></span> para <span class="math"><em>x</em><sup> * </sup></span> e construímos uma aproximação <span class="math"><em>x</em><sup>(<em>k</em> + 1)</sup></span>. Cada passo do método de Newton envolve os seguintes procedimentos:</p>
<ul>
<li><p>Linearização da função <span class="math"><em>f</em>(<em>x</em>)</span> no ponto <span class="math"><em>x</em><sup>(<em>k</em>)</sup></span>: <br /><span class="math"><em>f</em>(<em>x</em>) = <em>f</em>(<em>x</em><sup>(<em>k</em>)</sup>) + (<em>x</em> − <em>x</em><sup>(<em>k</em>)</sup>)<em>f</em>′(<em>x</em><sup>(<em>k</em>)</sup>) + <em>O</em>(|<em>x</em> − <em>x</em><sup>(<em>k</em>)</sup>|<sup>2</sup>)</span><br /></p></li>
<li><p>A aproximação <span class="math"><em>x</em><sup>(<em>k</em> + 1)</sup></span> é definida como o valor de <span class="math"><em>x</em></span> em que a linearização <span class="math"><em>f</em>(<em>x</em><sup>(<em>k</em>)</sup>) + (<em>x</em> − <em>x</em><sup>(<em>k</em>)</sup>)<em>f</em>′(<em>x</em><sup>(<em>k</em>)</sup>)</span> passa por zero.</p></li>
</ul>
<p><span><strong>Observação:</strong></span> <span class="math"><em>y</em> = <em>f</em>(<em>x</em><sup>(<em>k</em>)</sup>) + (<em>x</em> − <em>x</em><sup>(<em>k</em>)</sup>)<em>f</em>′(<em>x</em><sup>(<em>k</em>)</sup>)</span> é a equação da reta que tangencia a curva <span class="math"><em>y</em> = <em>f</em>(<em>x</em>)</span> no ponto <span class="math">(<em>x</em><sup>(<em>k</em>)</sup>, <em>f</em>(<em>x</em><sup>(<em>k</em>)</sup>))</span>.</p>
<p>Queremos, agora, generalizar o método de Newton a fim de resolver problemas de várias equações e várias incógnitas, ou seja, encontrar <span class="math"><em>x</em><sub>1</sub>, <em>x</em><sub>2</sub>, …<em>x</em><sub><em>n</em></sub></span> que satisfazem as seguinte equações:</p>
<p><br /><span class="math">$$\begin{aligned}
f_1(x_1,x_2,\ldots,x_n)&amp;=&amp;0\\
f_2(x_1,x_2,\ldots,x_n)&amp;=&amp;0\\
&amp;\vdots&amp;\\
f_n(x_1,x_2,\ldots,x_n)&amp;=&amp;0\end{aligned}$$</span><br /></p>
<p>Podemos escrever este problema na forma vetorial definindo o vetor <span class="math"><em>x</em> = [<em>x</em><sub>1</sub>, <em>x</em><sub>2</sub>, …, <em>x</em><sub><em>n</em></sub>]<sup><em>T</em></sup></span> e a função vetorial <br /><span class="math">$$F(x)=\left[
\begin{array}{c}
f_1(x_1,x_2,\ldots,x_n)\\
f_2(x_1,x_2,\ldots,x_n)\\
\vdots\\
f_n(x_1,x_2,\ldots,x_n)
\end{array}
\right]$$</span><br /></p>
<p>Suponha que queiramos resolver numericamente os seguinte sistema de duas equações e duas incógnitas: <br /><span class="math">$$\begin{aligned}
\frac{x_1^2}{3}+x_2^2&amp;=&amp;1\\
x_1^2+\frac{x_2^2}{4}&amp;=&amp;1\end{aligned}$$</span><br /> Então definimos</p>
<p><br /><span class="math">$$F(x)=\left[
\begin{array}{c}
\frac{x_1^2}{3}+x_2^2-1\\~\\
x_1^2+\frac{x_2^2}{4}-1
\end{array}
\right]$$</span><br /></p>
<p>Neste momento, dispomos de um problema na forma <span class="math"><em>F</em>(<em>x</em>) = 0</span> e precisamos desenvolver uma técnica para linearizar a função <span class="math"><em>F</em>(<em>x</em>)</span>. Para tal, precisamos de alguns conceitos do Cálculo II.</p>
<p>Observe que <span class="math"><em>F</em>(<em>x</em>) − <em>F</em>(<em>x</em><sup>(0)</sup>)</span> pode ser escrito como</p>
<p><br /><span class="math">$$F(x)-F(x^{(0)})=\left[
\begin{array}{c}
f_1(x_1,x_2,\ldots,x_n)-f_1(x_1^{(0)},x_2^{(0)},\ldots,x_n^{(0)})\\
f_2(x_1,x_2,\ldots,x_n)-f_2(x_1^{(0)},x_2^{(0)},\ldots,x_n^{(0)})\\
\vdots\\
f_n(x_1,x_2,\ldots,x_n)-f_n(x_1^{(0)},x_2^{(0)},\ldots,x_n^{(0)})
\end{array}
\right]$$</span><br /></p>
<p>Usamos a regra da cadeia <br /><span class="math">$$df_i = \frac{\partial f_i}{\partial x_1} dx_1+\frac{\partial f_i}{\partial x_2} dx_2+\cdots + \frac{\partial f_i}{\partial x_n} dx_n=\sum_{j=1}^n\frac{\partial f_i}{\partial x_j} dx_j$$</span><br /> e aproximamos as diferenças por derivadas parciais: <br /><span class="math">$$f_i(x_1,x_2,\ldots,x_n)-f_i(x_1^{(0)},x_2^{(0)},\ldots,x_n^{(0)})\approx \sum_{j=1}^n \frac{\partial f_i}{\partial x_j}\left(x_j-x_j^{(0)}\right)$$</span><br /> Portanto, <br /><span class="math">$$\label{eq_approx_newton}F(x)-F(x^{(0)})\approx \left[
\begin{array}{ccccc}
\frac{\partial f_1}{\partial x_1}&amp;\frac{\partial f_1}{\partial x_2}&amp;\cdots&amp;\frac{\partial f_1}{\partial x_n}\\~\\
\frac{\partial f_2}{\partial x_1}&amp;\frac{\partial f_2}{\partial x_2}&amp;\cdots&amp;\frac{\partial f_2}{\partial x_n}\\~\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\~\\
\frac{\partial f_n}{\partial x_1}&amp;\frac{\partial f_n}{\partial x_2}&amp;\cdots&amp;\frac{\partial f_n}{\partial x_n}\\~\\
\end{array}
\right]\left[
\begin{array}{c}
x_1-x_1^{(0)}\\~~\\
x_2-x_2^{(0)}\\~~\\
\vdots\\~~\\
x_n-x_n^{(0)}
\end{array}
\right]$$</span><br /></p>
<p>Definimos então a matriz jacobiana por <br /><span class="math">$$J_F= \frac{\partial(f_1,f_2,\ldots,f_n)}{\partial(x_1,x_2,\ldots,x_n)}=\left[
\begin{array}{ccccc}
\frac{\partial f_1}{\partial x_1}&amp;\frac{\partial f_1}{\partial x_2}&amp;\cdots&amp;\frac{\partial f_1}{\partial x_n}\\~\\
\frac{\partial f_2}{\partial x_1}&amp;\frac{\partial f_2}{\partial x_2}&amp;\cdots&amp;\frac{\partial f_2}{\partial x_n}\\~\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\~\\
\frac{\partial f_n}{\partial x_1}&amp;\frac{\partial f_n}{\partial x_2}&amp;\cdots&amp;\frac{\partial f_n}{\partial x_n}\\~\\
\end{array}
\right]$$</span><br /> A matriz jacobiana de uma função ou simplesmente, o Jacobiano de uma função <span class="math"><em>F</em>(<em>x</em>)</span> é a matriz formada pelas suas derivadas parciais: <br /><span class="math">$$\left(J_F\right)_{ij}=\frac{\partial f_i}{\partial x_j}$$</span><br /></p>
<p>Nestes termos podemos reescrever ([eq<sub>a</sub>pprox<sub>n</sub>ewton]) como <br /><span class="math"><em>F</em>(<em>x</em>) ≈ <em>F</em>(<em>x</em><sup>(0)</sup>) + <em>J</em><sub><em>F</em></sub>(<em>x</em><sup>(0)</sup>)(<em>x</em> − <em>x</em><sup>(0)</sup>)</span><br /> Esta expressão é chama de linearização de <span class="math"><em>F</em>(<em>x</em>)</span> no ponto <span class="math"><em>x</em><sup>(0)</sup></span> e generaliza a linearização em uma dimensão dada por <span class="math"><em>f</em>(<em>x</em>) ≈ <em>f</em>(<em>x</em><sup>(0)</sup>) + <em>f</em>′(<em>x</em><sup>(0)</sup>)(<em>x</em> − <em>x</em><sup>(0)</sup>)</span></p>
<h2 id="o-método-de-newton-para-sistemas">O método de Newton para sistemas</h2>
<p>Vamos agora construir o método de Newton-Raphson, ou seja, o método de Newton generalizado para sistemas. Assumimos, portanto, que a função <span class="math"><em>F</em>(<em>x</em>)</span> é diferenciável e que existe um ponto <span class="math"><em>x</em><sup> * </sup></span> tal que <span class="math"><em>F</em>(<em>x</em><sup> * </sup>) = 0</span>. Seja <span class="math"><em>x</em><sup>(<em>k</em>)</sup></span> uma aproximação para <span class="math"><em>x</em><sup> * </sup></span>, queremos construir uma nova aproximação <span class="math"><em>x</em><sup>(<em>k</em> + 1)</sup></span> através da linearização de <span class="math"><em>F</em>(<em>x</em>)</span> no ponto <span class="math"><em>x</em><sup>(<em>k</em>)</sup></span>.</p>
<ul>
<li><p>Linearização da função <span class="math"><em>F</em>(<em>x</em>)</span> no ponto <span class="math"><em>x</em><sup>(<em>k</em>)</sup></span>: <br /><span class="math"><em>F</em>(<em>x</em>) = <em>F</em>(<em>x</em><sup>(<em>k</em>)</sup>) + <em>J</em><sub><em>F</em></sub>(<em>x</em><sup>(<em>k</em>)</sup>)(<em>x</em> − <em>x</em><sup>(<em>k</em>)</sup>) + <em>O</em>(∥<em>x</em> − <em>x</em><sup>(<em>k</em>)</sup>∥<sup>2</sup>)</span><br /></p></li>
<li><p>A aproximação <span class="math"><em>x</em><sup>(<em>k</em>)</sup></span> é definida como o ponto <span class="math"><em>x</em></span> em que a linearização <span class="math"><em>F</em>(<em>x</em><sup>(<em>k</em>)</sup>) + <em>J</em><sub><em>F</em></sub>(<em>x</em><sup>(<em>k</em>)</sup>)(<em>x</em> − <em>x</em><sup>(<em>k</em>)</sup>)</span> é nula, ou seja: <br /><span class="math"><em>F</em>(<em>x</em><sup>(<em>k</em>)</sup>) + <em>J</em><sub><em>F</em></sub>(<em>x</em><sup>(<em>k</em>)</sup>)(<em>x</em><sup>(<em>k</em> + 1)</sup> − <em>x</em><sup>(<em>k</em>)</sup>) = 0</span><br /></p></li>
</ul>
<p>Supondo que a matriz jacobina seja inversível no ponto <span class="math"><em>x</em><sup>(<em>k</em>)</sup></span>, temos: <br /><span class="math">$$\begin{aligned}
J_F\left(x^{(k)}\right) \left(x^{(k+1)}-x^{(k)}\right)&amp;=&amp;-F(x^{(k)})\\
x^{(k+1)}-x^{(k)}&amp;=&amp;-J_F^{-1}\left(x^{(k)}\right)F(x^{(k)})\\
x^{(k+1)}&amp;=&amp;x^{(k)}-J_F^{-1}\left(x^{(k)}\right)F(x^{(k)})\end{aligned}$$</span><br /></p>
<p>Desta forma, o método iterativo de Newton-Raphson para encontrar as raízes de <span class="math"><em>F</em>(<em>x</em>) = 0</span> é dado por: <br /><span class="math">$$\left\{\begin{array}{rcl}
x^{(k+1)} &amp;=&amp; x^{(k)}-J_F^{-1}\left(x^{(k)}\right)F(x^{(k)}),~~ n\geq 0\\
x^{(0)}&amp;=&amp;\hbox{dado inicial}
\end{array}\right.$$</span><br /></p>
<p>Usamos subíndices para indicar o elemento de um vetor e super-índices para indicar o passo da iteração. Assim <span class="math"><em>x</em><sup>(<em>k</em>)</sup></span> se refere à iteração <span class="math"><em>k</em></span> e <span class="math"><em>x</em><sub><em>i</em></sub><sup>(<em>k</em>)</sup></span> se refere à componente <span class="math"><em>i</em></span> no vetor <span class="math"><em>x</em><sup>(<em>k</em>)</sup></span>.</p>
<p>A notação <span class="math"><em>J</em><sub><em>F</em></sub><sup> − 1</sup>(<em>x</em><sup>(<em>k</em>)</sup>)</span> enfatiza que a jacobiana deve ser calculada a cada passo.</p>
<p>Podemos definir o passo <span class="math">Δ<sup>(<em>k</em>)</sup></span> como <br /><span class="math">Δ<sup>(<em>k</em>)</sup> = <em>x</em><sup>(<em>k</em> + 1)</sup> − <em>x</em><sup>(<em>k</em>)</sup></span><br /> Assim, <span class="math">Δ<sup>(<em>k</em>)</sup> =  − <em>J</em><sub><em>F</em></sub><sup> − 1</sup>(<em>x</em><sup>(<em>k</em>)</sup>)<em>F</em>(<em>x</em><sup>(<em>k</em>)</sup>)</span>, ou seja, <span class="math">Δ<sup>(<em>k</em>)</sup></span> resolve o problema linear: <br /><span class="math"><em>J</em><sub><em>F</em></sub>(<em>x</em><sup>(<em>k</em>)</sup>)Δ<sup>(<em>k</em>)</sup> =  − <em>F</em>(<em>x</em><sup>(<em>k</em>)</sup>)</span><br /> Em geral, é menos custoso resolver o sistema acima do que calcular o inverso da jacobiana e multiplicar pelo vetor <span class="math"><em>F</em>(<em>x</em><sup>(<em>k</em>)</sup>)</span>.</p>
<p>Retornamos ao nosso exemplo inicial, isto é, resolver numericamente os seguinte sistema não-linear: <br /><span class="math">$$\begin{aligned}
\frac{x_1^2}{3}+x_2^2&amp;=&amp;1\\
x_1^2+\frac{x_2^2}{4}&amp;=&amp;1\end{aligned}$$</span><br /> Para tal, definimos a função <span class="math"><em>F</em>(<em>x</em>)</span>: <br /><span class="math">$$F(x)=\left[
\begin{array}{c}
\displaystyle \frac{x_1^2}{3}+x_2^2-1\\
\displaystyle x_1^2+\frac{x_2^2}{4}-1
\end{array}
\right]$$</span><br /> cuja jacobiana é: <br /><span class="math">$$J_F=\left[\begin{array}{cc}
      \displaystyle \frac{2x_1}{3} &amp; 2x_2\\
      \displaystyle 2x_1&amp;\frac{x_2}{2}
    \end{array}\right]$$</span><br /></p>
<p>Faremos a implementação numérica no <code>Scilab</code>. Para tal definimos as funções que implementarão <span class="math"><em>F</em>(<em>x</em>)</span> e a <span class="math"><em>J</em><sub><em>F</em></sub>(<em>x</em>)</span></p>
<pre><code>function y=F(x)
    y(1)=x(1)^2/3+x(2)^2-1
    y(2)=x(1)^2+x(2)^2/4-1
endfunction

function y=JF(x)
    y(1,1)=2*x(1)/3
    y(1,2)=2*x(2)
    y(2,1)=2*x(1)
    y(2,2)=x(2)/2
endfunction</code></pre>
<p>Alternativamente, estas funções poderiam ser escritas como</p>
<pre><code>function y=F(x)
    y=[x(1)^2/3+x(2)^2-1; x(1)^2+x(2)^2/4-1]
endfunction

function y=JF(x)
    y=[2*x(1)/3  2*x(2); 2*x(1) x(2)/2]
endfunction</code></pre>
<p>Desta forma, se <span class="math"><em>x</em></span> é uma aproximação para a raiz, pode-se calcular a próxima aproximação através dos comandos:</p>
<pre><code>delta=-JF(x)\F(x)
x=x+delta</code></pre>
<p>Ou simplesmente</p>
<pre><code>x=x-JF(x)\F(x)</code></pre>
<p>Observe que as soluções exatas desse sistema são <span class="math">$\left(\pm \sqrt{\frac{9}{11}},\pm \sqrt{\frac{8}{11}}\right)$</span>.</p>
<p>Encontre uma aproximação para a solução do sistema <br /><span class="math">$$\begin{aligned}
x_1^2=\cos(x_1x_2)+1\\
\sin(x_2)=2\cos(x_1)\end{aligned}$$</span><br /> que fica próxima ao ponto <span class="math"><em>x</em><sub>1</sub> = 1.5</span> e <span class="math"><em>x</em><sub>2</sub> = .5</span>.<br /><span><strong>Resp:</strong></span> <span class="math">(1, 3468109,  0, 4603195)</span>.</p>
<p>Vamos, aqui, dar as principais ideias para se obter a solução. Começamos definindo a função <span class="math"><em>F</em>(<em>x</em>)</span> por: <br /><span class="math">$$F(x)=\left[\begin{array}{c}
        \displaystyle x_1^2-\cos(x_1x_2)-1\\
        \displaystyle \sin(x_2)-2\cos(x_1)
      \end{array}\right]$$</span><br /> cuja jacobiana é: <br /><span class="math">$$J_F(x) = \left[\begin{array}{cc}
    \displaystyle 2x_1 +x_2\sin(x_1x_2) &amp; x_1\sin(x_1x_2)\\
    \displaystyle 2\sin(x_1) &amp; \cos(x_2)
  \end{array}\right]$$</span><br /> No <code>Scilab</code>, podemos implementá-las com o seguinte código:</p>
<pre><code>function y=F(x)
    y(1) = x(1)^2-cos(x(1)*x(2))-1
    y(2) = sin(x(2))-2*cos(x(1))
endfunction

function y=JF(x)
    y(1,1) = 2*x(1)+x(2)*sin(x(1)*x(2)) 
    y(1,2) = x(1)*sin(x(1)*x(2))

    y(2,1) = 2*sin(x(1)) 
    y(2,2) = cos(x(2))
endfunction</code></pre>
<p>E agora, basta iterar:</p>
<pre><code>x=[1.5; .5]
x=x-JF(x)\F(x) (5 vezes)</code></pre>
<h3 id="código-scilab-newton-para-sistemas">Código Scilab: Newton para Sistemas</h3>
<h2 id="exercícios-14" class="unnumbered">Exercícios</h2>
<p>Encontre uma aproximação numérica para o seguinte problema não-linear de três equações e três incógnitas: <br /><span class="math">$$\begin{aligned}
2x_1-x_2&amp;=&amp;\cos(x_1)\\
-x_1+2x_2-x_3&amp;=&amp;\cos(x_2)\\
-x_2+	x_3&amp;=&amp;\cos(x_3)\end{aligned}$$</span><br /> Partindo das seguintes aproximações iniciais:</p>
<ul>
<li><p><span class="math"><em>x</em><sup>(0)</sup> = [1,  1,  1]<sup><em>T</em></sup></span></p></li>
<li><p><span class="math"><em>x</em><sup>(0)</sup> = [ − 0, 5,   − 2,   − 3]<sup><em>T</em></sup></span></p></li>
<li><p><span class="math"><em>x</em><sup>(0)</sup> = [ − 2,   − 3,   − 4]<sup><em>T</em></sup></span></p></li>
<li><p><span class="math"><em>x</em><sup>(0)</sup> = [0,  0,  0]<sup><em>T</em></sup></span></p></li>
</ul>
<h2 id="linearização-de-uma-função-de-várias-variáveis">Linearização de uma função de várias variáveis</h2>
<h3 id="o-gradiente">O gradiente</h3>
<p>Considere primeiramente uma função <span class="math"><em>f</em> : ℝ<sup><em>n</em></sup> → ℝ</span>, ou seja, uma função que mapeia n variáveis reais em um único real, por exemplo: <br /><span class="math"><em>f</em>(<em>x</em>) = <em>x</em><sub>1</sub><sup>2</sup> + <em>x</em><sub>2</sub><sup>2</sup>/4</span><br /></p>
<p>Para construirmos a linearização, fixemos uma direção no espaço <span class="math">ℝ<sup><em>n</em></sup></span>, ou seja um vetor <span class="math"><em>v</em></span>: <br /><span class="math"><em>v</em> = [<em>v</em><sub>1</sub>, <em>v</em><sub>2</sub>, ⋯, <em>v</em><sub><em>n</em></sub>]<sup><em>T</em></sup></span><br /></p>
<p>Queremos estudar como a função <span class="math"><em>f</em>(<em>x</em>)</span> varia quando “andamos” na direção <span class="math"><em>v</em></span> a partir do ponto <span class="math"><em>x</em><sup>(0)</sup></span>. Para tal, inserimos um parâmetro real pequeno <span class="math"><em>h</em></span>, dizemos que <br /><span class="math"><em>x</em> = <em>x</em><sup>(0)</sup> + <em>h</em><em>v</em></span><br /> e definimos a função auxiliar <br /><span class="math"><em>g</em>(<em>h</em>) = <em>f</em>(<em>x</em><sup>0</sup> + <em>h</em><em>v</em>).</span><br /> Observamos que a função <span class="math"><em>g</em>(<em>h</em>)</span> é uma função de <span class="math">ℝ</span> em <span class="math">ℝ</span>.</p>
<p>A linearização de <span class="math"><em>g</em>(<em>h</em>)</span> em torno de <span class="math"><em>h</em> = 0</span> é dada por</p>
<p><br /><span class="math"><em>g</em>(<em>h</em>) = <em>g</em>(0) + <em>h</em><em>g</em>′(0) + <em>O</em>(<em>h</em><sup>2</sup>)</span><br /> Observamos que <span class="math"><em>g</em>(<em>h</em>) = <em>f</em>(<em>x</em><sup>(0)</sup> + <em>h</em><em>v</em>)</span> e <span class="math"><em>g</em>(0) = <em>f</em>(<em>x</em><sup>(0)</sup>)</span>. Precisamos calcular <span class="math"><em>g</em>′(0)</span>:</p>
<p><br /><span class="math">$$\begin{aligned}
g'(h)=\frac{d}{dh}g(h)=\frac{d}{dh}f(x^{(0)}+hv)\end{aligned}$$</span><br /></p>
<p>Pela regra da cadeia temos: <br /><span class="math">$$\begin{aligned}
\frac{d}{dh}f(x^{(0)}+hv)= \sum_{j=1}^n \frac{\partial f}{\partial x_j}\frac{d x_j}{d h}\end{aligned}$$</span><br /></p>
<p>Observamos que <span class="math"><em>x</em><sub><em>j</em></sub> = <em>x</em><sub><em>j</em></sub><sup>(0)</sup> + <em>h</em><em>v</em><sub><em>j</em></sub></span>, portanto <br /><span class="math">$$\frac{d x_j}{d h}=v_j$$</span><br /> Assim: <br /><span class="math">$$\begin{aligned}
\frac{d}{dh}f(x^{(0)}+hv)= \sum_{j=1}^n \frac{\partial f}{\partial x_j}v_j\end{aligned}$$</span><br /> Observamos que esta expressão pode ser vista como o produto interno entre o gradiente de <span class="math"><em>f</em></span> e o vetor <span class="math"><em>v</em></span>: <br /><span class="math">$$\begin{aligned}
\nabla f = \left[
\begin{matrix}
\frac{\partial f}{\partial x_1} \\
\frac{\partial f}{\partial x_2} \\
\vdots\\
\frac{\partial f}{\partial x_n}
\end{matrix}
\right] \qquad v=\left[
\begin{matrix}
v_1\\
v_2\\
\vdots\\
v_n
\end{matrix}
\right]\end{aligned}$$</span><br /></p>
<p>Na notação cálculo vetorial escrevemos este produto interno como <span class="math">∇<em>f</em> ⋅ <em>v</em> = <em>v</em> ⋅ ∇<em>f</em></span> na notação de produto matricial, escrevemos <span class="math">(∇<em>f</em>)<sup><em>T</em></sup><em>v</em> = <em>v</em><sup><em>T</em></sup>∇<em>f</em></span>. Esta quantidade é conhecida como <span><strong>derivada direcional</strong></span> de <span class="math"><em>f</em></span> no ponto <span class="math"><em>x</em><sup>(0)</sup></span> na direção <span class="math"><em>v</em></span>, sobretudo quando <span class="math">∥<em>v</em>∥ = 1</span>.</p>
<p>Podemos escrever a linearização <span class="math"><em>g</em>(<em>h</em>) = <em>g</em>(0) + <em>h</em><em>g</em>′(0) + <em>O</em>(<em>h</em><sup>2</sup>)</span> como <br /><span class="math"><em>f</em>(<em>x</em><sup>(0)</sup> + <em>h</em><em>v</em>) = <em>f</em>(<em>x</em><sup>(0)</sup>) + <em>h</em>∇<sup><em>T</em></sup>​<em>f</em>(<em>x</em><sup>(0)</sup>)​ <em>v</em> + <em>O</em>(<em>h</em><sup>2</sup>)</span><br /></p>
<p>Finalmente, escrevemos <span class="math"><em>x</em> = <em>x</em><sup>(0)</sup> + <em>h</em><em>v</em></span>, ou seja, <span class="math"><em>h</em><em>v</em> = <em>x</em> − <em>x</em><sup>(0)</sup></span> <br /><span class="math"><em>f</em>(<em>x</em>) = <em>f</em>(<em>x</em><sup>(0)</sup>) + ∇<sup><em>T</em></sup>​<em>f</em>(<em>x</em><sup>(0)</sup>)​ (<em>x</em> − <em>x</em><sup>(0)</sup>) + <em>O</em>(∥<em>x</em> − <em>x</em><sup>(0)</sup>∥<sup>2</sup>)</span><br /></p>
<p>Observe a semelhança com a linearização no caso em uma dimensão. A notação <span class="math">∇<sup><em>T</em></sup>​<em>f</em>(<em>x</em><sup>(0)</sup>)</span> é o transposto do vetor gradiente associado à função <span class="math"><em>f</em>(<em>x</em>)</span> no ponto <span class="math"><em>x</em><sup>(0)</sup></span>: <br /><span class="math">$$\nabla^T f(x^{(0)})=\left[\frac{\partial f\left(x^{(0)}\right)}{\partial x_1},~~ \frac{\partial f\left(x^{(0)}\right)}{\partial x_2},~~ \cdots,~\frac{\partial f\left(x^{(0)}\right)}{\partial x_n}\right]$$</span><br /></p>
<h3 id="a-matriz-jacobiana">A matriz jacobiana</h3>
<p>Interessamo-nos, agora, pela linearização da função <span class="math"><em>F</em> : ℝ<sup><em>n</em></sup> → ℝ<sup><em>n</em></sup></span>. Lembramos que <span class="math"><em>F</em>(<em>x</em>)</span> pode ser escrita como um vetor de funções <span class="math"><em>f</em><sub><em>j</em></sub> : ℝ<sup>𝕟</sup> → ℝ</span>: <br /><span class="math">$$F(x)=\left[\begin{matrix}
      f_1(x)\\
      f_2(x)\\
      \vdots\\
      f_n(x)
    \end{matrix}\right]$$</span><br /> Linearizando cada uma das funções <span class="math"><em>f</em><sub><em>j</em></sub></span>, temos: <br /><span class="math">$$\begin{aligned}
F(x)&amp;=&amp;\underbrace{\left[
\begin{array}{c}
f_1\left(x^{(0)}\right)+\nabla^T\! f_1(x^{(0)})\!~\left(x-x^{(0)}\right)   + O(\|x-x^{(0)}\|^2)\\~\\
f_2\left(x^{(0)}\right)+\nabla^T\! f_2(x^{(0)})\!~\left(x-x^{(0)}\right)   + O(\|x-x^{(0)}\|^2)\\~\\
\vdots\\~\\
f_n\left(x^{(0)}\right)+\nabla^T\! f_n(x^{(0)})\!~\left(x-x^{(0)}\right)   + O(\|x-x^{(0)}\|^2)
\end{array}
\right]}_{\hbox{Vetor coluna}}\end{aligned}$$</span><br /> ou, equivalentemente: <br /><span class="math">$$\begin{aligned}
 F(x) &amp;=&amp;\underbrace{\left[
\begin{array}{c}
f_1\left(x^{(0)}\right)\\~\\
f_2\left(x^{(0)}\right)\\~\\
\vdots\\~\\
f_n\left(x^{(0)}\right)
\end{array}
\right]}_{\hbox{Vetor coluna}}+
\underbrace{\left[
\begin{array}{c}\nabla^T\! f_1(x^{(0)})\\~~\\
\nabla^T\! f_2(x^{(0)})\\~~\\
\vdots\\~~\\
\nabla^T\! f_n(x^{(0)})
\end{array}
\right]}_{\hbox{Matriz jacobiana}}\underbrace{\left(x-x^{(0)}\right)}_{\hbox{Vetor coluna}}+O(\|x-x^{(0)}\|^2)\end{aligned}$$</span><br /></p>
<p>Podemos escrever a linearização de <span class="math"><em>F</em>(<em>x</em>)</span> na seguinte forma mais enxuta: <br /><span class="math"><em>F</em>(<em>x</em>) = <em>F</em>(<em>x</em><sup>(0)</sup>) + <em>J</em><sub><em>F</em></sub>(<em>x</em><sup>(0)</sup>)(<em>x</em> − <em>x</em><sup>(0)</sup>) + <em>O</em>(∥<em>x</em> − <em>x</em><sup>(0)</sup>∥<sup>2</sup>)</span><br /></p>
<p>A matriz jacobiana <span class="math"><em>J</em><sub><em>F</em></sub></span> é matriz cujas linhas são os gradientes transpostos de <span class="math"><em>f</em><sub><em>j</em></sub></span>, ou seja: <br /><span class="math">$$J_F= \frac{\partial(f_1,f_2,\ldots,f_n)}{\partial(x_1,x_2,\ldots,x_n)}=\left[
\begin{array}{ccccc}
\frac{\partial f_1}{\partial x_1}&amp;\frac{\partial f_1}{\partial x_2}&amp;\cdots&amp;\frac{\partial f_1}{\partial x_n}\\~\\
\frac{\partial f_2}{\partial x_1}&amp;\frac{\partial f_2}{\partial x_2}&amp;\cdots&amp;\frac{\partial f_2}{\partial x_n}\\~\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\~\\
\frac{\partial f_n}{\partial x_1}&amp;\frac{\partial f_n}{\partial x_2}&amp;\cdots&amp;\frac{\partial f_n}{\partial x_n}\\~\\
\end{array}
\right]$$</span><br /> A matriz jacobiana de uma função ou simplesmente, o Jacobiano de uma função <span class="math"><em>F</em>(<em>x</em>)</span> é a matriz formada pelas suas derivadas parciais: <br /><span class="math">$$\left(J_F\right)_{ij}=\frac{\partial f_i}{\partial x_j}$$</span><br /></p>
<p>Calcule a matriz jacobiana da função <br /><span class="math">$$F(x)=\left[
\begin{array}{c}
\frac{x_1^2}{3}+x_2^2-1\\~\\
x_1^2+\frac{x_2^2}{4}-1
\end{array}
\right]$$</span><br /></p>
<p><br /><span class="math">$$J_F=\left[
\begin{array}{cc}
\frac{\partial f_1}{\partial x_1} &amp; \frac{\partial f_1}{\partial x_2}\\~\\
\frac{\partial f_2}{\partial x_1} &amp; \frac{\partial f_2}{\partial x_2}\\
\end{array}
\right]=\left[
\begin{array}{cc}
\frac{2x_1}{3} &amp; 2x_2\\~\\
2x_1&amp;\frac{x_2}{2}
\end{array}
\right]$$</span><br /></p>
<h1 id="aproximação-de-funções">Aproximação de funções</h1>
<p>O problema geral da interpolação pode ser definido da seguinte forma:</p>
<p>Seja <span class="math">ℱ</span> uma família de funções <span class="math"><em>f</em> : <em>D</em> → <em>E</em></span> e <span class="math">{(<em>x</em><sub><em>i</em></sub>, <em>y</em><sub><em>i</em></sub>)}<sub><em>i</em> = 1</sub><sup><em>N</em></sup></span> um conjunto de pares ordenados tais que <span class="math"><em>x</em><sub><em>i</em></sub> ∈ <em>D</em></span> e <span class="math"><em>y</em><sub><em>i</em></sub> ∈ <em>E</em></span>, encontrar uma função <span class="math"><em>f</em></span> da família dada tal que <span class="math"><em>f</em>(<em>x</em><sub><em>i</em></sub>) = <em>y</em><sub><em>i</em></sub></span> para cada <span class="math">1 ≤ <em>i</em> ≤ <em>N</em></span>.</p>
<p>Encontrar uma função <span class="math"><em>f</em>(<em>x</em>)</span> da forma <span class="math"><em>f</em>(<em>x</em>) = <em>a</em><em>e</em><sup><em>b</em><em>x</em></sup></span> onde <span class="math"><em>a</em></span> e <span class="math"><em>b</em></span> são constantes tal que <span class="math"><em>f</em>(1) = 1</span> e <span class="math"><em>f</em>(2) = 5</span>. Este problema equivale a resolver o seguinte sistema de equações: <br /><span class="math">$$\begin{aligned}
ae^b&amp;=&amp;1\\
ae^{2b}&amp;=&amp;5\end{aligned}$$</span><br /> Dividindo a segunda equação pela primeira, temos <span class="math"><em>e</em><sup><em>b</em></sup> = 5</span>, logo, <span class="math"><em>b</em> = ln(5)</span>. Substituindo este valor em qualquer das equações, temos <span class="math">$a=\frac{1}{5}$</span>. Assim <br /><span class="math">$$f(x)=\frac{1}{5}e^{\ln(5) x}=\frac{1}{5}5^x=5^{x-1}.$$</span><br /></p>
<p>Encontrar a função polinomial do tipo <span class="math"><em>f</em>(<em>x</em>) = <em>a</em> + <em>b</em><em>x</em> + <em>c</em><em>x</em><sup>2</sup></span> que passe pelos pontos <span class="math">( − 1, 2)</span>, <span class="math">(0, 1)</span>, <span class="math">(1, 6)</span>. Observamos que podemos encontrar os coeficientes <span class="math"><em>a</em></span>, <span class="math"><em>b</em></span> e <span class="math"><em>c</em></span> através do seguinte sistema linear: <br /><span class="math">$$\begin{aligned}
a-b+c&amp;=&amp;2\\
a&amp;=&amp;1\\
a+b+c&amp;=&amp;6\end{aligned}$$</span><br /> cuja solução é dada por <span class="math"><em>a</em> = 1</span>, <span class="math"><em>b</em> = 2</span> e <span class="math"><em>c</em> = 3</span>. Portanto <br /><span class="math"><em>f</em>(<em>x</em>) = 1 + 2<em>x</em> + 3<em>x</em><sup>2</sup>.</span><br /></p>
<h2 id="interpolação-polinomial">Interpolação polinomial</h2>
<p>Interpolação polinomial é o caso particular do problema geral de interpolação quando a família de funções é constituída de polinômios.</p>
<p>[teo<sub>i</sub>nterp<sub>p</sub>oli] Seja <span class="math">{(<em>x</em><sub><em>i</em></sub>, <em>y</em><sub><em>i</em></sub>)}<sub><em>i</em> = 0</sub><sup><em>n</em></sup></span> um conjunto de <span class="math"><em>n</em> + 1</span> pares ordenados de números reais tais que <br /><span class="math">$$i\neq j \Longrightarrow x_i\neq x_j~~~~\hbox{ (i.e. as abscissas são distintas)}$$</span><br /> então existe um único polinômio <span class="math"><em>P</em>(<em>x</em>)</span> de grau igual ou inferior a <span class="math"><em>n</em></span> que passa por todos os pontos dados.</p>
<p>Observamos que o problema de encontrar os coeficientes <span class="math"><em>a</em><sub>0</sub></span>, <span class="math"><em>a</em><sub>1</sub></span>,…, <span class="math"><em>a</em><sub><em>n</em></sub></span> do polinômio <br /><span class="math">$$P(x)=a_0+a_1x+a_2x^2+\cdots a_n x^n=\sum_{k=0}^n a_k x^k$$</span><br /> tal que <span class="math"><em>P</em>(<em>x</em><sub><em>i</em></sub>) = <em>y</em><sub><em>i</em></sub></span> é equivalente ao seguinte sistema linear de <span class="math"><em>n</em> + 1</span> equações e <span class="math"><em>n</em> + 1</span> incógnitas: <br /><span class="math">$$\begin{aligned}
a_0+a_1x_0+a_2x_0^2+\cdots +a_n x_0^n&amp;=&amp;y_0\\
a_0+a_1x_2+a_2x_1^2+\cdots +a_n x_1^n&amp;=&amp;y_1\\
&amp;\vdots&amp;\\
a_0+a_1x_n+a_2x_n^2+\cdots +a_n x_n^n&amp;=&amp;y_n\end{aligned}$$</span><br /> que pode ser escrito na forma matricial como <br /><span class="math">$$\left[
\begin{array}{ccccc}
1 &amp; x_0 &amp; x_0^2 &amp; \cdots &amp; x_0^n\\
1 &amp; x_1 &amp; x_1^2 &amp; \cdots &amp; x_1^n\\
1 &amp; x_2 &amp; x_2^2 &amp; \cdots &amp; x_2^n\\
\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
1 &amp; x_n &amp; x_n^2 &amp; \cdots &amp; x_n^n
\end{array}
\right]
\left[
\begin{array}{c}
a_0\\a_1\\a_2\\ \vdots \\a_n
\end{array}
\right]=
\left[
\begin{array}{c}
y_0\\y_1\\y_2\\ \vdots \\y_n
\end{array}
\right]$$</span><br /> A matriz envolvida é uma matriz de Vandermonde de ordem <span class="math"><em>n</em> + 1</span> cujo determinante é dado por <br /><span class="math">∏<sub>0 ≤ <em>i</em> &lt; <em>j</em> ≤ <em>n</em></sub>(<em>x</em><sub><em>j</em></sub> − <em>x</em><sub><em>i</em></sub>)</span><br /> É fácil ver que se as abscissas são diferentes dois a dois, então o determinante é não-nulo. Disto decorre que o sistema possui um a solução e que esta solução é única.</p>
<p>Encontre o polinômio da forma <span class="math"><em>P</em>(<em>x</em>) = <em>a</em><sub>0</sub> + <em>a</em><sub>1</sub><em>x</em> + <em>a</em><sub>2</sub><em>x</em><sup>2</sup> + <em>a</em><sub>3</sub><em>x</em><sup>3</sup></span> que passa pelos pontos <br /><span class="math">(0, 1), (1, 2), (2, 4), (3, 8)</span><br /> Este problema é equivalente ao seguinte sistema linear: <br /><span class="math">$$\begin{aligned}
a_0&amp;=&amp;1\\
a_0+a_1+a_2+a_3&amp;=&amp;2\\
a_0+2a_1+4a_2+8a_3&amp;=&amp;4\\
a_0+3a_1+9a_2+27a_3&amp;=&amp;8\end{aligned}$$</span><br /> cuja solução é <span class="math"><em>a</em><sub>0</sub> = 1</span>, <span class="math">$a_1=\frac{5}{6}$</span>, <span class="math"><em>a</em><sub>2</sub> = 0</span> e <span class="math">$a_3=\frac{1}{6}$</span>. Portanto <br /><span class="math">$$P(x)=1+\frac{5}{6}x+\frac{1}{6}x^3$$</span><br /></p>
<p>Encontre o polinômio da forma <span class="math"><em>P</em>(<em>x</em>) = <em>a</em><sub>0</sub> + <em>a</em><sub>1</sub><em>x</em> + <em>a</em><sub>2</sub><em>x</em><sup>2</sup> + <em>a</em><sub>3</sub><em>x</em><sup>3</sup></span> que passa pelos pontos <br /><span class="math">(0, 0), (1, 1), (2, 4), (3, 9)</span><br /> Este problema é equivalente ao seguinte sistema linear: <br /><span class="math">$$\begin{aligned}
a_0&amp;=&amp;0\\
a_0+a_1+a_2+a_3&amp;=&amp;1\\
a_0+2a_1+4a_2+8a_3&amp;=&amp;4\\
a_0+3a_1+9a_2+27a_3&amp;=&amp;9\end{aligned}$$</span><br /> cuja solução é <span class="math"><em>a</em><sub>0</sub> = 0</span>, <span class="math"><em>a</em><sub>1</sub> = 0</span>, <span class="math"><em>a</em><sub>2</sub> = 1</span> e <span class="math"><em>a</em><sub>3</sub> = 0</span>. Portanto <br /><span class="math"><em>P</em>(<em>x</em>) = <em>x</em><sup>2</sup></span><br /></p>
<p>Esta abordagem direta que fizemos ao calcular os coeficientes do polinômio na base canônica se mostra ineficiente quando o número de pontos é grande e quando existe grande discrepância nas abscissas. Neste caso a matriz de Vandermonde é mal-condicionada (ver <span class="citation"></span>), acarretando um aumento dos erros de arredondamento na solução do sistema.</p>
<p>Uma maneira de resolver este problema é escrever o polinômio em uma base que produza um sistema mais bem-condicionado.</p>
<h2 id="diferenças-divididas-de-newton">Diferenças divididas de Newton</h2>
<p>O método das diferenças divididas de Newton consistem em construir o polinômio interpolador da seguinte forma: <br /><span class="math">$$\begin{aligned}
P(x) &amp;= a_0 + a_1 (x-x_0) + a_2 (x-x_0)(x-x_1) + \cdots \\
&amp;+ a_n (x-x_0)(x-x_1)\cdots (x-x_{n-1}).\end{aligned}$$</span><br /> Assim, o problema de calcular os coeficientes <span class="math"><em>a</em><sub>0</sub></span>, <span class="math"><em>a</em><sub>1</sub></span>, …, <span class="math"><em>a</em><sub><em>n</em></sub></span> é equivalente ao seguinte sistema linear:</p>
<p><br /><span class="math">$$\begin{aligned}
a_0 &amp;= y_0\\
a_0+a_1(x_1-x_0) &amp;= y_1\\
a_0+a_1(x_2-x_0)+a_2(x_2-x_0)(x_2-x_1) &amp;= y_2\\
&amp;\vdots\\
a_0+a_1(x_n-x_0)+a_2(x_n-x_0)(x_n-x_1)+\cdots + a_n(x_n-x_0)\cdots (x_n-x_{n-1})
 &amp;= y_n\end{aligned}$$</span><br /></p>
<p>.</p>
<p>O qual é equivalente à sua forma matricial:</p>
<p><br /><span class="math">$$\begin{bmatrix}
      1 &amp; 0 &amp; 0  &amp; \!\cdots\!&amp;0\\
      1&amp; (x_1-x_0)&amp;0 &amp;\!\cdots\!&amp;0\\
      1&amp;(x_2-x_0)&amp;(x_2-x_0)(x_2-x_1) &amp;\!\cdots\!&amp;0\\
      \vdots&amp;\vdots&amp;\vdots&amp;\!\ddots\!&amp;\vdots\\
      1&amp;(x_n-x_0)&amp;(x_n-x_0)(x_n-x_1) &amp;\!\cdots\!&amp; (x_{n}-x_0)\cdots(x_n-x_{n-1})\\
    \end{bmatrix}\begin{bmatrix}
      a_0\\a_1\\a_2\\ \vdots \\a_n
    \end{bmatrix} = 
    \begin{bmatrix}
      y_0\\y_1\\y_2\\ \vdots \\y_n
    \end{bmatrix}$$</span><br /></p>
<p>Este é um sistema triangular inferior que pode ser facilmente resolvido conforme: <br /><span class="math">$$\begin{aligned}
a_0&amp;=&amp;y_0\\
a_1&amp;=&amp;\frac{y_1-a_0}{x_1-x_0}=\frac{y_1-y_0}{x_1-x_0}\\
a_2&amp;=&amp;\frac{y_2-a_1(x_2-x_0)-a_0}{(x_2-x_0)(x_2-x_1)}=\frac{\frac{y_2-y_1}{(x_2-x_1)}-\frac{y_1-y_0}{(x_1-x_0)}}{(x_2-x_0)}\\
&amp;\ldots&amp;\end{aligned}$$</span><br /> A solução deste sistema pode ser escrita em termos das Diferenças Divididas de Newton, definidas recursivamente conforme: <br /><span class="math">$$\begin{aligned}
f[x_j]&amp;=&amp;y_j\\
f[x_j,x_{j+1}]&amp;=&amp;\frac{f[x_{j+1}]-f[x_j]}{x_{j+1}-x_j}\\
f[x_j,x_{j+1},x_{j+2}]&amp;=&amp;\frac{f[x_{j+1},x_{j+2}]-f[x_j,x_{j+1}]}{x_{j+2}-x_j}\\
&amp;\vdots&amp;\end{aligned}$$</span><br /> Nesta notação, temos <span class="math"><em>a</em><sub><em>k</em></sub> = <em>f</em>[<em>x</em><sub>0</sub>, <em>x</em><sub>1</sub>, <em>x</em><sub>2</sub>, …, <em>x</em><sub><em>k</em></sub>]</span></p>
<p>Podemos esquematizar o método na seguinte tabela: <br /><span class="math">$$\begin{array}{|c|c|c|c|c|}\hline
 j&amp;x_j&amp;f[x_j]&amp;f[x_{j-1},x_j]&amp;f[x_{j-2},x_{j-1},x_j]\\\hline
&amp;&amp;&amp;&amp;\\
0&amp; x_0 &amp; f[x_0]&amp;&amp;\\
&amp;&amp;&amp;&amp;\\
&amp;&amp;&amp;f[x_0,x_1]=\frac{f[x_1]-f[x_0]}{x_1-x_0}&amp;\\
&amp;&amp;&amp;&amp;\\
1&amp;x_1&amp;f[x_1]&amp;&amp;f[x_0,x_1,x_2]=\frac{f[x_1,x_2]-f[x_0,x_1]}{x_2-x_0}\\
&amp;&amp;&amp;&amp;\\
&amp;&amp;&amp;f[x_1,x_2]=\frac{f[x_2]-f[x_1]}{x_2-x_1}&amp;\\
&amp;&amp;&amp;&amp;\\
2&amp;x_2&amp;f[x_2]&amp;&amp;\\
&amp;&amp;&amp;&amp;\\ \hline
\end{array}$$</span><br /></p>
<p>Encontrar o polinômio que passe pelos seguintes pontos <br /><span class="math">( − 1, 3), (0, 1), (1, 3), (3, 43)</span><br /></p>
<p><br /><span class="math">$$\begin{array}{|c||c|c|c|c|c|}\hline
 j&amp;x_j&amp;f[x_j]&amp;f[x_{j-1},x_j]&amp;f[x_{j-2},x_{j-1},x_j]&amp;f[x_{j-3},x_{j-2},x_{j-1},x_j]\\\hline
&amp;&amp;&amp;&amp;&amp;\\
0&amp; -1 &amp; 3&amp;&amp;&amp;\\
&amp;&amp;&amp;&amp;&amp;\\
&amp;&amp;&amp;\frac{1-3}{0-(-1)}=-2&amp;&amp;\\
&amp;&amp;&amp;&amp;&amp;\\
1&amp;0&amp;1&amp;&amp;\frac{2-(-2)}{1-(-1)}=2&amp;\\
&amp;&amp;&amp;&amp;&amp;\\
&amp;&amp;&amp;\frac{3-1}{1-0}=2&amp;&amp;\frac{6-2}{3-(-1)}=1\\
&amp;&amp;&amp;&amp;&amp;\\
2&amp;1&amp;3&amp;&amp;\frac{20-2}{3-0}=6&amp;\\
&amp;&amp;&amp;&amp;&amp;\\
&amp;&amp;&amp;\frac{43-3}{3-1}=20&amp;&amp;\\
&amp;&amp;&amp;&amp;&amp;\\
3&amp;3&amp;43&amp;&amp;&amp;\\
&amp;&amp;&amp;&amp;&amp;\\\hline
\end{array}$$</span><br /></p>
<p>Portanto <br /><span class="math">$$\begin{aligned}
P(x)&amp;=&amp;3-2(x+1)+2(x+1)x+(x+1)x(x-1)\\
&amp;=&amp;x^3+2x^2-x+1\end{aligned}$$</span><br /></p>
<h2 id="exercícios-15" class="unnumbered">Exercícios</h2>
<p>[exer:interp1] Considere o seguinte conjunto de pontos: <br /><span class="math">( − 2,  − 47), (0,  − 3), (1, 4)(2, 41)</span><br />. Encontre o polinômio interpolador usando os métodos vistos.</p>
<p><span class="math">5<em>x</em><sup>3</sup> + 2<em>x</em> − 3</span></p>
<p>No <code>Scilab</code>, faça um gráfico com os pontos e o polinômio interpolador do Exercício [exer:interp1].</p>
<h2 id="polinômios-de-lagrange">Polinômios de Lagrange</h2>
<p>Outra maneira clássica de resolver o problema da interpolação polinomial é através do polinômios de Lagrange. Dado um conjunto de pontos <span class="math">{<em>x</em><sub><em>j</em></sub>}<sub><em>j</em> = 1</sub><sup><em>n</em></sup></span> distintos dois a dois, definimos os polinômios de Lagrange como os polinômios de grau <span class="math"><em>n</em> − 1</span> que satisfazem as seguintes condições: <br /><span class="math">$$L_k(x_j)=\left\{\begin{array}{rl}
1,&amp;k=j\\
0,&amp;k\neq j
\end{array}
\right.$$</span><br /> Assim, a solução do problema de encontrar os polinômios de grau <span class="math"><em>n</em> − 1</span> tais <span class="math"><em>P</em>(<em>x</em><sub><em>j</em></sub>) = <em>y</em><sub><em>j</em></sub>, <em>j</em> = 1, ⋯, <em>n</em></span> é dado por <br /><span class="math">$$P(x)=y_1L_1(x)+y_2L_2(x)+\cdots +y_nL_n(x)=\sum_{j=1}^n y_j L_j(x)$$</span><br /></p>
<p>Para construir os polinômios de Lagrange, basta olhar para sua forma fatorada, ou seja: <br /><span class="math"><em>L</em><sub><em>k</em></sub>(<em>x</em>) = <em>C</em><sub><em>k</em></sub>∏<sub>1 ≤ <em>j</em> ≠ <em>k</em> ≤ <em>n</em></sub>(<em>x</em> − <em>x</em><sub><em>j</em></sub>)</span><br /> onde o coeficiente <span class="math"><em>C</em><sub><em>k</em></sub></span> é obtido da condição <span class="math"><em>L</em><sub><em>k</em></sub>(<em>x</em><sub><em>k</em></sub>) = 1</span>: <br /><span class="math">$$L_k(x_k)=C_k\prod_{1\leq j \neq k \leq n } (x_k-x_j) \Longrightarrow C_k=\frac{1}{\prod_{1\leq j \neq k \leq n } (x_k-x_j)}$$</span><br /> Portanto, <br /><span class="math">$$L_k(x)=\prod_{1\leq j \neq k \leq n } \frac{(x-x_j)}{(x_k-x_j)}$$</span><br /></p>
<p>O problema de interpolação quando escrito usando como base os polinômios de Lagrange produz um sistema linear diagonal.</p>
<p>Encontre o polinômio da forma <span class="math"><em>P</em>(<em>x</em>) = <em>a</em><sub>0</sub> + <em>a</em><sub>1</sub><em>x</em> + <em>a</em><sub>2</sub><em>x</em><sup>2</sup> + <em>a</em><sub>3</sub><em>x</em><sup>3</sup></span> que passa pelos pontos <br /><span class="math">(0, 0), (1, 1), (2, 4), (3, 9)</span><br /> Escrevemos: <br /><span class="math">$$\begin{aligned}
L_1(x)&amp;=&amp; \frac{(x-1)(x-2)(x-3)}{(0-1)(0-2)(0-3)}=-\frac{1}{6}x^3+x^2-\frac{11}{6}x+1\\
L_2(x)&amp;=&amp; \frac{x(x-2)(x-3)}{1(1-2)(1-3)}=\frac{1}{2}x^3-\frac{5}{2}x^2+3x\\
L_3(x)&amp;=&amp; \frac{x(x-1)(x-3)}{2(2-1)(2-3)}=-\frac{1}{2}x^3+2x^2-\frac{3}{2}x\\
L_4(x)&amp;=&amp; \frac{x(x-1)(x-2)}{3(3-1)(3-2)}=\frac{1}{6}x^3-\frac{1}{2}x^2+\frac{1}{3}x\end{aligned}$$</span><br /> Assim temos: <br /><span class="math"><em>P</em>(<em>x</em>) = 0 ⋅ <em>L</em><sub>1</sub>(<em>x</em>) + 1 ⋅ <em>L</em><sub>2</sub>(<em>x</em>) + 4 ⋅ <em>L</em><sub>3</sub>(<em>x</em>) + 9 ⋅ <em>L</em><sub>4</sub>(<em>x</em>) = <em>x</em><sup>2</sup></span><br /></p>
<p>Encontre o polinômio da forma <span class="math"><em>P</em>(<em>x</em>) = <em>a</em><sub>0</sub> + <em>a</em><sub>1</sub><em>x</em> + <em>a</em><sub>2</sub><em>x</em><sup>2</sup> + <em>a</em><sub>3</sub><em>x</em><sup>3</sup></span> que passa pelos pontos <br /><span class="math">(0, 0), (1, 1), (2, 0), (3, 1)</span><br /> Como as abscissas são as mesmas do exemplo anterior, podemos utilizar os mesmos polinômios de Lagrange, assim temos: <br /><span class="math">$$P(x)=0\cdot L_1(x)+1\cdot L_2(x)+0\cdot L_3(x)+1\cdot L_4(x)=\frac{2}{3}x^3-3x^2+\frac{10}{3}x$$</span><br /></p>
<h2 id="aproximação-de-funções-reais-por-polinômios-interpoladores">Aproximação de funções reais por polinômios interpoladores</h2>
<p><span>[teo<sub>i</sub>nterp]</span> Dados <span class="math"><em>n</em> + 1</span> pontos distintos, <span class="math"><em>x</em><sub>0</sub>,  <em>x</em><sub>1</sub>,  ⋯,  <em>x</em><sub><em>n</em></sub></span>, dentro de um intervalo <span class="math">[<em>a</em>, <em>b</em>]</span> e uma função <span class="math"><em>f</em></span> com <span class="math"><em>n</em> + 1</span> derivadas contínuas nesse intervalo (<span class="math"><em>f</em> ∈ <em>C</em><sup><em>n</em> + 1</sup>[<em>a</em>, <em>b</em>]</span>), então para cada <span class="math"><em>x</em></span> em <span class="math">[<em>a</em>, <em>b</em>]</span>, existe um número <span class="math"><em>ξ</em>(<em>x</em>)</span> em <span class="math">(<em>a</em>, <em>b</em>)</span> tal que <br /><span class="math">$$f(x)=P(x)+\frac{f^{(n+1)}(\xi(x))}{(n+1)!}(x-x_0)(x-x_1)\cdots(x-x_n),$$</span><br /> onde <span class="math"><em>P</em>(<em>x</em>)</span> é o polinômio interpolador. Em especial, pode-se dizer que <br /><span class="math">$$|f(x)-P(x)|\leq \frac{M}{(n+1)!}\left|(x-x_0)(x-x_1)\cdots(x-x_n)\right|,$$</span><br /> onde <br /><span class="math"><em>M</em> = max<sub><em>x</em> ∈ [<em>a</em>, <em>b</em>]</sub>|<em>f</em><sup>(<em>n</em> + 1)</sup>(<em>ξ</em>(<em>x</em>))|</span><br /></p>
<p>Considere a função <span class="math"><em>f</em>(<em>x</em>) = cos(<em>x</em>)</span> e o polinômio <span class="math"><em>P</em>(<em>x</em>)</span> de grau 2 tal que <span class="math"><em>P</em>(0) = cos(0) = 1</span>, <span class="math">$P(\frac{1}{2})=\cos(\frac{1}{2})$</span> e <span class="math"><em>P</em>(1) = cos(1)</span>. Use a fórmula de Lagrange para encontrar <span class="math"><em>P</em>(<em>x</em>)</span>. Encontre o erro máximo que se assume ao aproximar o valor de <span class="math">cos(<em>x</em>)</span> pelo de <span class="math"><em>P</em>(<em>x</em>)</span> no intervalo <span class="math">[0, 1]</span>. Trace os gráficos de <span class="math"><em>f</em>(<em>x</em>)</span> e <span class="math"><em>P</em>(<em>x</em>)</span> no intervalo <span class="math">[0, 1]</span> no mesmo plano cartesiano e, depois, trace o gráfico da diferença <span class="math">cos(<em>x</em>) − <em>P</em>(<em>x</em>)</span>. Encontre o erro efetivo máximo <span class="math">|cos(<em>x</em>) − <em>P</em>(<em>x</em>)|</span>.</p>
<p><br /><span class="math">$$\begin{aligned}
P(x)&amp;=&amp;1\frac{(x-\frac{1}{2})(x-1)}{(0-\frac{1}{2})(0-1)}+\cos\left(\frac{1}{2}\right)\frac{(x-0)(x-1)}{(\frac{1}{2}-0)(\frac{1}{2}-1)}+\cos(1)\frac{(x-0)(x-\frac{1}{2})}{(1-0)(1-\frac{1}{2})}\\
&amp;\approx&amp;   1 - 0,0299720583066x - 0,4297256358252x^2\end{aligned}$$</span><br /></p>
<pre><code>L1=poly([.5 1],&#39;x&#39;);L1=L1/horner(L1,0)
L2=poly([0 1],&#39;x&#39;);L2=L2/horner(L2,0.5)
L3=poly([0 .5],&#39;x&#39;);L3=L3/horner(L3,1)
P=L1+cos(.5)*L2+cos(1)*L3
x=[0:.05:1]
plot(x,cos)
plot(x,horner(P,x),&#39;red&#39;)
plot(x,horner(P,x)-cos(x))</code></pre>
<p>Para encontrar o erro máximo, precisamos estimar <span class="math">|<em>f</em>‴(<em>x</em>)| = |sin(<em>x</em>)| ≤ sin(1) &lt; 0, 85</span> e <br /><span class="math">$$\max_{x\in[0,1]} \left|x\left(x-\frac{1}{2}\right)(x-1)\right|$$</span><br /> O polinômio de grau três <span class="math">$Q(x)=x\left(x-\frac{1}{2}\right)(x-1)$</span> tem um mínimo (negativo) em <span class="math">$x_1=\frac{3+\sqrt{3}}{6}$</span> e um máximo (positivo) em <span class="math">$x_2=\frac{3-\sqrt{3}}{6}$</span>. Logo: <br /><span class="math">$$\max_{x\in[0,1]} \left|x\left(x-\frac{1}{2}\right)(x-1)\right|\leq \max\{|Q(x_1)|,\ |Q(x_2)|\}\approx 0,0481125.$$</span><br /> Portanto: <br /><span class="math">$$|f(x)-P(x)|&lt; \frac{0,85}{3!}0,0481125\approx 0,0068159&lt;7\cdot 10^{-3}$$</span><br /></p>
<p>Para encontrar o erro efetivo máximo, basta encontrar o máximo de <span class="math">|<em>P</em>(<em>x</em>) − <em>c</em><em>o</em><em>s</em>(<em>x</em>)|</span>. O mínimo (negativo) de <span class="math"><em>P</em>(<em>x</em>) − <em>c</em><em>o</em><em>s</em>(<em>x</em>)</span> acontece em <span class="math"><em>x</em><sub>1</sub> = 4, 29 ⋅ 10<sup> − 3</sup></span> e o máximo (positivo) acontece em <span class="math"><em>x</em><sub>2</sub> = 3, 29 ⋅ 10<sup> − 3</sup></span>. Portanto, o erro máximo efetivo é <span class="math">4, 29 ⋅ 10<sup> − 3</sup></span>.</p>
<p>[exemp<sub>s</sub>impson] Considere o problema de aproximar o valor da integral <span class="math">∫<sub>0</sub><sup>1</sup><em>f</em>(<em>x</em>)<em>d</em><em>x</em></span> pelo valor da integral do polinômio <span class="math"><em>P</em>(<em>x</em>)</span> que coincide com <span class="math"><em>f</em>(<em>x</em>)</span> nos pontos <span class="math"><em>x</em><sub>0</sub> = 0</span>, <span class="math">$x_1=\frac{1}{2}$</span> e <span class="math"><em>x</em><sub>2</sub> = 1</span>. Use a fórmula de Lagrange para encontrar <span class="math"><em>P</em>(<em>x</em>)</span>. Obtenha o valor de <span class="math">∫<sub>0</sub><sup>1</sup><em>f</em>(<em>x</em>)<em>d</em><em>x</em></span> e encontre uma expressão para o erro de truncamento.</p>
<p>O polinômio interpolador de <span class="math"><em>f</em>(<em>x</em>)</span> é <br /><span class="math">$$\begin{aligned}
P(x)&amp;=&amp;f(0)\frac{(x-\frac{1}{2})(x-1)}{(0-\frac{1}{2})(0-1)}+f\left(\frac{1}{2}\right)\frac{(x-0)(x-1)}{(\frac{1}{2}-0)(\frac{1}{2}-1)}+f(1)\frac{(x-0)(x-\frac{1}{2})}{(1-0)(1-\frac{1}{2})}\\
&amp;=&amp;   f(0)(2x^2-3x+1)+f\left(\frac{1}{2}\right)(-4x^2+4x)+f(1)(2x^2-x)\end{aligned}$$</span><br /> e a integral de <span class="math"><em>P</em>(<em>x</em>)</span> é: <br /><span class="math">$$\begin{aligned}
\int_0^1 P(x)dx &amp;= \left[f(0)\left(\frac{2}{3}x^3 - \frac{3}{2}x^2+x\right)\right]_0^1 + \left[f\left(\frac{1}{2}\right)\left(-\frac{4}{3}x^3+2x^2\right)\right]_0^1 \\
&amp;+ \left[f(1)\left(\frac{2}{3}x^3-\frac{1}{2}x^2\right)\right]_0^1\\
&amp;= f(0)\left(\frac{2}{3}-\frac{3}{2}+1\right)+f\left(\frac{1}{2}\right)\left(-\frac{4}{3}+2\right)+f(1)\left(\frac{2}{3}-\frac{1}{2}\right)\\
&amp;= \frac{1}{6}f(0)+\frac{2}{3}f\left(\frac{1}{2}\right)+\frac{1}{6}f(1)\end{aligned}$$</span><br /> Para fazer a estimativa de erro usando o teorema ([teo<sub>i</sub>nterp]), e temos <br /><span class="math">$$\begin{aligned}
\left|\int_0^1f(x)dx-\int_0^1 P(x)dx\right|&amp;=&amp;\left|\int_0^1f(x)- P(x)dx\right|\\
&amp;\leq&amp;\int_0^1|f(x)- P(x)|dx\\
&amp;\leq&amp; \frac{M}{6}  \int_0^1\left|x\left(x-\frac{1}{2}\right)(x-1)\right|dx\\
&amp;=&amp; \frac{M}{6}  \left[\int_0^{1/2}x\left(x-\frac{1}{2}\right)(x-1)dx\right.\\
&amp;-&amp;\left.\int_{1/2}^1x\left(x-\frac{1}{2}\right)(x-1)dx\right]\\
&amp;=&amp; \frac{M}{6}  \left[\frac{1}{64}-\left(-\frac{1}{64}\right)\right]=\frac{M}{192}.\end{aligned}$$</span><br /> Lembramos que <span class="math"><em>M</em> = max<sub><em>x</em> ∈ [0, 1]</sub>|<em>f</em>‴(<em>x</em>)|</span>.</p>
<p>Existem estimativas melhores para o erro de truncamento para este esquema de integração numérica. Veremos com mais detalhes tais esquemas na teoria de integração numérica.</p>
<p>Use o resultado do exemplo anterior para aproximar o valor das seguintes integrais:<br /></p>
<p>a) <span class="math">∫<sub>0</sub><sup>1</sup>ln(<em>x</em> + 1)<em>d</em><em>x</em></span><br /></p>
<p>b) <span class="math">∫<sub>0</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em></span></p>
<p>Usando a fórmula obtida, temos que <br /><span class="math">$$\int_0^1\ln(x+1) dx \approx 0,39\pm \frac{1}{96}$$</span><br /> <br /><span class="math">$$\int_0^1 e^{-x^2} dx \approx 0,75\pm \frac{3,87}{192}$$</span><br /></p>
<h2 id="exercícios-16" class="unnumbered">Exercícios</h2>
<p>Use as mesmas técnicas usadas o resultado do Exemplo ([exemp<sub>s</sub>impson]) para obter uma aproximação do valor de: <br /><span class="math">∫<sub>0</sub><sup>1</sup><em>f</em>(<em>x</em>)<em>d</em><em>x</em></span><br /> através do polinômio interpolador que coincide com <span class="math"><em>f</em>(<em>x</em>)</span> nos pontos <span class="math"><em>x</em> = 0</span> e <span class="math"><em>x</em> = 1</span>.</p>
<p><span class="math">$\int_0^1 P(x)dx =\frac{f(0)+f(1)}{2}$</span>, <span class="math">$\frac{1}{12}\max_{x\in[0,1]}|f''(x)|$</span></p>
<h2 id="ajuste-de-curvas-pelo-método-dos-mínimos-quadrados">Ajuste de curvas pelo método dos mínimos quadrados</h2>
<p>No problema de interpolação, desejamos encontrar uma função <span class="math"><em>f</em>(<em>x</em>)</span> tal que <br /><span class="math"><em>f</em>(<em>x</em><sub><em>j</em></sub>) = <em>y</em><sub><em>j</em></sub></span><br /> para um conjunto de pontos dados.</p>
<p>Existem diversas situações em que desejamos encontrar uma função que se aproxime desses pontos.</p>
<div class="figure">
<embed src="./cap_aproxfun/pics/ajuste_reta.eps" />
<p class="caption">Conjunto de 15 pontos e a reta que melhor se ajuste a eles pelo critério do mínimos quadrados.</p>
</div>
<p>No problema de ajuste de curvas, busca-se a função <span class="math"><em>f</em>(<em>x</em>)</span> de família de funções dadas que melhor se aproxima de um conjunto de pontos dados. O critério mais usado para o ajuste é critério dos mínimos quadrados, ou seja, buscamos a função <span class="math"><em>f</em>(<em>x</em>)</span> da família que minimiza a soma dos erros elevados ao quadrado: <br /><span class="math">$$E_q=\left[f(x_1)-y_1\right]^2+\left[f(x_2)-y_2\right]^2+\cdots +\left[f(x_n)-y_n\right]^2=\sum_{j=1}^n \left[f(x_j)-y_j\right]^2$$</span><br /></p>
<p>Encontre a função do tipo <span class="math"><em>f</em>(<em>x</em>) = <em>a</em><em>x</em></span> que melhor se aproxima dos seguintes pontos: <br /><span class="math">$$(0,-0,1), (1,~2), (2,~3,7) ~ \hbox{e} ~(3,~7).$$</span><br /></p>
<p>Defina <br /><span class="math"><em>E</em><sub><em>q</em></sub> = [<em>f</em>(<em>x</em><sub>1</sub>) − <em>y</em><sub>1</sub>]<sup>2</sup> + [<em>f</em>(<em>x</em><sub>2</sub>) − <em>y</em><sub>2</sub>]<sup>2</sup> + [<em>f</em>(<em>x</em><sub>3</sub>) − <em>y</em><sub>3</sub>]<sup>2</sup> + [<em>f</em>(<em>x</em><sub>4</sub>) − <em>y</em><sub>4</sub>]<sup>2</sup></span><br /> temos que <br /><span class="math">$$\begin{aligned}
E_q&amp;=&amp;[f(0)+0,1]^2+[f(1)-2]^2+[f(2)-3,7]^2+[f(3)-7]^2\\
&amp;=&amp;[0,1]^2+[a-2]^2+[2a-3,7]^2+[3a-7]^2\end{aligned}$$</span><br /></p>
<p>Devemos encontrar o parâmetro <span class="math"><em>a</em></span> que minimiza o erro, portanto, calculamos: <br /><span class="math">$$\begin{aligned}
\frac{\partial E_q}{\partial a}&amp;=&amp;2[a-2]+4[2a-3,7]+6[3a-7]=28a-60,8\end{aligned}$$</span><br /> Portanto o valor de <span class="math"><em>a</em></span> que minimiza o erro é <span class="math">$a=\frac{60,8}{28}$</span>.</p>
<pre><code>x=[0 1 2 3]&#39;
y=[-.1 2 3.7 7]&#39;
plot2d(x,y,style=-4)</code></pre>
<p>Encontre a função do tipo <span class="math"><em>f</em>(<em>x</em>) = <em>b</em><em>x</em> + <em>a</em></span> que melhor aproxima os pontos: <br /><span class="math">$$(0,-0,1), (1,~2), (2,~3,7) ~ \hbox{e} ~(3,~7).$$</span><br /></p>
<p><br /><span class="math">$$\begin{aligned}
E_q&amp;=&amp;[f(0)+0,1]^2+[f(1)-2]^2+[f(2)-3,7]^2+[f(3)-7]^2\\
&amp;=&amp;[a+0,1]^2+[a+b-2]^2+[a+2b-3,7]^2+[a+3b-7]^2\end{aligned}$$</span><br /></p>
<p>Devemos encontrar os parâmetros <span class="math"><em>a</em></span> <span class="math"><em>b</em></span> que minimizam o erro, por isso, calculamos as derivadas parciais: <br /><span class="math">$$\begin{aligned}
\frac{\partial E_q}{\partial a}&amp;=&amp;2[a+0,1]+2[a+b-2]+2[a+2b-3,7]+2[a+3b-7]\\
\frac{\partial E_q}{\partial b}&amp;=&amp;2[a+b-2]+4[a+2b-3,7]+6[a+3b-7]\end{aligned}$$</span><br /></p>
<p>O erro mínimo acontece quando as derivadas são nulas, ou seja: <br /><span class="math">$$\begin{aligned}
8a+12b&amp;=&amp;25,2\\
12a+28b&amp;=&amp;60,8\end{aligned}$$</span><br /> Cuja solução é dada por <span class="math"><em>a</em> =  − 0, 3</span> e <span class="math"><em>b</em> = 2, 3</span>. Portanto a função que procuramos é <span class="math"><em>f</em>(<em>x</em>) =  − 0, 3 + 2, 3<em>x</em></span>.</p>
<h2 id="o-caso-linear">O caso linear</h2>
<h3 id="o-método-dos-mínimos-quadrados">O método dos mínimos quadrados</h3>
<p>Considere o sistema linear dado por <span class="math"><em>A</em><em>x</em> = <em>b</em></span> onde <span class="math"><em>A</em></span> é uma matriz <span class="math"><em>n</em> × <em>m</em></span> e <span class="math"><em>b</em></span> é um vetor de <span class="math"><em>n</em></span> linhas. Assumimos as seguintes hipóteses:</p>
<ul>
<li><p><span class="math"><em>n</em> ≥ <em>m</em></span>. O número de linhas é igual ou superior ao número de colunas. (Mais equações que incógnitas)</p></li>
<li><p>O posto de <span class="math"><em>A</em></span> é <span class="math"><em>m</em></span>, i.e., existem <span class="math"><em>m</em></span> linhas L.I. Isso implica que <span class="math"><em>A</em><em>v</em> = 0</span> apenas quando <span class="math"><em>v</em> = 0</span></p></li>
</ul>
<p>Neste caso, não seremos necessariamente capazes de encontrar um vetor <span class="math"><em>x</em></span> que satisfaça exatamente a equação <span class="math"><em>A</em><em>x</em> = <em>b</em></span>, pelo que estamos interessamos no problema de encontrar o vetor <span class="math"><em>x</em></span> (ordem m) que minimiza o erro quadrático dado por: <br /><span class="math">$$\label{defEm}
E:=\sum_{i=1}^n \left[z_i- b_i\right]^2$$</span><br /> onde <span class="math"><em>z</em> = <em>A</em><em>x</em></span> e <span class="math"><em>z</em><sub><em>i</em></sub></span> é linha <span class="math"><em>i</em></span> do vetor <span class="math"><em>z</em></span>, dado por: <br /><span class="math">$$\label{Axi}
z_i=(Ax)_i=\sum_{j=1}^m a_{ij} x_j,\quad i=1,\cdots,n$$</span><br /> onde <span class="math"><em>a</em><sub><em>i</em><em>j</em></sub></span> é o elemento de <span class="math"><em>A</em></span> na linha <span class="math"><em>i</em></span> e coluna <span class="math"><em>j</em></span>. Substituindo ([Axi]) em ([defEm]) <br /><span class="math">$$\label{erro}
E:=\sum_{i=1}^n \left[\sum_{j=1}^m a_{ij} x_j- b_i\right]^2$$</span><br /> Esta é uma função diferenciável nos coeficientes <span class="math"><em>x</em><sub><em>j</em></sub></span> e portanto todo ponto de mínimo acontece quando <span class="math">∇<em>E</em> = 0</span>, ou seja, quando <br /><span class="math">$$\frac{\partial}{\partial x_l}E=0,\forall 1\leq l \leq m$$</span><br /> O que implica a seguinte condição <br /><span class="math">$$\begin{aligned}
0=\frac{\partial}{\partial x_l}E=\sum_{i=1}^n 2\left[\sum_{j=1}^m a_{ij} x_j- b_i\right] a_{il}, ~~~l=1,\cdots, m\end{aligned}$$</span><br /> Equivalente a <br /><span class="math">$$\begin{aligned}
\sum_{i=1}^n\sum_{j=1}^m  a_{il}x_j a_{ij}=\sum_{i=1}^na_{il}b_i,~~~l=1,\cdots, m\end{aligned}$$</span><br /> que pode ser reescrito na forma vetorial como: <br /><span class="math">$$\begin{aligned}
\label{cond_vet}
\left[
\begin{array}{c}
\sum_{i=1}^n\sum_{j=1}^m   a_{i1}x_ja_{ij}\\
\sum_{i=1}^n\sum_{j=1}^m   a_{i2}x_ja_{ij}\\
\vdots\\
\sum_{i=1}^n\sum_{j=1}^m   a_{im}x_ja_{ij}\\
\end{array}
\right]
=
\left[
\begin{array}{c}
\sum_{i=1}^na_{i1}b_i\\
\sum_{i=1}^na_{i2}b_i\\
\vdots\\
\sum_{i=1}^na_{im}b_i
\end{array}
\right]\end{aligned}$$</span><br /> Observamos agora que a expressão ([cond<sub>v</sub>et]) é equivalente ao seguinte problema matricial:</p>
<p><br /><span class="math">$$\framebox[100 pt][c]{$A^TA x = A^Tb$}$$</span><br /></p>
<p>A matriz <span class="math"><em>M</em> = <em>A</em><sup><em>T</em></sup><em>A</em></span> é quadrada de ordem <span class="math"><em>m</em></span> e é invertível sempre que o posto da matriz <span class="math"><em>A</em></span> é igual a número de colunas <span class="math"><em>m</em></span>.</p>
<p>Para provar que <span class="math"><em>M</em></span> é invertível precisamos mostrar que <span class="math"><em>M</em><em>v</em> = 0</span> implica <span class="math"><em>v</em> = 0</span>: <br /><span class="math"><em>M</em><em>v</em> = 0 ⇒ <em>A</em><sup><em>T</em></sup><em>A</em><em>v</em> = 0</span><br /> tomando o produto interno da expressão <span class="math">0 = <em>A</em><sup><em>T</em></sup><em>A</em><em>v</em></span> com <span class="math"><em>v</em></span>, temos: <br /><span class="math">$$0=\left&lt;A^TAv,v\right&gt;=\left&lt;Av,Av\right&gt;=\|Av\|^2$$</span><br /> Então se <span class="math"><em>M</em><em>v</em> = 0</span> <span class="math"><em>A</em><em>v</em> = 0</span>, como o posto de <span class="math"><em>A</em></span> é igual ao número de colunas, <span class="math"><em>v</em> = 0</span>.</p>
<p>Outra propriedade importante é que <span class="math"><em>M</em></span> é simétrica, ou seja, <span class="math"><em>M</em> = <em>M</em><sup><em>T</em></sup></span>. Isso é facilmente provado pelo seguinte argumento: <br /><span class="math"><em>M</em><sup><em>T</em></sup> = (<em>A</em><sup><em>T</em></sup><em>A</em>)<sup><em>T</em></sup> = (<em>A</em>)<sup><em>T</em></sup>(<em>A</em><sup><em>T</em></sup>)<sup><em>T</em></sup> = <em>A</em><sup><em>T</em></sup><em>A</em> = <em>M</em></span><br /></p>
<h3 id="ajuste-linear-de-curvas">Ajuste linear de curvas</h3>
<p>Seja <span class="math"><em>f</em><sub>1</sub>(<em>x</em>), <em>f</em><sub>2</sub>(<em>x</em>), …, <em>f</em><sub><em>m</em></sub>(<em>x</em>)</span> um conjunto de <span class="math"><em>m</em></span> funções e <span class="math">(<em>x</em><sub>1</sub>, <em>y</em><sub>1</sub>), (<em>x</em><sub>2</sub>, <em>y</em><sub>2</sub>), …, (<em>x</em><sub><em>n</em></sub>, <em>y</em><sub><em>n</em></sub>)</span> um conjunto de <span class="math"><em>n</em></span> pontos. Procuram-se os coeficientes <span class="math"><em>a</em><sub>1</sub>, <em>a</em><sub>2</sub>, …, <em>a</em><sub><em>m</em></sub></span> tais que a função dada por <br /><span class="math"><em>f</em>(<em>x</em>) = <em>a</em><sub>1</sub><em>f</em><sub>1</sub>(<em>x</em>) + <em>a</em><sub>2</sub><em>f</em><sub>2</sub>(<em>x</em>) + … + <em>a</em><sub><em>m</em></sub><em>f</em><sub><em>m</em></sub>(<em>x</em>)</span><br /> minimiza o erro dado por <br /><span class="math">$$E_q= \sum_{i=1}^n \left[f(x_i)-y_i\right]^2$$</span><br /> como <span class="math">$f(x)=\sum_{j=1}^m a_jf_j(x)$</span>, temos <br /><span class="math">$$E_q= \sum_{i=1}^n \left[\sum_{j=1}^m a_jf_j(x_i)-y_i\right]^2$$</span><br /></p>
<p>Este problema é equivalente a resolver pelo métodos dos mínimos quadrados o seguinte sistema linear: <br /><span class="math">$$\left[
\begin{array}{cccc}
f_1(x_1)&amp;f_2(x_1) &amp; \cdots &amp; f_m(x_1)\\
f_1(x_2)&amp;f_2(x_2) &amp; \cdots &amp; f_m(x_2)\\
f_1(x_3)&amp;f_2(x_3) &amp; \cdots &amp; f_m(x_3)\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
f_1(x_n)&amp;f_2(x_n) &amp; \cdots &amp; f_m(x_n)
\end{array}
\right]
\left[
\begin{array}{c}
a_1\\
a_2\\
\vdots\\
a_m
\end{array}
\right]=\left[\begin{array}{c}
y_1\\
y_2\\
y_3\\
\vdots\\
y_n
\end{array}
\right]$$</span><br /></p>
<p>Encontre a reta que melhor aproxima o seguinte conjunto de dados:</p>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math"><em>x</em><sub><em>i</em></sub></span></th>
<th align="center"><span class="math"><em>y</em><sub><em>i</em></sub></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math">0, 01</span></td>
<td align="center"><span class="math">1, 99</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">1, 02</span></td>
<td align="center"><span class="math">4, 55</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">2, 04</span></td>
<td align="center"><span class="math">7, 20</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">2, 95</span></td>
<td align="center"><span class="math">9, 51</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">3, 55</span></td>
<td align="center"><span class="math">10, 82</span></td>
</tr>
</tbody>
</table>
<p>Desejamos então encontrar os valores de <span class="math"><em>a</em></span> e <span class="math"><em>b</em></span> tais que a função <span class="math"><em>f</em>(<em>x</em>) = <em>a</em><em>x</em> + <em>b</em></span> melhor se ajusta aos pontos da tabela. Afim de usar o critério dos mínimos quadrados, escrevemos o problema na forma matricial dada por: <br /><span class="math">$$\left[\begin{array}{cc}
0,01 &amp;1\\
1,02 &amp;1\\
2,04 &amp;1\\
2,95 &amp;1\\
3,55 &amp;1
\end{array}
\right]
\left[\begin{array}{c}
a\\
b
\end{array}
\right]
=
\left[\begin{array}{c}
1,99\\
4,55\\
7,2\\
9,51\\
10,82
\end{array}
\right]$$</span><br /></p>
<p>Multiplicamos agora ambos os lados pela transposta: <br /><span class="math">$$\left[\begin{array}{ccccc}
0,01 &amp;1,02 &amp;2,04 &amp;2,95 &amp;3,55\\
1 &amp;1 &amp;1 &amp;1 &amp;1
\end{array}
\right]$$</span><br /> o que fornece: <br /><span class="math">$$\begin{aligned}
&amp;\left[\begin{array}{ccccc}
0,01 &amp;1,02 &amp;2,04 &amp;2,95 &amp;3,55\\
1 &amp;1 &amp;1 &amp;1 &amp;1
\end{array}
\right]
\left[\begin{array}{cc}
0,01 &amp;1\\
1,02 &amp;1\\
2,04 &amp;1\\
2,95 &amp;1\\
3,55 &amp;1
\end{array}
\right]
\left[\begin{array}{c}
a\\
b
\end{array}
\right]
=\\
&amp;\left[\begin{array}{ccccc}
0,01 &amp;1,02 &amp;2,04 &amp;2,95 &amp;3,55\\
1 &amp;1 &amp;1 &amp;1 &amp;1
\end{array}
\right]
\left[\begin{array}{c}
1,99\\
4,55\\
7,2\\
9,51\\
10,82
\end{array}
\right]  \end{aligned}$$</span><br /> <br /><span class="math">$$\left[
\begin{array}{cc}
26,5071  &amp; 9,57 \\
  9,57  &amp;     5
\end{array}
\right]
\left[
\begin{array}{c}
a   \\
b
\end{array}
\right]=
\left[
\begin{array}{c}
85,8144  \\
34,07
\end{array}
\right]$$</span><br /></p>
<p>A solução desse sistema é <span class="math"><em>a</em> = 2, 5157653</span> e <span class="math"><em>b</em> = 1, 9988251</span></p>
<p>A tabela abaixo mostra os valores dados e os valores ajustados:</p>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math"><em>x</em><sub><em>i</em></sub></span></th>
<th align="center"><span class="math"><em>y</em><sub><em>i</em></sub></span></th>
<th align="center"><span class="math"><em>a</em><em>x</em><sub><em>i</em></sub> + <em>b</em></span></th>
<th align="center"><span class="math"><em>a</em><em>x</em><sub><em>i</em></sub> + <em>b</em> − <em>y</em><sub><em>i</em></sub></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math">0, 01</span></td>
<td align="center"><span class="math">1, 99</span></td>
<td align="center"><span class="math">2, 0239828</span></td>
<td align="center"><span class="math">0, 0339828</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">1, 02</span></td>
<td align="center"><span class="math">4, 55</span></td>
<td align="center"><span class="math">4, 5649057</span></td>
<td align="center"><span class="math">0, 0149057</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">2, 04</span></td>
<td align="center"><span class="math">7, 2</span></td>
<td align="center"><span class="math">7, 1309863</span></td>
<td align="center"><span class="math"> − 0, 0690137</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">2, 95</span></td>
<td align="center"><span class="math">9, 51</span></td>
<td align="center"><span class="math">9, 4203327</span></td>
<td align="center"><span class="math"> − 0, 0896673</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">3, 55</span></td>
<td align="center"><span class="math">10, 82</span></td>
<td align="center"><span class="math">10, 929792</span></td>
<td align="center"><span class="math">0, 1097919</span></td>
</tr>
</tbody>
</table>
<h2 id="exercícios-17" class="unnumbered">Exercícios</h2>
<p>Encontrar a parábola <span class="math"><em>y</em> = <em>a</em><em>x</em><sup>2</sup> + <em>b</em><em>x</em> + <em>c</em></span> que melhor aproxima o seguinte conjunto de dados:</p>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math"><em>x</em><sub><em>i</em></sub></span></th>
<th align="center"><span class="math"><em>y</em><sub><em>i</em></sub></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math">0, 01</span></td>
<td align="center"><span class="math">1, 99</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">1, 02</span></td>
<td align="center"><span class="math">4, 55</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">2, 04</span></td>
<td align="center"><span class="math">7, 2</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">2, 95</span></td>
<td align="center"><span class="math">9, 51</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">3, 55</span></td>
<td align="center"><span class="math">10, 82</span></td>
</tr>
</tbody>
</table>
<p>e complete a tabela:</p>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math"><em>x</em><sub><em>i</em></sub></span></th>
<th align="center"><span class="math"><em>y</em><sub><em>i</em></sub></span></th>
<th align="center"><span class="math"><em>a</em><em>x</em><sub><em>i</em></sub><sup>2</sup> + <em>b</em><em>x</em><sub><em>i</em></sub> + <em>c</em></span></th>
<th align="center"><span class="math"><em>a</em><em>x</em><sub><em>i</em></sub><sup>2</sup> + <em>b</em><em>x</em><sub><em>i</em></sub> + <em>c</em> − <em>y</em><sub><em>i</em></sub></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math">0, 01</span></td>
<td align="center"><span class="math">1, 99</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math">1, 02</span></td>
<td align="center"><span class="math">4, 55</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">2, 04</span></td>
<td align="center"><span class="math">7, 20</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math">2, 95</span></td>
<td align="center"><span class="math">9, 51</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">3, 55</span></td>
<td align="center"><span class="math">10, 82</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p><span class="math"><em>y</em> =  − 0, 0407898<em>x</em><sup>2</sup> + 2, 6613293<em>x</em> + 1, 9364598</span> <br /><span class="math">$$\begin{tabular}{|c|c|c|c|}
\hline
$x_i$ &amp; $y_i$&amp; $ax_i^2+bx_i+c$&amp; $ax_i^2+bx_i+c-y_i$\\
\hline
0,01 &amp; 1,99&amp;1,963069&amp;-0,0269310  \\
1,02 &amp; 4,55&amp;4,6085779&amp;    0,0585779  \\
2,04 &amp; 7,2&amp;7,1958206  &amp;  -0,0041794  \\
2,95 &amp; 9,51&amp; 9,4324077   &amp;-0,0775923   \\
3,55 &amp; 10,82&amp; 10,870125   &amp;0,0501249\\
\hline
\end{tabular}$$</span><br /></p>
<p>Dado o seguinte conjunto de dados <br /><span class="math">$$\begin{tabular}{|c|c|}
      \hline
      $x_i$ &amp; $y_i$\\
      \hline
      0,0 &amp;  31\\
      0,1 &amp;  35\\
      0,2 &amp;  37\\
      0,3 &amp;  33\\
      0,4 &amp;  28\\
      0,5 &amp;  20\\
      0,6 &amp;  16\\
      0,7 &amp;  15\\
      0,8 &amp;  18\\
      0,9 &amp;  23\\
      1,0 &amp;  31\\
      \hline
    \end{tabular}$$</span><br /></p>
<ul>
<li><p>Encontre a função do tipo <span class="math"><em>f</em>(<em>x</em>) = <em>a</em> + <em>b</em>sin(2<em>π</em><em>x</em>) + <em>c</em>cos(2<em>π</em><em>x</em>)</span> que melhor aproxima os valores dados.</p></li>
<li><p>Encontre a função do tipo <span class="math"><em>f</em>(<em>x</em>) = <em>a</em> + <em>b</em><em>x</em> + <em>c</em><em>x</em><sup>2</sup> + <em>d</em><em>x</em><sup>3</sup></span> que melhor aproxima os valores dados.</p></li>
</ul>
<p><span class="math"><em>a</em> = 25, 638625</span>, <span class="math"><em>b</em> = 9, 8591874</span>, <span class="math"><em>c</em> = 4, 9751219</span> e <span class="math"><em>a</em> = 31, 475524</span>, <span class="math"><em>b</em> = 65, 691531</span>, <span class="math"><em>c</em> =  − 272, 84382</span>, <span class="math"><em>d</em> = 208, 23621</span>.</p>
<h2 id="aproximando-problemas-não-lineares-por-problemas-lineares">Aproximando problemas não lineares por problemas lineares</h2>
<p>Eventualmente, problemas de ajuste de curvas podem recair num sistema não linear. Por exemplo, se desejamos ajustar a função <span class="math"><em>y</em> = <em>A</em><em>e</em><sup><em>b</em><em>x</em></sup></span> ao conjunto de pontos <span class="math">(<em>x</em><sub>0</sub>, <em>y</em><sub>0</sub>)</span>, <span class="math">(<em>x</em><sub>1</sub>, <em>y</em><sub>1</sub>)</span> e <span class="math">(<em>x</em><sub>2</sub>, <em>y</em><sub>2</sub>)</span>, temos que minimizar o funcional <br /><span class="math"><em>E</em><sub><em>q</em></sub> = (<em>A</em><em>e</em><sup><em>x</em><sub>0</sub><em>b</em></sup> − <em>y</em><sub>0</sub>)<sup>2</sup> + (<em>A</em><em>e</em><sup><em>x</em><sub>1</sub><em>b</em></sup> − <em>y</em><sub>1</sub>)<sup>2</sup> + (<em>A</em><em>e</em><sup><em>x</em><sub>2</sub><em>b</em></sup> − <em>y</em><sub>2</sub>)<sup>2</sup></span><br /> ou seja, resolver o sistema <br /><span class="math">$$\begin{aligned}
\frac{\partial E_q}{\partial A} &amp;= 2(Ae^{x_0b}-y_0)e^{x_0b}+2(Ae^{x_1b}-y_1)e^{x_1b}+2(Ae^{x_2b}-y_2)e^{x_2b}=0\\
\frac{\partial E_q}{\partial b} &amp;= 2Ax_0(Ae^{x_0b}-y_0)e^{x_0b} + 2Ax_1(Ae^{x_1b}-y_1)e^{x_1b} \\
&amp;+ 2x_2A(Ae^{x_2b}-y_2)e^{x_2b}=0\end{aligned}$$</span><br /> que é não linear em <span class="math"><em>A</em></span> e <span class="math"><em>b</em></span>. Esse sistema pode ser resolvido pelo método de Newton-Raphson, o que pode se tornar custoso, ou mesmo inviável quando não dispomos de uma boa aproximação da solução para inicializar o método.</p>
<p>Felizmente, algumas famílias de curvas admitem uma transformação que nos leva a um problema linear. No caso da curva <span class="math"><em>y</em> = <em>A</em><em>e</em><sup><em>b</em><em>x</em></sup></span>, observe que <span class="math">ln<em>y</em> = ln<em>A</em> + <em>b</em><em>x</em></span>. Assim, em vez de ajustar a curva original <span class="math"><em>y</em> = <em>A</em><em>e</em><sup><em>b</em><em>x</em></sup></span> a tabela de pontos, ajustamos a curva submetida a transformação logarítmica <br /><span class="math"><em>z</em> = ln<em>A</em> + <em>b</em><em>x</em> := <em>B</em> + <em>b</em><em>x</em>.</span><br /> Usamos os três pontos <span class="math">$(x_0,\ln y_0):=(x_0, \tilde{y}_0)$</span>, <span class="math">$(x_1,\ln y_1):=(x_1,\tilde{y}_1)$</span> e <span class="math">$(x_2,\ln y_2):=(x_2,\tilde{y}_2)$</span> e resolvemos o sistema linear <br /><span class="math">$$A^T A \left[\begin{array}{c} B\\b \end{array}\right]=A^T\left[\begin{array}{c}\tilde{y}_0\\\tilde{y}_1\\\tilde{y}_2 \end{array}\right],$$</span><br /> onde <br /><span class="math">$$A=\left[\begin{array}{cc} 1&amp;x_0\\1&amp;x_1\\1&amp;x_2 \end{array}\right]$$</span><br /></p>
<p>Encontre uma curva da forma <span class="math"><em>y</em> = <em>A</em><em>e</em><sup><em>x</em></sup></span> que melhor ajusta os pontos <span class="math">(1, 2)</span>, <span class="math">(2, 3)</span> e <span class="math">(3, 5)</span>.</p>
<p>Temos <br /><span class="math">$$A=\left[\begin{array}{cc} 1&amp;1\\1&amp;2\\1&amp;3 \end{array}\right]$$</span><br /> e a solução do sistema leva em <span class="math"><em>B</em> = 0, 217442</span> e <span class="math"><em>b</em> = 0, 458145</span>. Portanto, <span class="math"><em>A</em> = <em>e</em><sup>0, 217442</sup> = 1, 24289</span>.</p>
<p>Os coeficientes obtidos a partir dessa linearização são aproximados, ou seja, são diferentes daqueles obtidos quando aplicamos mínimos quadrados não linear. Observe que estamos minimizando <span class="math">∑<sub><em>i</em></sub>[ln<em>y</em><sub><em>i</em></sub> − ln(<em>f</em>(<em>x</em><sub><em>i</em></sub>))]<sup>2</sup></span> em vez de <span class="math">∑<sub><em>i</em></sub>[<em>y</em><sub><em>i</em></sub> − <em>f</em>(<em>x</em><sub><em>i</em></sub>)]<sup>2</sup></span>. No exemplo resolvido, a solução do sistema não linear original seria <span class="math"><em>A</em> = 1, 19789</span> e <span class="math"><em>B</em> = 0, 474348</span></p>
<p>Mesmo quando se deseja resolver o sistema não linear, a solução do problema linearizado pode ser usada para construir condições iniciais.</p>
<p>A próxima tabela apresenta algumas curvas e transformações que linearizam o problema de ajuste. <br /><span class="math">$$\begin{array}{|c|c|c|}
\hline
\hbox{curva}&amp;\hbox{transformação}&amp;\hbox{problema linearizado}\\
\hline
y=ae^{bx}&amp;Y=\ln y&amp;Y=\ln a+ bx\\
\hline
y=ax^b&amp;Y=\ln y&amp;Y=\ln a+ b\ln x\\
\hline
y=ax^be^{cx}&amp;Y=\ln y&amp;Y=\ln a+ b\ln x+cx\\
\hline
y=ae^{(b+cx)^2}&amp;Y=\ln y&amp;Y=\ln a+b^2+ bc x+c^2x^2\\
\hline
y=\frac{a}{b+x}&amp;Y=\frac{1}{y}&amp;Y=\frac{b}{a}+\frac{1}{a}x\\
\hline
\begin{array}{c}y=A\cos(\omega x+\phi)\\ \omega\ \hbox{conhecido}\end{array}&amp;-&amp;\begin{array}{c}y=a\cos(\omega x)-b\sin(\omega x),\\a=A\cos(\phi),\ b=A\sin(\phi)\end{array}\\
\hline
\end{array}$$</span><br /></p>
<p>Encontre a função <span class="math"><em>f</em></span> da forma <span class="math"><em>y</em> = <em>f</em>(<em>x</em>) = <em>A</em>cos(2<em>π</em><em>x</em> + <em>ϕ</em>)</span> que ajusta a tabela de pontos <span class="math"></span></p>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math"><em>x</em><sub><em>i</em></sub></span></th>
<th align="center"><span class="math"><em>y</em><sub><em>i</em></sub></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0,0</td>
<td align="center">9,12</td>
</tr>
<tr class="even">
<td align="center">0,1</td>
<td align="center">1,42</td>
</tr>
<tr class="odd">
<td align="center">0,2</td>
<td align="center">- 7,76</td>
</tr>
<tr class="even">
<td align="center">0,3</td>
<td align="center">- 11,13</td>
</tr>
<tr class="odd">
<td align="center">0,4</td>
<td align="center">- 11,6</td>
</tr>
<tr class="even">
<td align="center">0,5</td>
<td align="center">- 6,44</td>
</tr>
<tr class="odd">
<td align="center">0,6</td>
<td align="center">1,41</td>
</tr>
<tr class="even">
<td align="center">0,7</td>
<td align="center">11,01</td>
</tr>
<tr class="odd">
<td align="center">0,8</td>
<td align="center">14,73</td>
</tr>
<tr class="even">
<td align="center">0,9</td>
<td align="center">13,22</td>
</tr>
<tr class="odd">
<td align="center">1,0</td>
<td align="center">9,93</td>
</tr>
</tbody>
</table>
<p><span class="math"></span></p>
<p>Usando o fato que <span class="math"><em>y</em> = <em>A</em>cos(2<em>π</em><em>x</em> + <em>ϕ</em>) = <em>a</em>cos(2<em>π</em><em>x</em>) − <em>b</em>sin(2<em>π</em><em>x</em>)</span>, onde <span class="math"><em>a</em> = <em>A</em>cos(<em>ϕ</em>)</span> e <span class="math"><em>b</em> = <em>A</em>sin(<em>ϕ</em>)</span>, <span class="math">$z=[\begin{array}{cc}a &amp;b\end{array}]^T$</span> é solução do problema <br /><span class="math"><em>B</em><sup><em>T</em></sup><em>B</em><em>z</em> = <em>B</em><sup><em>T</em></sup><em>y</em>, </span><br /> onde <br /><span class="math">$$B\!=\!\left[\begin{array}{cc}\cos(2 \pi x_0)&amp; -\sin(2 \pi x_0)\\ \cos(2 \pi x_1)&amp; -\sin(2 \pi x_1)\\ \vdots\\ \cos(2 \pi x_{10})&amp; -\sin(2\pi x_{10}) \end{array}\right]\!=\!\left[\begin{array}{cc}  1.     &amp;      0.\\
    0,8090170 &amp; - 0,5877853\\
    0,3090170 &amp; - 0,9510565\\
  - 0,3090170 &amp; - 0,9510565\\
  - 0,8090170 &amp; - 0,5877853\\
  - 1,0000000 &amp;   0,0000000\\
  - 0,8090170 &amp;   0,5877853\\
  - 0,3090170 &amp;   0,9510565\\
    0,3090170 &amp;   0,9510565\\
    0,8090170 &amp;   0,5877853\\
    1,0000000 &amp;   0,0000000   \end{array}\right].$$</span><br /> Assim, <span class="math"><em>a</em> = 7, 9614704</span> e <span class="math"><em>b</em> = 11, 405721</span> e obtemos o seguinte sistema: <br /><span class="math">$$\left\{\begin{array}{c}
A\cos(\phi)=7,9614704\\ A\sin(\phi)=11,405721
\end{array}\right..$$</span><br /> Observe que <br /><span class="math"><em>A</em><sup>2</sup> = 7, 9614704<sup>2</sup> + 11, 405721<sup>2</sup></span><br /> e, escolhendo <span class="math"><em>A</em> &gt; 0</span>, <span class="math"><em>A</em> = 13, 909546</span> e <br /><span class="math">$$\sin(\phi)=\frac{11,405721}{13,909546}=0,8199923$$</span><br /> Assim, como <span class="math">cos<em>ϕ</em></span> também é positivo, <span class="math"><em>ϕ</em></span> é um ângulo do primeiro quadrante: <br /><span class="math"><em>ϕ</em> = 0, 9613976</span><br /> Portanto <span class="math"><em>f</em>(<em>x</em>) = 13, 909546cos(2<em>π</em><em>x</em> + 0, 9613976)</span>. Observe que nesse exemplo a solução do problema linear é a mesma do problema não linear.</p>
<p>Encontre a função <span class="math"><em>f</em></span> da forma <span class="math">$y=f(x)=\frac{a}{b+x}$</span> que ajusta a tabela de pontos <span class="math"></span></p>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math"><em>x</em><sub><em>i</em></sub></span></th>
<th align="center"><span class="math"><em>y</em><sub><em>i</em></sub></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0,0</td>
<td align="center">101</td>
</tr>
<tr class="even">
<td align="center">0,2</td>
<td align="center">85</td>
</tr>
<tr class="odd">
<td align="center">0,4</td>
<td align="center">75</td>
</tr>
<tr class="even">
<td align="center">0,6</td>
<td align="center">66</td>
</tr>
<tr class="odd">
<td align="center">0,8</td>
<td align="center">60</td>
</tr>
<tr class="even">
<td align="center">1,0</td>
<td align="center">55</td>
</tr>
</tbody>
</table>
<p><span class="math"></span> usando uma das transformações tabeladas.</p>
<p>Usando o fato que <span class="math">$Y=\frac{1}{y}=\frac{b}{a}+\frac{1}{a}x$</span>, <span class="math">$z=[\begin{array}{cc}\frac{b}{a} &amp;\frac{1}{a}\end{array}]^T$</span> é solução do problema <br /><span class="math"><em>A</em><sup><em>T</em></sup><em>A</em><em>z</em> = <em>A</em><sup><em>T</em></sup><em>Y</em>, </span><br /> onde <br /><span class="math">$$A=\left[\begin{array}{cc}1&amp; x_1\\ 1&amp; x_2\\ 1&amp;x_3\\1&amp;x_4 \\ 1&amp;x_5 \\ 1&amp;x_6 \end{array}\right]=\left[\begin{array}{cc}
  1 &amp;  0,0\\
  1 &amp;  0,2\\
  1 &amp;  0,4\\
  1 &amp;  0,6\\
  1 &amp;  0,8\\
  1 &amp;  1,0
\end{array}\right]$$</span><br /> e <br /><span class="math">$$Y=\left[\begin{array}{c}
  1/y_1\\
    1/y_2\\
    1/y_3\\
    1/y_4\\
    1/y_5\\
    1/y_6
\end{array}\right]=\left[\begin{array}{c}
  0,0099010\\
  0,0117647\\
  0,0133333\\
  0,0151515\\
  0,0166667\\
  0,0181818
\end{array}\right]$$</span><br /> Assim, <span class="math">$\frac{1}{a}=0,0082755$</span> e <span class="math">$\frac{b}{a}=0,0100288$</span> e, então, <span class="math"><em>a</em> = 120, 83924</span> e <span class="math"><em>b</em> = 1, 2118696</span>, ou seja, <span class="math">$f(x)=\frac{120,83924}{1,2118696+x}$</span>.</p>
<h2 id="interpolação-linear-segmentada">Interpolação linear segmentada</h2>
<p>Considere o conjunto <span class="math">(<em>x</em><sub><em>i</em></sub>, <em>y</em><sub><em>i</em></sub>)<sub><em>j</em> = 1</sub><sup><em>n</em></sup></span> de <span class="math"><em>n</em></span> pontos. Assumiremos que <span class="math"><em>x</em><sub><em>i</em> + 1</sub> &gt; <em>x</em><sub><em>i</em></sub></span>, ou seja, as abscissas são distintas e estão em ordem crescente. A função linear que interpola os pontos <span class="math"><em>x</em><sub><em>i</em></sub></span> e <span class="math"><em>x</em><sub><em>i</em> + 1</sub></span> no intervalo <span class="math"><em>i</em></span> é dada por <br /><span class="math">$$P_i(x)=y_i \frac{(x_{i+1}-x)}{(x_{i+1}-x_i)} + y_{i+1} \frac{(x-x_i)}{(x_{i+1}-x_i)}$$</span><br /></p>
<p>O resultado da interpolação linear segmentada é a seguinte função contínua definida por partes no intervalo <span class="math">[<em>x</em><sub>1</sub>, <em>x</em><sub><em>n</em></sub>]</span>: <br /><span class="math"><em>f</em>(<em>x</em>) = <em>P</em><sub><em>i</em></sub>(<em>x</em>),     <em>x</em> ∈ [<em>x</em><sub><em>i</em></sub>, <em>x</em><sub><em>i</em> + 1</sub>]</span><br /></p>
<p>Construa uma função linear por partes que interpola os pontos <span class="math">(0, 0)</span>, <span class="math">(1, 4)</span>, <span class="math">(2, 3)</span>, <span class="math">(3, 0)</span>, <span class="math">(4, 2)</span>, <span class="math">(5, 0)</span>.</p>
<p>A função procurada pode ser construída da seguinte forma: <br /><span class="math">$$f(x) = \left\{
    \begin{array}{ll}
      0\frac{x-1}{0-1} + 1\frac{x-0}{1-0} &amp;, 0 \leq x &lt; 1\\
      4\frac{x-2}{1-2} + 3\frac{x-1}{2-1} &amp;, 1\leq x &lt; 2\\
      3\frac{x-3}{2-3} + 0\frac{x-2}{3-2} &amp;, 2\leq x \leq 3
    \end{array}
\right.$$</span><br /> Simplificando, obtemos: <br /><span class="math">$$f(x) = \left\{
    \begin{array}{ll}
      x &amp;, 0 \leq x &lt; 1\\
      -x + 5 &amp;, 1\leq x &lt; 2\\
      -3x + 9 &amp;, 2\leq x \leq 3
    \end{array}
\right.$$</span><br /></p>
<p>A Figura [fig:linear<sub>s</sub>egmentada] é um esboço da função <span class="math"><em>f</em>(<em>x</em>)</span> obtida. Ela foi gerada no <code>Scilab</code> usando os comandos:</p>
<div class="figure">
<embed src="./cap_aproxfun/pics/interpolacao_linear_segmentada.eps" />
<p class="caption">Interpolação linear segmentada.<span data-label="fig:linearsegmentada"></span></p>
</div>
<h2 id="interpolação-cúbica-segmentada---spline">Interpolação cúbica segmentada - spline</h2>
<p>Dado um conjunto de <span class="math"><em>n</em></span> pontos <span class="math">(<em>x</em><sub><em>j</em></sub>, <em>y</em><sub><em>j</em></sub>)<sub><em>j</em> = 1</sub><sup><em>n</em></sup></span> tais que <span class="math"><em>x</em><sub><em>j</em> + 1</sub> &gt; <em>x</em><sub><em>j</em></sub></span>, ou seja, as abscissas são distintas e estão em ordem crescente; um spline cúbico que interpola estes pontos é uma função <span class="math"><em>s</em>(<em>x</em>)</span> com as seguintes propriedades:</p>
<ul>
<li><p>Em cada segmento <span class="math">[<em>x</em><sub><em>j</em></sub>, <em>x</em><sub><em>j</em> + 1</sub>]</span>, <span class="math"><em>j</em> = 1, 2, …<em>n</em> − 1</span> <span class="math"><em>s</em>(<em>x</em>)</span> é um polinômio cúbico.</p></li>
<li><p>para cada ponto, <span class="math"><em>s</em>(<em>x</em><sub><em>j</em></sub>) = <em>y</em><sub><em>j</em></sub></span>, i.e., o spline interpola os pontos dados.</p></li>
<li><p><span class="math"><em>s</em>(<em>x</em>) ∈ <em>C</em><sup>2</sup></span>, i.e., é função duas vezes continuamente diferenciável.</p></li>
</ul>
<p>Da primeira hipótese, escrevemos <br /><span class="math"><em>s</em>(<em>x</em>) = <em>s</em><sub><em>j</em></sub>(<em>x</em>), <em>x</em> ∈ [<em>x</em><sub><em>j</em></sub>, <em>x</em><sub><em>j</em> + 1</sub>],   <em>j</em> = 1, …, <em>n</em> − 1</span><br /> com <br /><span class="math"><em>s</em><sub><em>j</em></sub>(<em>x</em>) = <em>a</em><sub><em>j</em></sub> + <em>b</em><sub><em>j</em></sub>(<em>x</em> − <em>x</em><sub><em>j</em></sub>) + <em>c</em><sub><em>j</em></sub>(<em>x</em> − <em>x</em><sub><em>j</em></sub>)<sup>2</sup> + <em>d</em><sub><em>j</em></sub>(<em>x</em> − <em>x</em><sub><em>j</em></sub>)<sup>3</sup></span><br /> O problema agora consiste em obter os 4 coeficientes de cada um desses <span class="math"><em>n</em> − 1</span> polinômios cúbicos.</p>
<p>Veremos que a simples definição de spline produz <span class="math">4<em>n</em> − 6</span> equações linearmente independentes: <br /><span class="math">$$\begin{array}{rcll}
s_j(x_j)&amp;=&amp;y_j,~~ &amp;j=1,\ldots, n-1\\
s_{j}(x_{j+1})&amp;=&amp;y_{j+1},~~ &amp;j=1,\ldots, n-1\\
s_{j}'(x_{j+1})&amp;=&amp;s_{j+1}'(x_{j+1}),~~ &amp;j=1,\ldots, n-2\\
s_{j}''(x_{j+1})&amp;=&amp;s_{j+1}''(x_{j+1}),~~ &amp;j=1,\ldots, n-2
\end{array}$$</span><br /> Como <br /><span class="math">$${\label{eq_1derivada}}
s'_j(x)=b_j+2c_j(x-x_j)+3d_j(x-x_j)^2$$</span><br /> e <br /><span class="math">$${\label{eq_2derivada}}
s''_j(x)=2c_j+6d_j(x-x_j),$$</span><br /> temos, para <span class="math"><em>j</em> = 1, …, <em>n</em> − 1</span>, as seguintes equações <br /><span class="math">$$\begin{array}{rcl}
a_j&amp;=&amp;y_j,\\
a_j+b_j(x_{j+1}-x_j)+c_j(x_{j+1}-x_j)^2+d_j(x_{j+1}-x_j)^3&amp;=&amp;y_{j+1},\\
b_j+2c_j(x_{j+1}-x_j)+3d_j(x_{j+1}-x_j)^2&amp;=&amp;b_{j+1},\\
c_j+3d_j(x_{j+1}-x_j)&amp;=&amp;c_{j+1},
\end{array}$$</span><br /> Por simplicidade, definimos <br /><span class="math"><em>h</em><sub><em>j</em></sub> = <em>x</em><sub><em>j</em> + 1</sub> − <em>x</em><sub><em>j</em></sub></span><br /> e temos <br /><span class="math">$$\begin{array}{rcl}
a_j&amp;=&amp;y_j,\\
a_j+b_jh_j+c_jh_j^2+d_jh_j^3&amp;=&amp;y_{j+1},\\
{\label{eq3}}b_j+2c_jh_j+3d_jh_j^2&amp;=&amp;b_{j+1},\\
\nonumber c_j+3d_jh_j&amp;=&amp;c_{j+1},
\end{array}$$</span><br /> que podem ser escrita da seguinte maneira <br /><span class="math">$${\label{eq_an_spline}}
a_j=y_j,$$</span><br /> <br /><span class="math">$${\label{eq_dn_spline}}
d_j=\frac{c_{j+1}-c_j}{3h_j},$$</span><br /> <br /><span class="math">$$\begin{aligned}
\nonumber b_j&amp;=&amp;\frac{y_{j+1}-y_j-c_jh_j^2-\frac{c_{j+1}-c_j}{3h_j}h_j^3}{h_j},\\
\nonumber &amp;=&amp;\frac{3y_{j+1}-3y_j-3c_jh_j^2-c_{j+1}h_j^2+c_jh_j^2}{3h_j}\\
{\label{eq_bn_spline}}&amp;=&amp;\frac{3y_{j+1}-3y_j-2c_jh_j^2-c_{j+1}h_j^2}{3h_j}\end{aligned}$$</span><br /> Trocando o índice <span class="math"><em>j</em></span> por <span class="math"><em>j</em> − 1</span> na terceira equação ([eq3]), <span class="math"><em>j</em> = 2, …, <em>n</em> − 1</span> <br /><span class="math"><em>b</em><sub><em>j</em> − 1</sub> + 2<em>c</em><sub><em>j</em> − 1</sub><em>h</em><sub><em>j</em> − 1</sub> + 3<em>d</em><sub><em>j</em> − 1</sub><em>h</em><sub><em>j</em> − 1</sub><sup>2</sup> = <em>b</em><sub><em>j</em></sub></span><br /> e, portanto, <br /><span class="math">$$\begin{split}
    \frac{3y_{j}-3y_{j-1}-2c_{j-1}h_{j-1}^2-c_{j}h_{j-1}^2}{3h_{j-1}} &amp;+ 2c_{j-1}h_{j-1}+c_{j}h_{j-1}-c_{j-1}h_{j-1} \\
    &amp;=\frac{3y_{j+1}-3y_j-2c_jh_j^2-c_{j+1}h_j^2}{3h_j}.      
  \end{split}$$</span><br /> Fazendo as simplificações, obtemos: <br /><span class="math">$${\label{eq_cn_spline}}
c_{j-1}h_{j-1}+c_j(2h_j+2h_{j-1})+c_{j+1}h_j=3\frac{y_{j+1}-y_j}{h_j}-3\frac{y_{j}-y_{j-1}}{h_{j-1}}.$$</span><br /> É costumeiro acrescentar a incógnita <span class="math"><em>c</em><sub><em>n</em></sub></span> ao sistema. A incógnita <span class="math"><em>c</em><sub><em>n</em></sub></span> não está relacionada a nenhum dos polinômios interpoladores. Ela é uma construção artificial que facilita o cálculo dos coeficientes do spline. Portanto, a equação acima pode ser resolvida para <span class="math"><em>j</em> = 2, …, <em>n</em> − 1</span>.</p>
<p>Para determinar unicamente os <span class="math"><em>n</em></span> coeficientes <span class="math"><em>c</em><sub><em>n</em></sub></span> precisamos acrescentar duas equações linearmente independentes às <span class="math"><em>n</em> − 2</span> equações dadas por ([eq<sub>c</sub>n<sub>s</sub>pline]). Essas duas equações adicionais definem o tipo de spline usado.</p>
<h3 id="spline-natural">Spline natural</h3>
<p>Uma forma de definir as duas equações adicionais para completar o sistema ([eq<sub>c</sub>n<sub>s</sub>pline]) é impor condições de fronteira livres (ou naturais), ou seja, <br /><span class="math"><em>S</em>″(<em>x</em><sub>1</sub>) = <em>S</em>″(<em>x</em><sub><em>n</em></sub>) = 0.</span><br /> Substituindo na equação ([eq<sub>2</sub>derivada]) <br /><span class="math"><em>s</em>″<sub>1</sub>(<em>x</em><sub>1</sub>) = 2<em>c</em><sub>1</sub> + 6<em>d</em><sub>1</sub>(<em>x</em><sub>1</sub> − <em>x</em><sub>1</sub>) = 0 ⇒ <em>c</em><sub>1</sub> = 0.</span><br /> e <br /><span class="math"><em>s</em>″<sub><em>n</em> − 1</sub>(<em>x</em><sub><em>n</em></sub>) = 2<em>c</em><sub><em>n</em> − 1</sub> + 6<em>d</em><sub><em>n</em> − 1</sub>(<em>x</em><sub><em>n</em></sub> − <em>x</em><sub><em>n</em> − 1</sub>) = 0.</span><br /> Usando o fato que <br /><span class="math"><em>c</em><sub><em>n</em> − 1</sub> + 3<em>d</em><sub><em>n</em> − 1</sub><em>h</em><sub><em>n</em> − 1</sub> = <em>c</em><sub><em>n</em></sub></span><br /> temos que <br /><span class="math"><em>c</em><sub><em>n</em></sub> =  − 3<em>d</em><sub><em>n</em> − 1</sub>(<em>x</em><sub><em>n</em></sub> − <em>x</em><sub><em>n</em> − 1</sub>) + 3<em>d</em><sub><em>n</em> − 1</sub><em>h</em><sub><em>n</em> − 1</sub> = 0.</span><br /> Essa duas equações para <span class="math"><em>c</em><sub>1</sub></span> e <span class="math"><em>c</em><sub><em>n</em></sub></span> juntamente com as equações ([eq<sub>c</sub>n<sub>s</sub>pline]) formam um sistema de <span class="math"><em>n</em></span> equações <span class="math"><em>A</em><em>c</em> = <em>z</em></span>, onde <br /><span class="math">$$A=\left[\begin{array}{ccccccc}
1 &amp;0&amp;0&amp;0 &amp;\cdots&amp;0&amp;0\\
h_1&amp;2h_2+2h_{1}&amp;h_2&amp;0&amp;\cdots&amp;0&amp;0\\
0&amp;h_2&amp;2h_3+2h_{2}&amp;h_3&amp;\cdots&amp;0&amp;0\\
\vdots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots\\
0&amp;0&amp;0&amp;\cdots&amp;h_{n-2} &amp; 2h_{n-2}+2h_{n-1}&amp;h_{n-1}\\
0&amp;0&amp;0&amp;\cdots &amp;0&amp;0&amp;1
\end{array}\right]$$</span><br /> <br /><span class="math">$$c = \left[\begin{array}{c}
c_1\\
c_2\\
\vdots\\
c_n
\end{array}\right]\qquad \hbox{e}\qquad
z = \left[\begin{array}{c}
0\\
3\frac{y_{3}-y_2}{h_2}-3\frac{y_{2}-y_{1}}{h_{1}}\\
3\frac{y_{4}-y_3}{h_3}-3\frac{y_{3}-y_{2}}{h_{2}}\\
\vdots\\
3\frac{y_{n-1}-y_{n-2}}{h_{n-2}}-3\frac{y_{n-2}-y_{n-3}}{h_{n-3}}\\
0
\end{array}\right]$$</span><br /> Observe que a matriz <span class="math"><em>A</em></span> é diagonal dominante estrita e, portanto, o sistema <span class="math"><em>A</em><em>c</em> = <em>z</em></span> possui solução única. Calculado <span class="math"><em>c</em></span>, os valores dos <span class="math"><em>a</em><sub><em>n</em></sub></span>, <span class="math"><em>b</em><sub><em>n</em></sub></span> e <span class="math"><em>d</em><sub><em>n</em></sub></span> são obtidos diretamente pelas expressões ([eq<sub>a</sub>n<sub>s</sub>pline]), ([eq<sub>b</sub>n<sub>s</sub>pline]) e ([eq<sub>d</sub>n<sub>s</sub>pline]), respectivamente.</p>
<p>Construa um spline cúbico natural que passe pelos pontos <span class="math">(2,  4, 5)</span>, <span class="math">(5,  − 1, 9)</span>, <span class="math">(9,  0, 5)</span> e <span class="math">(12,  − 0, 5)</span>.</p>
<p>O spline desejado é uma função definida por partes da forma: <br /><span class="math">$$f(x)=\left\{\begin{array}{ll}
a_1+b_1(x-2)+c_1(x-2)^2+d_1(x-2)^3 &amp;, 2\leq x &lt;5\\
a_2+b_2(x-5)+c_2(x-5)^2+d_2(x-5)^3 &amp;, 5\leq x &lt;9\\
a_3+b_3(x-9)+c_3(x-9)^2+d_3(x-9)^3 &amp;, 9\leq x \leq 12
\end{array}\right..$$</span><br /> Os coeficientes <span class="math"><em>c</em><sub>1</sub></span>, <span class="math"><em>c</em><sub>2</sub></span> e <span class="math"><em>c</em><sub>3</sub></span> resolvem o sistema <span class="math"><em>A</em><em>c</em> = <em>z</em></span>, onde <br /><span class="math">$$A=\left[\begin{array}{cccc}
1 &amp;0&amp;0&amp;0 \\
3&amp;2\cdot 3+2\cdot 4&amp;4&amp;0\\
0&amp;4&amp;2\cdot 4+2\cdot 3&amp;3\\
0&amp;0&amp;0&amp;1
\end{array}\right]=\left[\begin{array}{cccc}
1 &amp;0&amp;0&amp;0 \\
3&amp;14&amp;4&amp;0\\
0&amp;4&amp;14&amp;3\\
0&amp;0&amp;0&amp;1
\end{array}\right]$$</span><br /> <br /><span class="math">$$c = \left[\begin{array}{c}
c_1\\
c_2\\
c_3\\
c_4
\end{array}\right]\qquad \hbox{e}\qquad
z=\left[\begin{array}{c}
0\\
3\frac{0,5-(-1,9)}{4}-3\frac{(-1,9)-4,5}{3}\\
3\frac{-0,5-0,5}{3}-3\frac{0,5-(-1,9)}{4}\\
0
\end{array}\right]=\left[\begin{array}{c}
0\\
8,2\\
-2,8\\
0
\end{array}\right]$$</span><br /> Observe que <span class="math"><em>c</em><sub>4</sub></span> é um coeficiente artificial para o problema. A solução é <span class="math"><em>c</em><sub>1</sub> = 0</span>, <span class="math"><em>c</em><sub>2</sub> = 0, 7</span>, <span class="math"><em>c</em><sub>3</sub> =  − 0, 4</span> e <span class="math"><em>c</em><sub>4</sub> = 0</span>. Calculamos os demais coeficientes usando as expressões ([eq<sub>a</sub>n<sub>s</sub>pline]), ([eq<sub>b</sub>n<sub>s</sub>pline]) e ([eq<sub>d</sub>n<sub>s</sub>pline]): <br /><span class="math">$$\begin{aligned}
a_1&amp;=&amp;y_1=4,5\\
a_2&amp;=&amp;y_2=-1,9\\
a_3&amp;=&amp;y_3=0,5\\\end{aligned}$$</span><br /> <br /><span class="math">$$\begin{aligned}
d_1&amp;=&amp;\frac{c_{2}-c_1}{3h_1}=\frac{0,7-0}{3\cdot 3}=0,0777778\\
d_2&amp;=&amp;\frac{c_{3}-c_2}{3h_2}=\frac{-0,4-0,7}{3\cdot 4}=-0,0916667\\
d_3&amp;=&amp;\frac{c_{4}-c_3}{3h_3}=\frac{0+0,4}{3\cdot 3}=0,0444444\end{aligned}$$</span><br /> <br /><span class="math">$$\begin{aligned}
b_1 &amp;= \frac{y_{2}-y_1}{h_1}-\frac{h_1}{3}(2c_1+c_{2})\\
&amp;= \frac{-1,9-4,5}{3}-\frac{3}{3}(2\cdot 0-0,7)=-2,8333333\\
b_2&amp;= \frac{y_{3}-y_2}{h_2}-\frac{h_2}{3}(2c_2+c_{3})\\
&amp;= \frac{0,5-(-1,9)}{4}-\frac{4}{3}(2\cdot 0,7+0,4)=-0,7333333\\
b_3&amp;= \frac{y_{4}-y_3}{h_3}-\frac{h_3}{3}(2c_3+c_{4})\\
&amp;= \frac{-0,5-0,5}{3}-\frac{3}{3}(2\cdot (-0,4)+0)=0,4666667\end{aligned}$$</span><br /> Portanto:</p>
<p><br /><span class="math">$$f(x)=\left\{\begin{array}{ll}
4,5-2,833(x-2)+0,078(x-2)^3 &amp;\!, 2\leq x&lt;5\\
-1,9-0,733(x-5)+0,7(x-5)^2-0,092(x-5)^3 &amp;\!, 5\leq x&lt;9\\
0,5+0,467(x-9)-0,4(x-9)^2+0,044(x-9)^3 &amp;\!, 9\leq x\leq 12
\end{array}\right.$$</span><br /></p>
<p>No <code>Scilab</code>, podemos utilizar:</p>
<pre><code>X = [2 5 9 12]&#39;
Y = [4.5 -1.9 0.5 -0.5]&#39;
h = X(2:4)-X(1:3)
A = [1 0 0 0;h(1) 2*h(1)+2*h(2) h(2) 0; ...
   0 h(2) 2*h(2)+2*h(3) h(3);0 0 0 1 ]
z = [0, 3*(Y(3)-Y(2))/h(2)-3*(Y(2)-Y(1))/h(1), ...
   3*(Y(4)-Y(3))/h(3)-3*(Y(3)-Y(2))/h(2), 0]&#39;
c = A\z
for i=1:3
   a(i) = Y(i)
   d(i) = (c(i+1)-c(i))/(3*h(i))
   b(i) = (Y(i+1)-Y(i))/h(i)-h(i)/3*(2*c(i)+c(i+1))
end

for i=1:3
    P(i) = poly([a(i) b(i) c(i) d(i)],&#39;x&#39;,&#39;coeff&#39;)
    z = [X(i):.01:X(i+1)]
    plot(z,horner(P(i),z-X(i)))
end</code></pre>
<h3 id="spline-fixado">Spline fixado</h3>
<p>Alternativamente, para completar o sistema ([eq<sub>c</sub>n<sub>s</sub>pline]), podemos impor condições de contorno fixadas, ou seja, <br /><span class="math">$$\begin{aligned}
S'(x_1)&amp;=&amp;f'(x_1)\\
S'(x_n)&amp;=&amp;f'(x_n).\end{aligned}$$</span><br /> Substituindo na equação ([eq<sub>1</sub>derivada]) <br /><span class="math"><em>s</em>′<sub>1</sub>(<em>x</em><sub>1</sub>) = <em>b</em><sub>1</sub> + 2<em>c</em><sub>1</sub>(<em>x</em><sub>1</sub> − <em>x</em><sub>1</sub>) + 3<em>d</em><sub><em>j</em></sub>(<em>x</em><sub>1</sub> − <em>x</em><sub>1</sub>)<sup>2</sup> = <em>f</em>′(<em>x</em><sub>1</sub>) ⇒ <em>b</em><sub>1</sub> = <em>f</em>′(<em>x</em><sub>1</sub>)</span><br /> e <br /><span class="math">$$\begin{split}
s'_{n-1}(x_n) &amp;= b_{n-1}+2c_{n-1}(x_n-x_{n-1})+3d_j(x_n-x_{n-1})^2 \\
&amp;= b_{n-1}+2c_{n-1}h_{n-1}+3d_{n-1}h_{n-1}^2=f'(x_n)
  \end{split}$$</span><br /> Usando as equações ([eq<sub>d</sub>n<sub>s</sub>pline]) e ([eq<sub>b</sub>n<sub>s</sub>pline]) para <span class="math"><em>j</em> = 1</span> e <span class="math"><em>j</em> = <em>n</em> − 1</span>, temos: <br /><span class="math">$$2c_1h_1+c_{2}h_1=3\frac{y_{2}-y_1}{h_1}-3f'(x_1)$$</span><br /> e <br /><span class="math">$$c_{n-1}h_{n-1}+c_{n}h_{n-1}=3f'(x_n)-3\frac{y_{n}-y_{n-1}}{h_{n-1}}$$</span><br /></p>
<p>Essas duas equações juntamente com as equações ([eq<sub>c</sub>n<sub>s</sub>pline]) formam um sistema de <span class="math"><em>n</em></span> equações <span class="math"><em>A</em><em>c</em> = <em>z</em></span>, onde <br /><span class="math">$$A=\left[\begin{array}{ccccccc}
2h_1 &amp;h_1&amp;0&amp;0 &amp;\cdots&amp;0&amp;0\\
h_1&amp;2h_2+2h_{1}&amp;h_2&amp;0&amp;\cdots&amp;0&amp;0\\
0&amp;h_2&amp;2h_3+2h_{2}&amp;h_3&amp;\cdots&amp;0&amp;0\\
\vdots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots\\
0&amp;0&amp;0&amp;\cdots&amp;h_{n-2} &amp; 2h_{n-2}+2h_{n-1}&amp;h_{n-1}\\
0&amp;0&amp;0&amp;\cdots &amp;0&amp;h_{n-1}&amp;2h_{n-1}
\end{array}\right]$$</span><br /> <br /><span class="math">$$c = \left[\begin{array}{c}
c_1\\
c_2\\
\vdots\\
c_n
\end{array}\right]\qquad \hbox{e}\qquad
z = \left[\begin{array}{c}
3\frac{y_{2}-y_1}{h_1}-3f'(x_1)\\
3\frac{y_{3}-y_2}{h_2}-3\frac{y_{2}-y_{1}}{h_{1}}\\
3\frac{y_{4}-y_3}{h_3}-3\frac{y_{3}-y_{2}}{h_{2}}\\
\vdots\\
3\frac{y_{n-1}-y_{n-2}}{h_{n-2}}-3\frac{y_{n-2}-y_{n-3}}{h_{n-3}}\\
3f'(x_n)-3\frac{y_{n}-y_{n-1}}{h_{n-1}}
\end{array}\right]$$</span><br /> Observe que a matriz <span class="math"><em>A</em></span> é diagonal dominante estrita e, portanto, o sistema <span class="math"><em>A</em><em>c</em> = <em>z</em></span> possui solução única. Calculado <span class="math"><em>c</em></span>, os valores dos <span class="math"><em>a</em><sub><em>n</em></sub></span>, <span class="math"><em>b</em><sub><em>n</em></sub></span> e <span class="math"><em>d</em><sub><em>n</em></sub></span> são obtidos diretamente pelas expressões ([eq<sub>a</sub>n<sub>s</sub>pline]), ([eq<sub>b</sub>n<sub>s</sub>pline]) e ([eq<sub>d</sub>n<sub>s</sub>pline]), respectivamente.</p>
<p>Construa um spline cúbico com fronteira fixada que interpola a função <span class="math"><em>y</em> = sin(<em>x</em>)</span> nos pontos <span class="math"><em>x</em> = 0</span>, <span class="math">$x=\frac{\pi}{2}$</span>, <span class="math"><em>x</em> = <em>π</em></span>, <span class="math">$x=\frac{3\pi}{2}$</span> e <span class="math"><em>x</em> = 2<em>π</em></span>.</p>
<p>O spline desejado passa pelos pontos <span class="math">(0, 0)</span>, <span class="math">(<em>π</em>/2, 1)</span>, <span class="math">(<em>π</em>, 0)</span>, <span class="math">(3<em>π</em>/2,  − 1)</span> e <span class="math">(2<em>π</em>, 0)</span> e tem a forma: <br /><span class="math">$$f(x)=\left\{\begin{array}{ll}
a_1+b_1x+c_1x^2+d_1x^3&amp;, 0\leq x&lt;\frac{\pi}{2}\\
a_2+b_2(x-\frac{\pi}{2})+c_2(x-\frac{\pi}{2})^2+d_2(x-\frac{\pi}{2})^3&amp;, \frac{\pi}{2}\leq x&lt;\pi\\
a_3+b_3(x-\pi)+c_3(x-\pi)^2+d_3(x-\pi)^3&amp;, \pi\leq x&lt;\frac{3\pi}{2}\\
a_4+b_4(x-\frac{3\pi}{2})+c_4(x-\frac{3\pi}{2})^2+d_4(x-\frac{3\pi}{2})^3&amp;, \frac{3\pi}{2}\leq x\leq 2\pi
\end{array}\right..$$</span><br /> Observe que ele satisfaz as condição de contorno <span class="math"><em>f</em>′(0) = <em>c</em><em>o</em><em>s</em>(0) = 1</span> e <span class="math"><em>f</em>′(2<em>π</em>) = <em>c</em><em>o</em><em>s</em>(2<em>π</em>) = 1</span>.</p>
<p>Os coeficientes <span class="math"><em>c</em><sub>1</sub></span>, <span class="math"><em>c</em><sub>2</sub></span>, <span class="math"><em>c</em><sub>3</sub></span> e <span class="math"><em>c</em><sub>4</sub></span> resolvem o sistema <span class="math"><em>A</em><em>c</em> = <em>z</em></span>, onde: <br /><span class="math">$$A=\left[\begin{array}{ccccc}
\pi &amp;\pi/2&amp;0&amp;0&amp;0 \\
\pi/2&amp;2\pi&amp;\pi/2&amp;0&amp;0\\
0&amp;\pi/2&amp;2\pi&amp;\pi/2&amp;0\\
0&amp;0&amp;\pi/2&amp;2\pi&amp;\pi/2\\
0&amp;0&amp;0&amp;\pi/2&amp;\pi\\
\end{array}\right]$$</span><br /> <br /><span class="math">$$c = \left[\begin{array}{c}
c_1\\
c_2\\
c_3\\
c_4\\
c_5
\end{array}\right]\qquad \hbox{e}\qquad
z = \left[\begin{array}{c}
3\frac{1-0}{\pi/2}-3\cdot 1\\
3\frac{0-1}{\pi/2}-3\frac{1-0}{\pi/2}\\
3\frac{-1-0}{\pi/2}-3\frac{0-1}{\pi/2}\\
3\frac{0-(-1)}{\pi/2}-3\frac{(-1)-0}{\pi/2}\\
3\cdot 1-3\frac{0-(-1)}{\pi/2}
\end{array}\right]=\left[\begin{array}{c}
6/\pi-3\\
-12/\pi\\
0\\
12/\pi\\
3-6/\pi
\end{array}\right]$$</span><br /> Aqui <span class="math"><em>c</em><sub>5</sub></span> é um coeficiente artificial para o problema. A solução é <span class="math"><em>c</em><sub>1</sub> =  − 0, 0491874</span>, <span class="math"><em>c</em><sub>2</sub> =  − 0, 5956302</span>, <span class="math"><em>c</em><sub>3</sub> = 0</span>, <span class="math"><em>c</em><sub>4</sub> = 0, 5956302</span> e <span class="math"><em>c</em><sub>5</sub> = 0, 0491874</span>. Calculamos os demais coeficientes usando as expressões ([eq<sub>a</sub>n<sub>s</sub>pline]), ([eq<sub>b</sub>n<sub>s</sub>pline]) e ([eq<sub>d</sub>n<sub>s</sub>pline]): <br /><span class="math">$$\begin{aligned}
a_1&amp;=&amp;y_1=0\\
a_2&amp;=&amp;y_2=1\\
a_3&amp;=&amp;y_3=0\\
a_4&amp;=&amp;y_3=-1\\\end{aligned}$$</span><br /> <br /><span class="math">$$\begin{aligned}
d_1&amp;=&amp;\frac{c_{2}-c_1}{3h_1}=\frac{-0,5956302-(-0,0491874)}{3\cdot \pi/2}=-0,1159588\\
d_2&amp;=&amp;\frac{c_{3}-c_2}{3h_2}=\frac{0-(-0,5956302)}{3\cdot \pi/2}=0,1263967\\
d_3&amp;=&amp;\frac{c_{4}-c_3}{3h_3}=\frac{0,5956302- 0}{3\cdot \pi/2}=0,1263967\\
d_4&amp;=&amp;\frac{c_{5}-c_4}{3h_4}=\frac{0,0491874- 0,5956302}{3\cdot \pi/2}=-0,1159588\end{aligned}$$</span><br /> <br /><span class="math">$$\begin{aligned}
b_1&amp;= \frac{y_{2}-y_1}{h_1}-\frac{h_1}{3}(2c_1+c_{2})\\
&amp;=\frac{1-0}{\pi/2}-\frac{\pi/2}{3}(2\cdot (-0,0491874)-0,5956302)=1\\
b_2&amp;=\frac{y_{3}-y_2}{h_2}-\frac{h_2}{3}(2c_2+c_{3})\\
&amp;=\frac{0-1}{\pi/2}-\frac{\pi/2}{3}(2\cdot(-0,5956302) +0)=-0,0128772\\
b_3&amp;=\frac{y_{4}-y_3}{h_3}-\frac{h_3}{3}(2c_3+c_{4})\\
&amp;=\frac{-1-0}{\pi/2}-\frac{\pi/2}{3}(2\cdot 0+0,5956302)=-0,9484910\\
b_4&amp;=\frac{y_{5}-y_4}{h_4}-\frac{h_4}{3}(2c_4+c_{5})\\
&amp;=\frac{0-(-1)}{\pi/2}-\frac{\pi/2}{3}(2\cdot 0,5956302+0,0491874)=-0,0128772\end{aligned}$$</span><br /> Portanto,</p>
<p><br /><span class="math">$$f(x)=\left\{\begin{array}{ll}
x-0,049x^2-0,12x^3&amp;, 0\leq x&lt;\frac{\pi}{2}\\
1+-0,01(x-\frac{\pi}{2})-0,6(x-\frac{\pi}{2})^2+0,13(x-\frac{\pi}{2})^3&amp;, \frac{\pi}{2}\leq x&lt;\pi\\
-0,95(x-\pi)+0,13(x-\pi)^3&amp;, \pi\leq x&lt;\frac{3\pi}{2}\\
-1-0,01(x-\frac{3\pi}{2})+0,6(x-\frac{3\pi}{2})^2-0,12(x-\frac{3\pi}{2})^3&amp;, \frac{3\pi}{2}\leq x\leq2\pi
\end{array}\right.$$</span><br /></p>
<p>No <code>Scilab</code>, podemos resolver este problema fazendo:</p>
<h4 id="resumo-sobre-splines">Resumo sobre Splines</h4>
<p>Dado um conjunto de pontos <span class="math">(<em>x</em><sub><em>i</em></sub>, <em>y</em><sub><em>i</em></sub>)</span>, <span class="math"><em>i</em> = 1, 2, …, <em>n</em></span>, um spline cúbico é a seguinte função definida por partes:</p>
<p><br /><span class="math">$$s(x) \!=\! \left\{\begin{array}{ll}
       \!\!\!a_1 \!+\! b_1(x\!-\!x_1) \!+\! c_1(x\!-\!x_1)^2 \!+\! d_1(x\!-\!x_1)^3 &amp;\!\!\!\!\!, x_1\leq x &lt; x_2\\
      \!\!\!a_2 \!+\! b_2(x\!-\!x_2) \!+\! c_2(x\!-\!x_2)^2 \!+\! d_2(x\!-\!x_2)^3 &amp;\!\!\!\!\!, x_2 \leq x &lt; x_3\\
      \qquad\qquad \vdots &amp; \qquad\vdots \\
      \!\!\!a_{n-1} \!+\! b_{n-1}(x\!-\!x_{n-1}) \!+\! c_{n-1}(x\!-\!x_{n-1})^2 \!+\! d_{n-1}(x\!-\!x_{n-1})^3 &amp;\!\!\!\!\!, x_{n-1} \leq x \leq x_n \end{array}\right.$$</span><br /></p>
<p>Definindo-se <span class="math"><em>h</em><sub><em>j</em></sub> = <em>x</em><sub><em>j</em> + 1</sub> − <em>x</em><sub><em>j</em></sub></span>, os coeficientes <span class="math"><em>c</em><sub><em>j</em></sub></span>, <span class="math">$j=1,2,\dotsc,n$</span>, são solução do sistema linear <span class="math"><em>A</em><em>c</em> = <em>z</em></span>, onde:</p>
<p><br /><span class="math">$$\begin{array}{|l|l|}\hline
    \text{Spline Natural} &amp; \text{Spline Fixado}\\
    s_1''(x_1) = 0 \text{ e } s_{n-1}''(x_n) = 0 &amp; s_1'(x_1) = f'(x_1) \text{ e } s_{n-1}'(x_n) = f'(x_n)\\ \hline
    a_{i,j} = \left\{
      \begin{array}{ll}
        1 &amp;, j=i=1\\
        h_{i-1} &amp;, j = i-1, i&lt;n\\
        2(h_i + h_{i-1}) &amp;, j=i, 1&lt;i&lt;n\\
        h_i &amp;, j=i+1, i&gt;1\\
        1 &amp;, j=i=n\\
        0 &amp;, \text{caso contrário.}
      \end{array}
\right. &amp;  a_{i,j} = \left\{
      \begin{array}{ll}
        2h_1 &amp;, j=i=1\\
        h_{i-1} &amp;, j = i-1\\
        2(h_i + h_{i-1}) &amp;, j=i, 1&lt;i&lt;n\\
        h_i &amp;, j=i+1\\
        2h_{n-1} &amp;, j=i=n\\
        0 &amp;, \text{caso contrário.}
      \end{array}
\right.\\
&amp;\\
z_i = \left\{
  \begin{array}{ll}
    0 &amp;, i=1\\
    3\frac{y_{i+1}-y_i}{h_i} - 3\frac{y_i-y_{i-1}}{h_{i-1}} &amp;, 1&lt;i&lt;n\\
    0 &amp;, i=n
  \end{array}
\right. &amp; z_i = \left\{
  \begin{array}{ll}
    3\frac{y_2-y_1}{h_1} - 3f'(x_1) &amp;, i=1\\
    3\frac{y_{i+1}-y_i}{h_i} - 3\frac{y_i-y_{i-1}}{h_{i-1}} &amp;, 1&lt;i&lt;n\\
    3f'(x_n) - 3\frac{y_n - y_{n-1}}{h_{n-1}} &amp;, i=n
  \end{array}
\right. \\ \hline
  \end{array}$$</span><br /></p>
<p>os coeficientes <span class="math"><em>a</em><sub><em>j</em></sub></span>, <span class="math"><em>b</em><sub><em>j</em></sub></span> e <span class="math"><em>d</em><sub><em>j</em></sub></span>, <span class="math">$j=1,2,\dotsc,n-1$</span>, são calculados conforme segue: <br /><span class="math">$$\begin{aligned}
  &amp;a_j = y_j\\
  &amp;b_j = \frac{3y_{j+1} - 3y_j - 2c_jh_j^2 - c_{j+1}h_j^2}{3h_j}\\
  &amp;d_j = \frac{c_{j+1} - c_j}{3h_j}\end{aligned}$$</span><br /></p>
<h1 id="derivação-e-integração-numérica">Derivação e integração numérica</h1>
<h2 id="derivação-numérica">Derivação Numérica</h2>
<p>Dado um conjunto de pontos <span class="math">(<em>x</em><sub><em>i</em></sub>, <em>y</em><sub><em>i</em></sub>)<sub><em>i</em> = 1</sub><sup><em>n</em></sup></span>, a derivada <span class="math">$\left(\frac{dy}{dx}\right)_i$</span> pode ser calculada de várias formas. Na próxima seção trabalharemos com diferenças finitas, que é mais adequada quando as abcissas estão próximas e os dados não sofrem perturbações significativas. Na seção subsequente trataremos os casos quando os dados oscilam via ajuste ou interpolações de curvas.</p>
<h3 id="aproximação-da-derivada-por-diferenças-finitas">Aproximação da derivada por diferenças finitas</h3>
<p>A derivada <span class="math"><em>f</em>′(<em>x</em><sub>0</sub>)</span> de uma função <span class="math"><em>f</em>(<em>x</em>)</span> no ponto <span class="math"><em>x</em><sub>0</sub></span> é <br /><span class="math">$$f'(x_0)=\lim_{h\to 0}\frac{f(x_0+h)-f(x_0)}{h}.$$</span><br /> Da definição, se <span class="math"><em>h</em> ≠ 0</span> é pequeno (não muito pequeno para evitar o cancelamento catastrófico), é esperado que uma aproximação para a derivada no ponto <span class="math"><em>x</em><sub>0</sub></span> seja dada por: <br /><span class="math">$$\label{eq:dp}
  f'(x_0)\approx \frac{f(x_0+h)-f(x_0)}{h}.$$</span><br /></p>
<p>[ex:dp] Calcule a derivada numérica da função <span class="math"><em>f</em>(<em>x</em>) = cos(<em>x</em>)</span> no ponto <span class="math"><em>x</em> = 1</span> usando <span class="math"><em>h</em> = 0, 1</span>, <span class="math"><em>h</em> = 0, 01</span>, <span class="math"><em>h</em> = 0, 001</span> e <span class="math"><em>h</em> = 0, 0001</span>.</p>
<p>Usando a fórmula de diferenças dada pela Equação , devemos calcular: <br /><span class="math">$$f'(x) \approx \frac{cos(1 + h) - cos(1)}{h}$$</span><br /> para cada valor de <span class="math"><em>h</em></span> solicitado. Fazendo isso, obtemos a seguinte tabela: <br /><span class="math">$$\begin{array}{|c|c|}
\hline
\vspace{-10pt}&amp;\\
h &amp; \dfrac{f(1+h)-f(1)}{h} \\
\vspace{-10pt}&amp;\\
\hline
\vspace{-10pt}&amp;\\
0,1 &amp; \dfrac{0,4535961-0,5403023}{0,1}=- 0,8670618\\
\vspace{-10pt}&amp;\\
\hline
\vspace{-10pt}&amp;\\
0,01 &amp; \dfrac{0,5318607-0,5403023}{0,01}=- 0,8441584\\
\vspace{-10pt}&amp;\\
\hline
\vspace{-10pt}&amp;\\
0,001 &amp; \dfrac{0,5403023-0,5403023}{0,001}=- 0,841741\\
\vspace{-10pt}&amp;\\
\hline
\vspace{-10pt}&amp;\\
0,0001 &amp; \dfrac{0,5403023-0,5403023}{0,0001}=-0,841498\\
\hline
\end{array}$$</span><br /> No <code>Scilab</code>, podemos calcular a aproximação da derivada <span class="math"><em>f</em>′(1)</span> com <span class="math"><em>h</em> = 0, 1</span> usando as seguintes linhas de código:</p>
<pre><code>deff(&#39;y = f(x)&#39;,&#39;y = cos(x)&#39;)
x0 = 1
h = 0.1
dp = (f(x0+h) - f(x0))/h</code></pre>
<p>E, similarmente, para outros valores de <span class="math"><em>x</em><sub>0</sub></span> e <span class="math"><em>h</em></span>.</p>
<p>Observe que, no exemplo anterior, quanto menor <span class="math"><em>h</em></span>, melhor é a aproximação, visto que o valor exato para a derivada é <span class="math"><em>f</em>′(1) =  − sin(1) =  − 0, 8414710</span>. Porém, quando <span class="math"><em>h</em> = 10<sup> − 13</sup></span>, a derivada numérica é <span class="math"> − 0, 8404388</span> (usando aritmética <code>double</code>), resultado pior que aquele para <span class="math"><em>h</em> = 0, 0001</span>. Além disso, na mesma aritmética, quando <span class="math"><em>h</em> = 10<sup> − 16</sup></span> a derivada numérica calculada é zero (cancelamento catastrófico). Isso nos motiva a pensar qual é o melhor <span class="math"><em>h</em></span>.</p>
<p>Essa aproximação para a derivada é denominada diferenças progressivas. A derivada numérica também pode ser aproximada usando definições equivalentes: <br /><span class="math">$$f'(x_0)\approx \frac{f(x_0)-f(x_0-h)}{h}=\frac{y_i-y_{i-1}}{h}$$</span><br /> que é denominada diferenças regressivas ou <br /><span class="math">$$f'(x_0)\approx \frac{f(x_0+h)-f(x_0-h)}{2h}=\frac{y_{i+1}-y_{i-1}}{2h}$$</span><br /> que é denominada diferenças centrais.</p>
<p>Calcule a derivada numérica da função <span class="math"><em>f</em>(<em>x</em>) = cos(<em>x</em>)</span> no ponto <span class="math"><em>x</em> = 1</span> usando diferenças progressivas, diferenças regressivas e diferenças centrais com <span class="math"><em>h</em> = 0, 1</span>, <span class="math"><em>h</em> = 0, 01</span> e <span class="math"><em>h</em> = 0, 001</span>.</p>
<p>A tabela abaixo mostra a derivada numérica para cada valor de <span class="math"><em>h</em></span>.</p>
<table>
<thead>
<tr class="header">
<th align="left">Diferenças</th>
<th align="center">h=0,1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Progressivas</td>
<td align="center"><span class="math"> − 0, 8670618</span></td>
</tr>
<tr class="even">
<td align="left">Regressivas</td>
<td align="center"><span class="math">$\displaystyle \frac{\cos(1)-\cos(0,9)}{0,1} = -0,8130766$</span></td>
</tr>
<tr class="odd">
<td align="left">Centrais</td>
<td align="center"><span class="math">$\displaystyle \frac{\cos(1,1)-\cos(0,9)}{0,2} = -0,8400692$</span></td>
</tr>
<tr class="even">
<td align="left">Diferenças</td>
<td align="center">h=0,01</td>
</tr>
<tr class="odd">
<td align="left">Progressivas</td>
<td align="center"><span class="math"> − 0, 8441584</span></td>
</tr>
<tr class="even">
<td align="left">Regressivas</td>
<td align="center"><span class="math">$\displaystyle \frac{\cos(1)-\cos(0,99)}{0,01} = -0,8387555$</span></td>
</tr>
<tr class="odd">
<td align="left">Centrais</td>
<td align="center"><span class="math">$\displaystyle \frac{\cos(1,01)-\cos(0,99)}{0,02} = -0,8414570$</span></td>
</tr>
<tr class="even">
<td align="left">Diferenças</td>
<td align="center">h=0,01</td>
</tr>
<tr class="odd">
<td align="left">Progressivas</td>
<td align="center"><span class="math"> − 0, 841741</span></td>
</tr>
<tr class="even">
<td align="left">Regressivas</td>
<td align="center"><span class="math">$\displaystyle \frac{\cos(1)-\cos(0,999)}{0,001} = -0,8412007$</span></td>
</tr>
<tr class="odd">
<td align="left">Centrais</td>
<td align="center"><span class="math">$\displaystyle \frac{\cos(1,001)-\cos(0,999)}{0,002} = -0,8414708$</span></td>
</tr>
</tbody>
</table>
<h3 id="erros-de-truncamento">Erros de truncamento</h3>
<p>Seja <span class="math"><em>D</em><sub> + , <em>h</em></sub><em>f</em>(<em>x</em><sub>0</sub>)</span> a aproximação da derivada de <span class="math"><em>f</em></span> em <span class="math"><em>x</em><sub>0</sub></span> por diferenças progressivas, <span class="math"><em>D</em><sub> − , <em>h</em></sub><em>f</em>(<em>x</em><sub>0</sub>)</span> a aproximação por diferenças regressivas e <span class="math"><em>D</em><sub>0, <em>h</em></sub><em>f</em>(<em>x</em><sub>0</sub>)</span> a aproximação por diferenças centrais, então <br /><span class="math">$$\begin{aligned}
D_{+,h}f(x_0)-f'(x_0)&amp;=&amp;\frac{f(x_0+h)-f(x_0)}{h}-f'(x_0)\\
&amp;=&amp;\frac{f(x_0)+hf'(x_0)+\frac{h^2}{2}f''(x_0)+O(h^3)-f(x_0)}{h}-f'(x_0)\\
&amp;=&amp;\frac{h}{2}f''(x_0)+O(h^2)=O(h).\\\end{aligned}$$</span><br /> Analogamente: <br /><span class="math">$$\begin{aligned}
D_{-,h}f(x_0)-f'(x_0)&amp;=&amp;\frac{f(x_0)-f(x_0-h)}{h}-f'(x_0)\\
&amp;=&amp;\frac{f(x_0)-\left(f(x_0)-hf'(x_0)+\frac{h^2}{2}f''(x_0)+O(h^3)\right)}{h}-f'(x_0)\\
&amp;=&amp;-\frac{h}{2}f''(x_0)+O(h^2)=O(h).\\\end{aligned}$$</span><br /> Também: <br /><span class="math">$$\begin{aligned}
D_{0,h}f(x_0)-f'(x_0)&amp;= \frac{f(x_0+h)-f(x_0-h)}{2h}-f'(x_0)\\
&amp;= \frac{f(x_0)+hf'(x_0)+\frac{h^2}{2}f''(x_0)+O(h^3)}{2h} \\
&amp;- \frac{f(x_0)-hf'(x_0)+\frac{h^2}{2}f''(x_0)+O(h^3)}{2h}-f'(x_0)\\
&amp;= O(h^2).\end{aligned}$$</span><br /></p>
<p>Calcule a derivada numérica e o erro de truncamento de <span class="math"><em>f</em>(<em>x</em>) = <em>e</em><sup> − <em>x</em></sup></span> em <span class="math"><em>x</em> = 1, 5</span> pela fórmula de diferença progressiva para <span class="math"><em>h</em> = 0, 1</span>, <span class="math"><em>h</em> = 0, 01</span> e <span class="math"><em>h</em> = 0, 001</span>.</p>
<p>Como <span class="math">|<em>f</em>″(<em>x</em>)| = |<em>e</em><sup> − <em>x</em></sup>| &lt; 1</span>, então <span class="math">$|f'_+(x_0)-f'(x_0)|&lt;\frac{h}{2}$</span>. <br /><span class="math">$$\begin{array}{|c|c|c|}
\hline
 h&amp;\hbox{diferenças progressivas} &amp; \hbox{erro}=\frac{h}{2}\\
\hline
0,1&amp;- 0,2123364 &amp; 0,05\\
\hline
0,01 &amp;- 0,2220182 &amp; 0,005\\
\hline
0,001 &amp;- 0,2230186 &amp; 0,0005\\
\hline
\end{array}$$</span><br /> O valor exato da derivada é <span class="math"><em>f</em>′(1, 5) =  − 0, 2231302</span>.</p>
<h3 id="erros-de-arredondamento-1">Erros de arredondamento</h3>
<p>Para entender como os erros de arredondamento se propagam ao calcular as derivadas numéricas vamos considerar o operador de diferenças finitas progressivas <br /><span class="math">$$D_{+,h}f(x) =\frac{f(x+h)-f(x)}{h}.$$</span><br /> Nesse contexto temos o valor exato <span class="math"><em>f</em>′(<em>x</em>)</span> para a derivada, a sua aproximação numérica <span class="math"><em>D</em><sub> + , <em>h</em></sub><em>f</em>(<em>x</em>)</span> e a representação em número de máquina do operador <span class="math"><em>D</em><sub> + , <em>h</em></sub><em>f</em>(<em>x</em>)</span> que denotaremos por <span class="math">$\overline{D_{+,h}f(x)}$</span>. Seja <span class="math"><em>ε</em>(<em>x</em>, <em>h</em>)</span> o erro de arredondamento ao calcularmos a derivada e consideremos <br /><span class="math">$$\overline{D_{+,h}f(x)}=D_{+,h}f(x)(1+\varepsilon(x,h))=\frac{\overline{f(x+h)}-\overline{f(x)}}{h}(1+\varepsilon(x,h)).$$</span><br /> Também, consideremos <br /><span class="math">$$|\overline{f(x+h)}-f(x+h)|=\delta(x,h)\leq \delta$$</span><br /> e <br /><span class="math">$$|\overline{f(x)}-f(x)|=\delta(x,0)\leq \delta,$$</span><br /> onde <span class="math">$\overline{f(x+h)}$</span> e <span class="math">$\overline{f(x)}$</span> são as representação em ponto flutuante dos números <span class="math"><em>f</em>(<em>x</em> + <em>h</em>)</span> e <span class="math"><em>f</em>(<em>x</em>)</span>, respectivamente. A diferença do valor da derivada e sua aproximação representada em ponto flutuante pode ser estimada da seguinte forma: <br /><span class="math">$$\begin{aligned}
\left|f'(x)-\overline{D_{+,h}f(x)}\right|&amp;= \left| f'(x)-\frac{\overline{f(x+h)}-\overline{f(x)}}{h}(1+\varepsilon(x,h)) \right|\\
&amp;= \left| f'(x)-\left(\frac{\overline{f(x+h)}-\overline{f(x)}}{h}+\frac{f(x+h)-f(x+h)}{h}\right.\right. \\
&amp;+ \left.\left.\frac{f(x)-f(x)}{h}\right)(1+\varepsilon) \right|\\
&amp;= \left| f'(x)+\left(-\frac{f(x+h)-f(x)}{h}-\frac{\overline{f(x+h)}-f(x+h)}{h}\right.\right.\\
&amp;+ \left.\left. \frac{\overline{f(x)}-f(x)}{h}\right)(1+\varepsilon) \right|\\
&amp;\leq \left|f'(x)-\frac{f(x+h)-f(x)}{h}\right| +\left(\left|\frac{\overline{f(x+h)}-f(x+h)}{h}\right|\right.\\
&amp;+\left.\left|\frac{\overline{f(x)}-f(x)}{h}\right| \right)|1+\varepsilon| + \left|\frac{f(x+h)-f(x)}{h}\right|\varepsilon\\
&amp;\leq Mh +\left(\left|\frac{\delta}{h}\right|+\left|\frac{\delta}{h}\right| \right)|1+\varepsilon| +|f'(x)|\varepsilon\\
&amp;\leq Mh +\left(\frac{2\delta}{h}\right)|1+\varepsilon| +|f'(x)|\varepsilon\end{aligned}$$</span><br /> onde <br /><span class="math">$$M=\frac{1}{2}\max_{x\leq y\leq x+h}|f''(y)|$$</span><br /> está relacionado com o erro de truncamento.</p>
<p>Esta estimativa mostra que se o valor de <span class="math"><em>h</em></span> for muito pequeno o erro ao calcular a aproximação numérica cresce. Isso nos motiva a procurar o valor ótimo de <span class="math"><em>h</em></span> que minimiza o erro.</p>
<p>Estude o comportamento da derivada de <span class="math"><em>f</em>(<em>x</em>) = <em>e</em><sup> − <em>x</em><sup>2</sup></sup></span> no ponto <span class="math"><em>x</em> = 1, 5</span> quando <span class="math"><em>h</em></span> fica pequeno.</p>
<p>Segue a tabela com os valores da derivada para vários valores de <span class="math"><em>h</em></span>.</p>
<p><br /><span class="math">$$\begin{array}{|c|c|c|c|c|c|c|}
\hline
h&amp;10^{-2}&amp;10^{-4}&amp;10^{-6}&amp;10^{-7}&amp;10^{-8}&amp;10^{-9}\\
\hline
D_{+,h}f(1,5)&amp; - 0,3125246&amp;- 0,3161608 &amp;- 0,3161973&amp;- 0,3161976&amp;- 0,3161977&amp;- 0,3161977 \\
\hline
\end{array}$$</span><br /></p>
<p><br /><span class="math">$$\begin{array}{|c|c|c|c|c|c|c|}
\hline
h&amp;10^{-10}&amp;10^{-11}&amp;10^{-12}&amp;10^{-13}&amp;10^{-14}&amp;10^{-15}\\
\hline
D_{+,h}f(1,5)&amp;- 0,3161976&amp;- 0,3161971&amp;- 0,3162332&amp;- 0,3158585&amp;- 0,3178013&amp;- 0,3747003\\
\hline
\end{array}$$</span><br /></p>
<p><br /><span class="math">$$\begin{array}{|c|c|c|c|c|c|c|}
\hline
h&amp;10^{-2}&amp;10^{-4}&amp;10^{-6}&amp;10^{-7}&amp;10^{-8}&amp;10^{-9}\\
\hline
D_{+,h}f(1,5)&amp; - 0,3125246&amp;- 0,3161608 &amp;- 0,3161973&amp;- 0,3161976&amp;- 0,3161977&amp;- 0,3161977 \\
\hline
\end{array}$$</span><br /></p>
<p>Observe que o valor exato é <span class="math"> − 0, 3161977</span> e o <span class="math"><em>h</em></span> ótimo é algo entre <span class="math">10<sup> − 8</sup></span> e <span class="math">10<sup> − 9</sup></span>.</p>
<h3 id="aproximações-de-alta-ordem">Aproximações de alta ordem</h3>
<p>Para aproximar a derivada de uma função <span class="math"><em>f</em>(<em>x</em>)</span> em <span class="math"><em>x</em><sub>0</sub></span>, <span class="math"><em>x</em><sub>1</sub></span> ou <span class="math"><em>x</em><sub>2</sub></span> usaremos os três pontos vizinhos <span class="math">(<em>x</em><sub>0</sub>, <em>f</em>(<em>x</em><sub>0</sub>))</span>, <span class="math">(<em>x</em><sub>1</sub>, <em>f</em>(<em>x</em><sub>1</sub>))</span> e <span class="math">(<em>x</em><sub>2</sub>, <em>f</em>(<em>x</em><sub>2</sub>))</span>. Uma interpolação usando polinômios de Lagrange para esses três pontos é da forma: <br /><span class="math">$$\begin{aligned}
f(x)&amp;=f(x_0)\frac{(x-x_{1})(x-x_{2})}{(x_0-x_{1})(x_0-x_{2})}
+f(x_{1})\frac{(x-x_{0})(x-x_{2})}{(x_{1}-x_{0})(x_{1}-x_{2})}\\
&amp;+f(x_{2})\frac{(x-x_{0})(x-x_{1})}{(x_{2}-x_{0})(x_{2}-x_{1})} 
+\frac{f'''(\xi(x))}{6}(x-x_0)(x-x_{1})(x-x_{2}).\end{aligned}$$</span><br /> A derivada de <span class="math"><em>f</em>(<em>x</em>)</span> é <br /><span class="math">$$\label{tres_pontos}
  \begin{split}
    f'(x) &amp;= f(x_0)\frac{2x-x_{1}-x_{2}}{(x_0-x_{1})(x_0-x_{2})}
    +f(x_{1})\frac{2x-x_{0}-x_{2}}{(x_{1}-x_{0})(x_{1}-x_{2})}\\
    &amp;+f(x_{2})\frac{2x-x_{0}-x_{1}}{(x_{2}-x_{0})(x_{2}-x_{1})}\\
    &amp;+\frac{f'''(\xi(x))}{6} \left( (x-x_{1})(x-x_{2}) +(x-x_0)(2x-x_{1}-x_{2})\right)\\
    &amp;+ D_x\left(\frac{f'''(\xi(x))}{6}\right)(x-x_0)(x-x_1)(x-x_2).    
  \end{split}$$</span><br /> Trocando <span class="math"><em>x</em></span> por <span class="math"><em>x</em><sub>0</sub></span>, temos <br /><span class="math">$$\begin{split}
    f'(x_0)&amp;= f(x_0)\frac{2x_0-x_{1}-x_{2}}{(x_0-x_{1})(x_0-x_{2})}
    +f(x_{1})\frac{2x_0-x_{0}-x_{2}}{(x_{1}-x_{0})(x_{1}-x_{2})}\\
    &amp;+f(x_{2})\frac{2x_0-x_{0}-x_{1}}{(x_{2}-x_{0})(x_{2}-x_{1})}\\
    &amp;+ \frac{f'''(\xi(x_0))}{6} \left( (x_0-x_{1})(x_0-x_{2}) +(x_0-x_0)(2x_0-x_{1}-x_{2})\right)\\
    &amp;+ D_x\left(\frac{f'''(\xi(x_0))}{6}\right)(x_0-x_0)(x_0-x_1)(x_0-x_2).
  \end{split}$$</span><br /> Considerando uma malha equiespaçada onde <span class="math"><em>x</em><sub>1</sub> = <em>x</em><sub>0</sub> + <em>h</em></span> e <span class="math"><em>x</em><sub>2</sub> = <em>x</em><sub>0</sub> + 2<em>h</em></span>, temos: <br /><span class="math">$$\begin{split}
  f'(x_0)&amp;= f(x_0)\frac{-3h}{(-h)(-2h)} + f(x_{1})\frac{-2h}{(h)(-h)} \\
  &amp;+f(x_{2})\frac{-h}{(2h)(h)}+\frac{f'''(\xi(x_0))}{6} \left( (-h)(-2h)\right)\\
  &amp;= \frac{1}{h}\left[-\frac{3}{2}f(x_0)+2f(x_{1})-\frac{1}{2}f(x_{2})\right]+h^2\frac{f'''(\xi(x_0))}{3}    
  \end{split}$$</span><br /> Similarmente, trocando <span class="math"><em>x</em></span> por <span class="math"><em>x</em><sub>1</sub></span> ou trocando <span class="math"><em>x</em></span> por <span class="math"><em>x</em><sub>2</sub></span> na expressão ([tres<sub>p</sub>ontos]), temos outras duas expressões <br /><span class="math">$$\begin{aligned}
f'(x_1)&amp;=&amp;\frac{1}{h}\left[-\frac{1}{2}f(x_0)
+\frac{1}{2}f(x_{2})\right]+h^2\frac{f'''(\xi(x_1))}{6}\\
f'(x_2)&amp;=&amp;\frac{1}{h}\left[\frac{1}{2}f(x_0)-2f(x_{1})
+\frac{3}{2}f(x_{2})\right]+h^2\frac{f'''(\xi(x_2))}{3}\end{aligned}$$</span><br /> Podemos reescrever as três fórmulas da seguinte forma: <br /><span class="math">$$\begin{aligned}
f'(x_0)&amp;=&amp;\frac{1}{h}\left[-\frac{3}{2}f(x_0)+2f(x_{0}+h)
-\frac{1}{2}f(x_{0}+2h)\right]+h^2\frac{f'''(\xi(x_0))}{3}\\
f'(x_0+h)&amp;=&amp;\frac{1}{h}\left[-\frac{1}{2}f(x_0)
+\frac{1}{2}f(x_{0}+2h)\right]+h^2\frac{f'''(\xi(x_0+h))}{6}\\
f'(x_0+2h)&amp;=&amp;\frac{1}{h}\left[\frac{1}{2}f(x_0)-2f(x_{0}+h)
+\frac{3}{2}f(x_{0}+2h)\right]+h^2\frac{f'''(\xi(x_{0}+2h))}{3}\end{aligned}$$</span><br /> ou ainda <br /><span class="math">$$\begin{aligned}
{\label{tres_pontos_frente}}f'(x_0)&amp;=&amp;\frac{1}{2h}\left[-3f(x_0)+4f(x_{0}+h)
-f(x_{0}+2h)\right]+h^2\frac{f'''(\xi(x_0))}{3}\\
{\label{tres_pontos_central}}f'(x_0)&amp;=&amp;\frac{1}{2h}\left[f(x_{0}+h)-f(x_0-h)\right]+h^2\frac{f'''(\xi(x_0))}{6}\\
{\label{tres_pontos_traz}}f'(x_0)&amp;=&amp;\frac{1}{2h}\left[f(x_0-2h)-4f(x_{0}-h)
+3f(x_{0})\right]+h^2\frac{f'''(\xi(x_{0}))}{3}\end{aligned}$$</span><br /> Observe que uma das fórmulas é exatamente as diferenças centrais obtida anteriormente.</p>
<p>Analogamente, para construir as fórmulas de cinco pontos tomamos o polinômio de Lagrange para cinco pontos e chegamos a cinco fórmulas, sendo uma delas a seguinte: <br /><span class="math">$${\label{cinco_pontos}}f'(x_0)=\frac{1}{12h}\left[f(x_0-2h)-8f(x_0-h)+8f(x_0+h)-f(x_0+2h)\right]+\frac{h^4}{30}f^{(5)}(\xi(x_0))$$</span><br /></p>
<p>Calcule a derivada numérica de <span class="math"><em>f</em>(<em>x</em>) = <em>e</em><sup> − <em>x</em><sup>2</sup></sup></span> em <span class="math"><em>x</em> = 1, 5</span> pela fórmula de três e cinco pontos para <span class="math"><em>h</em> = 0, 1</span>, <span class="math"><em>h</em> = 0, 01</span> e <span class="math"><em>h</em> = 0, 001</span>.</p>
<p>A tabela mostra os resultados: <br /><span class="math">$$\begin{array}{|c|c|c|c|}
\hline
 h &amp; h=0,1 &amp; h=0,01 &amp; h=0,001\\
\hline
\hbox{diferenças progressivas} &amp;-0,2809448 &amp;-0,3125246 &amp;- 0,3158289\\
\hline
\hbox{diferenças regressivas} &amp;- 0,3545920 &amp;- 0,3199024 &amp;- 0,3165667\\
\hline
\hbox{três pontos usando (\ref{tres_pontos_frente})} &amp;-0,3127746 &amp;- 0,3161657 &amp;-0,3161974\\
\hline
\hbox{três pontos usando (\ref{tres_pontos_central})} &amp;- 0,3177684 &amp;- 0,3162135 &amp;-0,3161978\\
\hline
\hbox{três pontos usando (\ref{tres_pontos_traz})} &amp;-0,3135824 &amp;- 0,3161665 &amp;-0,3161974\\
\hline
\hbox{cinco pontos usando (\ref{cinco_pontos})} &amp;-0,3162384&amp;-0,316197677 &amp;-0,3161976736860\\
\hline
\end{array}$$</span><br /> O valor exato da derivada é <span class="math"><em>f</em>′(1, 5) =  − 0, 3161976736856</span>.</p>
<h3 id="aproximação-para-a-segunda-derivada">Aproximação para a segunda derivada</h3>
<p>Para aproximar a derivada segunda, considere as expansões em série de Taylor <br /><span class="math">$$f(x_0+h)=f(x_0)+hf'(x_0)+\frac{h^2}{2}f''(x_0)+\frac{h^3}{6}f'''(x_0)+O(h^4)$$</span><br /> <br /><span class="math">$$f(x_0-h)=f(x_0)-hf'(x_0)+\frac{h^2}{2}f''(x_0)-\frac{h^3}{6}f'''(x_0)+O(h^4).$$</span><br /> Somando as duas expressões, temos: <br /><span class="math"><em>f</em>(<em>x</em><sub>0</sub> + <em>h</em>) + <em>f</em>(<em>x</em><sub>0</sub> − <em>h</em>) = 2<em>f</em>(<em>x</em><sub>0</sub>) + <em>h</em><sup>2</sup><em>f</em>″(<em>x</em><sub>0</sub>) + <em>O</em>(<em>h</em><sup>4</sup>)</span><br /> ou seja, uma aproximação de segunda ordem para a derivada segunda em <span class="math"><em>x</em><sub>0</sub></span> é <br /><span class="math">$$f''(x_0)=\frac{f(x_0+h)-2f(x_0)+f(x_0-h)}{h^2}+O(h^2):=D^2_{0,h}f(x_0)+O(h^2),$$</span><br /> onde <br /><span class="math">$$D^2_{0,h}f(x_0)=\frac{f(x_0+h)-2f(x_0)+f(x_0-h)}{h^2}.$$</span><br /></p>
<p>Calcule a derivada segunda numérica de <span class="math"><em>f</em>(<em>x</em>) = <em>e</em><sup> − <em>x</em><sup>2</sup></sup></span> em <span class="math"><em>x</em> = 1, 5</span> para <span class="math"><em>h</em> = 0, 1</span>, <span class="math"><em>h</em> = 0, 01</span> e <span class="math"><em>h</em> = 0, 001</span>.</p>
<p>A tabela mostra os resultados: <br /><span class="math">$$\begin{array}{|c|c|c|c|}
\hline
 h&amp;h=0,1&amp; h=0,01 &amp; h=0,001\\
\hline
D^2_{0,h}f(1,5) &amp; 0,7364712 &amp; 0,7377814 &amp; 0,7377944\\
\hline
\end{array}$$</span><br /> Observe que <span class="math"><em>f</em>″(<em>x</em>) = (4<em>x</em><sup>2</sup> − 2)<em>e</em><sup> − <em>x</em><sup>2</sup></sup></span> e <span class="math"><em>f</em>″(1, 5) = 0, 7377946</span>.</p>
<h3 id="derivada-via-ajuste-ou-interpolação">Derivada via ajuste ou interpolação</h3>
<p>Dado os valores de uma função em pontos <span class="math">{(<em>x</em><sub><em>i</em></sub>, <em>y</em><sub><em>i</em></sub>)}<sub><em>i</em> = 1</sub><sup><em>N</em></sup></span>, as derivadas <span class="math">$\left(\frac{dy}{dx}\right)_i$</span> podem ser obtidas através da derivada de uma curva que melhor ajusta ou interpola os pontos. Esse tipo de técnica é necessário quando os pontos são muito espaçados entre si ou quando a função oscila muito. Por exemplo, dado os pontos <span class="math">(0, 1)</span>, <span class="math">(1, 2)</span>, <span class="math">(2, 5)</span>, <span class="math">(3, 9)</span>, a parábola que melhor ajusta os pontos é <br /><span class="math"><em>Q</em>(<em>x</em>) = 0, 95 + 0, 45<em>x</em> + 0, 75<em>x</em><sup>2</sup>.</span><br /> Usando esse ajuste para calcular as derivadas, temos: <br /><span class="math"><em>Q</em>′(<em>x</em>) = 0, 45 + 1, 5<em>x</em></span><br /> e <br /><span class="math">$$\begin{aligned}
&amp;&amp;y'(x_1)\approx Q'(x_1)=0,45, \qquad\qquad y'(x_2)\approx Q'(x_2)=1,95, \\&amp;&amp; y'(x_3)\approx Q'(x_3)=3,45 \qquad ~ \hbox{e} ~ \qquad y'(x_4)\approx Q'(x_4)=4,95\end{aligned}$$</span><br /></p>
<p>Agora olhe o gráfico da seguinte tabela de pontos. <br /><span class="math">$$\begin{array}{|c|c|}
\hline
x&amp;y\\
\hline
0    &amp; 1,95  \\
\hline
    1&amp;     1,67  \\
		\hline
    2 &amp;    3,71  \\
		\hline
    3  &amp;   3,37  \\
		\hline
    4   &amp;  5,12   \\
		\hline
    5&amp;     5,79  \\
		\hline
    6 &amp;    7,50  \\
		\hline
    7  &amp;   7,55  \\
		\hline
    8   &amp;  9,33  \\
		\hline
    9   &amp;  9,41   \\
		\hline
    10  &amp;  11,48  \\
		\hline
\end{array}$$</span><br /></p>
<p><embed src="./cap_derint/pics/graf_der.eps" /></p>
<p>Observe que as derivadas calculadas por diferenças finitas oscilam entre um valor pequeno e um grande em cada intervalo e além disso, a fórmula progressiva difere da regressiva significantemente. Por exemplo, por diferenças regressivas <span class="math">$f'(7)\approx \frac{(7,55 -  7,50)}{1}=0,05$</span> e por diferenças progressivas <span class="math">$f'(7)\approx \frac{(9,33 -  7,55)}{1}=1,78$</span>. A melhor forma de calcular a derivada aqui é fazer um ajuste de curva. A reta que melhor ajusta os dados da tabela é <span class="math"><em>y</em> = <em>f</em>(<em>x</em>) = 1, 2522727 + 0, 9655455<em>x</em></span>. Usando esse ajuste, temos <span class="math"><em>f</em>′(7) ≈ 0, 9655455</span>.</p>
<h2 id="exercícios-18" class="unnumbered">Exercícios</h2>
<p>Expanda a função suave <span class="math"><em>f</em>(<em>x</em>)</span> em um polinômio de Taylor adequado para obter as seguintes aproximações:</p>
<ul>
<li><p><span class="math">$f'(x)=\frac{f(x+h)-f(x)}{h}+O(h)$</span></p></li>
<li><p><span class="math">$f'(x)=\frac{f(x)-f(x-h)}{h}+O(h)$</span></p></li>
<li><p><span class="math">$f'(x)=\frac{f(x+h)-f(x-h)}{2h}+O(h^2)$</span></p></li>
<li><p><span class="math">$f''(x)=\frac{f(x+h)-2f(x)+f(x-h)}{h^2}+O(h^2)$</span></p></li>
</ul>
<p>Use os esquemas numéricos do exercício [ex1] para aproximar as seguintes derivadas:</p>
<ul>
<li><p><span class="math"><em>f</em>′(<em>x</em>)</span> onde <span class="math"><em>f</em>(<em>x</em>) = sin(<em>x</em>)</span> e <span class="math"><em>x</em> = 2</span>.</p></li>
<li><p><span class="math"><em>f</em>′(<em>x</em>)</span> onde <span class="math"><em>f</em>(<em>x</em>) = <em>e</em><sup> − <em>x</em></sup></span> e <span class="math"><em>x</em> = 1</span>.</p></li>
<li><p><span class="math"><em>f</em>″(<em>x</em>)</span> onde <span class="math"><em>f</em>(<em>x</em>) = <em>e</em><sup> − <em>x</em></sup></span> e <span class="math"><em>x</em> = 1</span>.</p></li>
</ul>
<p>Use <span class="math"><em>h</em> = 10<sup> − 2</sup></span> e <span class="math"><em>h</em> = 10<sup> − 3</sup></span> e compare com os valores obtidos através da avaliação numérica das derivadas exatas.</p>
<p>Use a expansão da função <span class="math"><em>f</em>(<em>x</em>)</span> em torno de <span class="math"><em>x</em> = 0</span> em polinômios de Taylor para encontrar os coeficientes <span class="math"><em>a</em><sub>1</sub></span>, <span class="math"><em>a</em><sub>2</sub></span> e <span class="math"><em>a</em><sub>3</sub></span> tais que</p>
<ul>
<li><p><span class="math"><em>f</em>′(0) = <em>a</em><sub>1</sub><em>f</em>(0) + <em>a</em><sub>2</sub><em>f</em>(<em>h</em>) + <em>a</em><sub>3</sub><em>f</em>(2<em>h</em>) + <em>O</em>(<em>h</em><sup>2</sup>)</span></p></li>
<li><p><span class="math"><em>f</em>′(0) = <em>a</em><sub>1</sub><em>f</em>(0) + <em>a</em><sub>2</sub><em>f</em>( − <em>h</em>) + <em>a</em><sub>3</sub><em>f</em>( − 2<em>h</em>) + <em>O</em>(<em>h</em><sup>2</sup>)</span></p></li>
<li><p><span class="math"><em>f</em>′(0) = <em>a</em><sub>1</sub><em>f</em>( − <em>h</em><sub>1</sub>) + <em>a</em><sub>2</sub><em>f</em>(0) + <em>a</em><sub>3</sub><em>f</em>(<em>h</em><sub>2</sub>) + <em>O</em>(<em>h</em><sup>2</sup>),   |<em>h</em><sub>1</sub>|, |<em>h</em><sub>2</sub>| = <em>O</em>(<em>h</em>)</span></p></li>
<li><p><span class="math"><em>f</em>″(0) = <em>a</em><sub>1</sub><em>f</em>(0) + <em>a</em><sub>2</sub><em>f</em>(<em>h</em>) + <em>a</em><sub>3</sub><em>f</em>(2<em>h</em>) + <em>O</em>(<em>h</em>)</span></p></li>
<li><p><span class="math"><em>f</em>″(0) = <em>a</em><sub>1</sub><em>f</em>(0) + <em>a</em><sub>2</sub><em>f</em>( − <em>h</em>) + <em>a</em><sub>3</sub><em>f</em>( − 2<em>h</em>) + <em>O</em>(<em>h</em>)</span></p></li>
</ul>
<ul>
<li><p><span class="math">$f'(0)=\frac{-3f(0)+4f(h)-f(2h)}{2h} + O(h^2)$</span></p></li>
<li><p><span class="math">$f'(0)=\frac{3f(0)-4f(-h)+f(-2h)}{2h} + O(h^2)$</span></p></li>
<li><p><span class="math">$f'(0)=\frac{1}{h_1+h_2}l\left[-\frac{h_2}{h_1}f(-h_1) +\left(\frac{h_2}{h_1}-\frac{h_1}{h_2}\right)f(0)+ \frac{h_1}{h_2}f(h_2)\right]$</span></p></li>
<li><p><span class="math">$f''(0)=\frac{f(0)-2f(h)+f(2h)}{h^2}+O(h)$</span></p></li>
<li><p><span class="math">$f''(0)=\frac{f(0)-2f(-h)+f(-2h)}{h^2}+O(h)$</span></p></li>
</ul>
<p>As tensões na entrada, <span class="math"><em>v</em><sub><em>i</em></sub></span>, e saída, <span class="math"><em>v</em><sub><em>o</em></sub></span>, de um amplificador foram medidas em regime estacionário conforme tabela abaixo. <br /><span class="math">$$\begin{array}{|c|c|c|c|c|c|c|c|c|c|c|}
\hline
    0. &amp;   0.5  &amp;   1.   &amp;   1.5  &amp;   2. &amp;     2.5   &amp;  3.  &amp;    3.5  &amp;   4.  &amp;    4.5  &amp;   5.\\
 \hline
 0.  &amp;  1.05  &amp;  1.83  &amp;  2.69  &amp;  3.83 &amp;   4.56 &amp;   5.49 &amp;   6.56  &amp;  6.11 &amp;   7.06  &amp;  8.29\\
 \hline
\end{array}$$</span><br /> onde a primeira linha é a tensão de entrada em volts e a segunda linha é tensão de saída em volts. Sabendo que o ganho é definido como <br /><span class="math">$$\frac{\partial v_o}{\partial v_i}.$$</span><br /> Calcule o ganho quando <span class="math"><em>v</em><sub><em>i</em></sub> = 1</span> e <span class="math"><em>v</em><sub><em>i</em></sub> = 4.5</span> usando as seguintes técnicas:</p>
<ul>
<li><p>Derivada primeira numérica de primeira ordem usando o próprio ponto e o próximo.</p></li>
<li><p>Derivada primeira numérica de primeira ordem usando o próprio ponto e o anterior.</p></li>
<li><p>Derivada primeira numérica de segunda ordem usando o ponto anterior e o próximo.</p></li>
<li><p>Derivada primeira analítica da função do tipo <span class="math"><em>v</em><sub>0</sub> = <em>a</em><sub>1</sub><em>v</em><sub><em>i</em></sub> + <em>a</em><sub>3</sub><em>v</em><sub><em>i</em></sub><sup>3</sup></span> que melhor se ajusta aos pontos pelo critério dos mínimos quadrados.</p></li>
</ul>
<p><br /><span class="math">$$\begin{array}{|c|c|c|c|c|}
\hline
 Caso &amp;  a  &amp;   b &amp;   c   &amp;   d \\
 \hline
 v_i=1 &amp;    &amp; ~\hspace{50pt}~  &amp;   &amp; ~\hspace{50pt}~ \\
 \hline
v_i=4.5 &amp;~\hspace{50pt}~    &amp;   &amp;  ~\hspace{50pt}~   &amp;\\
 \hline
\end{array}$$</span><br /> Dica:</p>
<pre><code>y=[0 1.05 1.83 2.69 3.83 4.56 5.49 6.56 6.11 7.06 8.29]</code></pre>
<p><br /><span class="math">$$\begin{array}{|c|c|c|c|c|}
\hline
 Caso &amp;  a  &amp;   b &amp;   c   &amp;   d \\
 \hline
 v_i=1 &amp; 1.72   &amp; 1.56  &amp;  1.64 &amp; 1.86 \\
 \hline
v_i=4.5 &amp;2.46    &amp; 1.90  &amp;  2.18  &amp;1.14  \\
 \hline
\end{array}$$</span><br /></p>
<h2 id="problemas-de-valor-contorno">Problemas de valor contorno</h2>
<p>Nesta seção usaremos a aproximação numérica da derivada para resolver problemas de valor de contorno da forma <br /><span class="math">$$\left\{\begin{array}{l}-u_{xx}=f(x,u),~~ a&lt;x&lt;b.\\
u(a)=u_a\\
u(b)=u_b\end{array}
\right.$$</span><br /> Resolver numericamente o problema acima exige uma discretização do domínio <span class="math">[<em>a</em>, <em>b</em>]</span>, ou seja, dividir o domínio em <span class="math"><em>N</em></span> partes iguais, definindo <br /><span class="math">$$h=\frac{b-a}{N}$$</span><br /> O conjunto de abcissas <span class="math"><em>x</em><sub><em>i</em></sub></span>, <span class="math"><em>i</em> = 1, ..., <em>N</em> + 1</span> formam uma malha para o problema discreto. Nosso objetivo é encontrar as ordenadas <span class="math"><em>u</em><sub><em>i</em></sub> = <em>u</em>(<em>x</em><sub><em>i</em></sub>)</span> que satisfazem a versão discreta: <br /><span class="math">$$\left\{\begin{array}{l}-\frac{u_{i+1}-2u_i+u_{i-1}}{h^2}=f(x_i,u_i),~~ 2\leq i\leq N.\\
u_1=u_a\\
u_{N+1}=u_b\end{array}
\right.$$</span><br /> O vetor solução <span class="math">(<em>u</em><sub><em>i</em></sub>)<sub><em>i</em> = 1</sub><sup><em>N</em> + 1</sup></span> do problema é solução do sistema acima, que é linear se <span class="math"><em>f</em></span> for linear em <span class="math"><em>u</em></span> e não linear caso contrário.</p>
<p>Encontre uma solução numérica para o problema de contorno: <br /><span class="math">$$\left\{\begin{array}{l}-u_{xx}+u=e^{-x},~~ 0&lt;x&lt;1.\\
u(0)=1\\
u(1)=2\end{array}
\right.$$</span><br /></p>
<p>Observe que <br /><span class="math">$$h=\frac{1}{N}$$</span><br /> e a versão discreta da equação é <br /><span class="math">$$\left\{\begin{array}{l}-\frac{u_{i+1}-2u_i+u_{i-1}}{h^2}+u_i=e^{-x_i},~~ 2\leq i\leq N.\\
u_1=1\\
u_{N+1}=2\end{array}
\right.$$</span><br /> ou seja, <br /><span class="math">$$\left\{\begin{array}{l}u_1=1\\-u_{i+1}+(2+h^2)u_i-u_{i-1}=h^2e^{-x_i},~~ 2\leq i\leq N.\\
u_{N+1}=2\end{array}
\right.$$</span><br /> que é um sistema linear. A sua forma matricial é: <br /><span class="math">$$\left[\begin{array}{ccccccc}
1&amp;0&amp;0&amp;\cdots&amp;0&amp;0&amp;0\\
-1&amp;2+h^2&amp;-1&amp;\cdots&amp;0&amp;0&amp;0\\
0&amp;-1&amp;2+h^2&amp;\cdots&amp;0&amp;0&amp;0\\
\vdots&amp;&amp;&amp;&amp;\ddots&amp;&amp;\\
0&amp;0&amp;0&amp;\cdots&amp;-1&amp;2+h^2&amp;-1\\
0&amp;0&amp;0&amp;\cdots&amp;0&amp;0&amp;1\\
\end{array}\right]
\left[\begin{array}{c}u_1\\u_2\\u_3\\ \vdots\\ u_{N}\\u_{N+1}\end{array}\right]=
\left[\begin{array}{c}1\\h^2e^{-x_2}\\h^2e^{-x_3}\\ \vdots\\ h^2e^{-x_N}\\2\end{array}\right]$$</span><br /> Para <span class="math"><em>N</em> = 10</span>, temos a seguinte solução: <br /><span class="math">$$\left[\begin{array}{c} 1,000000\\  1,0735083  \\1,1487032 \\ 1,2271979\\  1,3105564\\  1,4003172\\  1,4980159\\  1,6052067\\  1,7234836\\  1,8545022\\2,000000\end{array}\right]$$</span><br /></p>
<h2 id="exercícios-19" class="unnumbered">Exercícios</h2>
<p>Considere o seguinte problema de valor de contorno para a equação de calor no estado estacionário: <br /><span class="math">$$\left\{\begin{array}{l}-u_{xx}=32,~~ 0&lt;x&lt;1.\\
u(0)=5\\
u(1)=10\end{array}
\right.$$</span><br /></p>
<p>Defina <span class="math"><em>u</em><sub><em>j</em></sub> = <em>u</em>(<em>x</em><sub><em>j</em></sub>)</span> onde <span class="math"><em>x</em><sub><em>j</em></sub> = (<em>j</em> − 1)<em>h</em></span> e <span class="math"><em>j</em> = 1, …, 5</span>. Aproxime a derivada segunda por um esquema de segunda ordem e transforme a equação diferencial em um sistema de equações lineares. Escreva este sistema linear na forma matricial e resolva-o. Faça o mesmo com o dobro de subintervalos, isto é, com malha de 9 pontos.</p>
<p><br /><span class="math">$$\left[
  \begin{array}{ccccc}
         1 &amp; 0&amp; 0&amp; 0&amp; 0\\
         -1 &amp; 2 &amp; -1 &amp;0&amp;0\\
         0&amp;-1 &amp; 2 &amp; -1 &amp;0\\
         0&amp;0&amp;-1 &amp; 2 &amp; -1 \\
         0 &amp; 0&amp; 0&amp; 0&amp; 1\\
        \end{array}
\right]
\left[
  \begin{array}{c}
     u_1\\ u_2\\u_3\\u_4 \\ u_5
   \end{array}
\right]
=
\left[
  \begin{array}{c}
     5\\ 2\\2\\2 \\ 10
   \end{array}
\right]$$</span><br /></p>
<p>Solução: [5, 9.25, 11.5, 11.75, 10]</p>
<p><br /><span class="math">$$\left[
  \begin{array}{ccccccccc}
         1 &amp; 0&amp; 0&amp; 0&amp; 0&amp; 0&amp; 0&amp; 0&amp; 0\\
         -1 &amp; 2 &amp; -1 &amp;0&amp;0&amp; 0&amp; 0&amp; 0&amp; 0\\
         0&amp;-1 &amp; 2 &amp; -1 &amp;0&amp; 0&amp; 0&amp; 0&amp; 0\\
         0&amp;0&amp;-1 &amp; 2 &amp; -1 &amp; 0&amp; 0&amp; 0&amp; 0\\
         0&amp;0&amp;0&amp;-1 &amp; 2 &amp; -1 &amp; 0&amp; 0&amp; 0\\
         0&amp;0&amp;0&amp;0&amp;-1 &amp; 2 &amp; -1 &amp; 0&amp; 0\\
         0&amp;0&amp;0&amp;0&amp;0&amp;-1 &amp; 2 &amp; -1 &amp; 0\\
         0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;-1 &amp; 2 &amp; -1\\
         0 &amp; 0&amp; 0&amp; 0&amp; 0&amp; 0&amp; 0&amp; 0&amp; 1\\
        \end{array}
\right]
\left[
  \begin{array}{c}
     u_1\\ u_2\\u_3\\u_4 \\u_5\\ u_6\\u_7\\u_8\\u_9
   \end{array}
\right]
=
\left[
  \begin{array}{c}
     5\\ 0.5\\0.5\\0.5\\ 0.5\\0.5\\0.5\\0.5 \\ 10
   \end{array}
\right]$$</span><br /></p>
<p>Solução: <span class="math">[5, 7.375, 9.25, 10.625, 11.5, 11.875, 11.75, 1.125, 10]</span></p>
<p>Considere o seguinte problema de valor de contorno para a equação de calor no estado estacionário: <br /><span class="math">$$\left\{\begin{array}{l}-u_{xx}=200e^{-(x-1)^2},~~ 0&lt;x&lt;2.\\
u(0)=120\\
u(2)=100\end{array}
\right.$$</span><br /> Defina <span class="math"><em>u</em><sub><em>j</em></sub> = <em>u</em>(<em>x</em><sub><em>j</em></sub>)</span> onde <span class="math"><em>x</em><sub><em>j</em></sub> = (<em>j</em> − 1)<em>h</em></span> e <span class="math"><em>j</em> = 1, …, 21</span>. Aproxime a derivada segunda por um esquema de segunda ordem e transforme a equação diferencial em um sistema de equações lineares. Resolva o sistema linear obtido.</p>
<p>120. 133.56 146.22 157.83 168.22 177.21 184.65 190.38 194.28 196.26 196.26 194.26 190.28 184.38 176.65 167.21 156.22 143.83 130.22 115.56 100.</p>
<p>Considere o seguinte problema de valor de contorno para a equação de calor no estado estacionário: <br /><span class="math">$$\left\{\begin{array}{l}-u_{xx}=200e^{-(x-1)^2},~~ 0&lt;x&lt;2.\\
u'(0)=0\\
u(2)=100\end{array}
\right.$$</span><br /> Defina <span class="math"><em>u</em><sub><em>j</em></sub> = <em>u</em>(<em>x</em><sub><em>j</em></sub>)</span> onde <span class="math"><em>x</em><sub><em>j</em></sub> = (<em>j</em> − 1)<em>h</em></span> e <span class="math"><em>j</em> = 1, …, 21</span>. Aproxime a derivada segunda por um esquema de segunda ordem, a derivada primeira na fronteira por um esquema de primeira ordem e transforme a equação diferencial em um sistema de equações lineares. Resolva o sistema linear obtido.</p>
<p>391.13 391.13 390.24 388.29 385.12 380.56 374.44 366.61 356.95 345.38 331.82 316.27 298.73 279.27 257.99 234.99 210.45 184.5 157.34 129.11 100.</p>
<p>Considere o seguinte problema de valor de contorno para a equação de calor no estado estacionário com um termo não-linear de radiação: <br /><span class="math">$$\left\{\begin{array}{l}-u_{xx}=100- \frac{u^4}{10000},~~ 0&lt;x&lt;2.\\
u(0)=0\\
u(2)=10\end{array}
\right.$$</span><br /> Defina <span class="math"><em>u</em><sub><em>j</em></sub> = <em>u</em>(<em>x</em><sub><em>j</em></sub>)</span> onde <span class="math"><em>x</em><sub><em>j</em></sub> = (<em>j</em> − 1)<em>h</em></span> e <span class="math"><em>j</em> = 1, …, 21</span>. Aproxime a derivada segunda por um esquema de segunda ordem e transforme a equação diferencial em um sistema de equações não lineares. Resolva o sistema obtido. Expresse a solução com dois algarismos depois do separador decimal. Dica: Veja problema 38 da lista 2, seção de sistemas não lineares.</p>
<p>0., 6.57, 12.14, 16.73, 20.4, 23.24, 25.38, 26.93 , 28, 28.7, 29.06, 29.15, 28.95, 28.46, 27.62 , 26.36, 24.59, 22.18, 19.02, 14.98, 10.</p>
<p>Considere o seguinte problema de valor de contorno para a equação de calor no estado estacionário com um termo não-linear de radiação e um termo de convecção: <br /><span class="math">$$\left\{\begin{array}{l}-u_{xx}+3u_x=100- \frac{u^4}{10000},~~ 0&lt;x&lt;2.\\
u'(0)=0\\
u(2)=10\end{array}
\right.$$</span><br /> Defina <span class="math"><em>u</em><sub><em>j</em></sub> = <em>u</em>(<em>x</em><sub><em>j</em></sub>)</span> onde <span class="math"><em>x</em><sub><em>j</em></sub> = (<em>j</em> − 1)<em>h</em></span> e <span class="math"><em>j</em> = 1, …, 21</span>. Aproxime a derivada segunda por um esquema de segunda ordem, a derivada primeira na fronteira por um esquema de primeira ordem, a derivada primeira no interior por um esquema de segunda ordem e transforme a equação diferencial em um sistema de equações não lineares. Resolva o sistema obtido.</p>
<p>u(0)=31.62, u(1)=31.50, u(1.9)=18.17</p>
<p>Considere o seguinte problema de valor de contorno: <br /><span class="math">$$\left\{\begin{array}{l}-u''+2u'=e^{-x}- \frac{u^2}{100},~~ 1&lt;x&lt;4.\\
u'(1)+u(1)=2\\
u'(4)=-1\end{array}
\right.$$</span><br /> Defina <span class="math"><em>u</em><sub><em>j</em></sub> = <em>u</em>(<em>x</em><sub><em>j</em></sub>)</span> onde <span class="math"><em>x</em><sub><em>j</em></sub> = 1 + (<em>j</em> − 1)<em>h</em></span> e <span class="math"><em>j</em> = 1, …, 101</span>. Aproxime a derivada segunda por um esquema de segunda ordem, a derivada primeira na fronteira por um esquema de primeira ordem, a derivada primeira no interior por um esquema de segunda ordem e transforme a equação diferencial em um sistema de equações não lineares. Resolva o sistema obtido.</p>
<p>u(1)=1.900362, u(2.5)=1.943681, u(4)=1.456517</p>
<h2 id="integração-numérica">Integração numérica</h2>
<p>Considere o problema de calcular a área entre uma função positiva, o eixo <span class="math"><em>x</em></span> e as retas <span class="math"><em>x</em> = <em>a</em></span> e <span class="math"><em>x</em> = <em>b</em></span>. O valor exato dessa área é calculada fazendo uma aproximação por retângulos com bases iguais e depois tomando o limite quando o número de retângulos tende ao infinito: <br /><span class="math">$$A=\lim_{n\to\infty}\sum_{i=1}^nf(x_i)h_n,$$</span><br /> onde <span class="math">$h_n=\frac{b-a}{n}$</span> é o tamanho da base dos retângulo e <span class="math"><em>f</em>(<em>x</em><sub><em>i</em></sub>)</span>, <span class="math">1 ≤ <em>i</em> ≤ <em>n</em></span>, <span class="math"><em>a</em> + (<em>i</em> − 1)<em>h</em> ≤ <em>x</em><sub><em>i</em></sub> ≤ <em>a</em> + <em>i</em><em>h</em></span>, é a altura dos retângulos. Essa definição é generalizada para cálculo de integrais num intervalo <span class="math">[<em>a</em>, <em>b</em>]</span>: <br /><span class="math">$$\int_a^bf(x)dx=\lim_{n\to\infty}\sum_{i=1}^nf(x_i)h_n.$$</span><br /> A figura abaixo mostra um exemplo quando <span class="math"><em>f</em>(<em>x</em>) = <em>x</em><sup>2</sup> + 1</span>, <span class="math">0 ≤ <em>x</em> ≤ 2</span>. Temos a aproximação por um retângulo com base <span class="math"><em>h</em><sub>1</sub> = 2</span>, depois com dois retângulos de base <span class="math"><em>h</em><sub>2</sub> = 1</span> e, finalmente com quatro retângulo de bases <span class="math"><em>h</em><sub>3</sub> = 0, 5</span>.</p>
<p><embed src="./cap_derint/pics/int_1.eps" /></p>
<p>Os valores aproximados para a integral são dados na tabela: <br /><span class="math">$$\begin{array}{|c|c|c|c|c|}
\hline
&amp;h_1=2&amp;h_2=1&amp;h_3=0,5&amp;h_4=0,25\\
\hline
\int_0^2(x^2+1)dx&amp;h_1f(1)=4&amp;h_2f(0,5)+h_2f(1,5)=4,5&amp;4,625&amp;4,65625\\
\hline
\end{array}$$</span><br /> Observe que <br /><span class="math">$$\int_0^2(x^2+1)dx=\left[\frac{x^3}{3}+x\right]_0^2=\frac{8}{3}+2=4,6666667$$</span><br /></p>
<h3 id="regras-de-newton-cotes">Regras de Newton-Cotes</h3>
<p>A integral de uma função num intervalo <span class="math">[<em>a</em>, <em>b</em>]</span>, também chamada de quadratura numérica, é aproximada pela soma: <br /><span class="math">$$\int_a^bf(x)dx\approx\sum_{i=1}^na_if(x_i),$$</span><br /> onde <span class="math"><em>x</em><sub><em>i</em></sub></span>, <span class="math">1 ≤ <em>i</em> ≤ <em>n</em></span>, são pontos distintos do intervalo <span class="math">[<em>a</em>, <em>b</em>]</span>. Nesta definição, a integral <span class="math">∫<sub>0</sub><sup>2</sup>(<em>x</em><sup>2</sup> + 1)<em>d</em><em>x</em></span> usando uma aproximação por retângulo usa apenas um ponto, o ponto médio do intervalo (<span class="math"><em>x</em><sub>1</sub> = 1</span>), e a soma se reduz a uma parcela (<span class="math">(2 − 0)<em>f</em>(1)</span>). A fórmula geral para essa caso, chamado de regra do ponto médio é: <br /><span class="math">$${\label{ponto_médio_1}}
\int_a^bf(x)dx\approx (b-a)f\left(\frac{a+b}{2}\right):=hf(x_1).$$</span><br /></p>
<h4 id="regra-do-ponto-médio">Regra do ponto médio</h4>
<p>A regra do ponto médio ([ponto<sub>m</sub>édio<sub>1</sub>]) pode ser deduzida mais formalmente usando a expansão de Taylor <br /><span class="math">$$f(x)=f(x_1)+f'(x_1)(x-x_1)+\frac{f''(\xi(x))}{2}(x-x_1)^2$$</span><br /> que leva a integral <br /><span class="math">$$\int_a^b f(x)dx=\int_a^b f(x_1) dx+f'(x_1)\int_a^b(x-x_1)dx +\int_a^b\frac{f''(\xi(x))}{2}(x-x_1)^2dx.$$</span><br /> Usando o teorema do valor médio para integrais e que <span class="math"><em>h</em> = <em>b</em> − <em>a</em></span> e <span class="math"><em>x</em><sub>1</sub> = (<em>a</em> + <em>b</em>)/2</span>, temos: <br /><span class="math">$$\begin{aligned}
\int_a^b f(x)dx &amp;= h f(x_1) + f'(x_1)\int_a^b(x-x_1)dx+f''(\eta)\int_a^b\frac{1}{2}(x-x_1)^2dx\\
&amp;= h f(x_1) +f'(x_1)\left[\frac{(x-x_1)^2}{2}\right]_a^b+f''(\eta)\left[\frac{1}{6}(x-x_1)^3\right]_a^b\\
&amp;= h f(x_1) +f'(x_1)\left[\frac{(b-x_1)^2}{2}-\frac{(a-x_1)^2}{2}\right]\\
&amp;+f''(\eta)\left[\frac{1}{6}(b-x_1)^3-\frac{1}{6}(a-x_1)^3\right]\\
&amp;= h f(x_1) +\frac{h^3f''(\eta)}{3}.\end{aligned}$$</span><br /> para <span class="math"><em>a</em> ≤ <em>η</em> ≤ <em>b</em></span>.</p>
<p>Use a regra do ponto médio para aproximar a integral <br /><span class="math">∫<sub>0</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em>.</span><br /> Depois divida a integral em duas <br /><span class="math">∫<sub>0</sub><sup>1/2</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em> + ∫<sub>1/2</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em>.</span><br /> e aplique a regra do ponto médio em cada uma delas. Finalmente, repita o processo dividindo em quatro integrais.</p>
<p>Usando o intervalo <span class="math">[0, 1]</span>, temos <span class="math"><em>h</em> = 1</span> e <span class="math"><em>x</em><sub>1</sub> = 1/2</span>. A regra do ponto médio resulta em <br /><span class="math">∫<sub>0</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em> ≈ 1 ⋅ <em>e</em><sup> − 1/4</sup> = 0, 7788008</span><br /> Usando dois intervalos, <span class="math">[0, 1/2]</span> e <span class="math">[1/2, 1]</span> e usando a regra do ponto médio em cada um dos intervalos, temos: <br /><span class="math">∫<sub>0</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em> ≈ 0, 5 ⋅ <em>e</em><sup> − 1/16</sup> + 0, 5 ⋅ <em>e</em><sup> − 9/16</sup>) = 0, 4697065 + 0, 2848914 = 0, 7545979</span><br /> Agora, usando quatro intervalos, temos <br /><span class="math">∫<sub>0</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em> ≈ 0, 25 ⋅ <em>e</em><sup> − 1/64</sup> + 0, 25 ⋅ <em>e</em><sup> − 9/64</sup> + 0, 25 ⋅ <em>e</em><sup> − 25/64</sup> + 0, 25 ⋅ <em>e</em><sup> − 49/64</sup> = 0, 7487471</span><br /> Observe que o valor da integral é <br /><span class="math">∫<sub>0</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em> = 0, 7468241330.</span><br /></p>
<p>A forma natural de obter as regras de integração é usar o polinômio de Lagrange que passa pelo pontos <span class="math">{(<em>x</em><sub><em>i</em></sub>, <em>f</em>(<em>x</em><sub><em>i</em></sub>))}<sub><em>i</em> = 1</sub><sup><em>n</em></sup></span> <br /><span class="math">$$f(x)=P_n(x)+\text{termo de erro}=\sum_{i=1}^nf(x_i)L_i(x) +\prod_{i=1}^n(x-x_i)\frac{f^{(n+1)}(\xi(x))}{(n+1)!}.$$</span><br /> e integramos <br /><span class="math">$$\int_a^bf(x)dx=\sum_{i=1}^n\left[f(x_i)\int_a^bL_i(x)dx\right] +\frac{1}{(n+1)!}\int_a^b\prod_{i=1}^n(x-x_i)f^{(n+1)}(\xi(x))dx.$$</span><br /> A fórmula de quadratura então é <br /><span class="math">$$\int_a^bf(x)dx\approx\sum_{i=1}^na_if(x_i),$$</span><br /> onde <br /><span class="math"><em>a</em><sub><em>i</em></sub> = ∫<sub><em>a</em></sub><sup><em>b</em></sup><em>L</em><sub><em>i</em></sub>(<em>x</em>)<em>d</em><em>x</em></span><br /></p>
<h4 id="regra-do-trapézio">Regra do Trapézio</h4>
<p>A regra do trapézio consiste em aproximar a integral por um trapézio em vez de um retângulo, como fizemos. Para isso, o polinômio de Lagrange deve ser uma reta, como mostra a figura.</p>
<p><embed src="./cap_derint/pics/int_2.eps" /></p>
<p>O polinômio de Lagrange de primeira ordem que passa por <span class="math">(<em>x</em><sub>0</sub>, <em>f</em>(<em>x</em><sub>0</sub>)) := (<em>a</em>, <em>f</em>(<em>a</em>))</span> e <span class="math">(<em>x</em><sub>1</sub>, <em>f</em>(<em>x</em><sub>1</sub>)) := (<em>b</em>, <em>f</em>(<em>b</em>))</span> é dado por <br /><span class="math">$$P_1(x)=f(x_0)\frac{(x-x_0)}{(x_1-x_0)}+f(x_1)\frac{(x-x_1)}{(x_0-x_1)}=f(x_0)\frac{(x-x_0)}{h}-f(x_1)\frac{(x-x_1)}{h},$$</span><br /> onde <span class="math"><em>h</em> = <em>x</em><sub>1</sub> − <em>x</em><sub>0</sub></span>. Podemos integrar a função <span class="math"><em>f</em>(<em>x</em>)</span> aproximando-a por esse polinômio: <br /><span class="math">$$\begin{split}
    \int_a^bf(x)dx &amp;= f(x_0)\int_a^b\frac{(x-x_0)}{h}dx-f(x_1)\int_a^b\frac{(x-x_1)}{h}dx\\
    &amp;+\frac{1}{2!}\int_a^b(x-x_0)(x-x_1)f''(\xi(x))dx.   
  \end{split}$$</span><br /> Pelo teorema do valor médio, existe <span class="math"><em>a</em> ≤ <em>η</em> ≤ <em>b</em></span> tal que <span class="math">∫<sub><em>a</em></sub><sup><em>b</em></sup><em>f</em>(<em>ξ</em>(<em>x</em>))<em>g</em>(<em>x</em>)<em>d</em><em>x</em> = <em>f</em>(<em>η</em>)∫<sub><em>a</em></sub><sup><em>b</em></sup><em>g</em>(<em>x</em>)<em>d</em><em>x</em></span> e, portanto, <br /><span class="math">$$\begin{split}
    \int_a^bf(x)dx&amp;= f(x_0)\left[\frac{(x-x_0)^2}{2h}\right]_{x_0}^{x_1}-f(x_1)\left[\frac{(x-x_1)^2}{2h}\right]_{x_0}^{x_1}\\
    &amp;+ \frac{f''(\eta)}{2}\left[\frac{x^3}{3}-\frac{x^2}{2}(x_1+x_0)+x_0x_1x\right]_{x_0}^{x_1}\\
&amp;= f(x_0)\frac{(x_1-x_0)^2}{2h}+f(x_1)\frac{(x_0-x_1)^2}{2h}\\
&amp;+ \frac{f''(\eta)}{2}\left(\frac{x_1^3}{3}-\frac{x_1^2}{2}(x_1+x_0)+x_0x_1x_1-\frac{x_0^3}{3}+\frac{x_0^2}{2}(x_1+x_0)-x_0x_1x_0\right)\\
&amp;= f(x_0)\frac{h^2}{2h}+f(x_1)\frac{h^2}{2h}\\
&amp;+ \frac{f''(\eta)}{2}\frac{2x_1^3-3x_1^2(x_1+x_0)+6x_1^2x_0-2x_0^3+3x_0^2(x_1+x_0)-6x_1x_0^2}{6}\\
&amp;= \frac{h}{2}(f(x_0)+f(x_1))+\frac{f''(\eta)}{12}\left(x_0^3-3x_0^2x_1+3x_1^2x_0-x_1^3\right)\\
&amp;= \frac{h}{2}(f(x_0)+f(x_1))-\frac{h^3f''(\eta)}{12}    
  \end{split}$$</span><br /></p>
<p>Use a regra do trapézio para aproximar a integral <br /><span class="math">∫<sub>0</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em>.</span><br /> Depois divida a integral em duas <br /><span class="math">∫<sub>0</sub><sup>1/2</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em> + ∫<sub>1/2</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em>.</span><br /> e aplica a regra do trapézio em cada uma delas. Finalmente, repita o processo dividindo em quatro integrais.</p>
<p>Usando o intervalo <span class="math">[0, 1]</span>, temos <span class="math"><em>h</em> = 1</span>, <span class="math"><em>x</em><sub>0</sub> = 0</span> e <span class="math"><em>x</em><sub>1</sub> = 1</span>. A regra do trapézio resulta em <br /><span class="math">$$\int_0^1e^{-x^2}dx\approx \frac{1}{2}(e^{0}+e^{-1})=0,6839397$$</span><br /> Usando dois intervalos, <span class="math">[0, 1/2]</span> e <span class="math">[1/2, 1]</span> e usando a regra do trapézio em cada um dos intervalos, temos: <br /><span class="math">$$\begin{aligned}
\int_0^1e^{-x^2}dx &amp;\approx \frac{0,5}{2}\left(e^{0}+e^{-1/4}\right) + \frac{0,5}{2}\left(e^{-1/4}+e^{-1}\right) \\
&amp;= 0,4447002+0,2866701 =0,7313703.\end{aligned}$$</span><br /> Agora, usando quatro intervalos, temos <br /><span class="math">$$\begin{aligned}
\int_0^1e^{-x^2}dx &amp;\approx \frac{0,25}{2}\left(e^{0}+e^{-1/16}\right) + \frac{0,25}{2}\left(e^{-1/16}+e^{-1/4}\right) \\
&amp;+ \frac{0,25}{2}\left(e^{-1/4}+e^{-9/16}\right)+\frac{0,25}{2}\left(e^{-9/16}+e^{-1}\right) \\
&amp;= 0,7429841\end{aligned}$$</span><br /></p>
<h4 id="regra-de-simpson">Regra de Simpson</h4>
<p>A regra de Simpson consiste em aproximar a integral usando três pontos do intervalo: <br /><span class="math">$$x_0=a,\qquad x_1:=\frac{a+b}{2}=x_0+h \qquad \text{e}\qquad x_2:=b=x_1+h.$$</span><br /> com <span class="math"><em>h</em> = (<em>b</em> − <em>a</em>)/2</span>. Para isso, o polinômio de Lagrange deve ser uma parábola: <br /><span class="math">$$\begin{split}
    P_2(x) &amp;= f(x_0)\frac{(x-x_1)(x-x_2)}{(x_0-x_1)(x_0-x_2)} + f(x_1)\frac{(x-x_0)(x-x_2)}{(x_1-x_0)(x_1-x_2)}\\
    &amp;+ f(x_2)\frac{(x-x_0)(x-x_1)}{(x_2-x_0)(x_2-x_1)}.
  \end{split}$$</span><br /> Se usarmos o mesma metodologia da regra dos trapézios, calcularemos <br /><span class="math">$$\int_a^bf(x)dx=\int_a^bP_2(x)dx+\int_a^b\frac{(x-x_0)(x-x_1)(x-x_2)}{6}f'''(\xi(x))dx$$</span><br /> e obteremos o fórmula de Simpson com um erro de quarta ordem. O fato é que a regra de Simpson tem ordem cinco e, para isso, usaremos uma abordagem alternativa. Considere o polinômio de Taylor <br /><span class="math">$$f(x)=f(x_1)+f'(x_1)(x-x_1)+\frac{f''(x_1)}{2}(x-x_1)^2+\frac{f'''(x_1)}{6}(x-x_1)^3+\frac{f^{(4)}(\xi(x))}{24}(x-x_1)^4,$$</span><br /> onde <span class="math"><em>x</em><sub>0</sub> ≤ <em>ξ</em>(<em>x</em>) ≤ <em>x</em><sub>2</sub></span> e integre no intervalo <span class="math">[<em>a</em>, <em>b</em>] = [<em>x</em><sub>0</sub>, <em>x</em><sub>2</sub>]</span>: <br /><span class="math">$$\begin{split}
    \int_a^bf(x)dx&amp;= \left[f(x_1)(x-x_1)+f'(x_1)\frac{(x-x_1)^2}{2} + \frac{f''(x_1)}{6}(x-x_1)^3\right. \\
      &amp;\left. + \frac{f'''(x_1)}{24}(x-x_1)^4\right]_{x_0}^{x_2}\\
      &amp;+ \frac{1}{24}\int_{x_0}^{x_2}f^{(4)}(\xi(x))(x-x_1)^4dx,    
  \end{split}$$</span><br /> Pelo teorema do valor médio, existe <span class="math"><em>x</em><sub>0</sub> ≤ <em>η</em> ≤ <em>x</em><sub>2</sub></span> tal que <br /><span class="math">$$\begin{split}
    \int_a^bf(x)dx&amp;= \left[f(x_1)(x-x_1)+f'(x_1)\frac{(x-x_1)^2}{2}+\frac{f''(x_1)}{6}(x-x_1)^3\right.\\
    &amp;+\left.\frac{f'''(x_1)}{24}(x-x_1)^4\right]_{x_0}^{x_2}\\
    &amp;+ \frac{f^{(4)}(\eta)}{24}\int_{x_0}^{x_2}(x-x_1)^4dx\\
    &amp;= \left[f(x_1)(x-x_1)+f'(x_1)\frac{(x-x_1)^2}{2}+\frac{f''(x_1)}{6}(x-x_1)^3\right.\\
    &amp;+\left.\frac{f'''(x_1)}{24}(x-x_1)^4\right]_{x_0}^{x_2}\\
    &amp;+ \frac{f^{(4)}(\eta)}{120}\left[(x-x_1)^5\right]_{x_0}^{x_2}    
  \end{split}$$</span><br /> Usando o fato que <br /><span class="math">(<em>x</em><sub>2</sub> − <em>x</em><sub>1</sub>)<sup>3</sup> − (<em>x</em><sub>0</sub> − <em>x</em><sub>1</sub>)<sup>3</sup> = 2<em>h</em><sup>3</sup>, </span><br /> <br /><span class="math">(<em>x</em><sub>2</sub> − <em>x</em><sub>1</sub>)<sup>4</sup> − (<em>x</em><sub>0</sub> − <em>x</em><sub>1</sub>)<sup>4</sup> = 0</span><br /> e <br /><span class="math">(<em>x</em><sub>2</sub> − <em>x</em><sub>1</sub>)<sup>5</sup> − (<em>x</em><sub>0</sub> − <em>x</em><sub>1</sub>)<sup>5</sup> = 2<em>h</em><sup>5</sup>, </span><br /> temos <br /><span class="math">$$\int_a^bf(x)dx=2hf(x_1)+\frac{h^3}{3}f''(x_1)+\frac{h^5f^{(4)}(\eta)}{60}.$$</span><br /> Usando a diferenças finitas centrais para a derivada segunda: <br /><span class="math">$$f''(x_1)=\frac{f(x_0)-2f(x_1)+f(x_2)}{h^2}+\frac{h^2}{12}f^{(4)}(\eta_1),$$</span><br /> <span class="math"><em>x</em><sub>0</sub> ≤ <em>η</em><sub>1</sub> ≤ <em>x</em><sub>2</sub></span>, temos <br /><span class="math">$$\begin{aligned}
\int_a^bf(x)dx&amp;=&amp;2hf(x_1)+\frac{h^3}{3}\left(\frac{f(x_0)-2f(x_1)+f(x_2)}{h^2}+\frac{h^2}{12}f^{(4)}(\eta_1)\right)\\
&amp;+&amp;\frac{h^5f^{(4)}(\eta)}{60}\\
&amp;=&amp;\frac{h}{3}\left(f(x_0)+4f(x_1)+f(x_2)\right)-\frac{h^5}{12}\left(\frac{1}{3}f^{(4)}(\eta_1)-\frac{1}{5}f^{(4)}(\eta)\right).\end{aligned}$$</span><br /> Pode-se mostrar que é possível escolher <span class="math"><em>η</em><sub>2</sub></span> que substitua <span class="math"><em>η</em></span> e <span class="math"><em>η</em><sub>1</sub></span> com a seguinte estimativa <br /><span class="math">$$\int_a^bf(x)dx=\frac{h}{3}\left(f(x_0)+4f(x_1)+f(x_2)\right)-\frac{h^5}{90}f^{(4)}(\eta_2).$$</span><br /></p>
<p>Use a regra de Simpson para aproximar a integral <br /><span class="math">∫<sub>0</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em>.</span><br /> Depois divida a integral em duas <br /><span class="math">∫<sub>0</sub><sup>1/2</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em> + ∫<sub>1/2</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em>.</span><br /> e aplica a regra de Simpson em cada uma delas.</p>
<p>Usando o intervalo <span class="math">[0, 1]</span>, temos <span class="math"><em>h</em> = 1/2</span>, <span class="math"><em>x</em><sub>0</sub> = 0</span>, <span class="math"><em>x</em><sub>1</sub> = 1/2</span> e <span class="math"><em>x</em><sub>2</sub> = 1</span>. A regra de Simpson resulta em <br /><span class="math">$$\int_0^1e^{-x^2}dx\approx \frac{0,5}{3}(e^{0}+4e^{-1/4}+e^{-1})=0,7471804$$</span><br /> Usando dois intervalos, <span class="math">[0, 1/2]</span> e <span class="math">[1/2, 1]</span> e usando a regra do trapézio em cada um dos intervalos, temos: <br /><span class="math">$$\int_0^1e^{-x^2}dx\approx \frac{0,25}{3}(e^{0}+4e^{-1/16}+e^{-1/4})+\frac{0,25}{3}(e^{-1/4}+4e^{-9/16}+e^{-1})=0,7468554$$</span><br /></p>
<h3 id="regras-compostas">Regras compostas</h3>
<p>Vimos que em todas as estimativas de erro que derivamos, o erro depende do tamanho do intervalo de integração. Uma estratégia para reduzir o erro consiste em particionar o intervalo de integração em diversos subintervalos menores: <br /><span class="math">$$\int_{a}^b f(x)dx=\sum_{i=1}^{n} \int_{x_i}^{x_{i+1}} f(x)dx$$</span><br /> onde <span class="math"><em>x</em><sub><em>i</em></sub> = <em>a</em> + (<em>i</em> − 1)<em>h</em></span>, <span class="math"><em>h</em> = (<em>b</em> − <em>a</em>)/<em>n</em></span> e <span class="math">$i = 1,2,\dotsc,n+1$</span>, sendo <span class="math"><em>n</em></span> o número de subintervalos da partição do intervalo de integração. Depois, aplica-se um método simples de integração em cada subintervalo.</p>
<h4 id="método-composto-dos-trapézios">Método composto dos trapézios</h4>
<p>A <em>regra composta dos trapézios</em> assume a seguinte forma: <br /><span class="math">$$\begin{aligned}
  \int_{a}^b f(x)dx &amp;= \sum_{i=1}^{n} \int_{x_i}^{x_{i+1}}f(x)\,dx \\
  &amp;\approx \sum_{i=1}^{n} \frac{x_{i+1}-x_i}{2}\left[f(x_i)+f(x_{i+1})\right]\end{aligned}$$</span><br /> Como <span class="math"><em>h</em> = <em>x</em><sub><em>i</em> + 1</sub> − <em>x</em><sub><em>i</em></sub></span>, temos: <br /><span class="math">$$\begin{aligned}
\int_{a}^b f(x)\,dx &amp;\approx \frac{h}{2}\sum_{k=1}^{N_i}\left[f(x_k)+f(x_{k+1})\right]\\
&amp; = \frac{h}{2}\left[f(x_1)+2f(x_2)+2f(x_3)+\cdots + 2f(x_{N_i})+f(x_{N_i+1})\right]\\
&amp; = \frac{h}{2}\left[f(x_1) + f(x_{N_i+1})\right] + h\sum_{i=2}^{N_i} f(x_i)\end{aligned}$$</span><br /></p>
<h4 id="código-scilab-trapézio-composto">Código Scilab: Trapézio Composto</h4>
<p>O código Scilab abaixo é uma implementação do método do trapézio composto para calcular: <br /><span class="math">$$\int_a^b f(x)\,dx = \frac{h}{2}\left[f(x_1) + f(x_{n+1})\right] + h\sum_{i=2}^n f(x_i) + O(h^3),$$</span><br /> onde <span class="math"><em>h</em> = (<em>b</em> − <em>a</em>)/<em>n</em></span> e <span class="math"><em>x</em><sub><em>i</em></sub> = <em>a</em> + (<em>i</em> − 1)<em>h</em></span>, <span class="math">$i=1,2,\dotsc,n+1$</span>. Os parâmetros de entrada são: <code>f</code> o integrando definido como uma função no Scilab, <code>a</code> o limite inferior de integração, <code>b</code> o limite superior de integração, <code>n</code> o número de subintervalos desejado. A variável de saída é <code>y</code> e corresponde a aproximação calculada de <span class="math">∫<sub><em>a</em></sub><sup><em>b</em></sup><em>f</em>(<em>x</em>) <em>d</em><em>x</em></span>.</p>
<h4 id="método-composto-de-simpson">Método composto de Simpson</h4>
<p>Já a regra composta de Simpson assume a seguinte forma: <br /><span class="math">$$\begin{aligned}
  \int_{a}^b f(x)\,dx &amp;= \sum_{k=1}^{n} \int_{x_k}^{x_{k+1}} f(x)dx \\
  &amp;\approx \sum_{k=1}^{n} \frac{x_{x+1}-x_k}{6}\left[f(x_k) + 4f\left(\frac{x_{k+1}+x_k}{2}\right)+f(x_{k+1})\right]\end{aligned}$$</span><br /> onde, como anteriormente, <span class="math"><em>x</em><sub><em>k</em></sub> = <em>a</em> + (<em>k</em> − 1)<em>h</em></span>, <span class="math"><em>h</em> = (<em>b</em> − <em>a</em>)/<em>n</em></span> e <span class="math">$i = 1,2,\dotsc,n+1$</span>, sendo <span class="math"><em>n</em></span> o número de subintervalos da partição do intervalo de integração. Podemos simplificar o somatório acima, escrevendo: <br /><span class="math">$$\int_{a}^b f(x)\,dx \approx \frac{h}{3}\left[f(x_1) + 2\sum_{i=1}^{n-1} f(x_{2i+1}) + 4\sum_{i=1}^{n} f(x_{2i}) + f(x_{2n+1})\right] + O(h^5)$$</span><br /> onde, agora, <span class="math"><em>h</em> = (<em>b</em> − <em>a</em>)/(2<em>n</em>)</span>, <span class="math"><em>x</em><sub><em>i</em></sub> = <em>a</em> + (<em>i</em> − 1)<em>h</em></span>, <span class="math">$i=1,2,\dotsc,2n+1$</span>.</p>
<h4 id="código-scilab-simpson-composto">Código Scilab: Simpson Composto</h4>
<p>O código Scilab abaixo é uma implementação do método de Simpson composto para calcular: <br /><span class="math">$$\int_a^b f(x)\,dx = \frac{h}{3}\left[f(x_1) + 2\sum_{i=1}^{n-1} f(x_{2i+1}) + 4\sum_{i=1}^{n} f(x_{2i}) + f(x_{2n+1})\right] + O(h^3),$$</span><br /> onde <span class="math"><em>h</em> = (<em>b</em> − <em>a</em>)/(2<em>n</em>)</span> e <span class="math"><em>x</em><sub><em>i</em></sub> = <em>a</em> + (<em>i</em> − 1)<em>h</em></span>, <span class="math">$i=1,2,\dotsc,2n+1$</span>. Os parâmetros de entrada são: <code>f</code> o integrando definido como uma função no Scilab, <code>a</code> o limite inferior de integração, <code>b</code> o limite superior de integração, <code>n</code> o número de subintervalos desejado. A variável de saída é <code>y</code> e corresponde a aproximação calculada de <span class="math">∫<sub><em>a</em></sub><sup><em>b</em></sup><em>f</em>(<em>x</em>) <em>d</em><em>x</em></span>.</p>
<p>Calcule numericamente a integral <br /><span class="math">∫<sub>0</sub><sup>2</sup><em>x</em><sup>2</sup><em>e</em><sup><em>x</em><sup>2</sup></sup><em>d</em><em>x</em></span><br /> pelas regras compostas do ponto médio, trapézio e Simpson variando o número de intervalos<br /><span class="math"><em>N</em><sub><em>i</em></sub> = 1,  2,  3,  6,  12,  24,  48,  96</span>.</p>
<p><br /><span class="math">$$\begin{array}{|c|c|c|c|}
\hline
n&amp;\hbox{ponto médio}&amp;\hbox{Trapézios}&amp;\hbox{Simpson}\\\hline
1&amp;5,4365637&amp;218,3926&amp;76,421909\\\hline
2&amp;21,668412&amp;111,91458&amp;51,750469\\\hline
3&amp;31,678746&amp;80,272022&amp;47,876505\\\hline
6&amp;41,755985&amp;55,975384&amp;46,495785\\\hline
12&amp;45,137529&amp;48,865685&amp;46,380248\\\hline
24&amp;46,057757&amp;47,001607&amp;46,372373\\\hline
48&amp;46,292964&amp;46,529682&amp;46,37187\\\hline
96&amp;46,352096&amp;46,411323&amp;46,371838\\
\hline
\end{array}$$</span><br /></p>
<h3 id="o-método-de-romberg">O método de Romberg</h3>
<p>O método de Romberg é um método simplificado para construir quadraturas de alta ordem.</p>
<p>Considere o método de trapézios composto aplicado à integral <br /><span class="math">∫<sub><em>a</em></sub><sup><em>b</em></sup><em>f</em>(<em>x</em>)<em>d</em><em>x</em></span><br /> Defina <span class="math"><em>I</em>(<em>h</em>)</span> a aproximação desta integral pelo método dos trapézios composto com malha de largura constante igual a h. Aqui <span class="math">$h=\frac{b-a}{N_i}$</span> para algum <span class="math"><em>N</em><sub><em>i</em></sub></span> inteiro, i.e.: <br /><span class="math">$$I(h)=\frac{h}{2}\left[f(a)+2\sum_{j=2}^{N_i} f(x_j)+ f(b)\right],~~~N_i=\frac{b-a}{h}$$</span><br /></p>
<p>Se <span class="math"><em>f</em>(<em>x</em>)</span> é uma função analítica no intervalo <span class="math">(<em>a</em>, <em>b</em>)</span>, então a função <span class="math"><em>I</em>(<em>h</em>)</span> admite uma representação na forma <br /><span class="math"><em>I</em>(<em>h</em>) = <em>I</em><sub>0</sub> + <em>I</em><sub>2</sub><em>h</em><sup>2</sup> + <em>I</em><sub>4</sub><em>h</em><sup>4</sup> + <em>I</em><sub>6</sub><em>h</em><sup>6</sup> + …</span><br /></p>
<p>Para um demonstração, veja <span class="citation"></span>. Em especial observamos que <br /><span class="math">∫<sub><em>a</em></sub><sup><em>b</em></sup><em>f</em>(<em>x</em>)<em>d</em><em>x</em> = lim<sub><em>h</em> → 0</sub><em>I</em>(<em>h</em>) = <em>I</em><sub>0</sub></span><br /> Ou seja, o valor exato da integral procurada é dado pelo coeficiente <span class="math"><em>I</em><sub>0</sub></span>.</p>
<p>A ideia central do método de Romberg, agora, consiste em usar a extrapolação de Richardson para construir métodos de maior ordem a partir do métodos dos trapézios para o intervalo <span class="math">(<em>a</em>, <em>b</em>)</span></p>
<p>[exemplo<sub>r</sub>omberg<sub>1</sub>]Construção do método de quarta ordem. <br /><span class="math">$$\begin{aligned}
I(h)&amp;=&amp;I_0 + I_2 h^2 + I_4{h^4}+ I_6{h^6}+\ldots\\~\\
I\left(\frac{h}{2}\right)&amp;=&amp;I_0 + I_2 \frac{h^2}{4} + I_4\frac{h^4}{16}+ I_6\frac{h^6}{64}+\ldots\\\end{aligned}$$</span><br /> Usamos agora uma eliminação gaussiana para obter o termo <span class="math"><em>I</em><sub>0</sub></span>: <br /><span class="math">$$\begin{aligned}
\frac{4I(h/2)-I(h)}{3}=I_0-\frac{1}{4}I_4h^4-\frac{5}{16}I_6h^6+\ldots\end{aligned}$$</span><br /> Vamos agora aplicar a fórmula para <span class="math"><em>h</em> = <em>b</em> − <em>a</em></span>, <br /><span class="math">$$\begin{aligned}
I(h)&amp;=&amp; \frac{h}{2} \left[f(a)+f(b)\right]\\
I(h/2)&amp;=&amp; \frac{h}{4} \left[f(a)+2f\left(c\right)+f(b)\right],~~ c=\frac{a+b}{2}\\\end{aligned}$$</span><br /></p>
<p><br /><span class="math">$$\begin{aligned}
\frac{4I(h/2)-I(h)}{3}&amp;=&amp;\frac{h}{3}\left[f(a)+2f\left(c\right)+f(b)\right]-\frac{h}{6} \left[f(a)+f(b)\right]\\
&amp;=&amp;\frac{h}{6}\left[f(a)+4f\left(c\right)+f(b)\right]\end{aligned}$$</span><br /></p>
<p>Observe que esquema coincide com o método de Simpson.</p>
<p>A partir de agora, usaremos a seguinte notação <br /><span class="math">$$\begin{aligned}
R_{1,1}&amp;=&amp;I(h)\\
R_{2,1}&amp;=&amp;I(h/2)\\
R_{3,1}&amp;=&amp;I(h/4)\\
&amp;\vdots&amp;\\
R_{n,1}&amp;=&amp;I(h/2^{n-1})\end{aligned}$$</span><br /></p>
<p>Observamos que os pontos envolvidos na quadratura <span class="math"><em>R</em><sub><em>k</em>, 1</sub></span> são os mesmos pontos envolvidos na quadratura <span class="math"><em>R</em>(<em>k</em> − 1, 1)</span> acrescidos dos pontos centrais, assim, temos a seguinte fórmula de recorrência: <br /><span class="math">$$R_{k,1}=\frac{1}{2}R_{k-1,1}+\frac{h}{2^{k-1}} \sum_{i=1}^{2^{k-2}}f\left(a+(2i-1)\frac{h}{2^{k-1}}\right)$$</span><br /></p>
<p>Definimos <span class="math"><em>R</em><sub><em>k</em>, 2</sub></span> para <span class="math"><em>k</em> ≥ 2</span> como o esquema de ordem quatro obtido da fórmula do exemplo [exemplo<sub>r</sub>omberg<sub>1</sub>]: <br /><span class="math">$$R_{k,2}=\frac{4R_{k,1}-R_{k-1,1}}{3}$$</span><br /> Os valores <span class="math"><em>R</em><sub><em>k</em>, 2</sub></span> representam então os valores obtidos pelo método de Simpson composto aplicado a uma malha composta de <span class="math">2<sup><em>k</em> − 1</sup> + 1</span> pontos.</p>
<p>Similarmente os valores de <span class="math"><em>R</em><sub><em>k</em>, <em>j</em></sub></span> são os valores obtidos pela quadratura de ordem <span class="math">2<em>j</em></span> obtida via extrapolação de Richardson. Pode-se mostrar que <br /><span class="math">$$R_{k,j}=R_{k,j-1}+\frac{R_{k,j-1}-R_{k-1,j-1}}{4^{j-1}-1}.$$</span><br /></p>
<p>Construa o esquema de Romberg para aproximar o valor de <span class="math">∫<sub>0</sub><sup>2</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em></span> com erro de ordem 8.</p>
<p>O que nos fornece os seguintes resultados: <br /><span class="math">$$\begin{array}{|c|c|c|c|}
\hline
    55,59815  &amp;   0,000000    &amp;       0,000000  &amp;         0,000000         \\
    30,517357 &amp;   22,157092 &amp;   0,000000   &amp;        0,000000         \\
    20,644559 &amp;   17,353626 &amp;   17,033395 &amp;   0,000000         \\
    17,565086 &amp;   16,538595  &amp;  16,484259 &amp;   \pmb{16,475543}  \\
\hline
\end{array}$$</span><br /></p>
<p>Ou seja, temos: <br /><span class="math">∫<sub>0</sub><sup>2</sup><em>e</em><sup><em>x</em><sup>2</sup></sup><em>d</em><em>x</em> ≈ 16, 475543</span><br /> usando uma aproximação de ordem 8.</p>
<p>Construa o esquema de Romberg para aproximar o valor de <span class="math">∫<sub>0</sub><sup>2</sup><em>x</em><sup>2</sup><em>e</em><sup><em>x</em><sup>2</sup></sup><em>d</em><em>x</em></span> com erro de ordem 12.</p>
<p>O que nos fornece: <br /><span class="math">$$\begin{array}{|c|c|c|c|c|c|}
\hline
     218,3926  &amp;          &amp;           &amp;            &amp;           &amp;         \\  \hline
    111,91458  &amp;  76,421909 &amp;           &amp;            &amp;           &amp;         \\ \hline
    66,791497  &amp;  51,750469 &amp;   50,105706 &amp;            &amp;           &amp;         \\  \hline
    51,892538  &amp;  46,926218 &amp;   46,604601 &amp;   46,549028  &amp;           &amp;         \\  \hline
    47,782846  &amp;  46,412949 &amp;   46,378731 &amp;   46,375146  &amp;  46,374464  &amp;         \\  \hline
    46,72661   &amp;  46,374531 &amp;   46,37197  &amp;   46,371863  &amp;  46,37185   &amp;  \pmb{46,371847}\\
\hline
\end{array}$$</span><br /></p>
<p>Ou seja, temos: <br /><span class="math">∫<sub>0</sub><sup>2</sup><em>x</em><sup>2</sup><em>e</em><sup><em>x</em><sup>2</sup></sup><em>d</em><em>x</em> ≈ 46, 371847</span><br /> com uma aproximação de ordem 12.</p>
<h3 id="ordem-de-precisão">Ordem de precisão</h3>
<p>Todos os métodos de quadratura que vimos até o momento são da forma <br /><span class="math">$$\int_a^b f(x)dx \approx \sum_{j=1}^N w_j f(x_j)$$</span><br /></p>
<ul>
<li><p>Método do trapézio <br /><span class="math">$$\begin{aligned}
\int_a^b f(x)dx &amp;\approx&amp; \left[f(a)+f(b)\right]\frac{b-a}{2}\\
&amp;=&amp;\frac{b-a}{2}f(a)+\frac{b-a}{2}f(b)\\
&amp;:=&amp;w_1f(x_1)+w_2f(x_2)= \sum_{j=1}^2 w_j f(x_j)\end{aligned}$$</span><br /></p></li>
<li><p>Método do trapézio com dois intervalos <br /><span class="math">$$\begin{aligned}
\int_a^b f(x)dx &amp;\approx&amp; \left[f(a)+2f\left(\frac{a+b}{2}\right)+f(b)\right]\frac{b-a}{4}\\
&amp;=&amp;\frac{b-a}{4}f(a)+\frac{b-a}{2}f\left(\frac{a+b}{2}\right)+\frac{b-a}{4}f(b)\\
&amp;:=&amp;w_1f(x_1)+w_2f(x_2)+w_3f(x_3)= \sum_{j=1}^3 w_j f(x_j)\end{aligned}$$</span><br /></p></li>
<li><p>Método de Simpson <br /><span class="math">$$\begin{aligned}
\int_a^b f(x)dx &amp;\approx&amp; \left[f(a)+4f\left(\frac{a+b}{2}\right)+f(b)\right]\frac{b-a}{6}\\
&amp;=&amp;\frac{b-a}{6}f(a)+\frac{2(b-a)}{3}f\left(\frac{a+b}{2}\right)+\frac{b-a}{6}f(b)\\
&amp;:=&amp;\sum_{j=1}^3 w_j f(x_j)\end{aligned}$$</span><br /></p></li>
<li><p>Método de Simpson com dois intervalos <br /><span class="math">$$\begin{aligned}
\int_a^b f(x)dx &amp;\approx&amp; \left[f(a)+4f\left(\frac{3a+b}{4}\right)+2f\left(\frac{a+b}{2}\right)\right.\\
&amp;+&amp; \left. 4f\left(\frac{a+3b}{4}\right)+f(b)\right]\frac{b-a}{12}\\
&amp;=&amp;\frac{b-a}{12}f(a)+\frac{b-a}{3}f\left(\frac{3a+b}{4}\right)+\frac{b-a}{6}f\left(\frac{a+b}{2}\right)\\
&amp;+&amp;\frac{b-a}{3}f\left(\frac{a+3b}{4}\right)+\frac{b-a}{12}f(b)\\
&amp;:=&amp;\sum_{j=1}^5 w_j f(x_j)\end{aligned}$$</span><br /></p></li>
</ul>
<p>A principal técnica que temos usado para desenvolver os métodos numéricos é o <span><strong>polinômio de Taylor</strong></span>: <br /><span class="math"><em>f</em>(<em>x</em>) = <em>a</em><sub>0</sub> + <em>a</em><sub>1</sub><em>x</em> + <em>a</em><sub>2</sub><em>x</em><sup>2</sup> + … + <em>a</em><sub><em>n</em></sub><em>x</em><sup><em>n</em></sup> + <em>R</em><sub><em>n</em></sub>(<em>x</em>)</span><br /></p>
<p>Integrando termo a termo, temos: <br /><span class="math">$$\begin{aligned}
\int_a^bf(x)dx&amp;=&amp; \int_a^b a_0dx+\int_a^ba_1xdx + \int_a^ba_2x^2dx+\ldots+\\
&amp;&amp; \int_a^ba_n x^ndx +\int_a^bR_n(x)dx\\
&amp;=&amp; a_0(b-a)+a_1\frac{b^2-a^2}{2} + a_2\frac{b^3-a^3}{3} +\ldots+\\
&amp;&amp;a_n \frac{b^{n+1}-a^{n+1}}{n+1} +\int_a^bR_n(x)dx\end{aligned}$$</span><br /></p>
<p>Neste momento, é natural investigar o desempenho de um esquema numérico aplicado a funções do tipo <span class="math"><em>f</em>(<em>x</em>) = <em>x</em><sup><em>n</em></sup></span>.</p>
<p>A <span><strong>ordem de precisão</strong></span> ou <span><strong>ordem de exatidão</strong></span> de um esquema de quadratura numérica como o maior inteiro positivo <span><strong>n</strong></span> para o qual o esquema é exato para todas as funções do tipo <span class="math"><em>x</em><sup><em>k</em></sup></span> com <span class="math">0 ≤ <em>k</em> ≤ <em>n</em></span>, ou seja, Um esquema é dito de ordem <span class="math"><em>n</em></span> se <br /><span class="math">$$\sum_{j=1}^n w_jf(x_j)=\int_a^b f(x)dx,~~~f(x)=x^k,~k=0,1,\ldots n$$</span><br /> ou, equivalentemente: <br /><span class="math">$$\sum_{j=1}^n w_jx_j^k=\int_a^b x^kdx=\frac{b^{k+1}-a^{k+1}}{k+1},~~~k=0,1,\ldots n$$</span><br /></p>
<p>Se o método tem ordem <span class="math">0</span> ou mais, então <br /><span class="math">$$\sum_{j=1}^n w_j=b-a$$</span><br /></p>
<p>A ordem de precisão do esquema de trapézios é 1: <br /><span class="math">$$\int_a^b f(x)dx \approx \left[f(a)+f(b)\right]\frac{b-a}{2}=\sum_{j=1}^2w_jf(x_j)$$</span><br /> onde <span class="math">$w_j=\frac{b-a}{2}$</span>, <span class="math"><em>x</em><sub>1</sub> = <em>a</em></span> e <span class="math"><em>x</em><sub>2</sub> = <em>b</em></span>. <br /><span class="math">$$\begin{aligned}
  &amp;(k=0):\quad\sum_{j=1}^n w_j = b-a\\
  &amp;(k=1):\quad\sum_{j=1}^n w_jx_j = (a+b)\frac{b-a}{2}=\frac{b^2-a^2}{2}\\
  &amp;(k=2):\quad\sum_{j=1}^n w_jx_j^2 = (a^2+b^2)\frac{b-a}{2}\neq\frac{b^3-a^3}{3}\end{aligned}$$</span><br /></p>
<p>A ordem de precisão do esquema de Simpson é 3: <br /><span class="math">$$\int_a^b f(x)dx \approx \left[f(a)+4f\left(\frac{a+b}{2}\right)+f(b)\right]\frac{b-a}{6}=\sum_{j=1}^3w_jf(x_j)$$</span><br /> onde <span class="math">$w_1=w_3=\frac{b-a}{6}$</span>,<span class="math">$w_2=4\frac{b-a}{6}$</span>, <span class="math"><em>x</em><sub>1</sub> = <em>a</em></span>, <span class="math">$x_2=\frac{a+b}{2}$</span> e <span class="math"><em>x</em><sub>3</sub> = <em>b</em></span> <br /><span class="math">$$\begin{aligned}
  &amp;(k=0):\quad\sum_{j=1}^n w_j = (1+4+1)\frac{b-a}{6}=b-a\\
  &amp;(k=1):\quad\sum_{j=1}^n w_jx_j = (a+4\frac{a+b}{2}+b)\frac{b-a}{6} = (a+b)\frac{b-a}{2} = \frac{b^2-a^2}{2}\\
  &amp;(k=2):\quad\sum_{j=1}^n w_jx_j^2 = (a^2+4\left(\frac{a+b}{2}\right)^2+b^2)\frac{b-a}{6} = \frac{b^3-a^3}{3}\\
  &amp;(k=3):\quad\sum_{j=1}^n w_jx_j^3 = (a^3+4\left(\frac{a+b}{2}\right)^3+b^3)\frac{b-a}{6}= \frac{b^4-a^4}{4}\\
  &amp;(k=4):\quad\sum_{j=1}^n w_jx_j^4 = (a^4+4\left(\frac{a+b}{2}\right)^4+b^4)\frac{b-a}{6}\neq \frac{b^5-a^5}{4}\end{aligned}$$</span><br /></p>
<p>Encontre os pesos <span class="math"><em>w</em><sub><em>j</em></sub></span> e as abscissas <span class="math"><em>x</em><sub><em>j</em></sub></span> tais que o esquema de dois pontos <br /><span class="math">∫<sub> − 1</sub><sup>1</sup><em>f</em>(<em>x</em>)<em>d</em><em>x</em> = <em>w</em><sub>1</sub><em>f</em>(<em>x</em><sub>1</sub>) + <em>w</em><sub>2</sub><em>f</em>(<em>x</em><sub>2</sub>)</span><br /> é de ordem 3.</p>
<p>Temos um sistema de quatro equações e quatro incógnitas dado por: <br /><span class="math">$$\begin{aligned}
w_1+w_2&amp;=&amp;2\\
x_1w_1+x_2w_2&amp;=&amp;0\\
x_1^2w_1+x_2^2w_2&amp;=&amp;\frac{2}{3}\\
x_1^3w_1+x_2^3w_2&amp;=&amp;0\\\end{aligned}$$</span><br /></p>
<p>Da segunda e quarta equação, temos: <br /><span class="math">$$\frac{w_1}{w_2}=-\frac{x_2}{x_1}=-\frac{x_2^3}{x_1^3}$$</span><br /> Como <span class="math"><em>x</em><sub>1</sub> ≠ <em>x</em><sub>2</sub></span>, temos <span class="math"><em>x</em><sub>1</sub> =  − <em>x</em><sub>2</sub></span> e <span class="math"><em>w</em><sub>1</sub> = <em>w</em><sub>2</sub></span>. Da primeira equação, temos <span class="math"><em>w</em><sub>1</sub> = <em>w</em><sub>2</sub> = 1</span>. Da terceira equação, temos <span class="math">$-x_1=x_2=\frac{\sqrt{3}}{3}$</span>.</p>
<p>Esse esquema de ordem de precisão três e dois pontos chama-se quadratura de Gauss-Legendre com dois pontos: <br /><span class="math">$$\int_{-1}^1 f(x)dx = f\left(\frac{\sqrt{3}}{3}\right)+f\left(-\frac{\sqrt{3}}{3}\right)$$</span><br /></p>
<p>Comparação</p>
<p><br /><span class="math">$$\begin{array}{|c|c|c|c|c|}
\hline
f(x)&amp;\hbox{Exato}&amp;\hbox{Trapézio} &amp;\hbox{Simpson} &amp; \hbox{Gauss-Legendre (2)}\\
\hline
&amp;&amp;&amp;&amp;\\
\displaystyle e^{x}&amp;\displaystyle \begin{array}{l}e-e^{-1}\\~\approx 2,35040\end{array}  &amp; \displaystyle \begin{array}{l}e^{-1}+e \\ ~\approx 3,08616 \end{array}&amp; \begin{array}{l}\displaystyle \frac{e^{-1}+4e^{0}+e^{1}}{3}\\ ~\approx  2,36205\end{array} &amp; \begin{array}{l}\displaystyle e^{-\frac{-\sqrt{3}}{3}}+e^{\frac{\sqrt{3}}{3}}\\ ~\approx   2,34270\end{array}\\
&amp;&amp;&amp;&amp;\\
 \hline
&amp;&amp;&amp;&amp;\\
\displaystyle x^2\sqrt{3+x^3}&amp; \begin{array}{l}\frac{16}{9}-\frac{4}{9}\sqrt{2}\\~\approx 1,14924\end{array} &amp; 3,41421  &amp; 1,13807 &amp; 1,15411\\
&amp;&amp;&amp;&amp;\\
 \hline
&amp;&amp;&amp;&amp;\\
  \displaystyle x^2e^{x^3}&amp;\frac{e-e^{-1}}{3}\approx 0,78347 &amp; 3,08616     &amp; 1,02872  &amp; 0,67905\\
&amp;&amp;&amp;&amp;\\
 \hline
    \end{array}$$</span><br /></p>
<h3 id="quadratura-de-gauss-legendre">Quadratura de Gauss-Legendre</h3>
<p>A quadratura de Gauss-Legendre de <span class="math"><em>n</em></span> pontos é o esquema numérico <br /><span class="math">$$\int_{-1}^1 f(x)dx =\sum_{j=1}^n w_j f(x_j)$$</span><br /> cuja ordem de exatidão é <span class="math">2<em>n</em> − 1</span>.</p>
<ul>
<li><p>O problema de encontrar os <span class="math"><em>n</em></span> pesos e <span class="math"><em>n</em></span> abscissas é equivalente a um sistema não linear com <span class="math">2<em>n</em></span> equações e <span class="math">2<em>n</em></span> incógnitas.</p></li>
<li><p>Pode-se mostrar que este problema sempre tem solução e que a solução é única se <span class="math"><em>x</em><sub>1</sub> &lt; <em>x</em><sub>2</sub> &lt; … &lt; <em>x</em><sub><em>n</em></sub></span></p></li>
<li><p>As abscissas são das pelos zeros do enésimo polinômio de Legendre, <span class="math"><em>P</em><sub><em>n</em></sub>(<em>x</em>)</span>.</p></li>
<li><p>Os pesos são dados por <br /><span class="math">$$w_j = \frac{2}{\left( 1-x_j^2 \right) [P'_n(x_j)]^2}.$$</span><br /></p></li>
<li><p>Estes dados são tabelados e facilmente encontrados.</p></li>
</ul>
<p><br /><span class="math">$$\begin{array}{|c|c|c|}
\hline
n&amp;x_j&amp;w_j\\
\hline
&amp;&amp;\\
1&amp; 0 &amp; 2\\
&amp;&amp;\\
\hline
&amp;&amp;\\
2&amp; \pm \frac{\sqrt{3}}{3}&amp;1\\
&amp;&amp;\\
\hline
&amp;&amp;\\
&amp; 0&amp;\frac{8}{9}\\
3&amp;&amp;\\
&amp; \pm \sqrt{\frac{3}{5}}&amp;\frac{5}{9}\\
&amp;&amp;\\
\hline
&amp;&amp;\\
&amp;\pm\sqrt{\Big( 3 - 2\sqrt{6/5} \Big)/7}&amp;\tfrac{18+\sqrt{30}}{36}\\
4&amp;&amp;\\
&amp;\pm\sqrt{\Big( 3 + 2\sqrt{6/5} \Big)/7}&amp;\tfrac{18-\sqrt{30}}{36}\\
&amp;&amp;\\
\hline
\end{array}$$</span><br /></p>
<p>Aproximar <br /><span class="math">$$\int_{-1}^1\sqrt{1+x^2}dx$$</span><br /> pelo método de Gauss-Legendre com 3 pontos.</p>
<p><br /><span class="math">$$I_3=\frac{5}{9}f\left(-\sqrt{\frac{3}{5}}\right)+\frac{8}{9}f(0)+\frac{5}{9}f\left(\sqrt{\frac{3}{5}}\right) \approx 2,2943456$$</span><br /></p>
<p>No Scilab:</p>
<p>Aproximar <br /><span class="math">$$\int_{-1}^1\sqrt{1+x^2}dx$$</span><br /> pelo método de Gauss-Legendre com 4 pontos.</p>
<pre><code>I4=f(x4(1))*w4(1)+f(-x4(1))*w4(1)+f(x4(2))*w4(2)+f(-x4(2))*w4(2)</code></pre>
<p>Aproximar <br /><span class="math">$$\int_{0}^1\sqrt{1+x^2}dx$$</span><br /> pelo método de Gauss-Legendre com <span class="math">3,  4</span> e <span class="math">5</span> pontos.</p>
<p>Para tanto, fazemos a mudança de variáveis <span class="math"><em>u</em> = 2<em>x</em> − 1</span>: <br /><span class="math">$$\int_{0}^1\sqrt{1+x^2}dx=\frac{1}{2}\int_{-1}^1\sqrt{1+\left(\frac{u+1}{2}\right)^2}du$$</span><br /> E, então aplicamos a quadratura gaussiana nesta última integral.</p>
<pre><code>deff(&#39;y=f(u)&#39;,&#39;y=sqrt(1+(u+1)^2/4)/2&#39;)
I3=f(0)*w3(1)+f(x3(2))*w3(2)+f(-x3(2))*w3(2)
I4=f(x4(1))*w4(1)+f(-x4(1))*w4(1)+f(x4(2))*w4(2)+f(-x4(2))*w4(2)
I5=f(0)*w5(1)+f(x5(2))*w5(2)+f(-x5(2))*w5(2)+f(x5(3))*w5(3) ...
  +f(-x5(3))*w5(3)</code></pre>
<h2 id="exercícios-20" class="unnumbered">Exercícios</h2>
<p>Calcule numericamente as seguintes integrais usando os métodos simples do Ponto médio, Trapézio e Simpson. Calcule também o valor exato usando seus conhecimentos de Cálculo I. Complete a tabela abaixo conforme modelo:</p>
<p><span>|c|c|c|c|c|</span> &amp; exato &amp; Ponto médio &amp; Trapézio &amp; Simpson<br />&amp; &amp; &amp; &amp;<br /><span class="math">∫<sub>0</sub><sup>1</sup><em>e</em><sup> − <em>x</em></sup><em>d</em><em>x</em></span> &amp;<span class="math">1 − <em>e</em><sup> − 1</sup> ≈ 0.6321206</span>&amp; <span class="math"><em>e</em><sup> − 1/2</sup> ≈ 0.6065307</span>&amp;<span class="math">$\frac{1+e^{-1}}{2}\approx 0.6839397$</span> &amp;<span class="math">$\frac{1+4e^{-1/2}+e^{-1}}{6}\approx 0.6323337$</span><br />&amp; &amp; &amp; &amp;<br /><span class="math">∫<sub>0</sub><sup>1</sup><em>x</em><sup>2</sup><em>d</em><em>x</em></span> &amp; &amp; &amp; &amp;<br /></p>
<p>&amp; &amp; &amp; &amp;<br /><span class="math">∫<sub>0</sub><sup>1</sup><em>x</em><sup>3</sup><em>d</em><em>x</em></span> &amp; &amp; &amp; &amp;<br />&amp; &amp; &amp; &amp;<br /><span class="math">∫<sub>0</sub><sup>1</sup><em>x</em><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em></span> &amp; &amp; &amp; &amp;<br />&amp; &amp; &amp; &amp;<br /><span class="math">$\int_0^1\frac{1}{x^2+1}dx$</span> &amp; &amp; &amp; &amp;<br />&amp; &amp; &amp; &amp;<br /><span class="math">$\int_0^1\frac{x}{x^2+1}dx$</span> &amp; &amp; &amp; &amp;<br />&amp; &amp; &amp; &amp;<br /><span class="math">$\int_0^1\frac{1}{x+1}dx$</span> &amp; &amp; &amp; &amp;<br /></p>
<p><span>|c|c|c|c|c|</span> &amp; exato &amp; Ponto médio &amp; Trapézio &amp; Simpson<br />&amp; &amp; &amp; &amp;<br /><span class="math">∫<sub>0</sub><sup>1</sup><em>e</em><sup> − <em>x</em></sup><em>d</em><em>x</em></span> &amp;<span class="math">1 − <em>e</em><sup> − 1</sup> ≈ 0.6321206</span>&amp; <span class="math"><em>e</em><sup> − 1/2</sup> ≈ 0.6065307</span>&amp;<span class="math">$\frac{1+e^{-1}}{2}\approx 0.6839397$</span> &amp;<span class="math">$\frac{1+4e^{-1/2}+e^{-1}}{6}\approx 0.6323337$</span><br />&amp; &amp; &amp; &amp;<br /><span class="math">∫<sub>0</sub><sup>1</sup><em>x</em><sup>2</sup><em>d</em><em>x</em></span> &amp; <span class="math">1/3 ≈ 0.3333333</span>&amp; 0.25 &amp; 0.5 &amp; 0.3333333<br /></p>
<p>&amp; &amp; &amp; &amp;<br /><span class="math">∫<sub>0</sub><sup>1</sup><em>x</em><sup>3</sup><em>d</em><em>x</em></span> &amp; <span class="math">1/4 = 0.25</span> &amp; 0.125 &amp; 0.5 &amp; 0.25<br />&amp; &amp; &amp; &amp;<br /><span class="math">∫<sub>0</sub><sup>1</sup><em>x</em><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em></span> &amp;<span class="math">$\frac{1}{2}\left(1-e^{-1}\right)\approx 0.3160603$</span> &amp; 0.3894004 &amp; 0.1839397 &amp; 0.3209135<br />&amp; &amp; &amp; &amp;<br /><span class="math">$\int_0^1\frac{1}{x^2+1}dx$</span> &amp; <span class="math">tan<sup> − 1</sup>(1) ≈ 0.7853982</span> &amp; 0.8 &amp; 0.75 &amp; 0.7833333<br />&amp; &amp; &amp; &amp;<br /><span class="math">$\int_0^1\frac{x}{x^2+1}dx$</span> &amp;<span class="math">$\frac{1}{2}\ln(2)\approx  0.3465736  $</span> &amp; 0.4 &amp; 0.25 &amp; 0.35<br />&amp; &amp; &amp; &amp;<br /><span class="math">$\int_0^1\frac{1}{x+1}dx$</span> &amp; <span class="math">ln(2) ≈ 0.6931472</span> &amp; 0.6666667 &amp; 0.75 &amp; 0.6944444<br /></p>
<p>Dados os valores da função <span class="math"><em>f</em>(<em>x</em>)</span>, <span class="math"><em>f</em>(2) = 2</span>, <span class="math"><em>f</em>(3) = 4</span> e <span class="math"><em>f</em>(4) = 8</span>, calcule o valor aproximado de <br /><span class="math">∫<sub>2</sub><sup>4</sup><em>f</em>(<em>x</em>)<em>d</em><em>x</em></span><br /> pelos métodos simples de ponto médio, trapézio e Simpson.</p>
<p>Resp: <span class="math">8</span>, <span class="math">10</span> e <span class="math">8.666667</span>.</p>
<p>Dê a interpretação geométrica dos métodos do ponto médio, trapézio e Simpson. A partir desta construção geométrica, deduza as fórmulas para aproximar <br /><span class="math">∫<sub><em>a</em></sub><sup><em>b</em></sup><em>f</em>(<em>x</em>)<em>d</em><em>x</em>.</span><br /> Verifique o método de Simpson pode ser entendido como uma média aritmética ponderada entre os métodos de trapézio e ponto médio. Encontre os pesos envolvidos. Explique o que são os métodos compostos.</p>
<p><br /><span class="math">$$I_{Simpson}= \frac{1}{3} I_{Trap}+ \frac{2}{3}I_{PM}$$</span><br /></p>
<p>Calcule numericamente o valor de <span class="math">∫<sub>2</sub><sup>5</sup><em>e</em><sup>4 − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em></span> usando os métodos compostos do ponto médio, trapézio e Simpson. Obtenha os resultados utilizando, em cada quadratura, o número de pontos indicado.</p>
<p><span>|c|c|c|c|c|</span> n &amp; Ponto médio &amp; Trapézios &amp; Simpson<br /><span class="math">3</span> &amp; </p>
<p> &amp;  </p>
<p> &amp;  </p>
<p><br /><span class="math">5</span> &amp; &amp; &amp;<br /><span class="math">7</span> &amp; &amp; &amp;<br /><span class="math">9</span> &amp; &amp; &amp;<br /></p>
<table>
<thead>
<tr class="header">
<th align="center">n</th>
<th align="center">Ponto médio</th>
<th align="center">Trapézios</th>
<th align="center">Simpson</th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math">3</span></td>
<td align="center">0.1056606</td>
<td align="center">0.7503919</td>
<td align="center">0.5005225</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math">5</span></td>
<td align="center">0.1726140</td>
<td align="center">0.3964724</td>
<td align="center">0.2784992</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">7</span></td>
<td align="center">0.1973663</td>
<td align="center">0.3062023</td>
<td align="center">0.2393551</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math">9</span></td>
<td align="center">0.2084204</td>
<td align="center">0.2721145</td>
<td align="center">0.2306618</td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>Use as rotinas construídas em aula e calcule numericamente o valor das seguintes integrais usando o método composto dos trapézios para os seguintes números de pontos: <span class="math"></span></p>
<p><span>|c|c|c|c|c|c|</span> n &amp;h&amp; <sub>0</sub><sup>1</sup>e<sup>-4x<sup>2</sup></sup>dx &amp; <sub>0</sub><sup>1</sup>dx &amp; <sub>0</sub><sup>1</sup>x<sup>4</sup>(1-x)<sup>4</sup>dx &amp; <sub>0</sub><sup>1</sup>e<sup>-</sup>dx<br /><span class="math">17</span> &amp;&amp; 0.4409931&amp; &amp;  </p>
<p> &amp;  </p>
<p> <br /><span class="math">33</span> &amp;&amp;0.4410288 &amp; &amp; &amp;<br /><span class="math">65</span> &amp;&amp;0.4410377 &amp; &amp; &amp;<br /><span class="math">129</span> &amp;&amp;0.4410400 &amp; &amp; &amp;<br /><span class="math">257</span> &amp;&amp;0.4410405 &amp; &amp; &amp;<br /><span class="math">513</span> &amp;&amp;0.4410406 &amp; &amp; &amp;<br /><span class="math">1025</span> &amp;&amp;0.4410407&amp;0.7853981 &amp;1.587301587301610<sup>-3</sup> &amp;4.619172377630910<sup>-1</sup><br /></p>
<p><span class="math"></span></p>
<p>Para cada integrando encontre o função <span class="math"><em>I</em>(<em>h</em>) = <em>a</em><sub>0</sub> + <em>a</em><sub>1</sub><em>h</em> + <em>a</em><sub>2</sub><em>h</em><sup>2</sup> + <em>a</em><sub>3</sub><em>h</em><sup>3</sup> + <em>a</em><sub>4</sub><em>h</em><sup>4</sup></span> que melhor se ajusta aos dados, onde <span class="math">$h=\frac{1}{n-1}$</span>. Discuta os resultados com base no teorema envolvido na construção do método de Romberg.</p>
<p><br /><span class="math"><em>a</em>)<em>I</em>(<em>h</em>) = 4.41041 ⋅ 10<sup> − 1</sup> − 8.49372 ⋅ 10<sup> − 12</sup><em>h</em> − 1.22104 ⋅ 10<sup> − 2</sup><em>h</em><sup>2</sup> − 1.22376 ⋅ 10<sup> − 7</sup><em>h</em><sup>3</sup> + 8.14294 ⋅ 10<sup> − 3</sup><em>h</em><sup>4</sup></span><br /> <br /><span class="math"><em>b</em>)<em>I</em>(<em>h</em>) = 7.85398 ⋅ 10<sup> − 1</sup> − 1.46294 ⋅ 10<sup> − 11</sup><em>h</em> − 4.16667 ⋅ 10<sup> − 2</sup><em>h</em><sup>2</sup> − 2.16110 ⋅ 10<sup> − 7</sup><em>h</em><sup>3</sup> + 4.65117 ⋅ 10<sup> − 6</sup><em>h</em><sup>4</sup></span><br /> <br /><span class="math"><em>c</em>)<em>I</em>(<em>h</em>) = 1.58730 ⋅ 10<sup> − 3</sup> − 9.68958 ⋅ 10<sup> − 10</sup><em>h</em> + 2.03315 ⋅ 10<sup> − 7</sup><em>h</em><sup>2</sup> − 1.38695 ⋅ 10<sup> − 5</sup><em>h</em><sup>3</sup> + 2.97262 ⋅ 10<sup> − 4</sup><em>h</em><sup>4</sup></span><br /> <br /><span class="math"><em>d</em>)<em>I</em>(<em>h</em>) = 4.61917 ⋅ 10<sup> − 1</sup> + 3.83229 ⋅ 10<sup> − 12</sup><em>h</em> + 2.52721 ⋅ 10<sup> − 2</sup><em>h</em><sup>2</sup> + 5.48935 ⋅ 10<sup> − 8</sup><em>h</em><sup>3</sup> + 5.25326 ⋅ 10<sup> − 4</sup><em>h</em><sup>4</sup></span><br /></p>
<p>Calcule os valores da quadratura de Romberg de <span class="math"><em>R</em><sub>1, 1</sub></span> até <span class="math"><em>R</em><sub>4, 4</sub></span> para <span class="math">∫<sub>0</sub><sup><em>π</em></sup>sin(<em>x</em>)<em>d</em><em>x</em></span>. Não use rotinas prontas neste problema.</p>
<p><span>|c|c|c|c|</span>  </p>
<p>  &amp;  </p>
<p> &amp;  </p>
<p> &amp;  </p>
<p> <br />&amp; &amp; &amp;<br />&amp;&amp;&amp;<br />&amp;&amp;&amp;<br /></p>
<p><span>|c|c|c|c|</span>  </p>
<p> &amp;  </p>
<p> &amp;  </p>
<p> &amp;<br />1.5707963 &amp; 2.0943951 &amp;&amp;<br />1.8961189 &amp; 2.0045598 &amp; 1.9985707 &amp;<br />1.9742316 &amp; 2.0002692 &amp; 1.9999831 &amp; 2.0000055<br /></p>
<p>Sem usar rotinas prontas, use o método de integração de Romberg para obter a aproximação <span class="math"><em>R</em><sub>3, 3</sub></span> das seguintes integrais:</p>
<ul>
<li><p><span class="math">∫<sub>0</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em></span></p></li>
<li><p><span class="math">$\int_{0}^2 \sqrt{2-\cos(x)}dx$</span></p></li>
<li><p><span class="math">$\int_{0}^2 \frac{1}{\sqrt{2-\cos(x)}}dx$</span></p></li>
</ul>
<p>0.7468337,2.4606311, 1.6595275.</p>
<p>Encontre uma expressão para <span class="math"><em>R</em><sub>2, 2</sub></span> em termos de <span class="math"><em>f</em>(<em>x</em>)</span> e verifique o método de Romberg <span class="math"><em>R</em><sub>2, 2</sub></span> é equivalente ao método de Simpson.</p>
<p>Considere o problema de aproximar numericamente o valor de <br /><span class="math">$$\int_0^{100} \left(e^{\frac{1}{2}\cos(x)}-1\right)dx$$</span><br /> pelo método de Romberg. Usando rotinas prontas, faça o que se pede.</p>
<ul>
<li><p>Calcule <span class="math"><em>R</em>(6, <em>k</em>),   <em>k</em> = 1, …, 6</span> e observe os valores obtidos.</p></li>
<li><p>Calcule <span class="math"><em>R</em>(7, <em>k</em>),   <em>k</em> = 1, …, 6</span> e observe os valores obtidos.</p></li>
<li><p>Calcule <span class="math"><em>R</em>(8, <em>k</em>),   <em>k</em> = 1, …, 6</span> e observe os valores obtidos.</p></li>
<li><p>Discuta os resultados anteriores e proponha uma estratégia mais eficiente para calcular o valor da integral.</p></li>
</ul>
<p><span class="math"><em>R</em>(6, 6) =  − 10.772065</span>, <span class="math"><em>R</em>(7, 7) = 5.2677002</span>, <span class="math"><em>R</em>(8, 8) = 6.1884951</span>, <span class="math"><em>R</em>(9, 9) = 6.0554327</span>, <span class="math"><em>R</em>(10, 10) = 6.0574643</span>. O valor desta integral com oito dígitos corretos é aproximado por <span class="math">6.0574613</span>.</p>
<p>Encontre os pesos <span class="math"><em>w</em><sub>1</sub></span>, <span class="math"><em>w</em><sub>2</sub></span> e <span class="math"><em>w</em><sub>3</sub></span> tais que o esquema de quadratura dado por <br /><span class="math">∫<sub>0</sub><sup>1</sup><em>f</em>(<em>x</em>)<em>d</em><em>x</em> ≈ <em>w</em><sub>1</sub><em>f</em>(0) + <em>w</em><sub>2</sub><em>f</em>(1/2) + <em>w</em><sub>3</sub><em>f</em>(1)</span><br /> apresente máxima ordem de exatidão. Qual a ordem obtida?</p>
<p><span class="math"><em>w</em><sub>1</sub> = 1/6</span>, <span class="math"><em>w</em><sub>2</sub> = 2/3</span>, <span class="math"><em>w</em><sub>3</sub> = 1/6</span>. O esquema construído é o de Simpson e a ordem de exatidão é 3.</p>
<p>Encontre a ordem de exatidão do seguinte método de integração: <br /><span class="math">$$\int_{-1}^1f(x)dx\approx \frac{2}{3}\left[f\left(\frac{-\sqrt{2}}{2}\right)+f(0)+f\left(\frac{\sqrt{2}}{2}\right)\right]$$</span><br /></p>
<p>3</p>
<p>Encontre a ordem de exatidão do seguinte método de integração: <br /><span class="math">$$\int_{-1}^1f(x)dx=-\frac{1}{210}f'(-1)+\frac{136}{105} f(-1/2) - \frac{62}{105} f(0) + \frac{136}{105}f(1/2) +\frac{1}{210}f'(1)$$</span><br /></p>
<p>5</p>
<p>Encontre os pesos <span class="math"><em>w</em><sub>1</sub></span>, <span class="math"><em>w</em><sub>2</sub></span> e <span class="math"><em>w</em><sub>3</sub></span> tal que o método de integração <br /><span class="math">∫<sub>0</sub><sup>1</sup><em>f</em>(<em>x</em>)<em>d</em><em>x</em> ≈ <em>w</em><sub>1</sub><em>f</em>(1/3) + <em>w</em><sub>2</sub><em>f</em>(1/2) + <em>w</em><sub>3</sub><em>f</em>(2/3)</span><br /> tenha ordem de exatidão máxima. Qual é ordem obtida?</p>
<p><span class="math">$\int_0^1 f(x)dx \approx \frac{3}{2} f(1/3)  -2f(1/2) + \frac{3}{2}f(2/3)$</span> com ordem 3.</p>
<p>Explique por quê quando um método simples tem estimativa de erro de truncamento local de ordem <span class="math"><em>h</em><sup><em>n</em></sup></span>, então o método composto associado tem estimativa de erro de ordem <span class="math"><em>h</em><sup><em>n</em> − 1</sup></span>.</p>
<p>Quantos pontos são envolvidos no esquema de quadratura <span class="math"><em>R</em><sub>3, 2</sub></span>? Qual a ordem do erro deste esquema de quadratura? Qual a ordem de exatidão desta quadradura?</p>
<p>5, 4, 3</p>
<p>Encontre os pesos <span class="math"><em>w</em><sub>1</sub></span> e <span class="math"><em>w</em><sub>2</sub></span> e as abcissas <span class="math"><em>x</em><sub>1</sub></span> e <span class="math"><em>x</em><sub>2</sub></span> tais que <br /><span class="math">∫<sub> − 1</sub><sup>1</sup><em>f</em>(<em>x</em>) = <em>w</em><sub>1</sub><em>f</em>(<em>x</em><sub>1</sub>) + <em>w</em><sub>2</sub><em>f</em>(<em>x</em><sub>2</sub>)</span><br /> quando <span class="math"><em>f</em>(<em>x</em>) = <em>x</em><sup><em>k</em></sup>,  <em>k</em> = 0, 1, 2, 3</span>, isto é o método apresente máxima ordem de exatidão possível com dois pontos.</p>
<p>Use esse método para avaliar o valor da integral das seguintes integrais e compare com os valores obtidos para Simpson e trapézio, bom como com o valor exato.</p>
<ul>
<li><p><span class="math">∫<sub> − 1</sub><sup>1</sup>(2 + <em>x</em> − 5<em>x</em><sup>2</sup> + <em>x</em><sup>3</sup>)<em>d</em><em>x</em></span></p></li>
<li><p><span class="math">∫<sub> − 1</sub><sup>1</sup><em>e</em><sup><em>x</em></sup><em>d</em><em>x</em></span></p></li>
<li><p><span class="math">$\int_{-1}^1\frac{dx}{\sqrt{x^2+1}}$</span></p></li>
</ul>
<p><span class="math">$\int_{-1}^1f(x)dx=f\left(-\frac{\sqrt{3}}{3}\right)+f\left(\frac{\sqrt{3}}{3}\right)$</span></p>
<p>Encontre os pesos <span class="math"><em>w</em><sub>1</sub></span>, <span class="math"><em>w</em><sub>2</sub></span> e <span class="math"><em>w</em><sub>3</sub></span> tal que o método de integração <br /><span class="math">$$\int_{-1}^1 f(x)dx \approx w_1 f\left(-\frac{\sqrt{3}}{3}\right)  + w_2f(0) + w_3f\left(\frac{\sqrt{3}}{3}\right)$$</span><br /> tenha ordem de exatidão máxima. Qual é ordem obtida?</p>
<p><span class="math"><em>w</em><sub>1</sub> = <em>w</em><sub>3</sub> = 1</span> e <span class="math"><em>w</em><sub>2</sub> = 0</span> com ordem 3.</p>
<p>Encontre aproximações para a seguinte integral via Gauss-Legendre com <span class="math">2,  3,  4,  5,  6</span> e <span class="math">7</span> pontos e compare com o valor exato <br /><span class="math">∫<sub> − 1</sub><sup>1</sup><em>x</em><sup>4</sup><em>e</em><sup><em>x</em><sup>5</sup></sup><em>d</em><em>x</em>.</span><br /></p>
<p>Encontre aproximações para as seguintes integrais via Gauss-Legendre com 4 e 5 pontos:</p>
<ul>
<li><p><span class="math">∫<sub>0</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>4</sup></sup><em>d</em><em>x</em></span></p></li>
<li><p><span class="math">∫<sub>1</sub><sup>4</sup>log(<em>x</em> + <em>e</em><sup><em>x</em></sup>)<em>d</em><em>x</em></span></p></li>
<li><p><span class="math">∫<sub>0</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em></span></p></li>
</ul>
<p>Calcule numericamente o valor das seguintes integrais usando a quadratura de Gauss-Legendre para os seguintes valores de <span class="math"><em>n</em></span>:</p>
<p><span>|c|c|c|c|c|</span> n &amp; <span class="math">∫<sub>0</sub><sup>1</sup><em>e</em><sup> − 4<em>x</em><sup>2</sup></sup><em>d</em><em>x</em></span> &amp; <span class="math">$\int_{0}^1\frac{1}{1+x^2}dx$</span> &amp; <span class="math">∫<sub>0</sub><sup>1</sup><em>x</em><sup>4</sup>(1 − <em>x</em>)<sup>4</sup><em>d</em><em>x</em></span> &amp; <span class="math">$\int_{0}^1e^{-\frac{1}{x^2+1}}dx$</span><br /><span class="math">2</span> &amp;  </p>
<p> &amp; &amp;  </p>
<p> &amp;  </p>
<p> <br /><span class="math">3</span> &amp;&amp; &amp;&amp;<br /><span class="math">4</span> &amp; &amp; &amp; &amp;<br /><span class="math">5</span> &amp; &amp; &amp; &amp;<br /><span class="math">8</span> &amp; &amp; &amp; &amp;<br /><span class="math">10</span> &amp; &amp; &amp; &amp;<br /><span class="math">12</span> &amp; &amp; &amp; &amp;<br /><span class="math">14</span> &amp; &amp; &amp; &amp;<br /><span class="math">16</span> &amp;0.4410407 &amp;0.7853982 &amp;0.0015873 &amp; 0.4619172<br /></p>
<h2 id="exercícios-finais-2" class="unnumbered">Exercícios finais</h2>
<p>O valor exato da integral imprópria <span class="math">∫<sub>0</sub><sup>1</sup><em>x</em>ln(<em>x</em>)<em>d</em><em>x</em></span> é dado por <br /><span class="math">$$\int_0^1x\ln(x)dx=\left.\left(\frac{x^2}{2}\ln x-\frac{x^2}{4}\right)\right|_0^1=-1/4$$</span><br /> Aproxime o valor desta integral usando a regra de Simpson para <span class="math"><em>n</em> = 3</span>, <span class="math"><em>n</em> = 5</span> e <span class="math"><em>n</em> = 7</span>. Como você avalia a qualidade do resultado obtido? Por que isso acontece.</p>
<p>-0.2310491, -0.2452073, - 0.2478649.</p>
<p>O valor exato da integral imprópria <span class="math">∫<sub>0</sub><sup>∞</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em></span> é dado por <span class="math">$\frac{\sqrt{\pi}}{2}$</span>. Escreva esta integral como <br /><span class="math"><em>I</em> = ∫<sub>0</sub><sup>1</sup><em>e</em><sup> − <em>x</em><sup>2</sup></sup><em>d</em><em>x</em> + ∫<sub>0</sub><sup>1</sup><em>u</em><sup> − 2</sup><em>e</em><sup> − 1/<em>u</em><sup>2</sup></sup><em>d</em><em>u</em> = ∫<sub>0</sub><sup>1</sup>(<em>e</em><sup> − <em>x</em><sup>2</sup></sup> + <em>x</em><sup> − 2</sup><em>e</em><sup> − 1/<em>x</em><sup>2</sup></sup>)<em>d</em><em>x</em></span><br /> e aproxime seu valor usando o esquema de trapézios e Simpson para <span class="math"><em>n</em> = 5</span>, <span class="math"><em>n</em> = 7</span> e <span class="math"><em>n</em> = 9</span>.</p>
<p>Estamos interessados em avaliar numericamente a seguinte integral: <br /><span class="math">∫<sub>0</sub><sup>1</sup>ln(<em>x</em>)sin(<em>x</em>)<em>d</em><em>x</em></span><br /> cujo valor com 10 casas decimais corretas é <span class="math"> − .2398117420</span>.</p>
<ul>
<li><p>Aproxime esta integral via Gauss-Legendre com <span class="math"><em>n</em> = 2</span>,<span class="math"><em>n</em> = 3</span>, <span class="math"><em>n</em> = 4</span>, <span class="math"><em>n</em> = 5</span>, <span class="math"><em>n</em> = 6</span> e <span class="math"><em>n</em> = 7</span>.</p></li>
<li><p>Use a identidade <br /><span class="math">$$\begin{aligned}
\int_0^1 \ln(x)\sin(x)dx&amp;=&amp;\int_0^1 \ln(x)xdx+\int_0^1 \ln(x)\left[\sin(x)-x\right]dx\\
&amp;=&amp;\left.\left(\frac{x^2}{2}\ln x-\frac{x^2}{4}\right)\right|_0^1+\int_0^1 \ln(x)\left[\sin(x)-x\right]dx\\
&amp;=&amp;-\frac{1}{4}+\int_0^1 \ln(x)\left[\sin(x)-x\right]dx\end{aligned}$$</span><br /> e aproxime a integral <span class="math">∫<sub>0</sub><sup>1</sup>ln(<em>x</em>)[sin(<em>x</em>) − <em>x</em>]<em>d</em><em>x</em></span> numericamente via Gauss-Legendre com <span class="math"><em>n</em> = 2</span>, <span class="math"><em>n</em> = 3</span>, <span class="math"><em>n</em> = 4</span>, <span class="math"><em>n</em> = 5</span>, <span class="math"><em>n</em> = 6</span> e <span class="math"><em>n</em> = 7</span>.</p></li>
<li><p>Compare os resultados e discuta levando em consideração as respostas às seguintes perguntas: 1)Qual função é mais bem-comportada na origem? 2)Na segunda formulação, qual porção da solução foi obtida analiticamente e, portanto, sem erro de truncamento?</p></li>
</ul>
<p>a)-0.2472261, -0.2416451, -0.2404596, -0.2400968, -0.2399563, -0.2398928. b)-0.2393727, -0.2397994, -0.2398104, -0.2398115, -0.2398117, -0.2398117.</p>
<p>Considere o problema de calcular numericamente a integral <span class="math"><em>I</em> = ∫<sub> − 1</sub><sup>1</sup><em>f</em>(<em>x</em>)<em>d</em><em>x</em></span> quando <span class="math">$f(x)=\frac{\cos(x)}{\sqrt{|x|}}$</span>.</p>
<ul>
<li><p>O que acontece quando se aplica diretamente a quadratura gaussiana com um número impar de abscissas?</p></li>
<li><p>Calcule o valor aproximado por quadratura gaussiana com <span class="math"><em>n</em> = 2</span>, <span class="math"><em>n</em> = 4</span>, <span class="math"><em>n</em> = 6</span> e <span class="math"><em>n</em> = 8</span>.</p></li>
<li><p>Calcule o valor aproximado da integral removendo a singularidade <br /><span class="math">$$\begin{aligned}
I&amp;=&amp;\int_{-1}^1\frac{\cos(x)}{\sqrt{|x|}}dx=\int_{-1}^1\frac{\cos(x)-1}{\sqrt{|x|}}dx+\int_{-1}^1\frac{1}{\sqrt{|x|}}dx \\
&amp;=&amp;\int_{-1}^1\frac{\cos(x)-1}{\sqrt{|x|}}dx+2\int_{0}^1\frac{1}{\sqrt{x}}dx=\int_{-1}^1\frac{\cos(x)-1}{\sqrt{|x|}}dx+4\end{aligned}$$</span><br /> e aplicando quadratura gaussiana com <span class="math"><em>n</em> = 2</span>, <span class="math"><em>n</em> = 4</span>, <span class="math"><em>n</em> = 6</span> e <span class="math"><em>n</em> = 8</span>.</p></li>
<li><p>Calcule o valor aproximado da integral removendo a singularidade, considerando a paridade da função <br /><span class="math">$$\begin{aligned}
I&amp;=&amp;4+\int_{-1}^1\frac{\cos(x)-1}{\sqrt{|x|}}dx=4+2\int_{0}^1\frac{\cos(x)-1}{\sqrt{x}}dx=4+\sqrt{2}\int_{-1}^1\frac{\cos\left(\frac{1+u}{2}\right)-1}{\sqrt{1+u}}du\end{aligned}$$</span><br /> e aplicando quadratura gaussiana com <span class="math"><em>n</em> = 2</span>, <span class="math"><em>n</em> = 4</span>, <span class="math"><em>n</em> = 6</span> e <span class="math"><em>n</em> = 8</span>.</p></li>
<li><p>Expandindo a função <span class="math">cos(<em>x</em>)</span> em série de Taylor, truncando a série depois do <span class="math"><em>n</em></span>-ésimo termos não nulo e integrando analiticamente.<br /></p></li>
<li><p>Aproximando a função <span class="math">cos(<em>x</em>)</span> pelo polinômio de Taylor de grau 4 dado por <br /><span class="math">$$P_4(x)=1-\frac{x^2}{2}+\frac{x^4}{24}$$</span><br /> e escrevendo <br /><span class="math">$$\begin{aligned}
I&amp;=&amp;\int_{-1}^1\frac{\cos(x)}{\sqrt{|x|}}dx=\int_{-1}^1\frac{\cos(x)-P_4(x)}{\sqrt{|x|}}dx+\int_{-1}^1\frac{P_4(x)}{\sqrt{|x|}}dx\\
&amp;=&amp;2\underbrace{\int_{0}^1\frac{\cos(x)-P_4(x)}{\sqrt{x}}dx}_{\hbox{Resolver numericamente}}+2\underbrace{\int_{0}^1\left(x^{-1/2}-\frac{x^{3/2}}{2}+\frac{x^{7/2}}{24}\right)dx}_{\hbox{Resolver analiticamente}}\end{aligned}$$</span><br /></p></li>
</ul>
<table>
<thead>
<tr class="header">
<th align="center">n</th>
<th align="center">b</th>
<th align="center">c</th>
<th align="center">d</th>
<th align="center">e</th>
<th align="center">f</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math">2</span></td>
<td align="center">2.205508</td>
<td align="center">3.5733599</td>
<td align="center">3.6191866</td>
<td align="center"><span class="math">3.6185185</span></td>
<td align="center"><span class="math">3.618146</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">4</span></td>
<td align="center">2.5973554</td>
<td align="center">3.6107456</td>
<td align="center">3.6181465</td>
<td align="center"><span class="math">3.6180970</span></td>
<td align="center"><span class="math">3.6180970</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math">6</span></td>
<td align="center">2.7732372</td>
<td align="center">3.6153069</td>
<td align="center">3.6181044</td>
<td align="center"><span class="math">3.6180970</span></td>
<td align="center"><span class="math">3.6180970</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math">8</span></td>
<td align="center">2.880694</td>
<td align="center">3.6166953</td>
<td align="center">3.6180989</td>
<td align="center"><span class="math">3.6180970</span></td>
<td align="center"><span class="math">3.6180970</span></td>
</tr>
</tbody>
</table>
<p><span><strong>Solução do item e:</strong></span> Como <br /><span class="math">$$\cos(x)=1+\sum_{n=1}^\infty(-1)^n\frac{x^{2n}}{(2n)!}$$</span><br /> temos <br /><span class="math">$$\frac{1-\cos(x)}{\sqrt{x}}=-\sum_{n=1}^\infty(-1)^{n}\frac{x^{2n-1/2}}{(2n)!},~~x\geq0$$</span><br /> Logo, podemos integrar <br /><span class="math">$$\begin{aligned}
I&amp;=&amp;4+2\int_{0}^1\frac{\cos(x)-1}{\sqrt{|x|}}dx=4-2\sum_{n=1}^\infty(-1)^{n}\int_0^1\frac{x^{2n-1/2}}{(2n)!}dx\\
&amp;=&amp;4-2\sum_{n=1}^\infty(-1)^{n}\frac{1}{(2n)!(2n+1/2)}\end{aligned}$$</span><br /> <span><strong>Solução do item f)</strong></span> <br /><span class="math">$$\begin{aligned}
2\int_{0}^1\left(x^{-1/2}-\frac{x^{3/2}}{2}+\frac{x^{7/2}}{24}\right)dx=2\left(2-\frac{1}{5}+\frac{1}{54}\right)=\frac{977}{270}\end{aligned}$$</span><br /> <br /><span class="math">$$\begin{aligned}
2\int_{0}^1\frac{\cos(x)-P_4(x)}{\sqrt{x}}dx=\sqrt{2}\int_{-1}^1\frac{\cos\left(\frac{1+u}{2}\right)-P_4\left(\frac{1+u}{2}\right)}{\sqrt{1+u}}du\end{aligned}$$</span><br /></p>
<p>Calcule numericamente o valor das seguintes integrais com um erro relativo inferior a <span class="math">10<sup> − 4</sup></span>.</p>
<ul>
<li><p><span class="math">$\displaystyle\int_0^1\frac{\sin(\pi x)}{{x}}dx$</span></p></li>
<li><p><span class="math">$\displaystyle\int_0^1\frac{\sin(\pi x)}{{x(1-x)}}dx$</span></p></li>
<li><p><span class="math">$\displaystyle \int_0^1\frac{\sin\left(\frac{\pi}{2} x\right)}{\sqrt{x(1-x)}}dx$</span></p></li>
<li><p><span class="math">∫<sub>0</sub><sup>1</sup>ln(<em>x</em>)cos(<em>x</em>)<em>d</em><em>x</em></span></p></li>
</ul>
<p>Calcule as integrais <span class="math">$\int_0^{1}\frac{e^x}{|x|^{1/4}}dx$</span> e <span class="math">$\int_0^1\frac{e^{-x}}{|x|^{4/5}}dx$</span> usando procedimentos analíticos e numéricos.</p>
<p>Use a técnica de integração por partes para obter a seguinte identidade envolvendo integrais impróprias: <br /><span class="math">$$I=\int_0^\infty \frac{\cos(x)}{1+x}dx =\int_0^\infty \frac{\sin(x)}{(1+x)^2}dx.$$</span><br /> Aplique as técnicas estudadas para aproximar o valor de I e explique por que a integral da direita é mais bem comportada.</p>
<p>Resolva a equação <br /><span class="math"><em>x</em> + ∫<sub>0</sub><sup><em>x</em></sup><em>e</em><sup> − <em>y</em><sup>2</sup></sup><em>d</em><em>y</em> = 5</span><br /> com 5 dígitos significativos.</p>
<p>4.1138</p>
<p>[title=Ciência dos materiais] O calor específico (molar) de um sólido pode ser aproximado pela teoria de Debye usando a seguinte expressão <br /><span class="math">$$C_V=9Nk_B\left(\frac{T}{T_D}\right)^3\int_0^{T_D/T} \frac{y^4e^y}{(e^y-1)^2}dy$$</span><br /> onde <span class="math"><em>N</em></span> é a constante de Avogrado dado por <span class="math"><em>N</em> = 6.022 × 10<sup>23</sup></span> e <span class="math"><em>k</em><sub><em>B</em></sub></span> é a constante de Boltzmann dada por <span class="math"><em>k</em><sub><em>B</em></sub> = 1.38 × 10<sup> − 23</sup></span>. <span class="math"><em>T</em><sub><em>D</em></sub></span> é temperatura de Debye do sólido.</p>
<ul>
<li><p>Calcule o calor específico do ferro em quando <span class="math"><em>T</em> = 200<em>K</em></span>, <span class="math"><em>T</em> = 300<em>K</em></span> e <span class="math"><em>T</em> = 400<em>K</em></span> supondo <span class="math"><em>T</em><sub><em>D</em></sub> = 470<em>K</em></span>.</p></li>
<li><p>Calcule a temperatura de Debye de um sólido cujo calor específico a temperatura de <span class="math">300<em>K</em></span> é <span class="math">24<em>J</em>/<em>K</em>/<em>m</em><em>o</em><em>l</em></span>. Dica: aproxime a integral por um esquema numérico com um número fixo de pontos.</p></li>
<li><p>Melhore sua cultura geral: A lei de Dulong-Petit para o calor específico dos sólidos precede a teoria de Debye. Verifique que a equação de Debye é consistente com Dulong-Petit, ou seja: <br /><span class="math">lim<sub><em>T</em> → ∞</sub><em>C</em><sub><em>v</em></sub> = 3<em>N</em><em>k</em><sub><em>B</em></sub>.</span><br /> Dica: use <span class="math"><em>e</em><sup><em>y</em></sup> ≈ 1 + <em>y</em></span> quando <span class="math"><em>y</em> ≈ 0</span></p></li>
</ul>
<p>a)19.2, 22.1, 23.3 b)513.67K</p>
<h1 id="problemas-de-valor-inicial">Problemas de valor inicial</h1>
<p>Neste capítulo, desenvolveremos técnicas numérica para aproximar a solução de problemas de valor inical da forma</p>
<p>[PVI] <br /><span class="math">$$\begin{aligned}
y'(t)&amp;=&amp;f(y(t),t)\label{PVI_EDO}\\
y(t_0)&amp;=&amp;y_0 ~~ \hbox{(condição inicial)}.\label{PVI_CI}\end{aligned}$$</span><br /></p>
<p>A ingógnita de um problema de valor inicial é uma função que satisfaz a equação diferencial ([PVI<sub>E</sub>DO]) e a condição inicial ([PVI<sub>C</sub>I]).</p>
<p>Considere o seguinte problema de valor inicial</p>
<p>[exemplo<sub>y2</sub>y] <br /><span class="math">$$\begin{aligned}
y'(t)&amp;=&amp;2y(t),\\
y(t_0)&amp;=&amp;1.\end{aligned}$$</span><br /></p>
<p>A solução desta equação é dada pela função <span class="math"><em>y</em>(<em>t</em>) = <em>e</em><sup>2<em>y</em></sup></span> pois <span class="math"><em>y</em>′(<em>t</em>) = 2<em>e</em><sup>2<em>t</em></sup> = 2<em>y</em>(<em>t</em>)</span> e <span class="math"><em>y</em>(0) = <em>e</em><sup>0</sup> = 1</span>.</p>
<p>Muito problemas de valor inicial da forma ([PVI]) não podem ser resolvidos exatamente, ou seja, sabe-se que a solução existe e é única, porém não podemos expressá-la em termos de funções elementares. Por isso é necessário calcular aproximações numéricas. Diversos métodos completamente diferentes estão disponíveis para aproximar uma função real.</p>
<p>Aqui nos limitaremos a estudar métodos que se fundamentam em tentar calcular <span class="math"><em>y</em>(<em>t</em>)</span> em um conjunto finito de valores de <span class="math"><em>t</em></span>. Esse conjunto de valores para <span class="math"><em>t</em></span> será denotado por <span class="math">{<em>t</em><sub><em>i</em></sub>}<sub><em>i</em> = 1</sub><sup><em>N</em></sup></span>, isto é <span class="math">{<em>t</em><sub>1</sub>, <em>t</em><sub>2</sub>, <em>t</em><sub>3</sub>, …, <em>t</em><sub><em>N</em></sub>}</span> e calculamos o valor aproximado da função solução <span class="math"><em>y</em>(<em>t</em><sub><em>i</em></sub>)</span> em cada ponto da malha usando esquemas numéricos.</p>
<h2 id="método-de-euler">Método de Euler</h2>
<p>Retornemos ao problema de valor inicial ([PVI]) dado por:</p>
<p>[PVI<sub>2</sub>] <br /><span class="math">$$\begin{aligned}
y'(t)&amp;=&amp;f(y(t),t)\\
y(0)&amp;=&amp;y_0 ~~ \hbox{(condição inicial)}\end{aligned}$$</span><br /></p>
<p>O Método de Euler aplicado à solução desse problema consiste em aproximar a derivada <span class="math"><em>y</em>′(<em>t</em>)</span> por um esquema de primeira ordem do tipo <br /><span class="math">$$y'(t)=\frac{y(t+h)-y(t)}{h}+O(h),~~ h&gt;0.$$</span><br /> Aqui <span class="math"><em>h</em></span> é o passo do método, que consideraremos uma constante. Assim temos ([PVI<sub>2</sub>]) se transforma em: <br /><span class="math">$$\begin{aligned}
\nonumber \frac{y(t+h)-y(t)}{h}&amp;=&amp;f(y(t),t)+O(h)\\
{\label{erro_local}}y(t+h)&amp;=&amp;y(t)+hf(y(t),t)+O(h^2).\end{aligned}$$</span><br /></p>
<p>Definimos, então, <span class="math"><em>t</em><sup>(<em>k</em>)</sup> = (<em>k</em> − 1)<em>h</em></span> e <span class="math"><em>y</em><sup>(<em>k</em>)</sup></span> como a aproximação para <span class="math"><em>y</em>(<em>t</em><sup>(<em>k</em>)</sup>)</span> produzida pelo Método de Euler. Assim, obtemos <br /><span class="math">$$\begin{aligned}
\label{PVI_EULER}
y^{(k+1)}&amp;=&amp;y^{(k)}+hf(y^{(k)},t^{(k)}) ~\hbox{(aproximação da EDO)},\\
y^{(1)}&amp;=&amp;y_0~~ \hbox{(condição inicial)}.\end{aligned}$$</span><br /> O problema ([PVI<sub>E</sub>ULER]) consiste em um esquema iterativo, isto é, <span class="math"><em>y</em><sup>(1)</sup></span> é a condição inicial; <span class="math"><em>y</em><sup>(2)</sup></span> pode ser obtido de <span class="math"><em>y</em><sup>(2)</sup></span>; <span class="math"><em>y</em><sup>(3)</sup></span>, de <span class="math"><em>y</em><sup>(4)</sup></span> e assim por diante, calculamos o termo <span class="math"><em>y</em><sup>(<em>n</em>)</sup></span> apartir do anterior <span class="math"><em>y</em><sup>(<em>n</em> − 1)</sup></span>.</p>
<p>Retornemos ao o problema de valor inicial do exemplo ([exemplo<sub>y2</sub>y]): <br /><span class="math">$$\begin{aligned}
y'(t)&amp;=&amp;2y(t)\\
y(0)&amp;=&amp;1\end{aligned}$$</span><br /></p>
<p>Cuja solução é <span class="math"><em>y</em>(<em>t</em>) = <em>e</em><sup>2<em>t</em></sup></span>. O método de Euler aplicado a este problema produz o seguinte esquema: <br /><span class="math">$$\begin{aligned}
y^{(k+1)}&amp;=&amp;y^{(k)}+2hy^{(k)}=(1+2h)y^{(k)}\\
y^{(1)}&amp;=&amp;1,\end{aligned}$$</span><br /> cuja solução é dada por <br /><span class="math"><em>y</em><sup>(<em>k</em>)</sup> = (1 + 2<em>h</em>)<sup><em>k</em> − 1</sup>.</span><br /> Como <span class="math"><em>t</em> = (<em>k</em> − 1)<em>h</em></span>, a solução aproximada pelo Método de Euler é <br /><span class="math">$$y(t)\approx \tilde{y}(t)= (1+2h)^{\frac{t}{h}}.$$</span><br /> Observe que <span class="math">$\tilde{y}(t) \neq y(t)$</span>, mas se <span class="math"><em>h</em></span> é pequeno, a aproximação é boa, pois <br /><span class="math">$$\lim_{h\to 0+} (1+2h)^{\frac{t}{h}}= e^{2t}.$$</span><br /></p>
<p>Vamos agora, analisar o desempenho do Método de Euler usando um exemplo mais complicado, porém ainda simples suficiente para que possamos obter a solução exata:</p>
<p><span>[ex<sub>e</sub>uler<sub>1</sub>]</span> Considere o problema de valor inicial relacionado à equação logística: <br /><span class="math">$$\begin{aligned}
y'(t)&amp;=&amp;y(t)(1-y(t))\\
y(0)&amp;=&amp;1/2\end{aligned}$$</span><br /></p>
<p>Podemos obter a solução exata desta equação usando o método de separação de variáveis e o método das frações parciais. Para tal escrevemos: <br /><span class="math">$$\frac{dy(t)}{y(t)(1-y(t))}=dt$$</span><br /> O termo <span class="math">$\frac{1}{y(1-y)}$</span> pode ser decomposto em frações parciais como <span class="math">$\frac{1}{y}-\frac{1}{1-y}$</span> e chegamos na seguinte equação diferencial: <br /><span class="math">$$\left(\frac{1}{y}+\frac{1}{1-y}\right)dy=dt.$$</span><br /> Integrando termo-a-termo, temos a seguinte equação algébrica relacionando <span class="math"><em>y</em>(<em>t</em>)</span> e <span class="math"><em>t</em></span>: <br /><span class="math">ln(<em>y</em>) − ln(1 − <em>y</em>) = <em>t</em> + <em>C</em></span><br /> Onde <span class="math"><em>C</em></span> é a constante de integração, que é definida pela condição inicial, isto é, <span class="math"><em>y</em> = 1/2</span> em <span class="math"><em>t</em> = 0</span>. Substituindo, temos <span class="math"><em>C</em> = 0</span>. O que resulta em: <br /><span class="math">$$\ln\left(\frac{y}{1-y}\right)=t$$</span><br /> Equivalente a <br /><span class="math">$$\frac{y}{1-y}=e^{t}$$</span><br /> e <br /><span class="math"><em>y</em> = (1 − <em>y</em>)<em>e</em><sup><em>t</em></sup></span><br /> Colocando o termo <span class="math"><em>y</em></span> em evidência, encontramos: <br /><span class="math">(1 + <em>e</em><sup><em>t</em></sup>)<em>y</em> = <em>e</em><sup><em>t</em></sup></span><br /> E, finalmente, encontramos a solução exata dada por <span class="math">$y(t)=\frac{e^t}{1+e^{t}}$</span>.</p>
<p>Vejamos, agora, o esquema iterativo produzido pelo método de Euler:</p>
<p>[ite<sub>l</sub>ogistica] <br /><span class="math">$$\begin{aligned}
y^{(k+1)}&amp;=&amp;y^{(k)}+h y^{(k)}(1-y^{(k)}),\\
y^{(1)}&amp;=&amp;1/2.\end{aligned}$$</span><br /></p>
<p>Para fins de comparação, calculamos a solução de ([ex<sub>e</sub>uler<sub>1</sub>]) e de ([ite<sub>l</sub>ogistica]) para alguns valores de <span class="math"><em>t</em></span> e de passo <span class="math"><em>h</em></span> e resumimos na tabela ([tab<sub>l</sub>ogistica]).</p>
<p>[tab<sub>l</sub>ogistica]</p>
<p><br /><span class="math">$$\begin{array}{|c|c|c|c|}
\hline
t &amp;  \hbox{Exato} &amp; \hbox{Euler}~~ h=0,1 &amp; \hbox{Euler}~~ h=0,01\\
\hline
0 &amp;  1/2 &amp; 0,5 &amp; 0,5\\
\hline
1/2 &amp;   \frac{e^{1/2}}{1+e^{1/2}}\approx 0,6224593 &amp; 0,6231476 &amp; 0,6225316\\
\hline
1 &amp;   \frac{e}{1+e}\approx 0,7310586 &amp; 0,7334030 &amp; 0,7312946\\
\hline
2 &amp;   \frac{e^2}{1+e^2}\approx  0,8807971 &amp; 0,8854273  &amp; 0,8812533 \\
\hline
3 &amp;   \frac{e^3}{1+e^3}\approx   0,9525741   &amp; 0,9564754   &amp; 0,9529609 \\
\hline
\end{array}$$</span><br /></p>
<p>No exemplo a seguir, apresentamos um problema envolvendo uma equação não-autônoma, isto é, quando a função <span class="math"><em>f</em>(<em>y</em>, <em>t</em>)</span> depende explicitamente do tempo.</p>
<p>Resolva o problema de valor inicial <br /><span class="math">$$\begin{aligned}
y'&amp;=&amp;-y+t\\
y(0)&amp;=&amp;1,\end{aligned}$$</span><br /> cuja solução exata é <span class="math"><em>y</em>(<em>t</em>) = 2<em>e</em><sup> − <em>t</em></sup> + <em>t</em> − 1</span>.</p>
<p>O esquema recursivo de Euler fica: <br /><span class="math">$$\begin{aligned}
y^{(k+1)}&amp;=&amp;y({k})- hy({k})+ht^{(k)}\\
y(0)&amp;=&amp;1\end{aligned}$$</span><br /></p>
<p>Comparação <br /><span class="math">$$\begin{array}{|c|c|c|c|}
\hline
t &amp;  \hbox{Exato} &amp; \hbox{Euler}~~ h=0,1 &amp; \hbox{Euler}~~ h=0,01\\
\hline
0 &amp;  1 &amp; 1 &amp; 1\\
\hline
1 &amp;   2e^{-1}\approx 0,7357589 &amp; 0,6973569   &amp;   0,7320647  \\
\hline
2 &amp;   2e^{-2}+1\approx  1,2706706 &amp;  1,2431533    &amp;   1,2679593     \\
\hline
3 &amp;   2e^{-3}+2\approx 2,0995741  &amp;  2,0847823 &amp; 2,0980818   \\
\hline
\end{array}$$</span><br /></p>
<p>No exemplo [sys<sub>e</sub>do], mostramos como o Método de Euler pode ser facilmente estendido para problemas envolvendo sistemas de equações diferenciais..</p>
<p>[sys<sub>e</sub>do] Escreva o processo iterativo de Euler para resolver numericamente o seguinte sistema de equações diferenciais <br /><span class="math">$$\begin{aligned}
x'&amp;=&amp;-y\\
y'&amp;=&amp;x\\
x(0)&amp;=&amp;1\\
y(0)&amp;=&amp;0,\\\end{aligned}$$</span><br /> cuja solução exata é <span class="math"><em>x</em>(<em>t</em>) = cos(<em>t</em>)</span> e <span class="math"><em>y</em>(<em>t</em>) = sin(<em>t</em>)</span>.</p>
<p>Par aplicar o Método de Euler a um sistema, devemos encarar as diversas incógnitas do sistema como formando um vetor, neste caso, encrevemos: <br /><span class="math">$$z(t)=\left[\begin{array}{c}x(t)\\y(t)\end{array}\right].$$</span><br /> O sistema é igualmente escrito na forma vetorial: <br /><span class="math">$$\begin{aligned}
\left[\begin{array}{c}x^{(k+1)}\\y^{(k+1)}\end{array}\right]=\left[\begin{array}{c}x^{(k)}\\y^{(k)}\end{array}\right]+h\left[\begin{array}{c}-y^{(k)}\\x^{(k)}\end{array}\right].\end{aligned}$$</span><br /> Observe que este processo iterativo é equivalente a: <br /><span class="math">$$\begin{aligned}
x^{(k+1)}&amp;=&amp;x^{(k)}-hy^{(k)}\\
y^{(k+1)}&amp;=&amp;y^{(k)}+hx^{(k)}.\end{aligned}$$</span><br /></p>
<p>Escreva o problema de valor inicial de segunda ordem dado por <br /><span class="math">$$\begin{aligned}
y''+y'+y&amp;=&amp;\cos(t),\\
y(0)&amp;=&amp;1,\\
y'(0)&amp;=&amp;0,\end{aligned}$$</span><br /> como um problema envolvendo um sistema de primeira ordem.</p>
<p>A fim de transformar a equação diferencial dada em um sistema de equações de primeira ordem, introduzimos a substituição <span class="math"><em>w</em> = <em>y</em>′</span>, de forma que obtermos o sistema: <br /><span class="math">$$\begin{aligned}
y'&amp;=&amp;w\\
w'&amp;=&amp;-w-y+\cos(t)\\
y(0)&amp;=&amp;1\\
w(0)&amp;=&amp;0\end{aligned}$$</span><br /> Portanto, o Método de Euler produz o seguinte processo iterativo: <br /><span class="math">$$\begin{aligned}
y^{(k+1)}&amp;=&amp;y^{(k)}+hw^{(k)},\\
w^{(k+1)}&amp;=&amp;w^{(k)}-hw^{(k)}-hy^{(k)}+h\cos(t^{(k)}),\\
y^{(1)}&amp;=&amp;1,\\
w^{(1)}&amp;=&amp;0.\end{aligned}$$</span><br /></p>
<h2 id="exercícios-21" class="unnumbered">Exercícios</h2>
<p>Resolva o problema de valor inicial dado por <br /><span class="math">$$\begin{aligned}
y'&amp;=&amp; -2y + \sqrt{y}\\
y(0)&amp;=&amp;1\end{aligned}$$</span><br /> com passo <span class="math"><em>h</em> = 0.1</span> e <span class="math"><em>h</em> = 0.1</span> para obter aproximações para <span class="math"><em>y</em>(1)</span>. Compare com a solução exata dada por <span class="math"><em>y</em>(<em>t</em>) = (1 + 2<em>e</em><sup> − <em>t</em></sup> + <em>e</em><sup> − 2<em>t</em></sup>)/4</span></p>
<p><span class="math">0, 4496</span> com <span class="math"><em>h</em> = 0, 1</span> e <span class="math">0, 4660</span> com <span class="math"><em>h</em> = 0, 01</span>. A solução exata vale <span class="math">$y(1)=\frac{1+2e^{-1}+e^{-2}}{4}= \left(\frac{1+e^{-1}}{2}\right)^2\approx 0,4678$</span></p>
<p>Resolva o problema de valor inicial dado por <br /><span class="math">$$\begin{aligned}
y'&amp;=&amp; -2y + \sqrt{z}\\
z'&amp;=&amp; -z + y\\
y(0)&amp;=&amp;0\\
z(0)&amp;=&amp;2\\\end{aligned}$$</span><br /> com passo <span class="math"><em>h</em> = 0.2</span>, <span class="math"><em>h</em> = 0.2</span>, <span class="math"><em>h</em> = 0.02</span> e <span class="math"><em>h</em> = 0.002</span> para obter aproximações para <span class="math"><em>y</em>(2)</span> e <span class="math"><em>z</em>(2)</span>.</p>
<p><span class="math"><em>y</em>(2) ≈ 0, 430202</span> e <span class="math"><em>z</em>(2) = 0, 617294</span> com <span class="math"><em>h</em> = 0, 2</span>, <span class="math"><em>y</em>(2) ≈ 0, 435506</span> e <span class="math"><em>z</em>(2) = 0, 645776</span> com <span class="math"><em>h</em> = 0, 02</span>, <span class="math"><em>y</em>(2) ≈ 0, 435805</span> e <span class="math"><em>z</em>(2) = 0, 648638</span> com <span class="math"><em>h</em> = 0, 002</span> e <span class="math"><em>y</em>(2) ≈ 0, 435832</span> e <span class="math"><em>z</em>(2) = 0, 648925</span> com <span class="math"><em>h</em> = 0, 0002</span>.</p>
<p>Resolva o problema de valor inicial dado por <br /><span class="math">$$\begin{aligned}
y'&amp;=&amp; \cos(ty(t))\\
y(0)&amp;=&amp;1\\\end{aligned}$$</span><br /> com passo <span class="math"><em>h</em> = 0.1</span>, <span class="math"><em>h</em> = 0.01</span>, <span class="math"><em>h</em> = 0.001</span>, <span class="math"><em>h</em> = 0.0001</span> e <span class="math">0.00001</span> para obter aproximações para <span class="math"><em>y</em>(2)</span>.</p>
<p><span class="math"><em>y</em>(2) ≈ 1, 161793</span> com <span class="math"><em>h</em> = 0, 1</span>, <span class="math"><em>y</em>(2) ≈ 1, 139573</span> com <span class="math"><em>h</em> = 0, 01</span>, <span class="math"><em>y</em>(2) ≈ 1, 137448</span> com <span class="math"><em>h</em> = 0, 001</span>, <span class="math"><em>y</em>(2) ≈ 1, 137237</span> com <span class="math"><em>h</em> = 0, 0001</span>, <span class="math"><em>y</em>(2) ≈ 1, 137216</span> com <span class="math"><em>h</em> = 0, 00001</span></p>
<h2 id="método-de-euler-melhorado">Método de Euler melhorado</h2>
<p>O método de Euler foi o primeiro método que estudamos e sua principal virtude é a simplicidade. Outros métodos, no entanto, podem apresentar resultados superiores. Vamos apresentar agora uma pequena modificação ao Método de Euler, dando origem a um novo método chamado de Método de Euler Modificado ou Método de Euler Melhorado.</p>
<p>No método de Euler, usamos a seguinte iteração: <br /><span class="math">$$\begin{aligned}
y^{(k+1)}&amp;=&amp;y^{(k)}+hf(y^{(k)},t^{(k)})\\
y^{(1)}&amp;=&amp;y_0~~ \hbox{(condição inicial)}\end{aligned}$$</span><br /></p>
<p>A ideia do método de Euler Melhorado é substituir a declividade <span class="math"><em>f</em>(<em>y</em><sup>(<em>k</em>)</sup>, <em>t</em><sup>(<em>k</em>)</sup>)</span> pela média aritmética entre <span class="math"><em>f</em>(<em>y</em><sup>(<em>k</em>)</sup>, <em>t</em><sup>(<em>k</em>)</sup>)</span> e <span class="math"><em>f</em>(<em>y</em><sup>(<em>k</em> + 1)</sup>, <em>t</em><sup>(<em>k</em> + 1)</sup>)</span>, isto é, as declividades avaliadas no início e no fim do intervalo <span class="math">[<em>t</em><sup>(<em>k</em>)</sup>, <em>t</em><sup>(<em>k</em> + 1)</sup>]</span>.</p>
<p>No entanto, não dispomos do valor de <span class="math"><em>y</em><sup>(<em>k</em> + 1)</sup></span> antes de executar o passo. Assim aproximamos esta grandeza pelo valor produzido pelo Método de Euler original: <br /><span class="math">$$\tilde{y}^{(k+1)}=y^{(k)}+hf(y^{(k)},t^{(k)}).$$</span><br /></p>
<p>De posse desta aproximação, calculamos a média aritmética e, finalmente, com esta média, realizamos o passo do Método de Euler Melhorado. O processo iterativo de Euler Melhorado é, portanto, dado por: <br /><span class="math">$$\begin{aligned}
\tilde{y}^{(k+1)}&amp;=&amp;y^{(k)}+hf(y^{(k)},t^{(k)})\\
y^{(k+1)}&amp;=&amp;y^{(k)}+\frac{h}{2}\left[f(y^{(k)},t^{(k)})+f(\tilde{y}^{(k+1)},t^{(k+1)})\right]\\
y^{(1)}&amp;=&amp;y_0~~ \hbox{(condição inicial)}\end{aligned}$$</span><br /></p>
<p>Podemos reescrever este mesmo processo iterativo da seguinte forma: <br /><span class="math">$$\begin{aligned}
k_1&amp;=&amp;hf(y^{(k)},t^{(k)}),\\
k_2&amp;=&amp;hf(y^{(k)}+k_1,t^{(k+1)}),\\
y^{(k+1)}&amp;=&amp;y^{(k)}+\frac{k_1+k_2}{2},\\
y^{(1)}&amp;=&amp;y_0~~ \hbox{(condição inicial)}.\end{aligned}$$</span><br /> Aqui <span class="math"><em>k</em><sub>1</sub></span> e <span class="math"><em>k</em><sub>2</sub></span> são variáveis auxiliares que representam as inclinações e devem ser calculadas a cada passo. Esta notação é compatível com a notação usada nos métodos de Runge-Kutta, uma família de esquemas iterativos para aproximar problemas de valor inicial, da qual o Método de Euler e o Método de Euler Melhorado são casos particulares. Veremos os métodos de Runge-Kutta na seção [sec<sub>R</sub>K].</p>
<h2 id="exercícios-22" class="unnumbered">Exercícios</h2>
<p>Use o Método de Euler melhorado para obter uma aproximação numérica do valor de <span class="math"><em>y</em>(1)</span> quando <span class="math"><em>y</em>(<em>t</em>)</span> satisfaz o seguinte problema de valor inicial <br /><span class="math">$$\begin{aligned}
 y'(t)&amp;=&amp;-y(t)+ e^{y(t)},\\
 y(0)&amp;=&amp;0,\end{aligned}$$</span><br /> usando passos <span class="math"><em>h</em> = 0, 1</span> e <span class="math"><em>h</em> = 0, 01</span>.</p>
<p><span class="math"><em>y</em>(1) ≈ 1, 317078</span> quando <span class="math"><em>h</em> = 0, 1</span> e <span class="math"><em>y</em>(1) ≈ 1, 317045</span>.</p>
<p>Use o Método de Euler e o Método de Euler melhorado para obter aproximações numéricas para a solução do seguinte problema de valor inicial para <span class="math"><em>t</em> ∈ [0, 1]</span>: <br /><span class="math">$$\begin{aligned}
 y'(t)&amp;=&amp;-y(t)- y(t)^2,\\
 y(0)&amp;=&amp;1,\end{aligned}$$</span><br /> usando passo <span class="math"><em>h</em> = 0, 1</span>. Compare os valores da solução exata dada por <span class="math">$y(t)=\frac{1}{2e^t-1}$</span> com os numéricos nos pontos <span class="math"><em>t</em> = 0</span>, <span class="math"><em>t</em> = 0.1</span>, <span class="math"><em>t</em> = 0.2</span>, <span class="math"><em>t</em> = 0.3</span>, <span class="math"><em>t</em> = 0.4</span>, <span class="math"><em>t</em> = 0.5</span>, <span class="math"><em>t</em> = 0.6</span>, <span class="math"><em>t</em> = 0.7</span>, <span class="math"><em>t</em> = 0.8</span>, <span class="math"><em>t</em> = 0.9</span>, <span class="math"><em>t</em> = 1.0</span>.</p>
<p><br /><span class="math">$$\begin{array}{|c|c|c|c|c|c|}
\hline
t &amp;  \hbox{Exato} &amp; \hbox{Euler} &amp; \hbox{Euler Melhorado} &amp; \hbox{Erro Euler} &amp; \hbox{Erro Euler Melhorado}\\
\hline
0.0&amp;    1.          &amp;1.          &amp;1.          &amp;0.          &amp;0.       \\ 
0.1&amp;    0.826213    &amp;0.8         &amp;0.828       &amp;0.026213    &amp;0.001787\\  
0.2&amp;    0.693094    &amp;0.656       &amp;0.695597    &amp;0.037094    &amp;0.002502  \\
0.3&amp;    0.588333    &amp;0.547366    &amp;0.591057    &amp;0.040967    &amp;0.002724  \\
0.4&amp;    0.504121    &amp;0.462669    &amp;0.506835    &amp;0.041453    &amp;0.002714  \\
0.5&amp;    0.435267    &amp;0.394996    &amp;0.437861    &amp;0.040271    &amp;0.002594  \\
0.6&amp;    0.378181    &amp;0.339894    &amp;0.380609    &amp;0.038287    &amp;0.002428  \\
0.7&amp;    0.330305    &amp;0.294352    &amp;0.332551    &amp;0.035953    &amp;0.002246  \\
0.8&amp;    0.289764    &amp;0.256252    &amp;0.291828    &amp;0.033512    &amp;0.002064  \\
0.9&amp;    0.255154    &amp;0.224061    &amp;0.257043    &amp;0.031093    &amp;0.001889  \\
1.0&amp;    0.225400    &amp;0.196634    &amp;0.227126    &amp;0.028766    &amp;0.001726\\

\hline
\end{array}$$</span><br /></p>
<p>No Scilab, esta tabela pode ser produzida com o código:</p>
<pre><code>       deff(&#39;dy=f(y,t)&#39;,&#39;dy=-y-y^2&#39;)
       sol_Euler=Euler(f,0,1,10,1)&#39;
       sol_Euler_mod=Euler_mod(f,0,1,10,1)&#39;
       deff(&#39;y=y_exata(t)&#39;,&#39;y=1/(2*exp(t)-1)&#39;)
       t=[0:.1:1]&#39;
       sol_exata=feval(t,y_exata)
       tabela=[t sol_exata sol_Euler sol_Euler_mod abs(sol_exata-sol_Euler) abs(sol_exata-sol_Euler_mod)]
      </code></pre>
<h2 id="ordem-de-precisão-1">Ordem de precisão</h2>
<p>Considere o problema de valor inicial dado por <br /><span class="math">$$\begin{aligned}
y'(t)&amp;=&amp;f(y(t),t),\\
y(0)&amp;=&amp;y_0.\end{aligned}$$</span><br /> Nessa seção vamos definir a precisão de um método numérico pela ordem do erro acumulado ao calcular o valor da função em um ponto <span class="math"><em>t</em><sub><em>N</em></sub></span> em função do espaçamento da malha <span class="math"><em>h</em></span>. Se <span class="math"><em>y</em>(<em>t</em><sub><em>n</em></sub>)</span> pode ser aproximado por uma expressão que depende de <span class="math"><em>f</em></span>, <span class="math"><em>h</em></span>, <span class="math"><em>y</em>(<em>t</em><sub>0</sub>)</span>, <span class="math"><em>y</em>(<em>t</em><sub>1</sub>)</span>, <span class="math">⋯</span>, <span class="math"><em>y</em>(<em>t</em><sub><em>n</em></sub>)</span>, com erro da ordem de <span class="math"><em>O</em>(<em>h</em><sup><em>p</em> + 1</sup>)</span>, ou seja, <br /><span class="math">$${\label{erro_local_1}}
y(t_{n+1})=\mathcal{F}(f, h, y(t_n), y(t_{n-1}), \cdots, y_0) + O(h^{p+1})$$</span><br /> para cada função analítica <span class="math"><em>f</em></span>, dizemos que o método tem erro de truncamento da ordem de <span class="math"><em>O</em>(<em>h</em><sup><em>p</em></sup>)</span> ou <span><strong>ordem de precisão <span class="math"><em>p</em></span></strong></span>. Essa afirmação faz sentido quando fazemos a seguinte análise informal: para aproximar <span class="math"><em>y</em><sub>1</sub></span>, acumulamos erros da ordem <span class="math"><em>O</em>(<em>h</em><sup><em>p</em> + 1</sup>)</span>, para calcular <span class="math"><em>y</em><sub>2</sub></span> acumulamos os erros de <span class="math"><em>y</em><sub>1</sub></span> e novos erros <span class="math"><em>O</em>(<em>h</em><sup><em>p</em> + 1</sup>)</span>. Para calcular <span class="math"><em>y</em><sub><em>N</em></sub></span>, acumulamos todos os erros até <span class="math"><em>t</em><sub><em>N</em></sub></span>, ou seja, <span class="math"><em>N</em></span> vezes <span class="math"><em>O</em>(<em>h</em><sup><em>p</em> + 1</sup>)</span>. Como <span class="math"><em>N</em> = <em>O</em>(1/<em>h</em>)</span>, temos que os erros ao calcular <span class="math"><em>y</em><sub><em>N</em></sub></span> são da ordem <span class="math"><em>O</em>(<em>h</em><sup><em>p</em></sup>)</span>. É verdade que essa análise só vale quando impomos condições de suavidade para <span class="math"><em>f</em></span> e condições adequada para a expressão <span class="math">ℱ(<em>f</em>, <em>h</em>, <em>y</em>(<em>t</em><sub><em>n</em></sub>), <em>y</em>(<em>t</em><sub><em>n</em> − 1</sub>), ⋯, <em>y</em><sub>0</sub>)</span>. Para explicar melhor esse pequeno texto, fazemos em detalhes essa operação para o método de Euler na seção [sec<sub>p</sub>re<sub>e</sub>uler].</p>
<h3 id="ordem-de-precisão-do-método-de-euler">Ordem de precisão do Método de Euler</h3>
<p><span>[sec<sub>p</sub>re<sub>e</sub>uler]</span> Primeiro lembramos da expressão ([erro<sub>l</sub>ocal]) que origina a seguinte relação de recorrência: <br /><span class="math">$$\begin{aligned}
{\label{es_Euler}}
y(t_{n+1})&amp;=&amp;y(t_n)+hf(y(t_n),t_n)+O(h^2).\end{aligned}$$</span><br /> Para entender melhor o motivo de na expressão ([es<sub>E</sub>uler]) aparecer <span class="math"><em>O</em>(<em>h</em><sup>2</sup>)</span> e o método ser de precisão 1, vamos a seguinte análise informal: observemos que <br /><span class="math">$$\begin{aligned}
 y(t_1)&amp;=&amp;y(t_0)+hf(y(t_0),t_0)+O(h^2)\\
 &amp;=&amp;y_0+hf(y_0,t_0)+O(h^2)=y_1+O(h^2)\end{aligned}$$</span><br /> onde <span class="math"><em>y</em><sub><em>i</em></sub></span> é a aproximação pelo método de Euler para o valor exato <span class="math"><em>y</em>(<em>t</em><sub><em>i</em></sub>)</span>. Subsequentemente, temos <br /><span class="math">$$\begin{aligned}
 y(t_2)&amp;=&amp;y(t_1)+hf(y(t_1),t_1)+O(h^2)\\
 &amp;=&amp;y(t_1)+hf(y_1+O(h^2),t_1)+O(h^2)\\
 &amp;=&amp;y(t_1)+hf(y_1,t_1) +O(h^2)\\
 &amp;=&amp;y_1+O(h^2)+hf(y_1,t_1) +O(h^2)= y_2+O(h^2)+O(h^2).\end{aligned}$$</span><br /> onde usamos o primeiro termo da série de Taylor <span class="math"><em>h</em><em>f</em>(<em>y</em><sub>1</sub> + <em>O</em>(<em>h</em><sup>2</sup>), <em>t</em><sub>1</sub>) = <em>h</em><em>f</em>(<em>y</em><sub>1</sub>, <em>t</em><sub>1</sub>) + <em>O</em>(<em>h</em><sup>3</sup>)</span> na passagem da segunda para terceira linha. Repetindo sucessivamente o passo anterior, obtemos uma expressão geral para o valor exato <span class="math"><em>y</em>(<em>t</em><sub><em>N</em></sub>)</span> em termos do valor aproximado <span class="math"><em>y</em><sub><em>N</em></sub></span>: <br /><span class="math">$$\begin{aligned}
 y(t_N)=y_N+N O(h^2) .\end{aligned}$$</span><br /> Como <span class="math"><em>N</em> = (<em>t</em><sub><em>f</em></sub> − <em>t</em><sub>0</sub>)/<em>h</em></span>, temos <br /><span class="math">$$\begin{aligned}
{\label{euler_precisao}}
 y(t_N)&amp;=&amp;=y_{N}+\frac{t-t_0}{h}O(h^2)=y_{N}+O(h),\end{aligned}$$</span><br /> ou seja, o erro entre o valor exato e o aproximado é de ordem <span class="math"><em>h</em></span>. Uma demonstração mais formal que garante que o erro é limitado por uma expressão que é proporcional a <span class="math"><em>h</em></span> está discutido na seção [sec<sub>c</sub>onv<sub>E</sub>uler].</p>
<h3 id="ordem-de-precisão-do-método-de-euler-melhorado">Ordem de precisão do Método de Euler Melhorado</h3>
<p>Para obter o erro de precisão do método de Euler Melhorado vamos calcular o erro de truncamento do método, ou seja, precisamos demonstrar que: <br /><span class="math">$$\label{es_Euler_melhorado}
y(t+h)=y(t)+\frac{h}{2} f(y(t),t)+\frac{h}{2} f(y(t)+hf(t,y(t))),t+h)+O(h^3)$$</span><br /> De fato, tomando a diferença do termo da esquerda o os termos da direita, temos: <br /><span class="math">$$\begin{aligned}
&amp;&amp;y(t+h)-\left(y(t)+\frac{h}{2} f(y(t),t)+\frac{h}{2} f(y(t)+hf(t,y(t))),t+h)\right)\\
&amp;&amp;=y(t)+hy'(t)+\frac{h^2}{2}y''(t)+O(h^3)\\
&amp;&amp;-\left(y(t)+\frac{h}{2} y'(t)+\frac{h}{2} f(y(t)+hf(t,y(t))),t+h)\right),\end{aligned}$$</span><br /> onde usamos uma expansão em série de Taylor para <span class="math"><em>y</em>(<em>t</em> + <em>h</em>)</span> e a equação diferencial <span class="math"><em>y</em>′(<em>t</em>) = <em>f</em>(<em>y</em>(<em>t</em>), <em>t</em>)</span>. Portanto, <br /><span class="math">$$\begin{aligned}
&amp;&amp;y(t+h)-\left(y(t)+\frac{h}{2} f(y(t),t)+\frac{h}{2} f(y(t)+hf(t,y(t))),t+h)\right)\\
&amp;&amp;=\frac{h}{2}y'(t)+\frac{h^2}{2}y''(t)-\frac{h}{2} f(y(t)+hf(t,y(t))),t+h)+O(h^3).\end{aligned}$$</span><br /> Agora, usamos a série de Taylor de <span class="math"><em>f</em>(<em>y</em>(<em>t</em>) + <em>h</em><em>f</em>(<em>y</em>(<em>t</em>), <em>t</em>), <em>t</em> + <em>h</em>)</span> e, torno de <span class="math">(<em>y</em>, <em>t</em>)</span>: <br /><span class="math">$$\begin{aligned}
&amp;&amp;y(t+h)-\left(y(t)+\frac{h}{2} f(y(t),t)+\frac{h}{2} f(y(t)+hf(t,y(t))),t+h)\right)\\
&amp;&amp;=\frac{h}{2}y'(t)+\frac{h^2}{2}y''(t)+O(h^3)\\
&amp;&amp;-\frac{h}{2}\left(f(y(t),t)+\frac{\partial f(y(t),t) }{\partial t}h +\frac{\partial f(t,y(t))}{\partial y} hf(t,y(t))+O(h^2)\right).\end{aligned}$$</span><br /> Usando a equação diferencial <span class="math"><em>y</em>′(<em>t</em>) = <em>f</em>(<em>y</em>(<em>t</em>), <em>t</em>)</span> obtemos <br /><span class="math">$$y''(t)=\frac{f(y(t),t)}{\partial t}+\frac{f(y(t),t)}{\partial y}y'(t)=\frac{f(y(t),t)}{\partial t}+\frac{f(y(t),t)}{\partial y}f(y(t),t).$$</span><br /> Logo, <br /><span class="math">$$\begin{aligned}
&amp;&amp;y(t+h)-\left(y(t)+\frac{h}{2} f(y(t),t)+\frac{h}{2} f(y(t)+hf(t,y(t))),t+h)\right)\\
&amp;&amp;=\frac{h}{2}y'(t)+\frac{h^2}{2}y''(t)+O(h^3)\\
&amp;&amp;-\frac{h}{2}\left(f(y(t),t)+hy''(t)+O(h^2)\right)\\
&amp;&amp;=\frac{h}{2}y'(t)+\frac{h^2}{2}y''(t)\\
&amp;&amp;-\frac{h}{2}\left(y'(t)+hy''(t)\right)+O(h^3)=O(h^3)\end{aligned}$$</span><br /> Portanto, a expressão ([es<sub>E</sub>uler<sub>m</sub>elhorado]) é válida. Logo, usando uma discussão análoga aquela feita na seção [sec<sub>p</sub>re<sub>e</sub>uler] para o método de Euler, concluímos que o método de Euler Melhorado possui ordem de precisão 2.</p>
<h2 id="convergência">Convergência</h2>
<p>Em desenvolvimento</p>
<h3 id="sec_conv_Euler">Convergência do método de Euler</h3>
<p>Em desenvolvimento</p>
<h3 id="convergência-do-método-de-euler-melhorado">Convergência do método de Euler Melhorado</h3>
<p>Em desenvolvimento</p>
<h2 id="sec_RK">Métodos de Runge-Kutta</h2>
<p>Os métodos de Runge-Kutta consistem em iterações do tipo: <br /><span class="math"><em>y</em><sup>(<em>k</em> + 1)</sup> = <em>y</em><sup>(<em>k</em>)</sup> + <em>w</em><sub>1</sub><em>k</em><sub>1</sub> + … + <em>w</em><sub><em>n</em></sub><em>k</em><sub><em>n</em></sub></span><br /> onde <br /><span class="math">$$\begin{aligned}
k_1&amp;=&amp;hf(y^{(k)},t^{(k)})\\
k_2&amp;=&amp;hf(y^{(k)}+\alpha_{2,1}k_1,t^{(k)}+\beta_{2}h)\\
k_3&amp;=&amp;hf(y^{(k)}+\alpha_{3,1}k_1+\alpha_{3,2}k_2,t^{(k)}+\beta_{3}h)\\
&amp;\vdots&amp;\\
k_n&amp;=&amp;hf(y^{(k)}+\alpha_{n,1}k_1+\alpha_{n,2}k_2+\ldots \alpha_{n,n-1}k_{n-1},t^{(k)}+\beta_{n}h)\\\end{aligned}$$</span><br /></p>
<p>Os coeficientes são escolhidos de forma que a expansão em Taylor de <span class="math"><em>y</em><sup>(<em>k</em> + 1)</sup></span> e <span class="math"><em>y</em><sup>(<em>k</em>)</sup> + <em>w</em><sub>1</sub><em>k</em><sub>1</sub> + … + <em>w</em><sub><em>n</em></sub><em>k</em><sub><em>n</em></sub></span> coincidam até ordem <span class="math"><em>n</em> + 1</span>.</p>
<p>O método de Euler melhorado é um exemplo de Runge-Kutta de segunda ordem <br /><span class="math">$$y^{(n+1)}=y^{(n)}+\frac{k_1+k_2}{2}$$</span><br /> onde <span class="math"><em>k</em><sub>1</sub> = <em>h</em><em>f</em>(<em>y</em><sup>(<em>n</em>)</sup>, <em>t</em><sup>(<em>n</em>)</sup>)</span> e <span class="math"><em>k</em><sub>2</sub> = <em>h</em><em>f</em>(<em>y</em><sup>(<em>n</em>)</sup> + <em>k</em><sub>1</sub>, <em>t</em><sup>(<em>n</em>)</sup> + <em>h</em>)</span></p>
<h3 id="métodos-de-runge-kutta---quarta-ordem">Métodos de Runge-Kutta - Quarta ordem</h3>
<p><br /><span class="math">$$y^{(n+1)}=y^{(n)}+\frac{k_1+2k_2+2k_3+k_4}{6}$$</span><br /> onde <br /><span class="math">$$\begin{aligned}
k_1&amp;=&amp;hf(y^{(n)},t^{(n)})\\
k_2&amp;=&amp;hf(y^{(n)}+k_1/2,t^{(n)}+h/2)\\
k_3&amp;=&amp;hf(y^{(n)}+k_2/2,t^{(n)}+h/2)\\
k_4&amp;=&amp;hf(y^{(n)}+k_3,t^{(n)}+h)\\\end{aligned}$$</span><br /> Este método tem ordem de precisão 4. Uma discussão heurística usando método de Simpson pode ajudar a compreender os estranhos coeficientes: <br /><span class="math">$$\begin{aligned}
y({t^{(n+1)}})-y({t^{(n)}})&amp;=&amp;\int_{t^{(n)}}^{t^{(n+1)}}f(y(s),s)ds \\
&amp;\approx&amp; \frac{h}{6}\left[ f\left(y(t^{(n)}),t^{(n)}\right)+4f\left(y(t^{(n)}+h/2),t^{(n)}+h/2\right)\right.\\
&amp;+&amp;\left.f\left(y(t^{(n)}+h),t^{(n)}+h\right)\right]\\
&amp;\approx&amp; \frac{k_1+4(\frac{k_2+k_3}{2})+k_4}{6}\end{aligned}$$</span><br /> onde <span class="math"><em>k</em><sub>1</sub></span> e <span class="math"><em>k</em><sub>4</sub></span> representam as inclinações nos extremos e <span class="math"><em>k</em><sub>2</sub></span> e <span class="math"><em>k</em><sub>3</sub></span> são duas aproximações diferentes para a inclinação no meio do intervalo.</p>
<h2 id="métodos-de-passo-múltiplo---adams-bashforth">Métodos de passo múltiplo - Adams-Bashforth</h2>
<p>O método de Adams-Bashforth consiste de um esquema recursivo do tipo: <br /><span class="math">$$y^{(n+1)}=y^{(n)}+\sum_{j=0}^k w_jf(y^{(n-j)},t^{(n-j)})$$</span><br /></p>
<p>Adams-Bashforth de segunda ordem <br /><span class="math">$$y^{(n+1)}=y^{(n)}+\frac{h}{2}\left[3f\left(y^{(n)},t^{(n)}\right)-f\left(y^{(n-1)},t^{(n-1)}\right)\right]$$</span><br /></p>
<p>Adams-Bashforth de terceira ordem <br /><span class="math">$$y^{(n+1)}=y^{(n)}+\frac{h}{12}\left[23f\left(y^{(n)},t^{(n)}\right)-16f\left(y^{(n-1)},t^{(n-1)}\right)+5f\left(y^{(n-2)},t^{(n-2)}\right)\right]$$</span><br /></p>
<p>Adams-Bashforth de quarta ordem <br /><span class="math">$$\begin{split}
      y^{(n+1)} &amp;= y^{(n)} + \frac{h}{24}\left[55f\left(y^{(n)},t^{(n)}\right)-59f\left(y^{(n-1)},t^{(n-1)}\right)\right.\\
        &amp;+\left. 37f\left(y^{(n-2)},t^{(n-2)}\right)-9f\left(y^{(n-3)},t^{(n-3)}\right)\right]    
    \end{split}$$</span><br /></p>
<p>Os métodos de passo múltiplo evitam os múltiplos estágios do métodos de Runge-Kutta, mas exigem ser “iniciados” com suas condições iniciais.</p>
<h2 id="métodos-de-passo-múltiplo---adams-moulton">Métodos de passo múltiplo - Adams-Moulton</h2>
<p>O método de Adams-Moulton consiste de um esquema recursivo do tipo: <br /><span class="math">$$y^{(n+1)}=y^{(n)}+\sum_{j=-1}^k w_jf(y^{(n-j)},t^{(n-j)})$$</span><br /></p>
<p>Adams-Moulton de quarta ordem <br /><span class="math">$$\begin{split}
      y^{(n+1)} &amp;= y^{(n)} + \frac{h}{24}\left[9f\left(y^{(n+1)},t^{(n+1)}\right) + 19f\left(y^{(n)},t^{(n)}\right) \right.\\
      &amp;-\left. 5f\left(y^{(n-1)},t^{(n-1)}\right) + f\left(y^{(n-2)},t^{(n-2)}\right)\right]      
    \end{split}$$</span><br /> <br /><span class="math"></span><br /></p>
<p>O método de Adams-Moulton é implícito, ou seja, exige que a cada passo, uma equação em <span class="math"><em>y</em><sup>(<em>n</em> + 1)</sup></span> seja resolvida.</p>
<h2 id="estabilidade">Estabilidade</h2>
<p>Consideremos o seguinte problema de teste: <br /><span class="math">$$\left\{\begin{array}{rcl}y'&amp;=&amp;-\alpha y\\y(0)&amp;=&amp;1\end{array}\right.$$</span><br /> cuja solução exata é dada por <span class="math"><em>y</em>(<em>t</em>) = <em>e</em><sup> − <em>α</em><em>t</em></sup></span>.</p>
<p>Considere agora o método de Euler aplicado a este problema com passa <span class="math"><em>h</em></span>: <br /><span class="math">$$\left\{\begin{array}{rcl}y^{(k+1)}&amp;=&amp;y^{(k)}-\alpha h y^{(k)}\\y^{(1)}&amp;=&amp;1\end{array}\right.$$</span><br /> A solução exata do esquema de Euler é dada por <br /><span class="math"><em>y</em><sup>(<em>k</em> + 1)</sup> = (1 − <em>α</em><em>h</em>)<sup><em>k</em></sup></span><br /> e, portanto, <br /><span class="math">$$\tilde{y}(t)=y^{(k+1)}=(1-\alpha h)^{t/h}$$</span><br /></p>
<p>Fixamos um <span class="math"><em>α</em> &gt; 0</span>, de forma que <span class="math"><em>y</em>(<em>t</em>) → 0</span>. Mas observamos que <span class="math">$\tilde{y}(t)\to 0$</span> somente quando <span class="math">|1 − <em>α</em><em>h</em>| &lt; 1</span> e solução positivas somente quando <span class="math"><em>α</em><em>h</em> &lt; 1</span>.</p>
<p><span><strong>Conclusão:</strong></span> Se o passo <span class="math"><em>h</em></span> for muito grande, o método pode se tornar instável, produzindo solução espúrias.</p>
<h2 id="exercícios-23" class="unnumbered">Exercícios</h2>
<p>Resolva o problema 1 pelos diversos métodos e verifique heuristicamente a estabilidade para diversos valores de <span class="math"><em>h</em></span>.</p>
<h2 id="exercícios-finais-3" class="unnumbered">Exercícios finais</h2>
<p>Considere o seguinte modelo para o crescimento de uma colônia de bactérias: <br /><span class="math">$$\frac{dy}{dt}=\alpha y (A-y)$$</span><br /> onde <span class="math"><em>y</em></span> indica a densidade de bactérias em unidades arbitrárias na colônia e <span class="math"><em>α</em></span> e <span class="math"><em>A</em></span> são constantes positivas. Pergunta-se:</p>
<ul>
<li><p>Qual a solução quando a condição inicial <span class="math"><em>y</em>(0)</span> é igual a <span class="math">0</span> ou <span class="math"><em>A</em></span>?</p></li>
<li><p>O que acontece quando a condição inicial <span class="math"><em>y</em>(0)</span> é um número entre <span class="math">0</span> e <span class="math"><em>A</em></span>?</p></li>
<li><p>O que acontece quando a condição inicial <span class="math"><em>y</em>(0)</span> é um número negativo?</p></li>
<li><p>O que acontece quando a condição inicial <span class="math"><em>y</em>(0)</span> é um número positivo maior que A?</p></li>
<li><p>Se <span class="math"><em>A</em> = 10</span> e <span class="math"><em>α</em> = 1</span> e <span class="math"><em>y</em>(0) = 1</span>, use métodos numéricos para obter tempo necessário para que a população dobre?</p></li>
<li><p>Se <span class="math"><em>A</em> = 10</span> e <span class="math"><em>α</em> = 1</span> e <span class="math"><em>y</em>(0) = 4</span>, use métodos numéricos para obter tempo necessário para que a população dobre?</p></li>
</ul>
<p>Os valores exatos para os itens e e f são:<span class="math">$\frac{1}{10}\ln\left(\frac{9}{4}\right)$</span> e <span class="math">$\frac{1}{10}\ln\left(6\right)$</span></p>
<p>Considere o seguinte modelo para a evolução da velocidade de um objeto em queda (unidades no SI): <br /><span class="math"><em>v</em>′ = <em>g</em> − <em>α</em><em>v</em><sup>2</sup></span><br /> Sabendo que <span class="math"><em>g</em> = 9, 8</span> e <span class="math"><em>α</em> = 10<sup> − 2</sup></span> e <span class="math"><em>v</em>(0) = 0</span>. Pede-se a velocidade ao tocar o solo, sabendo que a altura inicial era 100.</p>
<p>O valor exato é <span class="math">$\sqrt{\frac{g}{\alpha}\left[1-e^{{-200\alpha}}\right]}$</span> em <span class="math">$t=\frac{1}{\sqrt{g\alpha}}\tanh^{-1}\left(\sqrt{1-e^{{-200\alpha}}}\right)$</span></p>
<p>Considere o seguinte modelo para o oscilador não-linear de Van der Pol: <br /><span class="math"><em>y</em>″(<em>t</em>) − <em>α</em>(<em>A</em> − <em>y</em>(<em>t</em>)<sup>2</sup>)<em>y</em>′(<em>t</em>) + <em>w</em><sub>0</sub><sup>2</sup><em>y</em>(<em>t</em>) = 0</span><br /> onde <span class="math"><em>A</em></span>, <span class="math"><em>α</em></span> e <span class="math"><em>w</em><sub>0</sub></span> são constantes positivas.</p>
<ul>
<li><p>Encontre a frequência e a amplitude de oscilações quando <span class="math"><em>w</em><sub>0</sub> = 1</span>, <span class="math"><em>α</em> = .1</span> e <span class="math"><em>A</em> = 10</span>. (Teste diversas condições iniciais)</p></li>
<li><p>Estude a dependência da frequência e da amplitude com os parâmetros <span class="math"><em>A</em></span>, <span class="math"><em>α</em></span> e <span class="math"><em>w</em><sub>0</sub></span>. (Teste diversas condições iniciais)</p></li>
<li><p>Que diferenças existem entre esse oscilador não-linear e o oscilador linear?</p></li>
</ul>
<p>Considere o seguinte modelo para um oscilador não-linear: <br /><span class="math">$$\begin{aligned}
y''(t)-\alpha(A-z(t))y'(t)+w_0^2 y(t)&amp;=&amp;0\\
Cz'(t)+z(t)&amp;=&amp;y(t)^2\end{aligned}$$</span><br /> onde <span class="math"><em>A</em></span>, <span class="math"><em>α</em></span>, <span class="math"><em>w</em><sub>0</sub></span> e <span class="math"><em>C</em></span> são constantes positivas.</p>
<ul>
<li><p>Encontre a frequência e a amplitude de oscilações quando <span class="math"><em>w</em><sub>0</sub> = 1</span>, <span class="math"><em>α</em> = .1</span>, <span class="math"><em>A</em> = 10</span> e <span class="math"><em>C</em> = 10</span>. (Teste diversas condições iniciais)</p></li>
<li><p>Estude a dependência da frequência e da amplitude com os parâmetros <span class="math"><em>A</em></span>, <span class="math"><em>α</em></span>, <span class="math"><em>w</em><sub>0</sub></span> e <span class="math"><em>C</em></span>. (Teste diversas condições iniciais)</p></li>
</ul>
<p>Considere o seguinte modelo para o controle de temperatura em um processo químico: <br /><span class="math">$$\begin{aligned}
CT'(t)+T(t)&amp;=&amp;\kappa P(t)+T_{ext}\\
P'(t)&amp;=&amp;\alpha(T_{set}-T(t))\end{aligned}$$</span><br /> onde <span class="math"><em>C</em></span>, <span class="math"><em>α</em></span> e <span class="math"><em>κ</em></span> são constantes positivas e <span class="math"><em>P</em>(<em>t</em>)</span> indica o potência do aquecedor. Sabendo que <span class="math"><em>T</em><sub><em>s</em><em>e</em><em>t</em></sub></span> é a temperatura desejada, interprete o funcionamento esse sistema de controle.</p>
<ul>
<li><p>Calcule a solução quando a temperatura externa <span class="math"><em>T</em><sub><em>e</em><em>x</em><em>t</em></sub> = 0</span>, <span class="math"><em>T</em><sub><em>s</em><em>e</em><em>t</em></sub> = 1000</span>, <span class="math"><em>C</em> = 10</span>, <span class="math"><em>κ</em> = .1</span> e <span class="math"><em>α</em> = .1</span>. Considere condições iniciais nulas.</p></li>
<li><p>Quanto tempo demora o sistema para atingir a temperatura 900K?</p></li>
<li><p>Refaça os dois primeiros itens com <span class="math"><em>α</em> = 0.2</span> e <span class="math"><em>α</em> = 1</span></p></li>
<li><p>Faça testes para verificar a influência de <span class="math"><em>T</em><sub><em>e</em><em>x</em><em>t</em></sub></span>, <span class="math"><em>α</em></span> e <span class="math"><em>κ</em></span> na temperatura final.</p></li>
</ul>
<p>Considere a equação do pêndulo dada por: <br /><span class="math">$$\frac{d^2\theta(t)}{dt^2}+\frac{g}{l}\sin(\theta(t))=0$$</span><br /> onde <span class="math"><em>g</em></span> é o módulo da aceleração da gravidade e <span class="math"><em>l</em></span> é o comprimento da haste.</p>
<ul>
<li><p>Mostre analiticamente que a energia total do sistema dada por <br /><span class="math">$$\frac{1}{2}\left(\frac{d\theta(t)}{dt}\right)^2-\frac{g}{l}\cos(\theta(t))$$</span><br /> é mantida constante.</p></li>
<li><p>Resolva numericamente esta equação para <span class="math"><em>g</em> = 9, 8<em>m</em>/<em>s</em><sup>2</sup></span> e <span class="math"><em>l</em> = 1<em>m</em></span> e as seguintes condições iniciais: <span class="math"><em>θ</em>(0) = 0.5</span> e <span class="math"><em>θ</em>′(0) = 0</span>. <span class="math"><em>θ</em>(0) = 1.0</span> e <span class="math"><em>θ</em>′(0) = 0</span>. <span class="math"><em>θ</em>(0) = 1.5</span> e <span class="math"><em>θ</em>′(0) = 0</span>. <span class="math"><em>θ</em>(0) = 2.0</span> e <span class="math"><em>θ</em>′(0) = 0</span>. <span class="math"><em>θ</em>(0) = 2.5</span> e <span class="math"><em>θ</em>′(0) = 0</span>. <span class="math"><em>θ</em>(0) = 3.0</span> e <span class="math"><em>θ</em>′(0) = 0</span>.</p></li>
</ul>
<p>Em todos os casos, verifique se o método numérico reproduz a lei de conservação de energia e calcule período e amplitude.</p>
<p>Considere o modelo simplificado de FitzHugh-Nagumo para o potencial elétrico sobre a membrana de um neurônio: <br /><span class="math">$$\begin{aligned}
\frac{d V}{dt}&amp; = &amp;  V-V^3/3 - W +  I  \\
\frac{d W}{dt} &amp; = &amp; 0.08(V+0.7 - 0.8W)\end{aligned}$$</span><br /> onde <span class="math"><em>I</em></span> é a corrente de excitação.</p>
<ul>
<li><p>Encontre o único estado estacionário <span class="math">(<em>V</em><sub>0</sub>, <em>W</em><sub>0</sub>)</span> com <span class="math"><em>I</em> = 0</span>.</p></li>
<li><p>Resolva numericamente o sistema com condições iniciais dadas por <span class="math">(<em>V</em><sub>0</sub>, <em>W</em><sub>0</sub>)</span> e <span class="math"><em>I</em> = 0</span> <span class="math"><em>I</em> = 0.2</span> <span class="math"><em>I</em> = 0.4</span> <span class="math"><em>I</em> = 0.8</span> <span class="math"><em>I</em> = <em>e</em><sup> − <em>t</em>/200</sup></span></p></li>
</ul>
<p>Considere o problema de valor inicial dado por <br /><span class="math">$$\begin{aligned}
\frac{d u(t)}{dt} &amp;=&amp; -u(t) + e^{-t} \\
u(0)&amp;=&amp;0\end{aligned}$$</span><br /> Resolva analiticamente este problema usando as técnicas elementares de equações diferenciais ordinárias. A seguir encontre aproximações numéricas usando os métodos de Euler, Euler modificado, Runge-Kutta Clássico e Adams-Bashforth de ordem 4 conforme pedido nos itens.</p>
<ul>
<li><p>Construa uma tabela apresentando valores com 7 algarismos significativos para comparar a solução analítica com as aproximações numéricas produzidas pelos métodos sugeridos. Construa também uma tabela para o erro absoluto obtido por cada método numérico em relação à solução analítica. Nesta última tabela, expresse o erro com 2 algarismos significativos em formato científico. Dica: <span class="math"><em>f</em><em>o</em><em>r</em><em>m</em><em>a</em><em>t</em>(′<em>e</em>′, 8)</span> para a segunda tabela.</p>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">0.5</th>
<th align="center">1.0</th>
<th align="center">1.5</th>
<th align="center">2.0</th>
<th align="center">2.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Analítico</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">Euler</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">Euler modificado</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">Runge-Kutta Clássico</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">Adams-Bashforth ordem 4</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">0.5</th>
<th align="center">1.0</th>
<th align="center">1.5</th>
<th align="center">2.0</th>
<th align="center">2.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Euler</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">Euler modificado</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">Runge-Kutta Clássico</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">Adams-Bashforth ordem 4</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table></li>
<li><p>Calcule o valor produzido por cada um desses método para <span class="math"><em>u</em>(1)</span> com passo <span class="math"><em>h</em> = 0.1</span>, <span class="math"><em>h</em> = 0.05</span>, <span class="math"><em>h</em> = 0.01</span>, <span class="math"><em>h</em> = 0.005</span> e <span class="math"><em>h</em> = 0.001</span>. Complete a tabela com os valores para o erro absoluto encontrado.</p>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">0.1</th>
<th align="center">0.05</th>
<th align="center">0.01</th>
<th align="center">0.005</th>
<th align="center">0.001</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Euler</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">Euler modificado</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">Runge-Kutta Clássico</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">Adams-Bashforth ordem 4</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table></li>
</ul>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">0.5</th>
<th align="center">1.0</th>
<th align="center">1.5</th>
<th align="center">2.0</th>
<th align="center">2.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Analítico</td>
<td align="center">0.3032653</td>
<td align="center">0.3678794</td>
<td align="center">0.3346952</td>
<td align="center">0.2706706</td>
<td align="center">0.2052125</td>
</tr>
<tr class="even">
<td align="center">Euler</td>
<td align="center">0.3315955</td>
<td align="center">0.3969266</td>
<td align="center">0.3563684</td>
<td align="center">0.2844209</td>
<td align="center">0.2128243</td>
</tr>
<tr class="odd">
<td align="center">Euler modificado</td>
<td align="center">0.3025634</td>
<td align="center">0.3671929</td>
<td align="center">0.3342207</td>
<td align="center">0.2704083</td>
<td align="center">0.2051058</td>
</tr>
<tr class="even">
<td align="center">Runge-Kutta Clássico</td>
<td align="center">0.3032649</td>
<td align="center">0.3678790</td>
<td align="center">0.3346949</td>
<td align="center">0.2706703</td>
<td align="center">0.2052124</td>
</tr>
<tr class="odd">
<td align="center">Adams-Bashforth ordem 4</td>
<td align="center">0.3032421</td>
<td align="center">0.3678319</td>
<td align="center">0.3346486</td>
<td align="center">0.2706329</td>
<td align="center">0.2051848</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">0.5</th>
<th align="center">1.0</th>
<th align="center">1.5</th>
<th align="center">2.0</th>
<th align="center">2.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Euler</td>
<td align="center">2.8D-02</td>
<td align="center">2.9D-02</td>
<td align="center">2.2D-02</td>
<td align="center">1.4D-02</td>
<td align="center">7.6D-03</td>
</tr>
<tr class="even">
<td align="center">Euler modificado</td>
<td align="center">7.0D-04</td>
<td align="center">6.9D-04</td>
<td align="center">4.7D-04</td>
<td align="center">2.6D-04</td>
<td align="center">1.1D-04</td>
</tr>
<tr class="odd">
<td align="center">Runge-Kutta Clássico</td>
<td align="center">4.6D-07</td>
<td align="center">4.7D-07</td>
<td align="center">3.5D-07</td>
<td align="center">2.2D-07</td>
<td align="center">1.2D-07</td>
</tr>
<tr class="even">
<td align="center">Adams-Bashforth ordem 4</td>
<td align="center">2.3D-05</td>
<td align="center">4.8D-05</td>
<td align="center">4.7D-05</td>
<td align="center">3.8D-05</td>
<td align="center">2.8D-05</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">0.1</th>
<th align="center">0.05</th>
<th align="center">0.01</th>
<th align="center">0.005</th>
<th align="center">0.001</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Euler</td>
<td align="center">2.9D-02</td>
<td align="center">5.6D-03</td>
<td align="center">2.8D-03</td>
<td align="center">5.5D-04</td>
<td align="center">2.8D-04</td>
</tr>
<tr class="even">
<td align="center">Euler modificado</td>
<td align="center">6.9D-04</td>
<td align="center">2.5D-05</td>
<td align="center">6.2D-06</td>
<td align="center">2.5D-07</td>
<td align="center">6.1D-08</td>
</tr>
<tr class="odd">
<td align="center">Runge-Kutta Clássico</td>
<td align="center">4.7D-07</td>
<td align="center">6.9D-10</td>
<td align="center">4.3D-11</td>
<td align="center">6.8D-14</td>
<td align="center">4.4D-15</td>
</tr>
<tr class="even">
<td align="center">Adams-Bashforth ordem 4</td>
<td align="center">4.8D-05</td>
<td align="center">9.0D-08</td>
<td align="center">5.7D-09</td>
<td align="center">9.2D-12</td>
<td align="center">5.8D-13</td>
</tr>
</tbody>
</table>
<h1 id="cap:scilab">Rápida Introdução ao Scilab</h1>
<h2 id="sobre-o-scilab">Sobre o Scilab</h2>
<p>Scilab é uma linguagem de programação associada com uma rica coleção de algoritmos numéricos que cobrem muitos aspectos de problemas de computação científica. Do ponto de vista de <span><em>software</em></span>, Scilab é uma linguagem interpretada. A linguagem Scilab permite a compilação dinâmica e lincagem com outras linguagens como Fortran e C. Do ponto de vista de licença, Scilab é um software gratuito no sentido que o usuário não paga por ele. Além disso, Scilab é um software de código aberto disponível sobre a licença Cecill <span class="citation"></span>. Scilab esta disponível para Linux, Mac Os e Windows. Ajuda <span><em>online</em></span> esta disponível em português e muitas outras línguas. Do ponto de vista científico, Scilab começou focado em soluções computacionais para problemas de álgebra linear, mas, rapidamente, o número de aplicações se estendeu para muitas áreas da computação científica.</p>
<p>As informações deste apêndice foram adaptadas do tutorial “Introduction to Scilab” <span class="citation"></span>, veja-o para maiores informações. Além disso, recomendamos visitar o sítio oficial do Scilab:</p>
<p><a href="www.scilab.org" class="uri">www.scilab.org</a></p>
<p>O manual oficial do Scilab em português pode ser obtido em:</p>
<p><a href="http://help.scilab.org/docs/5.5.2/pt_BR/index.html" class="uri">http://help.scilab.org/docs/5.5.2/pt_BR/index.html</a></p>
<h3 id="instalação-e-execução">Instalação e Execução</h3>
<p>O Scilab pode ser executado normalmente nos sistemas operacionais Linux, Mac Os e Windows. Muitas distribuições de Linux (Linux Mint, Ubuntu, etc.) têm o Scilab no seu sistema de pacotes (incluindo binário e documentação em várias línguas). Alternativamente, no <a href="www.scilab.org">sítio de internet oficial do Scilab</a> pode-se obter mais versões de binários e documentação para instalação em sistemas Linux. Para a instalação em sistemas Mac Os e Windows, visite <a href="www.scilab.org">sítio de internet oficial do Scilab</a>.</p>
<h3 id="usando-o-scilab">Usando o Scilab</h3>
<p>O uso do Scilab pode ser feito de três formas básicas:</p>
<ul>
<li><p>usando o <span><strong>console</strong></span> de modo iterativo;</p></li>
<li><p>usando a função <code>exec</code> para executar um código Scilab digitado em um arquivo externo;</p></li>
<li><p>usando processamento <span><em>bash</em></span>.</p></li>
</ul>
<p>Considere o seguinte pseudocódigo:</p>
<pre><code>s = &quot;Olá Mundo!&quot;. (Sem imprimir na tela o resultado.)
saída(s). (Imprime na tela.)</code></pre>
<p>Implemente este pseudocódigo no Scilab: a) usando somente o console do Scilab; b) usando o editor do Scilab e executando o código com a função <code>exec</code>; c) usando processamento <span><em>bash</em></span>.</p>
<p>Seguem as soluções de cada item:</p>
<ul>
<li><p>No console temos:</p>
<pre><code>--&gt;s = &quot;Olá Mundo!&quot;;
--&gt;disp(s)</code></pre></li>
<li><p>Para abrir o editor do Scilab pode-se digitar no <code>prompt</code>:</p>
<pre><code>--&gt;editor()</code></pre>
<p>ou, alternativamente:</p>
<pre><code>--&gt;scinotes</code></pre>
<p>Então, digita-se no editor o código:</p>
<pre><code>s = &quot;Olá Mundo!&quot;
disp(s)</code></pre>
<p>salva-se em um arquivo de sua preferência (por exemplo, <code>~/foo.sce</code>) e executa-se o código clicando no botão “<span><em>play</em></span>” disponível na barra de botões do Scinotes.</p></li>
<li><p>Para executar o código em processamento <span><em>bash</em></span>, digita-se em um editor o código:</p>
<pre><code>s = &quot;Olá Mundo!&quot;
disp(s)</code></pre>
<p>salva-se em um arquivo de sua preferência (por exemplo, <code>~/foo.sce</code>) e executa-se em um console do sistema usando a linha de comando:</p>
<pre><code>$ scilab -nw -f ~/foo.sce</code></pre>
<p>Digite, então, <code>quit</code> para voltar ao prompt do sistema.</p></li>
</ul>
<h2 id="elementos-da-linguagem">Elementos da linguagem</h2>
<p>Scilab é uma linguagem interpretada em que todas as variáveis são matrizes. Uma variável é criada quando um valor é atribuído a ela. Por exemplo:</p>
<pre><code>--&gt;x=1
 x  =
    1.  
--&gt;y = x * 2
 y  =
    2.  </code></pre>
<p>a variável <code>x</code> recebe o valor <code>double</code> <span class="math">1</span> e, logo após, na segunda linha de comando, a variável <code>y</code> recebe o valor <code>double</code> <span class="math">2</span>. Observamos que o símbolo <code>=</code> significa o operador de atribuição não o de igualdade. O operador lógico de igualdade no Scilab é <code>==</code>.</p>
<p>Comentários e continuação de linha de comando são usados como no seguinte exemplo:</p>
<pre><code>--&gt;//Isto é um comentário
--&gt;x = 1 ..
--&gt;+ 2
 x  =
    3.  </code></pre>
<h3 id="operações-matemáticas-elementares">Operações matemáticas elementares</h3>
<p>No Scilab, os operadores matemáticos elementares são os seguintes:</p>
<pre><code>  + adição
  - subtração
  * multiplicação
  / divisão
  ^ potenciação (igual a **)
  &#39; transposto conjugado</code></pre>
<h3 id="funções-e-constantes-elementares">Funções e constantes elementares</h3>
<p>Várias funções e constantes elementares já estão pré-definidas no Scilab. Por exemplo:</p>
<pre><code>--&gt;cos(%pi) //cosseno de pi
 ans  =
  - 1.  
 
--&gt;exp(1) == %e //número de Euler
 ans  =
  T  
 
--&gt;log(1) //logarítmo natual de 1
 ans  =
    0.  </code></pre>
<p>Para mais informações sobre quais as funções e constantes pré-definidas no Scilab, consulte o manual, seções “Funções elementares” e o carácter especial ``%&quot;.</p>
<h3 id="operadores-lógicos">Operadores lógicos</h3>
<p>No Scilab, o valor lógico verdadeiro é escrito como <code>%T</code> e o valor lógico falso como <code>%F</code>. Temos os seguintes operadores lógicos disponíveis:</p>
<pre><code>&amp;  e lógico
|  ou lógico
~  negação
== igualdade
~= diferente
&lt;  menor que
&gt;  maior que
&lt;= menor ou igual que
&gt;= maior ou igual que</code></pre>
<p>Se <span class="math"><em>x</em> = 2</span>, então <span class="math"><em>x</em></span> é maior ou igual a 1 e menor que 3?</p>
<p>No Scilab, temos:</p>
<pre><code>--&gt;x=2;
 
--&gt;(x &gt;= 1) &amp; (x &lt; 3)
 ans  =
 
  T  </code></pre>
<h2 id="matrizes">Matrizes</h2>
<p>No Scilab, matriz é o tipo básico de dados, a qual é definida por seu número de linhas, colunas e tipo de dado (real, inteiro, lógico, etc.). Uma matriz <span class="math"><em>A</em> = [<em>a</em><sub><em>i</em>, <em>j</em></sub>]<sub><em>i</em>, <em>j</em> = 1</sub><sup><em>m</em>, <em>n</em></sup></span> no Scilab é definida usando-se a seguinte sintaxe:</p>
<pre><code>A = [ a11 , a12 , ... , a1n ; ...; am1 , am2 , ... , amn ]</code></pre>
<p>Defina a matriz: <br /><span class="math">$$A = \left[
      \begin{array}{ccc}
        1 &amp; 2 &amp; 3\\
        4 &amp; 5 &amp; 6
      \end{array}
\right]$$</span><br /></p>
<p>No Scilab, digitamos:</p>
<pre><code>--&gt;A = [1 , 2 , 3 ; 4 , 5 , 6]
 A  =
 
    1.    2.    3.  
    4.    5.    6.  </code></pre>
<p>A seguinte lista contém uma série de funções que geram matrizes particulares:</p>
<pre><code>eye      matrix identidade
linspace vetor de elementos linearmente espaçados
ones     matriz cheia de uns
zeros    matriz nula</code></pre>
<h3 id="o-operador">O operador “:”</h3>
<p>O operador “:” cria um vetor linha de elementos. A sintaxe:</p>
<pre><code>v = i:s:j</code></pre>
<p>cria um vetor linha: <br /><span class="math">$$v = [i,~i+s,~i+2s,\dotsc, i+ns]$$</span><br /> onde <span class="math"><em>n</em></span> é o maior inteiro tal que <span class="math"><em>i</em> + <em>n</em><em>s</em> &lt; <em>j</em></span>.</p>
<p>Veja as seguintes linhas de comando:</p>
<pre><code>--&gt;v = 10:-2:3
 v  =
 
    10.    8.    6.    4.  
 
--&gt;u = 2:6
 u  =
    2.    3.    4.    5.    6.</code></pre>
<h3 id="obtendo-dados-de-uma-matriz">Obtendo dados de uma matriz</h3>
<p>A função <code>size</code> retorna o tamanho de uma matriz, por exemplo:</p>
<pre><code>--&gt;A = ones(3,2)
 A  =
 
    1.    1.  
    1.    1.  
    1.    1.  
 
--&gt;[nl, nc] = size(A)
 nc  =
 
    2.  
 nl  =
 
    3.  </code></pre>
<p>informando que a matriz <code>A</code> tem três linhas e duas colunas.</p>
<p>Existem vários métodos para se acessar os elementos de uma matriz dada <code>A</code>:</p>
<ul>
<li><p>a matriz inteira acessa-se com a sintaxe:</p>
<pre><code>A</code></pre></li>
<li><p>o elemento da <span class="math"><em>i</em></span>-ésima linha e <span class="math"><em>j</em></span>-ésima coluna acessa-se usando a sintaxe:</p>
<pre><code>A(i,j)</code></pre></li>
<li><p>o bloco formado pelas linhas <span class="math"><em>i</em><sub>1</sub></span>, <span class="math"><em>i</em><sub>2</sub></span> e pelas colunas <span class="math"><em>j</em><sub>1</sub></span>, <span class="math"><em>j</em><sub>2</sub></span> obtém-se usando a sintaxe:</p>
<pre><code>A(i1:i2, j1:j2)</code></pre></li>
</ul>
<p>Veja as seguintes linhas de comando:</p>
<pre><code>--&gt;A = rand(3,4) //gera uma matriz randômica
 A  =
 
    0.2113249    0.3303271    0.8497452    0.0683740  
    0.7560439    0.6653811    0.6857310    0.5608486  
    0.0002211    0.6283918    0.8782165    0.6623569  
 
--&gt;A //mostra toda a matriz A
 ans  =
 
    0.2113249    0.3303271    0.8497452    0.0683740  
    0.7560439    0.6653811    0.6857310    0.5608486  
    0.0002211    0.6283918    0.8782165    0.6623569  
 
--&gt;A(2,3) //acessa o elemento a23
 ans  =
 
    0.6857310  
 
--&gt;A(2:3,2:4) //acessa um bloco de A
 ans  =
 
    0.6653811    0.6857310    0.5608486  
    0.6283918    0.8782165    0.6623569  </code></pre>
<p>Definida uma matriz <span class="math"><em>A</em></span> no Scilab, as seguintes sintaxes são bastante úteis:</p>
<pre><code>A(:,:)   toda a matriz
A(i:j,k) os elementos das linhas i até j (inclusive) da k-ésima coluna
A(i,j:k) os elementos da i-ésina linha das colunas j até k (inclusive)
A(i,:)   a i-ésima linha da matriz
A(:,j)   a j-ésima coluna da matriz
A(i,$)   o elemento da i-ésima linha e da última coluna
A($,j)   o elemento da última linha e da j-ésima coluna</code></pre>
<p>Veja as seguintes linhas de comando:</p>
<pre><code>--&gt;B = rand(4,4)
 B  =
 
    0.2113249    0.6653811    0.8782165    0.7263507  
    0.7560439    0.6283918    0.0683740    0.1985144  
    0.0002211    0.8497452    0.5608486    0.5442573  
    0.3303271    0.6857310    0.6623569    0.2320748  
 
--&gt;aux = B(:,2); B(:,2) = B(:,3); B(:,3) = aux
 B  =
 
    0.2113249    0.8782165    0.6653811    0.7263507  
    0.7560439    0.0683740    0.6283918    0.1985144  
    0.0002211    0.5608486    0.8497452    0.5442573  
    0.3303271    0.6623569    0.6857310    0.2320748  </code></pre>
<h3 id="operações-matriciais-e-elemento-a-elemento">Operações matriciais e elemento-a-elemento</h3>
<p>As operações matriciais elementares seguem a mesma sintaxe que as operações elementares de números. Agora, no Scilab, também podemos fazer operações elemento-a-elemento colocando um ponto “.” antes da operação desejada.</p>
<p>Aqui, temos as sintaxes análogas entre operações matriciais e operações elemento-a-elemento:</p>
<pre><code>+ adição               .+ adição elemento-a-elemento
- subtração            .- subtração elemento-a-elemento
* multiplicação        .* multiplicação elemento-a-elemento
                       ./ divisão elemento-a-elemento
^ potenciação          .^ potenciação elemento-a-elemento
&#39; transposta conjugada .&#39; transposta (não conjugada)</code></pre>
<p>Veja as seguintes linhas de comando:</p>
<pre><code>--&gt;A = ones (2 ,2)
 A  =
 
    1.    1.  
    1.    1.  
 
--&gt;B = 2 * ones (2 ,2)
 B  =
 
    2.    2.  
    2.    2.  
 
--&gt;A * B
 ans  =
 
    4.    4.  
    4.    4.  
 
--&gt;A .* B
 ans  =
 
    2.    2.  
    2.    2.  </code></pre>
<h2 id="estruturas-de-ramificação-e-repetição">Estruturas de ramificação e repetição</h2>
<p>O Scilab contém estruturas de repetição e ramificação padrões de linguagens estruturadas.</p>
<h3 id="a-instrução-de-ramificação-if">A instrução de ramificação “if”</h3>
<p>A instrução “if” permite executar um pedaço do código somente se uma dada condição for satisfeita.</p>
<p>Veja o seguinte código Scilab:</p>
<pre><code>i = 2
if ( i == 1 ) then
    disp ( &quot; Hello ! &quot; )
elseif ( i == 2 ) then
    disp ( &quot; Goodbye ! &quot; )
elseif ( i == 3 ) then
    disp ( &quot; Tchau ! &quot; )
else
    disp ( &quot; Au Revoir ! &quot; )
end</code></pre>
<p>Qual é a saída apresentada no console do Scilab? Porquê?</p>
<h3 id="a-instrução-de-repetição-for">A instrução de repetição “for”</h3>
<p>A instrução <code>for</code> permite que um pedaço de código seja executado repetidamente.</p>
<p>Veja o seguinte código:</p>
<pre><code>for i = 1:5
    disp(i)
end</code></pre>
<p>O que é mostrado no console do Scilab?</p>
<p>Veja o seguinte código:</p>
<pre><code>for j = 1:2:8
    disp(j)
end</code></pre>
<p>O que é mostrado no console do Scilab?</p>
<p>Veja o seguinte código:</p>
<pre><code>for k = 10:-3:1
    disp(k)
end</code></pre>
<p>O que é mostrado no console do Scilab?</p>
<p>Veja o seguinte código:</p>
<pre><code>for i = 1:3
    for j = 1:3
        disp([i,j])
    end
end</code></pre>
<p>O que é mostrado no console do Scilab?</p>
<h3 id="a-instrução-de-repetição-while">A instrução de repetição “while”</h3>
<p>A instrução <code>while</code> permite que um pedaço de código seja executado repetidamente até que uma dada condição seja satisfeita.</p>
<p>Veja o seguinte código Scilab:</p>
<pre><code>s = 0
i = 1
while ( i &lt;= 10 )
   s = s + i
   i = i + 1
end</code></pre>
<p>Qual é o valor de <code>s</code> ao final da execução? Porquê?</p>
<h2 id="funções">Funções</h2>
<p>Além das muitas funções já pré-definidas no Scilab, o usuário podemos definir nossas próprias funções. Para tanto, existem duas instruções no Scilab:</p>
<ul>
<li><p><code>deff</code></p></li>
<li><p><code>function</code></p></li>
</ul>
<p>A instrução <code>deff</code> é apropriada para definirmos funções com poucas computações. Quando a função exige um grande quantidade de código para ser definida, a melhor opção é usar a instrução <code>function</code>. Veja os seguintes exemplos:</p>
<p>O seguinte código:</p>
<pre><code>--&gt;deff(&#39;y = f(x)&#39;, &#39;y = x + sin(x)&#39;)</code></pre>
<p>define, no Scilab, a função <span class="math">$f(x) = x + \sen x$</span>.</p>
<p>Observe que <span class="math"><em>f</em>(<em>π</em>) = <em>π</em></span>. Confirme isso computando:</p>
<pre><code>--&gt;f(%pi)</code></pre>
<p>no Scilab.</p>
<p>Alternativamente, definimos a mesma função com o código:</p>
<pre><code>function [y] = f(x)
   y = x + sin(x)
endfunction</code></pre>
<p>Verifique!</p>
<p>O seguinte código Scilab:</p>
<pre><code>function [z] = h(x,y)
   if (x &lt; y) then
      z = y - x
   else
      z = x - y
   end
endfunction</code></pre>
<p>define a função: <br /><span class="math">$$h(x,y) = \left\{
    \begin{array}{ll}
      y - x &amp;, x &lt; y\\
      x - y &amp;, x \geq y
    \end{array}
\right.$$</span><br /></p>
<p>O seguinte código:</p>
<pre><code>function [y] = J(x)
   y(1,1) = 2*x(1)
   y(1,2) = 2*x(2)

   y(2,1) = -x(2)*sin(x(1)*x(2))
   y(2,2) = -x(1)*sin(x(1)*x(2))
endfunction</code></pre>
<p>define a matriz jacobiana <span class="math">$J(x_1,x_2) := \frac{\p(f_1,f_2)}{\p(x_1,x_2)}$</span> da função: <br /><span class="math">$$\pmb{f}(x_1,x_2) = (x_1^2 + x_2^2,~\cos(x_1x_2)).$$</span><br /></p>
<h2 id="gráficos">Gráficos</h2>
<p>Para criar um esboço do gráfico de uma função de uma variável real <span class="math"><em>y</em> = <em>f</em>(<em>x</em>)</span>, podemos usar a função <code>plot</code>. Esta função faz uma representação gráfica de pontos <span class="math">(<em>x</em><sub><em>i</em></sub>, <em>y</em><sub><em>i</em></sub>)</span> fornecidos. O Scilab oferece uma série de opções para esta função de forma que o usuário pode ajustar várias questões de visualização. Consulte sobre a função <code>plot</code> no <a href="http://help.scilab.org/docs/5.5.2/pt_BR/index.html">manual do Scilab</a>.</p>
<p>Veja as seguintes linhas de código:</p>
<pre><code>--&gt;deff(&#39;y = f(x)&#39;,&#39;y = x .^ 3 + 1&#39;)
--&gt;x = linspace(-2, 2, 100);
--&gt;plot(x, f(x)); xgrid</code></pre>
<h1 id="resposta-dos-exercícios" class="unnumbered">Resposta dos Exercícios</h1>
<p>Recomendamos ao leitor o uso criterioso das respostas aqui apresentadas. Devido a ainda muito constante atualização do livro, as respostas podem conter imprecisões e erros.</p>
<h1 id="referências-bibliográficas" class="unnumbered">Referências Bibliográficas</h1>
<h1 id="colaboradores" class="unnumbered">Colaboradores</h1>
<p>Até o momento não temos registro de colaborações externas ao corpo de organizadores. Ajude-nos a mudar isso editando você mesmo este livro. Seja o primeiro a ter o registro de sua colaboração neste espaço. O código fonte está disponível no repositório GitHub:</p>
<p><a href="https://github.com/livroscolaborativos/CalculoNumerico" class="uri">https://github.com/livroscolaborativos/CalculoNumerico</a></p>
<p>Dúvidas, escreva para a lista de emails:</p>
<p><a href="livro_colaborativo@googlegroups.com" class="uri">livro_colaborativo@googlegroups.com</a></p>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Para <span class="math"><em>b</em> &gt; 10</span>, veja a Observação [obs:sistema<sub>d</sub>e<sub>n</sub>umeracao]<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Em algumas referências é usado <span class="math">(0.1)<sub><em>b</em></sub> ≤ (<em>M</em>)<sub><em>b</em></sub> &lt; 1</span>.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Note que poderíamos definir números um pouco menores que o <span class="math"><em>M</em><em>I</em><em>N</em><em>R</em></span>.<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p>Esta definição é apresentada em <span class="citation"></span>. Não existe uma definição única na literatura para o conceito de dígitos significativos corretos, embora não precisamente equivalentes, elas transmitem o mesmo conceito. Uma maneira de interpretar essa regra é: calcula-se o erro relativo na forma normalizada e a partir da ordem do expoente temos o número de dígitos significativos corretos. Como queremos o expoente, podemos estimar <span class="math"><em>s</em></span> por <br /><span class="math">$$DIGSE(x,\bar{x})=s \approx int \left|\log_{10} \frac{|x-\overline{x}|}{|x|}\right|.$$</span><br /><a href="#fnref4">↩</a></p></li>
<li id="fn5"><p>Note que essas duas opções são equivalentes a somar <span class="math">5</span> no dígito a direita do corte e depois arredondar por corte, ou seja, arredondar por corte <br /><span class="math"> ± (<em>d</em><sub>0</sub>, <em>d</em><sub>1</sub><em>d</em><sub>2</sub>…<em>d</em><sub><em>k</em></sub><em>d</em><sub><em>k</em> + 1</sub> + 5 × 10<sup> − (<em>k</em> + 1)</sup>) × 10<sup><em>e</em></sup></span><br /><a href="#fnref5">↩</a></p></li>
<li id="fn6"><p>Sir Isaac Newton, 1642 - 1727, matemático e físico inglês.<a href="#fnref6">↩</a></p></li>
<li id="fn7"><p>Bernhard Placidus Johann Gonzal Nepomuk Bolzano, 1781 - 1848, matemático do Reino da Boêmia.<a href="#fnref7">↩</a></p></li>
<li id="fn8"><p>Heron de Alexandria, 10 d.C. - 70 d.C., matemático grego.<a href="#fnref8">↩</a></p></li>
<li id="fn9"><p>Joseph Raphson, 1648 - 1715, matemático inglês.<a href="#fnref9">↩</a></p></li>
<li id="fn10"><p>Também chamado apenas de método de Newton.<a href="#fnref10">↩</a></p></li>
<li id="fn11"><p>Leonardo Fibonacci, c. 1170 - c. 1250, matemático italiano.<a href="#fnref11">↩</a></p></li>
<li id="fn12"><p>A sequência de Fibonacci <span class="math">{<em>γ</em><sub><em>n</em></sub>}<sub><em>n</em> ∈ ℕ</sub></span> é definida por <span class="math"><em>γ</em><sub>0</sub> = <em>γ</em><sub>1</sub> = 1</span> e <span class="math"><em>γ</em><sub><em>n</em> + 1</sub> = <em>γ</em><sub><em>n</em></sub> − <em>γ</em><sub><em>n</em> − 1</sub></span>, <span class="math"><em>n</em> ≥ 1</span>.<a href="#fnref12">↩</a></p></li>
<li id="fn13"><p>Contando apenas multiplicações/divisões obtemos <br /><span class="math"><em>n</em> ⋅ 𝒪(<em>n</em>) = 𝒪(<em>n</em><sup>2</sup>) flops.</span><br /><a href="#fnref13">↩</a></p></li>
<li id="fn14"><p>Contando apenas <span class="math"> × </span> e <span class="math">/</span> obtemos <br /><span class="math"><em>n</em> × <em>n</em> × (<em>n</em>) = <em>n</em><sup>3</sup> flops.</span><br /><a href="#fnref14">↩</a></p></li>
<li id="fn15"><p>Contando apenas multiplicações/divisões obtemos <br /><span class="math">(<em>n</em><sup>2</sup> + <em>n</em>)/2 flops.</span><br /><a href="#fnref15">↩</a></p></li>
<li id="fn16"><p>Temos que <span class="math">$\displaystyle \sum_{k=1}^n k =n(n+1)/2, \quad\quad \sum_{k=1}^n 1=n$</span><a href="#fnref16">↩</a></p></li>
<li id="fn17"><p>Diferentemente de uma matriz esparsa, uma matriz densa possui a maioria dos elementos diferentes de zero.<a href="#fnref17">↩</a></p></li>
<li id="fn18"><p>Não vamos usar pivotamento nesse primeiro exemplo.<a href="#fnref18">↩</a></p></li>
<li id="fn19"><p>Perceba que a partir da segunda coluna para calcular <span class="math"><em>L</em><sub><em>i</em><em>j</em></sub></span> não usamos os elementos de <span class="math"><em>A</em></span>, mas os elementos da matriz <span class="math"><em>A</em></span> em processo de escalonamento<a href="#fnref19">↩</a></p></li>
</ol>
</div>
</body>
</html>
